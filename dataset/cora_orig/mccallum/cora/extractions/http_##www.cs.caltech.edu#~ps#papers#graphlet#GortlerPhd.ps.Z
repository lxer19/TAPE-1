URL: http://www.cs.caltech.edu/~ps/papers/graphlet/GortlerPhd.ps.Z
Refering-URL: http://www.cs.caltech.edu/~ps/papers/graphlet/
Root-URL: http://www.cs.caltech.edu
Title: WAVELET METHODS FOR COMPUTER GRAPHICS  
Author: Steven J. Gortler 
Degree: A DISSERTATION PRESENTED TO THE FACULTY  IN CANDIDACY FOR THE DEGREE OF DOCTOR OF PHILOSOPHY RECOMMENDED FOR ACCEPTANCE BY THE DEPARTMENT OF COMPUTER SCIENCE  
Date: January 1995  
Affiliation: OF PRINCETON UNIVERSITY  
Abstract-found: 0
Intro-found: 1
Reference: [1] <author> B. Alpert, G. Beylkin, R. Coifman, and V. Rokhlin. </author> <title> Wavelet-like bases for the fast solution of second-kind integral equations. </title> <journal> SIAM Journal on Scientific Computing, </journal> <volume> 14(1), </volume> <month> Jan </month> <year> 1993. </year>
Reference-contexts: = 6 6 6 6 6 6 6 1 2 1 2 3 7 7 7 7 7 7 5 The top two rows of this matrix are chosen to create box functions twice as wide while the bottom two rows are orthogonal to constant and linear variations (the vectors <ref> [1; 1; 1; 1] </ref>, [0; 1; 2; 3]). <p> 6 6 6 6 1 2 1 2 3 7 7 7 7 7 7 5 The top two rows of this matrix are chosen to create box functions twice as wide while the bottom two rows are orthogonal to constant and linear variations (the vectors [1; 1; 1; 1], <ref> [0; 1; 2; 3] </ref>). <p> This procedure is very similar to the one used in <ref> [1] </ref>. CHAPTER 4. WAVELET RADIOSITY 74 4.5.2 Calculating The Wavelet Matrix At the heart of the wavelet representation of the radiosity operator is a matrix of k terms defined by Equation (104).
Reference: [2] <author> Bradley Alpert. </author> <title> Construction of simple multiscale bases for fast matrix operations. </title> <editor> In Gregory Beylkin, Ronald Coifman, Ingrid Daubechies, Stephane Mallat, Yves Meyer, Louise Raphael, and Mary Beth Ruskai, editors, </editor> <booktitle> Wavelets and Their Applications, </booktitle> <pages> pages 211-226. </pages> <publisher> Jones and Bartlett, </publisher> <address> Cambridge, </address> <year> 1992. </year>
Reference-contexts: This represents work done jointly with other researchers at Princeton University, and the presentation here is adapted from the papers [40, 65]. The use of wavelet functions to quickly solve integral equations was discovered by <ref> [9, 2, 3] </ref>. This important discovery allows a large class of integral equations to be expressed in a wavelet basis by a sparse matrix with only O (n) significant entries. When a classical finite element basis is used, the resulting matrix generally has O (n 2 ) significant entries. <p> 6 6 6 6 1 2 1 2 3 7 7 7 7 7 7 5 The top two rows of this matrix are chosen to create box functions twice as wide while the bottom two rows are orthogonal to constant and linear variations (the vectors [1; 1; 1; 1], <ref> [0; 1; 2; 3] </ref>).
Reference: [3] <author> Bradley Alpert. </author> <title> A class of bases in L 2 for the sparse representation of integral operators. </title> <journal> SIAM Journal on Mathematical Analysis, </journal> <volume> 24(1), </volume> <month> Jan </month> <year> 1993. </year>
Reference-contexts: This represents work done jointly with other researchers at Princeton University, and the presentation here is adapted from the papers [40, 65]. The use of wavelet functions to quickly solve integral equations was discovered by <ref> [9, 2, 3] </ref>. This important discovery allows a large class of integral equations to be expressed in a wavelet basis by a sparse matrix with only O (n) significant entries. When a classical finite element basis is used, the resulting matrix generally has O (n 2 ) significant entries. <p> Hierarchical radiosity (HR) exploits "constant" smoothness in the kernel. Within this context, we recognize hierarchical radiosity as a first order wavelet. Higher order wavelets can be used that result in an even sparser matrix. One such family of higher order wavelets is the multiwavelet family of <ref> [3] </ref> (M 2;3 in Figure 15). <p> i )K (P 0 + i=0 = ~ P 0 KP 0 + i=0 L1 X ~ Q i KP 0 + i;l=0 (102) Each one of the terms in the above expansion describes the action of the integral operator between the two spaces on its left and right side <ref> [3] </ref>. 4.4.2 Non-Standard Decomposition A sparser set of coefficients representing the kernel can be obtained using the non standard wavelet decomposition. This representation must be used to obtain a method to implement the integral operator K. <p> In the implementation described in this thesis, only tree wavelets were considered because the wavelet radiosity program was written as an extension to an already existent hierarchical radiosity program 2 . Two families of bases were considered, the multiwavelets that were developed by Alpert <ref> [3] </ref>, and the flatlets which were developed specifically for the radiosity problem. To maintain the tree property, while increasing the number of vanishing moments, one must surrender the wavelet property of having the construction based on a single and a single . Instead multiple m and m shapes are used. <p> Instead multiple m and m shapes are used. Multiwavelets The M th multiwavelet basis, M M , is a generalization of the Haar basis with M vanishing moments, that was developed by Alpert <ref> [3] </ref> to quickly approximate integral operators. Like the Haar basis, the domain is divided up into a set of elements, and the represented function is allowed to be any polynomial of order M over each of the elements. There are no continuity constraints between the elements. <p> 6 6 6 6 1 2 1 2 3 7 7 7 7 7 7 5 The top two rows of this matrix are chosen to create box functions twice as wide while the bottom two rows are orthogonal to constant and linear variations (the vectors [1; 1; 1; 1], <ref> [0; 1; 2; 3] </ref>).
Reference: [4] <author> Peter R. Atherton. </author> <title> A scan-line hidden surface removal procedure for constructive solid geometry. </title> <journal> Computer Graphics, </journal> <volume> 17(3) </volume> <pages> 73-82, </pages> <year> 1983. </year>
Reference-contexts: Because these objects can be described mathematically in closed form, one doesn't have to resort to a "blocky" voxel representation. Also surface normals can be computed directly from the mathematical representation. These models can be ray traced, or converted to polygons for display <ref> [36, 4] </ref>. The main drawback to constructive solid geometry is that one must build all geometric objects by combining a fixed set of simple shapes. At times a user wants to describe an arbitrary or free-form shape, and so a more general representation is often required.
Reference: [5] <author> Richard Bartels and John Beatty. </author> <title> A technique for the direct manipulation of spline curves. </title> <booktitle> In Graphics Interface 1989, </booktitle> <pages> pages 33-39, </pages> <year> 1989. </year>
Reference-contexts: In least squares solving <ref> [5] </ref>, given a current curve or surface defined by some current set of control points, when the user drags on the curve/surface or otherwise defines some constraint, the new curve or surface is found that meets the new constraints, while minimizing the change of the control points.
Reference: [6] <author> Richard Bartels, John Beatty, and Brian Barsky. </author> <title> An Introduction to Splines for Use in Computer Graphics and Modeling. </title> <publisher> Morgan Kaufmann, </publisher> <year> 1987. </year>
Reference-contexts: One can continue this sequence, representing functions which are piecewise higher order polynomials, using B-spline basis functions N d i of arbitrary degree d <ref> [6] </ref>. The B-spline basis functions can be defined recursively using B-spline basis functions of lower degree. N d t t i1 N d1 t i+d t N d1 The sequence of parameter values t i is called the knot sequence. <p> These functions are defined as the division of two sets of basis functions, using a set of weighting coefficients w j . F (t) = i f i N d P j (t) This thesis will not be discussing NURBS. For more detail about B-splines see <ref> [6, 27] </ref>. 2.2 Haar basis Wavelets offer a family of bases that combine the frequency decomposition of the Fourier basis, with the piecewise locality of bases like the box, or hat basis. This combination of features is very useful. <p> basis functions, one may either choose to include the translational basis functions L;j themselves from Section 2.3.1 whose support intersects the boundaries by just truncating those basis functions at the boundary, or else one may use the special boundary basis functions that arise from placing quadruple knots at the boundaries <ref> [6] </ref>. This complete set of CHAPTER 2. WAVELETS 28 basis functions will be denoted L;j with j in f3 : : : 2 L 1g, where it is understood that the first and last three basis functions are the special boundary B-spline basis functions. <p> In particular, these knots can be coincident allowing for discontinuities of various degrees along a curve. The nonuniform rational B-spline basis (NURB), introduces a polynomial denominator which gives rise to rational functions that allow for expressing a greater variety of curves <ref> [6] </ref>. Parametric curves and surfaces, represented with combination of basis functions, are used in many popular modeling systems. They can be easily rendered, and are subject to a variety of useful manipulation methods. These parametric curves and surfaces will be the subject of this thesis. <p> Bernstein (and Hermite) basis functions are therefore often used because the resulting curve or surface interpolates the control points (and control tangents). Cubic B-splines are also commonly used because the resulting object is C 2 , and the curve is related to the control polyon in some natural ways <ref> [6] </ref>. These control schemes are desirable because it is computationally inexpensive to calculate and display a curve or surface given the control points. When controlling a curve or surface using a piecewise basis, the user is forced into manipulating the object at some fixed resolution.
Reference: [7] <author> Daniel R. Baum, Holly E. Rushmeier, and James M. Winget. </author> <title> Improving radiosity solutions through the use of analytically determined form-factors. </title> <journal> Computer Graphics, </journal> <volume> 23(3) </volume> <pages> 325-334, </pages> <month> July </month> <year> 1989. </year> <note> 176 BIBLIOGRAPHY 177 </note>
Reference-contexts: The distance between these polygons is 0:1. Because the shooter emits constant radiosity, and reflects none, the resulting radiosity at any point on the receiver can be analytically computed using the differential area to finite area form factor <ref> [7] </ref>. In the wavelet radiosity program, the user sets the stringency of the oracle using an input parameter.
Reference: [8] <author> G. Beylkin, R. Coifman, and V. Rokhlin. </author> <title> Fast wavelet transforms and numerical algorithms I. </title> <journal> Communications on Pure and Applied Mathematics, </journal> <volume> 44 </volume> <pages> 141-183, </pages> <year> 1991. </year>
Reference-contexts: It has been shown in <ref> [8] </ref> that a large class of smooth operators can be represented in a wavelet basis by a sparse matrix with only O (n) significant entries. This is a dramatic improvement over piecewise bases, where these operators are expressed by a dense matrix with O (n 2 ) significant entries. <p> of wavelets, which we have dubbed flatlets (F 2;3 in Figure 15) that require only low order quadrature methods while maintaining most of the benefits of other wavelet sets. 4.3 Compression of Integral Operators The theoretical basis for the wavelet radiosity method comes from the discovery by Beylkin et al. <ref> [8] </ref> that a large class of functional operators can be realized in the wavelet basis with a sparse set of matrix entries. <p> Although the theoretical bounds are stronger for the non-standard basis than for CHAPTER 4. WAVELET RADIOSITY 82 error plotted against number of coefficients used with full matrices, non-standard haar, standard haar, non-standard F 2 , and standard F 2 bases (top to bottom) (from [65]). the standard basis <ref> [8] </ref>, in these experiments the standard basis performed slightly better. This is consistent with the experimental results obtained in [47]. The explanation is that even though the non-standard functions have smaller support, the bivariate standard basis functions are combinations of univariate functions in both variables s and t. <p> Appendix B Bounding the Magnitude of Coefficients Beylkin et al. <ref> [8] </ref> prove that Calderon-Zygmund operators can be represented in the non-standard wavelet basis with only O (n) significant entries. This appendix summarizes their arguments. Given a Calderon-Zygmund kernel, the magnitude of a wavelet coefficient can be bounded as follows.
Reference: [9] <author> G. Beylkin, R. Coifman, and V. Rokhlin. </author> <title> Wavelets in numerical analysis. </title> <editor> In Gregory Beylkin, Ronald Coifman, Ingrid Daubechies, Stephane Mallat, Yves Meyer, Louise Raphael, and Mary Beth Ruskai, editors, </editor> <booktitle> Wavelets and Their Applications, </booktitle> <pages> pages 181-210. </pages> <publisher> Jones and Bartlett, </publisher> <address> Cambridge, </address> <year> 1992. </year>
Reference-contexts: This represents work done jointly with other researchers at Princeton University, and the presentation here is adapted from the papers [40, 65]. The use of wavelet functions to quickly solve integral equations was discovered by <ref> [9, 2, 3] </ref>. This important discovery allows a large class of integral equations to be expressed in a wavelet basis by a sparse matrix with only O (n) significant entries. When a classical finite element basis is used, the resulting matrix generally has O (n 2 ) significant entries. <p> In the non-standard basis, there are the 4 functions at level 0 with support 4 fi 4, CHAPTER 4. WAVELET RADIOSITY 62 while the remaining 12 basis functions only involve functions at level 1 and all have support 2 fi 2. For the non-standard basis, the arguments in <ref> [9] </ref> arrive at an O (n) sparseness bound on the number of significant coefficients. 4.4 Wavelet Radiosity 4.4.1 Standard Decomposition The idea behind the standard wavelet method is simple. <p> This representation must be used to obtain a method to implement the integral operator K. This can be done using the method described in <ref> [9] </ref>, which may be described from three different points of view. Algebraic In Equation (101), ^ K is expressed with respect to the standard bivariate wavelet basis. As explained in Section 2.6.2, an alternative bivariate basis is the non-standard basis, CHAPTER 4. <p> Because all of the bivariate basis functions have square support, the well-separated arguments of <ref> [9] </ref>, show that only O (n) k terms will be above *. The only question remaining is how does one use this expansion of the kernel function to expand the integral operator. To expand the operator, it is best to begin with Equation (90) and not Equation (91). <p> CHAPTER 4. WAVELET RADIOSITY 68 4.5.1 Choice of Basis The 3D implementation of wavelet radiosity, includes only the non-standard decomposition due to the theoretical properties of this basis, and due to some implementation issues. In particular, the arguments in <ref> [9] </ref> show an O (n) sparseness for the non-standard decomposition, as compared to O (n lg n) sparseness for the standard decomposition. In addition, our implementation of wavelet radiosity was built on top of an already existing hierarchical radiosity program [44], and the non-standard basis was a more natural extension. <p> The bottom row shows the matrix of the flatland kernel for two line segments meeting at right angles in the same three bases (from [65]). measuring the specific error incurred when using some fixed emission function E. This is also different from the k 2 matrix norm used in <ref> [9] </ref>. The k 2 matrix norm measures the worst possible error over the space of possible emission functions. This is probably too pessimistic for typical radiosity problems. <p> The system of Equation (131) is set up using a wavelet basis instead of a finite-element basis, and then all of the off diagonal terms of H are discarded. This new linear system can then be solved very rapidly. The justification given in [58] for this method cites Beylkin <ref> [9] </ref> and claims that due to the vanishing moments of the wavelet basis, most of the off diagonal terms are negligible and so can be ignored.
Reference: [10] <author> James Blinn. </author> <title> A generalization of algebraic surface drawing. </title> <journal> ACM TOG, </journal> <volume> 1(3) </volume> <pages> 235-256, </pages> <month> July </month> <year> 1982. </year>
Reference-contexts: For implicit surfaces, one needs a way to represent the density function, F , using a finite set of scalars. The most prevalent method is the blobby object method <ref> [10, 79] </ref>, where the density function is defined by placing a collection of "field sources" in space. These field sources have simple density functions, such as a decaying Gaussian function that has the greatest value at the center, and decrease with distance.
Reference: [11] <author> Terrence Boult. </author> <title> Information-Based Complexity in Nonlinear Equations and Computer Vision. </title> <type> PhD thesis, </type> <institution> Columbia University, </institution> <year> 1986. </year>
Reference-contexts: When a piecewise basis is used, the condition number of the resulting matrix grows as O (n 2 ) <ref> [11] </ref>. The number of iterations required by iterative methods for convergence is a function of . As discussed in [25, 81], for a large class of differential equations, when the problem is expressed in a wavelet basis, the condition number of the resulting matrix remains constant, independent of n. <p> For these problems, when a fixed resolution basis, such a B-spline basis, is used in a finite element approximation of X, the condition number of the resulting matrix grows as n 2 , where n is the number of basis functions <ref> [47, 11] </ref>. The number of iterations required by the conjugate gradiant method to achieve convergence to within some epsilon grows proportionally to p [71, 47]. As a result, obtaining accurate solutions to these problems using a finite element basis is very costly.
Reference: [12] <author> William L. Briggs. </author> <title> A Multigrid Tutorial. </title> <publisher> SIAM, </publisher> <year> 1987. </year>
Reference-contexts: In other multigrid schemes, the algorithm uses a more complicated pattern of subproblems at various resolutions. This is done so to avoid slow convergence. Multigrid is a successful and popular methodology, with entire conferences devoted to its details <ref> [12] </ref>. In contrast to the multigrid methods, the wavelet method used here attempts to solve a single problem, but the good conditioning is obtained by using a multires-olution basis. Various researchers have discussed using a wavelet basis to quickly solve differential equations [60, 47].
Reference: [13] <author> E. Catmull and J. Clark. </author> <title> Recursively generated b-spline surfaces on arbitrary topological meshes. </title> <booktitle> Computer Aided Design, </booktitle> <volume> 10(6) </volume> <pages> 350-355, </pages> <year> 1978. </year>
Reference-contexts: Computing the intersection of a ray with an implicit surface requires an expensive root finding operation. Another way to represent a surface is using some procedural method. An example of a procedural representation is subdivision surfaces <ref> [13, 43] </ref>. In this representation, the surface is defined by an input mesh made up of vertices and edges. A transformation rule is applied to the input mesh resulting in a denser mesh.
Reference: [14] <author> Per Christensen, Eric Stollnitz, David Salesin, and Tone DeRose. </author> <title> Importance-driven wavelet radiance. </title> <type> Technical Report TR 94-01-05, </type> <institution> Department of Computer Science, University of Washington, </institution> <month> January </month> <year> 1994. </year>
Reference-contexts: The left column of Figure 19 shows these projections 6 Special Gauss-Legendre rules can be developed for each basis function, so that its order is considered an "integral weighting function", not included in the complexity of the integrand. This has been attempted in <ref> [14] </ref>. 7 This choice is justified further in [65]. CHAPTER 4. WAVELET RADIOSITY 79 . with L = 5 obtaining a 64 fi 64 element matrix (1=4 of the full symmetric matrix is shown in these figures). <p> The work described in this thesis has been recently been extended to elegantly use texture mapped emittance and reflection patterns [34]. More significantly, there is current research extending this wavelet method to solve the general illumination rendering equation with glossy reflectance <ref> [67, 14] </ref>. CHAPTER 4. WAVELET RADIOSITY 87 rendered directly from the basis functions (from [40]). Chapter 5 Geometric Modeling There are many computer applications where it is necessary for a computer to have an internal representation of some three dimensional geometric object.
Reference: [15] <author> Charles Chui and Ewald Quak. </author> <title> Wavelets on a bounded interval. Numerical Methods of Approximation Theory, </title> <booktitle> 9 </booktitle> <pages> 53-75, </pages> <year> 1992. </year>
Reference-contexts: A full description of this construction is given in <ref> [15, 61] </ref>. This interval construction, which on the real line corresponds to Equations (15) and (16), is described by the linear time procedure basis xform up that is given in Appendix A.2. <p> The sequence h and the sequence g are the convolution sequences used to construct the inner basis functions [16], while the vectors h j and the vectors g j are used to construct the boundary basis functions <ref> [15, 61] </ref>. Only the vectors for the left boundary are given, the vectors for the right boundaries are the mirror images of these vectors. It is assumed that the boundary B-spline basis functions are those that arise by placing quadruple knots at the boundaries.
Reference: [16] <author> Charles K. Chui. </author> <title> An Introduction to Wavelets, volume 1 of Wavelet Analysis and its Applications. </title> <publisher> Academic Press Inc., </publisher> <year> 1992. </year>
Reference-contexts: Some of the details are technical, and the reader may want to first read this chapter lightly, and later come back to this chapter as a reference. More details about wavelets may be found in <ref> [59, 16, 54, 26] </ref>. 2.1 Basis Functions Computer graphics applications, in particular geometric modeling and realistic rendering, often require a method for representing or approximating some function F (t). One possible representation is through a linear combination of a set of basis functions using scalar coefficients as weights. <p> This space will be referred to as V L1 . According to the well known B-spline knot insertion algorithm <ref> [18, 30, 16] </ref> there is the following relationship L1;j = k where the sequence h is given in Appendix A.1. This process is illustrated in Figure 6. Clearly V L1 is a proper subset of V L and thus, it is not as rich as the space V L . <p> For certain technical reasons, that construction is called bi-orthogonal. There are other possible wavelet constructions based on cubic B-splines. In <ref> [16] </ref> a different sequence g is chosen (given here in Appendix A.2) so that the resulting basis functions L1;j are orthogonal to the B-spline basis functions L1;j with respect to the L 2 inner product, defined for general functions F and G as hF (t); G (t)i = 1 This type <p> Modulo scaling, this implies that h = ~ h and g = ~g. The price paid for full orthogonality in the cubic B-spline setting is that the sequence g must be infinite in length, and the function must have infinite support <ref> [16] </ref>. 2.3.2 Bases on the Interval In a classical wavelet construction, the index j goes from 1 : : : 1, and V L includes functions of unbounded support. <p> Corresponding to these sequences are associated and functions. Perhaps the most famous wavelets are the ones developed by Daubechies [26]. These wavelets are both fully orthogonal and have compact support. (This is impossible when the is a cubic B-spline <ref> [16] </ref>). The Daubechies wavelets are not symmetric. <p> The sequence h and the sequence g are the convolution sequences used to construct the inner basis functions <ref> [16] </ref>, while the vectors h j and the vectors g j are used to construct the boundary basis functions [15, 61]. Only the vectors for the left boundary are given, the vectors for the right boundaries are the mirror images of these vectors.
Reference: [17] <author> A. Cohen, Ingrid Daubechies, and J. C. Feauveau. </author> <title> Biorthogonal bases of compactly supported wavelets. </title> <journal> Communication on Pure and Applied Mathematics, </journal> <volume> 45 </volume> <pages> 485-560, </pages> <year> 1992. </year>
Reference-contexts: Advantages to the particular choice 2 There are some other technical requirements in order to ensure the numerical stability of the basis. These requirements insure a dual basis with certain bi-orthogonal properties, and hence are called bi-orthogonal wavelets. See <ref> [17] </ref>. CHAPTER 2. WAVELETS 20 the wavelet function L1;0 of g given in Figure 7 include compactness and symmetry. <p> This process is illustrated in Figure 8. In the literature, there are many wavelet constructions, each with its own particular functions and , and sequences h, g, ~ h, and ~g 3 , The sequences and the particular wavelet construction described in this section are derived in <ref> [17] </ref>. <p> However, it can be shown that under some weak conditions, there does exist a dual shape ~ that does have the two-scale property <ref> [17] </ref>. When wavelet functions i;j are used to form a basis for L 2 on the real line (i.e., not just V L ) by including "infinite" levels fi = 0 : : : 1g, then there is one natural dual basis, and this dual basis satisfies the two-scale property. <p> It is important to see how these wavelet optimization methods can be applied to other areas as well. Appendix A A.1 Bi-orthogonal B-spline Wavelet Transform This appendix provides pseudo code for the bi-orthogonal wavelet transform. The convolution sequences are given in <ref> [17] </ref>.
Reference: [18] <author> Elane Cohen, Tom Lyche, and Richard Riesenfeld. </author> <title> Discrete b-splines and subdivision techniques in computer-aided geometric design and computer graphics. </title> <journal> Computer Graphics and Image Processing, </journal> <volume> 14(2) </volume> <pages> 87-111, </pages> <month> October </month> <year> 1980. </year> <note> BIBLIOGRAPHY 178 </note>
Reference-contexts: This space will be referred to as V L1 . According to the well known B-spline knot insertion algorithm <ref> [18, 30, 16] </ref> there is the following relationship L1;j = k where the sequence h is given in Appendix A.1. This process is illustrated in Figure 6. Clearly V L1 is a proper subset of V L and thus, it is not as rich as the space V L .
Reference: [19] <author> Michael F. Cohen. </author> <title> Spacetime constraints. </title> <journal> Computer Graphics, </journal> <volume> 26(2) </volume> <pages> 293-302, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: This hierarchical representation offers a flexible way to extend the methods described in this thesis to more general surface topologies. Numerical optimization is a general paradigm that can be applied to many problem domains. One such example is the control problems that arise in computer animation <ref> [19] </ref>. In such a problem the animator wishes to create an animation sequence for some creature without specifying the exact trajectory that the creature will take. In this context, a costly non-linear minimization problem must be solved.
Reference: [20] <author> Michael F. Cohen, Shenchang Eric Chen, John R. Wallace, and Donald P. Green-berg. </author> <title> A progressive refinement approach to fast radiosity image generation. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 75-84, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: In [21] it was noted this matrix is diagonally dominant, and hence can be solved by relaxation methods such as Gauss-Seidel or Jacobi iteration, which converge to acceptable solutions much quicker than direct inversion methods. This was improved upon in <ref> [20] </ref> where the progressive radiosity (PR) solution method was introduced. PR operates by keeping track of unshot energy and "shooting" it around the environment until convergence occurs.
Reference: [21] <author> Michael F. Cohen and Donald P. Greenberg. </author> <title> The hemi-cube: A radiosity solution for complex environments. </title> <journal> Computer Graphics, </journal> <volume> 19(3) </volume> <pages> 31-40, </pages> <month> July </month> <year> 1985. </year>
Reference-contexts: Some research has focussed on methods for solving the linear system (Equation (71)). Obviously one could use a direct matrix inversion technique such as Gaussian elimination, but this takes O (n 3 ) time. In <ref> [21] </ref> it was noted this matrix is diagonally dominant, and hence can be solved by relaxation methods such as Gauss-Seidel or Jacobi iteration, which converge to acceptable solutions much quicker than direct inversion methods. This was improved upon in [20] where the progressive radiosity (PR) solution method was introduced.
Reference: [22] <author> Michael F. Cohen, Donald P. Greenberg, David Immel, and Phillip Brock. </author> <title> An efficient radiosity approach for realistic image synthesis. </title> <journal> IEEE CG&A, </journal> <volume> 6(3) </volume> <pages> 26-35, </pages> <year> 1986. </year>
Reference-contexts: After all of the shooting elements have been accounted for, the received energy can then be summed up at finest resolution mesh of the receiver. Multilevel shooters: Cohen et al. <ref> [22] </ref> discuss the converse strategy. In their method, one always uses the finest resolution mesh to describe the receiving surface, but one uses a coarser description to represent the energy distribution of the shooting surface.
Reference: [23] <author> Michael F. Cohen and John R. Wallace. </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press Professional, </publisher> <year> 1993. </year>
Reference-contexts: function (BRDF) f r (! i ; s; ! o ; ) (70) which describes the amount of light from an incoming beam centered in the direction ! i with wavelength 2 that is reflected in the outgoing direction ! o at the surface point s (see Figure 13). (See <ref> [23] </ref> for a comprehensive discussion of photometric units). Thus given a point light source in some direction ! i , and an eye placed in direction ! o , the BRDF can be used to compute the the appearance of the surface point s to the eye. <p> This algorithm raises several computational issues that have motivated a great deal of research. The form factor integrals Equation (72), must be computed, and many methods to do this have since been developed <ref> [23] </ref>. <p> that the mesh of elements chosen has a great impact on the quality of the solution; in regions where the true radiosity varies greatly (for example shadow boundaries) many small elements are needed to express the variation, thus methods for mesh generation have also generated a great deal of research <ref> [23] </ref>. Once the solution (b) is computed one can simply output flat shaded surface elements to the screen, but one may also use more sophisticated methods such displaying Gouraud shaded polygons, or employing some more complicated method of reconstruction [63]. <p> If the symmetric expansion is used, but the primals and duals do not span the same space, then the projection of Equation (92) is not orthogonal, CHAPTER 4. WAVELET RADIOSITY 69 and one does not obtain a true Galerkin method. (One obtains a more general weighted residual method <ref> [23] </ref>.) * The tree property of the Haar basis is convenient for implementation. In tree wavelets, during the construction of the two-part basis, disjoint sets of scaling functions are combined to construct disjoint sets of wavelet and wider scaling functions.
Reference: [24] <author> Robert Cook, Thomas Porter, and Loren Carpenter. </author> <title> Distributed ray tracing. </title> <journal> Computer Graphics, </journal> <volume> 18(3) </volume> <pages> 137-145, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: Early ray tracing methods only accounted for direct reflection of point light sources at non-specular surfaces, and indirect reflection at specular surfaces. Later, these methods were extended to include area light sources and non-specular interreflection using the method of distribution ray tracing <ref> [24] </ref>. To account for area light sources, a large collection (distribution) of shadow rays are fired towards area light sources. Each of these shadow rays is associated with some fraction of the area light source, CHAPTER 3. RADIOSITY 46 and propagates its energy back to the surface point.
Reference: [25] <author> Wolfgang Dahmen and Angel Kunoth. </author> <title> Multilevel preconditioning. </title> <journal> Numerische Mathematik, </journal> <volume> 63 </volume> <pages> 315-344, </pages> <year> 1992. </year>
Reference-contexts: When a piecewise basis is used, the condition number of the resulting matrix grows as O (n 2 ) [11]. The number of iterations required by iterative methods for convergence is a function of . As discussed in <ref> [25, 81] </ref>, for a large class of differential equations, when the problem is expressed in a wavelet basis, the condition number of the resulting matrix remains constant, independent of n. This feature of wavelets can be used to obtain efficient solutions to certain optimization problems that arise in geometric modeling. <p> As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. When a multiresolution basis, such as a wavelet basis is employed to solve these problems, it can be shown that the number of iterations remains constant, independent of n <ref> [81, 47, 25] </ref>. Thus, wavelets provide a practical way of quickly obtaining solutions to many differential equations. For a more detailed discussion see Appendix C. CHAPTER 7. <p> When the basis functions are normalized, the basis transformation to the wavelet basis can become close to an orthogonal transformation. An orthogonal basis transformation merely "rotates" the finite dimensional optimization problem, and cannot change its conditioning properties. For the optimization procedure to be well conditioned <ref> [47, 25] </ref> it is essential to emphasize the coarser levels. The correct theoretical scaling depends on both the energy function used, and the dimension of problem. For a fuller discussion, see Appendix C. <p> Since there are only log n levels, the number of significant entries is O (n): log n X w fl length (diagonal (i)) = X w fl 2 i = O (n) (186) Appendix C Bounding the Condition Number A number of researchers <ref> [81, 47, 25] </ref> have studied the condition number of the matrices that arise from finite-element solutions to differential equations. Their main result is that when a wavelet basis is used, the condition number of the matrix remains constant, independent of n, the number of functions in the basis. <p> Thus, remains bounded <ref> [81, 47, 25] </ref>.
Reference: [26] <author> Ingrid Daubechies. </author> <title> Ten Lectures on Wavelets, </title> <booktitle> volume 61 of CBMS-NSF Regional Conference Series in Applied Mathematics. </booktitle> <publisher> SIAM, </publisher> <year> 1992. </year>
Reference-contexts: Some of the details are technical, and the reader may want to first read this chapter lightly, and later come back to this chapter as a reference. More details about wavelets may be found in <ref> [59, 16, 54, 26] </ref>. 2.1 Basis Functions Computer graphics applications, in particular geometric modeling and realistic rendering, often require a method for representing or approximating some function F (t). One possible representation is through a linear combination of a set of basis functions using scalar coefficients as weights. <p> Both of these methods are unacceptable since they will require the function to either be zero at the ends, periodic (a closed B-spline curve), or have discontinuities. Bi-orthogonal Mirrored Interval Construction Another solution is to use a mirror-reflection of the interval <ref> [26] </ref>. This technique, borrowed from signal processing, is simple to understand and requires the least special cases in the code. Because the technical details are non-trivial, this thesis includes specific pseudo-code in Appendix A.1. <p> In the signal processing literature, many convolution sequences (h, g, ~ h, and ~g) have been developed in the context of band-pass filters used for signal compression. Corresponding to these sequences are associated and functions. Perhaps the most famous wavelets are the ones developed by Daubechies <ref> [26] </ref>. These wavelets are both fully orthogonal and have compact support. (This is impossible when the is a cubic B-spline [16]). The Daubechies wavelets are not symmetric.
Reference: [27] <author> Gerald Farin. </author> <title> Curves and Surfaces for Computer Aided Geometric Design. </title> <publisher> Academic Press, </publisher> <year> 1990. </year>
Reference-contexts: A drawback of piecewise linear interpolation is the derivative discontinuities at the point samples; these discontinuities may not be desirable for some applications. A different representation method which generates a smooth function is polynomial interpolation (using Lagrange's method <ref> [27] </ref>). Although these polynomials are smooth, Lagrange interpolation is not a well behaved method; when one interpolates a large set of points, the resulting polynomial tends to oscillate wildly [27]. <p> A different representation method which generates a smooth function is polynomial interpolation (using Lagrange's method <ref> [27] </ref>). Although these polynomials are smooth, Lagrange interpolation is not a well behaved method; when one interpolates a large set of points, the resulting polynomial tends to oscillate wildly [27]. Both linear interpolation and polynomial interpolation can be expressed by linearly combining a set of functional "building blocks" called basis functions. This method allows one to approximately represent a function using a set of discrete scalar values called "coefficients". <p> This thesis will discuss a variety of modeling paradigms and explain how a wavelet basis can be used to obtain efficient and useful modeling tools. In the simplest geometric modeling paradigm the user sculpts a curve or surface by dragging control points (e.g., Bezier or B-spline <ref> [27] </ref>). Each control point directs how the different basis functions are to be blended, and so this method is sensitive to the type of basis functions being used. <p> These functions are defined as the division of two sets of basis functions, using a set of weighting coefficients w j . F (t) = i f i N d P j (t) This thesis will not be discussing NURBS. For more detail about B-splines see <ref> [6, 27] </ref>. 2.2 Haar basis Wavelets offer a family of bases that combine the frequency decomposition of the Fourier basis, with the piecewise locality of bases like the box, or hat basis. This combination of features is very useful. <p> For curves, the intrinsic equivalent to the thin plate measure method is based on the second derivative of the arc-length parameterization of the curve. For surfaces, curvature is measured with gaussian and normal curvature <ref> [27] </ref>. Other intrinsic functionals include the minimum variation surface measure of [57] and the measures given in [62]. All of these functionals can have variable local weights over s and t, allowing the modeling material to be "stiffer" in some regions, and more flexible (and even creasable) in others [73].
Reference: [28] <author> Adam Finkelstein and David Salesin. </author> <title> Multiresolution curves. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1994, </year> <pages> pages 261-268. </pages> <note> Siggraph, </note> <year> 1994. </year>
Reference-contexts: This gives the user a more flexible manipulation method. The wavelet representation allows the user to specify whether local detail changes are desired, or whether broader changes to the entire sweep of the object are intended. These ideas have been pursued independently by Finkelstein et al. <ref> [28] </ref>. The wavelet 100 CHAPTER 6. MULTIRESOLUTION MODELING WITH WAVELETS 101 "hump" like fashion. When wavelet coefficients are manipulated, the curve responds in a "wave" like fashion. approach may be considered as an extension to the Hierarchical B-spline approach described in [30, 31]. <p> This is not fully desirable, since the user may want the detail's orientation to follow the broad sweep. An "orientation" approach used with hierarchical B-splines [30] may be applied to the wavelet multiresolution editing scheme, as suggested by Adam Finkelstein <ref> [28] </ref>. In a multiresolution representation, each level of the hierarchy represents a further level of detail. Usually this detail is expressed as three independent functions of x; y; z.
Reference: [29] <author> James Foley, Andries van Dam, Steven Feiner, and John Hughes. </author> <title> Computer Graphics, </title> <booktitle> Principles and Practice. </booktitle> <publisher> Addison-Wesley Publishing, </publisher> <year> 1990. </year>
Reference-contexts: This can be used to compute the value of the corresponding pixel of a graphical image. Many simple lighting models, such as Phong and Torrance-Sparrow have been developed <ref> [29] </ref>, and important research on BRDFs continues to the present time [50, 64]. 2 In computer graphics, color is often handled by sampling the visible spectrum at three locations for red, green, and blue values. This thesis will have no further discussion of wavelength, and will be dropped. CHAPTER 3.
Reference: [30] <author> David Forsey and Richard Bartels. </author> <title> Hierarchical b-spline refinement. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 205-212, </pages> <month> August </month> <year> 1988. </year> <note> BIBLIOGRAPHY 179 </note>
Reference-contexts: This space will be referred to as V L1 . According to the well known B-spline knot insertion algorithm <ref> [18, 30, 16] </ref> there is the following relationship L1;j = k where the sequence h is given in Appendix A.1. This process is illustrated in Figure 6. Clearly V L1 is a proper subset of V L and thus, it is not as rich as the space V L . <p> This adaptivity can be done easily when using a hierarchical description; a few wide (or coarse) basis functions can be used until the solution procedure decides to add detail in some region. Wavelets offer such a hierarchical basis for representing a curve or surface. Unlike hierarchical B-splines <ref> [30] </ref>, which over-represent a curve or surface by using B-spline functions of different widths, wavelets offer a unique representation of a curve or surface. The wavelet coefficients directly encode the necessary detail at various degrees of resolution, and thus allow solutions of variational problems to proceed adaptively and quickly. <p> The wavelet 100 CHAPTER 6. MULTIRESOLUTION MODELING WITH WAVELETS 101 "hump" like fashion. When wavelet coefficients are manipulated, the curve responds in a "wave" like fashion. approach may be considered as an extension to the Hierarchical B-spline approach described in <ref> [30, 31] </ref>. In the Hierarchical B-spline approach, there is no unique representation of any curve or surface. When a user modifies some "broad" B-spline control points, the affect on "finer" control points is computed using B-spline refinement rules. <p> When the levels are moving "away from" each other, then a modified pyramid up or down is performed. This modeling method is quite similar to the Hierarchical B-spline editing method CHAPTER 6. MULTIRESOLUTION MODELING WITH WAVELETS 114 described in <ref> [30] </ref> where the resulting curve (or surface) is defined as the superposition of the hierarchical B-spline functions f i;j g 0 i L (136) and the user directly manipulates the hierarchical B-spline control points. <p> If the user later manipulates the broad sweep of the curve, the detail will still maintain its direction (see Figure 41). This is not fully desirable, since the user may want the detail's orientation to follow the broad sweep. An "orientation" approach used with hierarchical B-splines <ref> [30] </ref> may be applied to the wavelet multiresolution editing scheme, as suggested by Adam Finkelstein [28]. In a multiresolution representation, each level of the hierarchy represents a further level of detail. Usually this detail is expressed as three independent functions of x; y; z. <p> The stored (t; n; b) triplets are used with these new frames. Using this method, the wavelet description of detail follows the broad orientation of the curve. Even though this idea works well in the context of hierarchical B-splines <ref> [30] </ref>, in the wavelet context, this is not as successful. When the user changes the broad sweep CHAPTER 6. MULTIRESOLUTION MODELING WITH WAVELETS 117 of the curve, changing the tangent, normal, and binormal frame at t j , this remixes the wavelet functions.
Reference: [31] <author> David Forsey and Lifeng Weng. </author> <title> Multi-resolution surface approximation for animation. </title> <booktitle> In Graphics Interface, </booktitle> <year> 1993. </year>
Reference-contexts: The wavelet 100 CHAPTER 6. MULTIRESOLUTION MODELING WITH WAVELETS 101 "hump" like fashion. When wavelet coefficients are manipulated, the curve responds in a "wave" like fashion. approach may be considered as an extension to the Hierarchical B-spline approach described in <ref> [30, 31] </ref>. In the Hierarchical B-spline approach, there is no unique representation of any curve or surface. When a user modifies some "broad" B-spline control points, the affect on "finer" control points is computed using B-spline refinement rules.
Reference: [32] <author> Barry Fowler. </author> <title> Geometric manipulation of tensor product surfaces. </title> <booktitle> In Proceedings, Symposium on Interactive 3D Graphics, </booktitle> <pages> pages 101-108, </pages> <year> 1992. </year>
Reference-contexts: The magnitude of the change is measured by the sum of the squares of the change in each control point. Least square solutions can be found very inexpensively using the pseudoinverse <ref> [32] </ref> or quadratic minimization techniques [76]. Clearly the semantics of this method is sensitive to the representation used. For example if the uniform cubic B-spline basis is used, the addition of an interpolation constraint has a very local effect. <p> The basis functions are "locked" and the least squared solution is found over the r d ;j coefficients. The least squared solution may be found using the pseudoinverse <ref> [32] </ref>.
Reference: [33] <author> Reid Gershbein. </author> <type> Personal communication. </type>
Reference-contexts: In practice, because of the high constant factor of using the bases with many vanishing moments, users of the program have had the best experience with the M 2 basis <ref> [33] </ref>. Clearly it will be fruitful to experiment in 3D with a standard decomposition, using families of continuous wavelets. The work described in this thesis has been recently been extended to elegantly use texture mapped emittance and reflection patterns [34].
Reference: [34] <author> Reid Gershbein, Peter Schroder, and Pat Hanrahan. </author> <title> Textures and radiosity: Controlling emission and reflection with texture maps. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1994, </year> <pages> pages 51-58. </pages> <note> Siggraph, </note> <year> 1994. </year>
Reference-contexts: Clearly it will be fruitful to experiment in 3D with a standard decomposition, using families of continuous wavelets. The work described in this thesis has been recently been extended to elegantly use texture mapped emittance and reflection patterns <ref> [34] </ref>. More significantly, there is current research extending this wavelet method to solve the general illumination rendering equation with glossy reflectance [67, 14]. CHAPTER 4. WAVELET RADIOSITY 87 rendered directly from the basis functions (from [40]).
Reference: [35] <author> Philip Gill, Walter Murray, and Margaret Wright. </author> <title> Practical Optimization. </title> <publisher> Academic Press, </publisher> <year> 1981. </year>
Reference-contexts: Solution techniques such as sequential quadratic programming <ref> [35] </ref>, lead to a series of linear systems with a form like Equation (131). A common choice of a basis for variational modeling is the uniform cubic B-spline basis.
Reference: [36] <author> Robert A. Goldstein and Roger Nagel. </author> <title> 3-D visual simulation. </title> <journal> Simulation, </journal> <volume> 16(1) </volume> <pages> 25-31, </pages> <month> January </month> <year> 1971. </year>
Reference-contexts: Because these objects can be described mathematically in closed form, one doesn't have to resort to a "blocky" voxel representation. Also surface normals can be computed directly from the mathematical representation. These models can be ray traced, or converted to polygons for display <ref> [36, 4] </ref>. The main drawback to constructive solid geometry is that one must build all geometric objects by combining a fixed set of simple shapes. At times a user wants to describe an arbitrary or free-form shape, and so a more general representation is often required.
Reference: [37] <author> Gene Golub and Charles Van Loan. </author> <title> Matrix Computations. </title> <publisher> Johns Hopkins University Press, </publisher> <year> 1989. </year>
Reference-contexts: Given a current guess, x (k) , these methods pick a descent direction, and then travel along that direction by some amount. Often the distance 2 QR factorization updating is another good method for quickly updating a solution as new constraints are added <ref> [37] </ref>. 3 This squaring of the matrix has the unfortunate consequence of squaring the condition number. CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 123 is chosen that minimizes the quadratic function along that direction 4 .
Reference: [38] <author> Cindy M. Goral, Kenneth E. Torrance, Donald P. Greenberg, and Bennett Bat-taile. </author> <title> Modeling the interaction of light between diffuse surfaces. </title> <journal> Computer Graphics, </journal> <volume> 18(3) </volume> <pages> 212-222, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: In this method, the illumination function is represented pointwise, i.e., the function is only defined at a discrete set of points (which correspond to the surface points "seen" through each pixel). This thesis will focus on the radiosity method for realistic rendering <ref> [38] </ref>. Unlike ray tracing, which generates a single image with a single view of the environment, the radiosity method is view independent; it produces a representation of the illumination over all of the surface points in the environment. <p> Computing the correct illumination function has been one of the primary foci of computer graphics research. There are two families of methods commonly used, the ray tracing method [77], and the radiosity method <ref> [38] </ref>. The ray tracing method simulates the light in the environment by tracing the paths of many photons. In contrast to this, the radiosity method breaks up the environment into little pieces or elements, and computes how the illumination at one element effects the illumination of the others. <p> In theory, these methods can be extended to include very general BRDFs such as diffuse reflectance, but this requires sending an immense amount of rays to sample the entire hemisphere of reflection (there being no preferred bounce direction). The radiosity algorithm <ref> [38] </ref> was introduced as a method for rendering an image with primarily diffuse reflectance, and area light sources. <p> But this is a result of measuring in units of radiosity (power/area) instead of power and using the reciprocity relationship A i F i;j = A j F j;i <ref> [38] </ref>. CHAPTER 3.
Reference: [39] <author> Steven J. Gortler, Michael F. Cohen, and Philipp Slusallek. </author> <title> Radiosity and relaxation methods. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 14, </volume> <month> November </month> <year> 1994. </year>
Reference-contexts: This was improved upon in [20] where the progressive radiosity (PR) solution method was introduced. PR operates by keeping track of unshot energy and "shooting" it around the environment until convergence occurs. In <ref> [39] </ref>, it was shown that PR is related to the Southwell method of solving linear systems. 4 In all of the integrals presented in this chapter are parameterized with respect to geometric size. For 3D radiosity then, dt and ds are unit area elements.
Reference: [40] <author> Steven J. Gortler, Peter Schroder, Michael F. Cohen, and Pat Hanrahan. </author> <title> Wavelet radiosity. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 221-230. </pages> <note> Siggraph, </note> <month> August </month> <year> 1993. </year>
Reference-contexts: In particular this thesis will describe how the wavelet basis gives rise to a sparse linear system, which can be computed and solved quickly. 1 These chapters represent work done jointly with Peter Schroder and our advisors Professors Michael F. Cohen and Pat Hanrahan and is also reported in <ref> [40, 65] </ref>. 43 CHAPTER 3. RADIOSITY 44 incoming and outgoing directions ! i and ! o . 3.1 A Little Background The earliest attempts to render realistic looking images only focused on local reflectance properties. The goal was to mimic the way that real objects respond to real light sources. <p> The sparseness of this matrix allows for a more efficient solution method then possible with classical radiosity approaches where a dense matrix of equations must be solved. This represents work done jointly with other researchers at Princeton University, and the presentation here is adapted from the papers <ref> [40, 65] </ref>. The use of wavelet functions to quickly solve integral equations was discovered by [9, 2, 3]. This important discovery allows a large class of integral equations to be expressed in a wavelet basis by a sparse matrix with only O (n) significant entries. <p> In particular the matrix with the non-standard k terms (Equation (104)) is one such inverse. 4.5 Implementation This section discusses the implementation of a wavelet radiosity system that was implemented by Peter Schroder and this author, and was reported in <ref> [40] </ref>. This section discusses some of the issues that arose in implementing that system, and the choices that were made. CHAPTER 4. <p> This lack of continuity in the multiwavelets is most likely a liability, since the number of basis functions must double to express this extra CHAPTER 4. WAVELET RADIOSITY 71 Legendre polynomials. Both of the detail shapes (lower right) have two vanishing moments (from <ref> [40] </ref>). Both of the detail shapes have two vanishing moments (from [40]). freedom, and the freedom to be discontinuous gives rise to solutions that display unwanted discontinuities. However this is the price that must be paid if one is to use a tree-wavelet. <p> WAVELET RADIOSITY 71 Legendre polynomials. Both of the detail shapes (lower right) have two vanishing moments (from <ref> [40] </ref>). Both of the detail shapes have two vanishing moments (from [40]). freedom, and the freedom to be discontinuous gives rise to solutions that display unwanted discontinuities. However this is the price that must be paid if one is to use a tree-wavelet. Flatlets The flatlets are a family of basis functions that were developed specifically for ra-diosity problems. <p> These experimental results suggest that wavelet radiosity can obtain radiosity solutions more efficiently than hierarchical radiosity. CHAPTER 4. WAVELET RADIOSITY 83 haar basis with h = 1 4 ; 1 16 ; 1 32 (top to bottom). The test configuration is depicted in the upper right corner (from <ref> [40] </ref>). 4.6.2 3D Radiosity This section discusses the experimental results using the 3D implementation of wavelet radiosity. <p> WAVELET RADIOSITY 84 wavelet bases M 1 , M 2 , M 3 , and M 4 (top to bottom) using the same test configuration as in Figure 23. Here h = 1 32 . Right: Relative L 1 error as a function of work (from <ref> [40] </ref>). Haar wavelet basis, the full accuracy in the solution is reached well before the full matrix is computed. The left graph of Figure 24 shows the work/error tradeoff using the first four mul-tiwavelet bases (h was set to 1 32 ). <p> In all of these cases the number of interactions is approximately constant (8000). CHAPTER 4. WAVELET RADIOSITY 85 (left), and F 2 basis (right) using same amount of work. Note that any post processing such as Gouraud shading has not been performed. From <ref> [40] </ref>. Exact answer Error: Haar basis Error: F 2 basis Error: F 3 basis the M 2 basis 8 . <p> More significantly, there is current research extending this wavelet method to solve the general illumination rendering equation with glossy reflectance [67, 14]. CHAPTER 4. WAVELET RADIOSITY 87 rendered directly from the basis functions (from <ref> [40] </ref>). Chapter 5 Geometric Modeling There are many computer applications where it is necessary for a computer to have an internal representation of some three dimensional geometric object. These objects may include a variety of real world objects, such as a mountain, an airplane or a chair.
Reference: [41] <author> Silicon Graphics. </author> <title> Graphics Library Programming Guide. Silicon Graphics Documents, 1991. BIBLIOGRAPHY 180 </title>
Reference-contexts: These levels are chosen dynamically by the user, and can be set independently. Therefore two valid representations of the same curve must be maintained. The B-spline coefficients at the seeLevel are used to draw the curve using a GL nurbscurve call <ref> [41] </ref>. If the seeLevel is set to L the user views the complete resolution curve. If it is set to a smaller number, then the user views a smoother projected version of the curve. Figure 40 displays the same curve with the seeLevel set to 4, 3, and 2. <p> Some implementation details are described here. 7.8.1 Choice of Wavelet Section 2.3 describes a number of wavelet constructions based on cubic B-splines. This implementation uses B-spline wavelets since the the resulting solutions are C 2 . Moreover the result can be displayed with GL nurbscurve and nurbssurface calls <ref> [41] </ref>, and interfaced with other computer graphics software that knows how to handle B-splines. In Section 2.3, two wavelet constructions are discussed, a bi-orthogonal and a semi-orthogonal construction. <p> The system uses thin plate energy to measure the smoothness of the solution. Resulting curves and surfaces are displayed by transforming the wavelet representation back to a uniform cubic B-spline representation at the finest level of detail, and then making a SGI GL nurbscurve or nurbssurface call <ref> [41] </ref> 8 . The solver sets up the appropriate linear system (Equation (161/162)). Initially the solver assumes that very few degrees of freedom are needed, thus only a few 8 One GL call to nurbssurface can be more expensive than a complete iteration. CHAPTER 7.
Reference: [42] <author> A. </author> <title> Haar. Zur theorie der orthogonalen funktionen-systeme. </title> <journal> Math. Ann., </journal> <volume> 69 </volume> <pages> 331-371, </pages> <year> 1910. </year>
Reference-contexts: This combination of features is very useful. Let us start by looking at the simplest and oldest wavelet basis, the Haar basis <ref> [42] </ref>. CHAPTER 2. WAVELETS 14 one Haar function to represent the same function F.
Reference: [43] <author> Mark Halstead, Michael Kass, and Tone DeRose. </author> <title> Efficient, fair interpolation using catmull-clark surfaces. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 35-43. </pages> <note> Siggraph, </note> <year> 1993. </year>
Reference-contexts: Computing the intersection of a ray with an implicit surface requires an expensive root finding operation. Another way to represent a surface is using some procedural method. An example of a procedural representation is subdivision surfaces <ref> [13, 43] </ref>. In this representation, the surface is defined by an input mesh made up of vertices and edges. A transformation rule is applied to the input mesh resulting in a denser mesh. <p> It is also important to study optimization modeling methods where constraint changes only have local effects. Finally, it would be desirable to extend the multiresolution framework beyond tensor product bases in order to model surfaces with arbitrary topology <ref> [43] </ref>. Presently, the only way to model an arbitrary structure is to piece together patches, and constrain the boundaries to have the necessary continuity. In addition, improvements to the oracle function that determines the appropriate local resolution may lead to more efficient results. <p> Secondly, the tensor product B-spline used in this thesis can only model surfaces that have a square parametric domain. This is certainly a limitation when trying to model arbitrary objects. Recently researchers have been exploring very flexible representation methods for objects with arbitrary topology <ref> [43] </ref>. A hierarchical representation bases on such methods has also been studied [53]. This hierarchical representation offers a flexible way to extend the methods described in this thesis to more general surface topologies. Numerical optimization is a general paradigm that can be applied to many problem domains.
Reference: [44] <author> Pat Hanrahan, David Salzman, and Larry Aupperle. </author> <title> A rapid hierarchical radios-ity algorithm. </title> <journal> Computer Graphics, </journal> <volume> 25(4) </volume> <pages> 197-206, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: A hierarchical representation for radiosity was explored in the hierarchical radiosity method of Hanrahan et al. to obtain a fast radiosity method <ref> [44] </ref>. As will be discussed, the hierarchical radiosity method can be understood as a first order wavelet method. Chapter 4 Wavelet Radiosity This chapter will discuss using a wavelet basis to represent the illumination function and the kernel function. <p> WAVELET RADIOSITY 56 4.1 Contribution The contribution of the wavelet approach to radiosity described in this chapter is both theoretical and practical. The use of a wavelet formulation gives rise to a more elegant formulation of the hierarchical radiosity method (HR) of Hanrahan et al. <ref> [44] </ref>. hierarchical radiosity uses a hierarchical representation of the geometric environment in order to simulate the energy transfer of light in the environment using only O (n) interaction terms instead of the usual O (n 2 ). This makes it the most efficient method know to solve radios-ity problems. <p> This chapter explores some of these tradeoffs, describes an implementation, and discusses some experimental results. 4.2 Hierarchical Radiosity This section briefly describes a hierarchical radiosity method described by Hanrahan et al. <ref> [44] </ref>. Later sections will discuss the relationship between this algorithm and wavelet based methods. In classical radiosity implementations, the radiosity integral equation is solved by an iterative method such as Jacobi iteration. <p> The radiosity received at the various resolutions of the mesh are summed together with a procedure named push that works from the coarsest resolution to the finest <ref> [44] </ref>. Because many of the interactions can be done between coarse levels of the hierarchy, hierarchical radiosity is able to use interaction patterns with only O (n) interactions, where n is the number of elements in the finest level description of the hierarchy. <p> In particular, the arguments in [9] show an O (n) sparseness for the non-standard decomposition, as compared to O (n lg n) sparseness for the standard decomposition. In addition, our implementation of wavelet radiosity was built on top of an already existing hierarchical radiosity program <ref> [44] </ref>, and the non-standard basis was a more natural extension. In the standard decomposition, each basis function interacts with basis functions from all resolution levels, while in the non-standard decomposition, only basis functions from the same resolution level interact. <p> This makes the numerical integration of those coefficients well behaved. In this light, this implementation of wavelet radiosity is closely related to the hierarchical radiosity algorithm of <ref> [44] </ref>. In 3D radiosity where B is a bivariate function, the bivariate non-standard flatlet or multiwavelet coefficients are stored in a quad-tree. The flatlet or multiwavelet coefficients are transformed into the box or piecewise Legendre representation using a quad-tree push procedure similar to that of [44]. <p> the hierarchical radiosity algorithm of <ref> [44] </ref>. In 3D radiosity where B is a bivariate function, the bivariate non-standard flatlet or multiwavelet coefficients are stored in a quad-tree. The flatlet or multiwavelet coefficients are transformed into the box or piecewise Legendre representation using a quad-tree push procedure similar to that of [44]. The flatlet or multiwavelet representation is obtained using a quadtree procedure pull like that in [44]. The k i;j entries of the sparse matrix are stored on links that have pointers to the i and j flatlet or multiwavelet coefficients. <p> The flatlet or multiwavelet coefficients are transformed into the box or piecewise Legendre representation using a quad-tree push procedure similar to that of <ref> [44] </ref>. The flatlet or multiwavelet representation is obtained using a quadtree procedure pull like that in [44]. The k i;j entries of the sparse matrix are stored on links that have pointers to the i and j flatlet or multiwavelet coefficients. <p> This procedure makes use of a oracle function that measures the smoothness of the kernel. By using different wavelets, with better compression properties, more efficient radiosity solutions can be obtained. This wavelet methodology also allows for a more formal understanding of the hierarchical radiosity method of <ref> [44] </ref>. Some implementation issues have been discussed and experimental results have been reported. In particular, experiments with two simple 2D environments have shown that wavelets with 2 vanishing moments lead to sparser radiosity matrices than the Haar basis.
Reference: [45] <author> Paul S. Heckbert. </author> <title> Simulating Global Illumination Using Adaptive Meshing. </title> <type> PhD thesis, </type> <institution> University of California at Berkeley, </institution> <month> January </month> <year> 1991. </year>
Reference-contexts: In <ref> [45] </ref>, Heckbert explained how the radiosity method, was actually an application of the Galerkin/finite element method for solving the radiosity integral equation (Equation (74)). The finite element method begins by orthogonally projecting E into some finite dimensional function space V L , spanned by n basis functions L;j . <p> For multiwavelets, the solution has been to have the oracle function subdivide these singular regions until their error is below a given threshold. 4.6 Results 4.6.1 Flatland Radiosity To verify and illustrate some of the ideas of wavelet radiosity, 2 flatland radiosity <ref> [45] </ref> (radiosity in 2D) environments were studied: the configuration consisting of two perpendicular unit length line segments meeting in a corner, and the configuration of two unit length parallel line segments that are separated by unit length (Figure 18) The kernel functions from these two configurations were projected into the bivariate
Reference: [46] <author> Tim Van Hook. </author> <title> Real-time shaded NC milling display. </title> <journal> Computer Graphics, </journal> <volume> 20(4) </volume> <pages> 15-20, </pages> <month> August </month> <year> 1986. </year>
Reference-contexts: One way to obtain a finite representation of a geometric solid shape, is to simply discretize the ideal binary function S. A 3D spatial region is chopped up into an N fi N fi N cube of voxels <ref> [46, 55] </ref>. A binary value at each voxel is then used to denote whether the object covers that spatial region or not. Using this representation, one can combine different modeled objects using the boolean operations "and" , "or", and "not".
Reference: [47] <author> S. Jaffard and Ph. Lauren~cot. </author> <title> Orthonormal wavelets, analysis of operators, and applications to numerical analysis. </title> <editor> In Charles K. Chui, editor, </editor> <booktitle> Wavelets: A Tutorial in Theory and Applications, </booktitle> <pages> pages 543-602. </pages> <publisher> Academic Press, </publisher> <year> 1992. </year>
Reference-contexts: This is consistent with the experimental results obtained in <ref> [47] </ref>. The explanation is that even though the non-standard functions have smaller support, the bivariate standard basis functions are combinations of univariate functions in both variables s and t. <p> VARIATIONAL MODELING WITH WAVELETS 121 needed as the process continues. The optimization work described in this chapter is related to the work of a variety of researchers. Qian et al. and Jaffard et al. <ref> [60, 47] </ref> use wavelets to quickly solve simple differential equations. In work more related to the topic at hand, Szeliski [71] uses a hierarchical pyramid basis change to perform efficient surface reconstruction from sparse data, to be used for machine vision problems. <p> For these problems, when a fixed resolution basis, such a B-spline basis, is used in a finite element approximation of X, the condition number of the resulting matrix grows as n 2 , where n is the number of basis functions <ref> [47, 11] </ref>. The number of iterations required by the conjugate gradiant method to achieve convergence to within some epsilon grows proportionally to p [71, 47]. As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. <p> The number of iterations required by the conjugate gradiant method to achieve convergence to within some epsilon grows proportionally to p <ref> [71, 47] </ref>. As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. <p> As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. When a multiresolution basis, such as a wavelet basis is employed to solve these problems, it can be shown that the number of iterations remains constant, independent of n <ref> [81, 47, 25] </ref>. Thus, wavelets provide a practical way of quickly obtaining solutions to many differential equations. For a more detailed discussion see Appendix C. CHAPTER 7. <p> When the basis functions are normalized, the basis transformation to the wavelet basis can become close to an orthogonal transformation. An orthogonal basis transformation merely "rotates" the finite dimensional optimization problem, and cannot change its conditioning properties. For the optimization procedure to be well conditioned <ref> [47, 25] </ref> it is essential to emphasize the coarser levels. The correct theoretical scaling depends on both the energy function used, and the dimension of problem. For a fuller discussion, see Appendix C. <p> In contrast to the multigrid methods, the wavelet method used here attempts to solve a single problem, but the good conditioning is obtained by using a multires-olution basis. Various researchers have discussed using a wavelet basis to quickly solve differential equations <ref> [60, 47] </ref>. In the machine vision community, Szeliski has used a hierarchical basis to quickly solve surface reconstruction problems [71]. The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 133 basis he uses is contructed by starting with the L;j functions defined as Terzopoulos' quadratic elements [74]. <p> Since there are only log n levels, the number of significant entries is O (n): log n X w fl length (diagonal (i)) = X w fl 2 i = O (n) (186) Appendix C Bounding the Condition Number A number of researchers <ref> [81, 47, 25] </ref> have studied the condition number of the matrices that arise from finite-element solutions to differential equations. Their main result is that when a wavelet basis is used, the condition number of the matrix remains constant, independent of n, the number of functions in the basis. <p> Thus, remains bounded <ref> [81, 47, 25] </ref>.
Reference: [48] <author> Bjorn Jawerth and Wim Sweldens. </author> <title> Wavelet multiresolution analysis adapted for the fast solution of boundary value ordinary differential equations. </title> <booktitle> In Sixth Copper Mountain Multigrid Conference, </booktitle> <month> April </month> <year> 1993. </year>
Reference-contexts: This method does produce smoother solutions than are obtained by a least squared solution using a finite element basis, because when a wavelet basis is used the least squares solution affects all resolutions. The properties of the wavelet least squares interpolant deserve further study. Jawerth et al. <ref> [48] </ref> discuss a methodology, where given a differential equation (as opposed to a variational problem), a special wavelet basis can be constructed on the fly so that the finite-element matrix is indeed diagonal.
Reference: [49] <author> James T. Kajiya. </author> <title> The rendering equation. </title> <journal> Computer Graphics, </journal> <volume> 20(4) </volume> <pages> 143-150, </pages> <year> 1986. </year>
Reference-contexts: CHAPTER 3. RADIOSITY 49 Just as ray tracing was first designed for specular reflectance, and then extended to more diffuse BRDFs, radiosity which was first designed for specular reflectance has since been extended to handle more specular-like BRDFs [69]. 3.2 Integral Equations Kajiya <ref> [49] </ref> put this whole topic in formal terms when he explained that all these methods were really trying to solve the integral rendering equation.
Reference: [50] <author> Robert Lewis. </author> <title> Making shaders more physically plausible. </title> <booktitle> In Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 47-62, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: This can be used to compute the value of the corresponding pixel of a graphical image. Many simple lighting models, such as Phong and Torrance-Sparrow have been developed [29], and important research on BRDFs continues to the present time <ref> [50, 64] </ref>. 2 In computer graphics, color is often handled by sampling the visible spectrum at three locations for red, green, and blue values. This thesis will have no further discussion of wavelength, and will be dropped. CHAPTER 3.
Reference: [51] <author> Dani Lischinski, Filippo Tampieri, and Donald P. Greenberg. </author> <title> Combining hierarchical radiosity and discontinuity meshing. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 199-208. </pages> <note> Siggraph, </note> <month> August </month> <year> 1993. </year>
Reference-contexts: It is important to study families of smooth wavelets, and understand how they can be used in a radiosity implementation. In radiosity algorithms, much of the subdivision is used to resolve discontinuities in the illumination function, such as shadow boundaries. Recently, Lischinski et al. <ref> [51] </ref> have discussed combining hierarchical radiosity with discontinuity meshing. In this algorithm, the mesh is not simply refined by quad-tree subdivision, but rather along the discontinuity lines which are computed a-priori by analyzing the geometry of the environment.
Reference: [52] <author> Zicheng Liu, Steven Gortler, and Michael F. Cohen. </author> <title> Hierarchical spacetime control. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1994, </year> <pages> pages 35-42, </pages> <month> August </month> <year> 1994. </year> <note> BIBLIOGRAPHY 181 </note>
Reference-contexts: In this context, a costly non-linear minimization problem must be solved. Research in this area has shown that wavelet methods, like those described in this thesis, can help to efficiently produce solutions <ref> [52] </ref>. It is important to see how these wavelet optimization methods can be applied to other areas as well. Appendix A A.1 Bi-orthogonal B-spline Wavelet Transform This appendix provides pseudo code for the bi-orthogonal wavelet transform. The convolution sequences are given in [17].
Reference: [53] <author> Michael Lounsbery, Tony DeRose, and Joe Warren. </author> <title> Multiresolution surfaces of arbitrary topological type. </title> <type> Technical Report 93-10-05b, </type> <institution> Department of Computer Science and Engineering, University of Washington, </institution> <month> January </month> <year> 1994. </year>
Reference-contexts: This is certainly a limitation when trying to model arbitrary objects. Recently researchers have been exploring very flexible representation methods for objects with arbitrary topology [43]. A hierarchical representation bases on such methods has also been studied <ref> [53] </ref>. This hierarchical representation offers a flexible way to extend the methods described in this thesis to more general surface topologies. Numerical optimization is a general paradigm that can be applied to many problem domains. One such example is the control problems that arise in computer animation [19].
Reference: [54] <author> Stephane G. Mallat. </author> <title> A theory for multiresolution signal decomposition: The wavelet representation. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 11 </volume> <pages> 674-693, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: In particular, the wavelet basis has been found to have the following powerful attributes: * If one has represented some function in an appropriate "piecewise" basis, the wavelet representation can be computed in O (n) time, where n is the number of functions in the basis <ref> [54] </ref>. * The hierarchical nature of a wavelet basis allows many "smooth" functions and operators to be compressed, and represented with a sparse set of coefficients. <p> Some of the details are technical, and the reader may want to first read this chapter lightly, and later come back to this chapter as a reference. More details about wavelets may be found in <ref> [59, 16, 54, 26] </ref>. 2.1 Basis Functions Computer graphics applications, in particular geometric modeling and realistic rendering, often require a method for representing or approximating some function F (t). One possible representation is through a linear combination of a set of basis functions using scalar coefficients as weights. <p> L 2 = V 0 _ + i=0 W i (37) Scaling One final issue is the scaling ratio between the basis functions. Traditionally <ref> [54, 58] </ref> the wavelet functions are defined with the following scaling: i;j (t) = 2 (iL)=2 (2 (iL) t j) This means that at each level up, the basis functions become twice as wide, and are scaled 1 p 2 times as tall. <p> But as will be shown in the experimental results section, in practice, the wavelet basis is a powerful method to reduce the number of iterations. 7.3.1 Scaling The scaling of the basis functions is very significant for the behavior of the optimizing procedures. Traditionally <ref> [54, 58] </ref> the wavelet functions are defined with the following scaling: i;j (t) = 2 (iL)=2 (2 (iL) t j) This means that at each level moving up, the basis functions become twice as wide, and are scaled 1 p 2 times as tall.
Reference: [55] <author> Donald Meagher. </author> <title> Geometric modeling using octree encoding. </title> <journal> Computer Graphics and Image Processing, </journal> <volume> 19 </volume> <pages> 129-147, </pages> <month> June </month> <year> 1982. </year>
Reference-contexts: One way to obtain a finite representation of a geometric solid shape, is to simply discretize the ideal binary function S. A 3D spatial region is chopped up into an N fi N fi N cube of voxels <ref> [46, 55] </ref>. A binary value at each voxel is then used to denote whether the object covers that spatial region or not. Using this representation, one can combine different modeled objects using the boolean operations "and" , "or", and "not".
Reference: [56] <author> Jean Meinguet. </author> <title> Multivariate interpolation at arbitrary points made simple. </title> <journal> Journal of Applied Mathematics and Physics (ZAMP), </journal> <volume> 30 </volume> <pages> 292-304, </pages> <year> 1979. </year>
Reference-contexts: For some simple surface problems, such as point and tangent interpolation using the thin plate measure over the entire infinite s; t plane, there are sets of radially symmetric basis functions (where each basis function corresponds to one constraint) which, when properly combined, give rise to the optimal solution <ref> [56] </ref>. (These methods are the multivariate extension to natural spline optimization methods).
Reference: [57] <author> Henry Moreton and Carlo Sequin. </author> <title> Functional optimization for fair surface design. </title> <journal> Computer Graphics, </journal> <volume> 26(4) </volume> <pages> 167-176, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: Other measures include first derivative terms [73], which penalize stretching, while yet other measures include third derivative terms which penalize variation in curvature <ref> [57] </ref> (favoring circles, cylinders and spheres). Some measures, like the thin plate term, are sensitive to the particular parameterization of a curve or surface (there are many different parameterized trajectories (X (t); Y (t); Z (t)) that trace out the same curve in space). <p> For curves, the intrinsic equivalent to the thin plate measure method is based on the second derivative of the arc-length parameterization of the curve. For surfaces, curvature is measured with gaussian and normal curvature [27]. Other intrinsic functionals include the minimum variation surface measure of <ref> [57] </ref> and the measures given in [62]. All of these functionals can have variable local weights over s and t, allowing the modeling material to be "stiffer" in some regions, and more flexible (and even creasable) in others [73]. <p> Clearly, the intrinsic measures are the most natural ones for a geometric setting, and they produce the most desirable results <ref> [57] </ref>. The disadvantage of these measures is that the resulting optization problems are highly non-linear and very costly to compute. On the other hand, parametric measures such as the thin plate (even allowing variable local weights) give rise to the much easier quadratic minimization problems. <p> Future work will be required to explore the use of higher order functionals like those given in <ref> [57, 62] </ref>. Because the optimization problems resulting from those func-tionals are non-linear, they are much more computationally expensive, and it is even more important to find efficient methods. It is also important to study optimization modeling methods where constraint changes only have local effects.
Reference: [58] <author> Alex Pentland. </author> <title> Fast solutions to physical equilibrium and interpolation problems. </title> <journal> The Visual Computer, </journal> <volume> 8(5) </volume> <pages> 303-314, </pages> <year> 1992. </year>
Reference-contexts: L 2 = V 0 _ + i=0 W i (37) Scaling One final issue is the scaling ratio between the basis functions. Traditionally <ref> [54, 58] </ref> the wavelet functions are defined with the following scaling: i;j (t) = 2 (iL)=2 (2 (iL) t j) This means that at each level up, the basis functions become twice as wide, and are scaled 1 p 2 times as tall. <p> Pentland describes a related method where complicated variational problems are solved quickly using wavelets <ref> [58] </ref>. The system of Equation (131) is set up using a wavelet basis instead of a finite-element basis, and then all of the off diagonal terms of H are discarded. This new linear system can then be solved very rapidly. The justification given in [58] for this method cites Beylkin [9] <p> problems are solved quickly using wavelets <ref> [58] </ref>. The system of Equation (131) is set up using a wavelet basis instead of a finite-element basis, and then all of the off diagonal terms of H are discarded. This new linear system can then be solved very rapidly. The justification given in [58] for this method cites Beylkin [9] and claims that due to the vanishing moments of the wavelet basis, most of the off diagonal terms are negligible and so can be ignored. <p> Also, by using a basis derived from uniform cubic B-splines, this method is compatible with other modeling software tools. In other related work, Pentland <ref> [58] </ref> also describes a method similar to Szeliski. Independent of this work, Yaou et al. [80] discuss a wavelet optimization approach similar to the one described here. These approaches are not based on B-splines, and no adaptive refinement method is investigated. <p> But as will be shown in the experimental results section, in practice, the wavelet basis is a powerful method to reduce the number of iterations. 7.3.1 Scaling The scaling of the basis functions is very significant for the behavior of the optimizing procedures. Traditionally <ref> [54, 58] </ref> the wavelet functions are defined with the following scaling: i;j (t) = 2 (iL)=2 (2 (iL) t j) This means that at each level moving up, the basis functions become twice as wide, and are scaled 1 p 2 times as tall. <p> Szeliski also explores the implicit matrix representation [81] to counteract the fact that the wavelets produce denser matrices. He experiments with both conjugate gradient and Gauss-Seidel iteration, and find conjugate gradient to require fewer iterations. This corresponds to what is generally known for iterative methods. In <ref> [58] </ref> Pentland discusses using a wavelet basis for quickly solving variational problems [58]. (His method of using the diagonal terms from the wavelet matrix is discussed in Section 5.2). <p> He experiments with both conjugate gradient and Gauss-Seidel iteration, and find conjugate gradient to require fewer iterations. This corresponds to what is generally known for iterative methods. In <ref> [58] </ref> Pentland discusses using a wavelet basis for quickly solving variational problems [58]. (His method of using the diagonal terms from the wavelet matrix is discussed in Section 5.2). He uses an orthonormal wavelet transformation, without discussing scaling and also assumes the wavelet matrix to be sparse, and so does not pursue the implicit matrix representation.
Reference: [59] <author> Willaim Press, Saul Teukolski, William Vetterling, and Brian Flannery. </author> <title> Numerical Recipes in C, </title> <booktitle> The Art of Scientific Computing. </booktitle> <publisher> Cambridge University Press, </publisher> <address> 2nd edition, </address> <year> 1992. </year>
Reference-contexts: Some of the details are technical, and the reader may want to first read this chapter lightly, and later come back to this chapter as a reference. More details about wavelets may be found in <ref> [59, 16, 54, 26] </ref>. 2.1 Basis Functions Computer graphics applications, in particular geometric modeling and realistic rendering, often require a method for representing or approximating some function F (t). One possible representation is through a linear combination of a set of basis functions using scalar coefficients as weights. <p> This avoids the need for direct inversion of the matrix in O (n 3 ) time, as one can use an iterative method such as the conjugate gradient method <ref> [59] </ref>, where each iteration, comprised of a constant number of matrix-vector multiplies, can be performed in linear time. Unfortunately as the number of basis functions in the set grows, the system becomes poorly conditioned resulting in the need for an excessive number of iterations to find a solution [72, 71]. <p> Conjugate Gradient iteration descends down a set of mutually conjugate directions. Two directions a and b are called conjugate if 0 = a T Mb (157) A new conjugate direction can be found by doing a small number of matrix vector multiplies in linear time given a sparse matrix <ref> [59] </ref>. In exact arithmetic, the precise minimum should be found after considering n conjugate directions, but in floating point computation this does not occur, and further iterations are often required. Generally, conjugate gradient requires the fewest iterations for convergence. <p> In exact arithmetic, the precise minimum should be found after considering n conjugate directions, but in floating point computation this does not occur, and further iterations are often required. Generally, conjugate gradient requires the fewest iterations for convergence. This is followed by Gauss-Seidel, which is followed by steepest descent <ref> [59, 71] </ref>. 4 Over-relaxation schemes travel a distance along the ray further than the minimizer. CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 124 7.3 Fast Convergence With Wavelets The number of iterations required to obtain a satisfactory solution is sensitive to the basis chosen for representing the problem. <p> The matrices are represented sparsely, so the solver only needs storage for the non-zero entries, and the cost of a matrix-vector multiply scales with the number of non-zero entries. This linear system is then solved by using conjugate gradient iterations <ref> [59] </ref>. After every k iterations (25 is the default), the oracle is called. As explained in Section 7.5, the oracle decides which new wavelet basis functions and their corresponding variables x should be activated, and which ones can be deactivated. At this point the matrices must be updated.
Reference: [60] <author> Sam Qian and John Weiss. </author> <title> Wavelets and the numerical solution of partial differential equations. </title> <journal> Journal of Computational Physics, </journal> <volume> 106(1) </volume> <pages> 155-175, </pages> <month> May </month> <year> 1993. </year>
Reference-contexts: VARIATIONAL MODELING WITH WAVELETS 121 needed as the process continues. The optimization work described in this chapter is related to the work of a variety of researchers. Qian et al. and Jaffard et al. <ref> [60, 47] </ref> use wavelets to quickly solve simple differential equations. In work more related to the topic at hand, Szeliski [71] uses a hierarchical pyramid basis change to perform efficient surface reconstruction from sparse data, to be used for machine vision problems. <p> In contrast to the multigrid methods, the wavelet method used here attempts to solve a single problem, but the good conditioning is obtained by using a multires-olution basis. Various researchers have discussed using a wavelet basis to quickly solve differential equations <ref> [60, 47] </ref>. In the machine vision community, Szeliski has used a hierarchical basis to quickly solve surface reconstruction problems [71]. The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 133 basis he uses is contructed by starting with the L;j functions defined as Terzopoulos' quadratic elements [74].
Reference: [61] <author> Ewald Quak and Norman Weyrich. </author> <title> Decomposition and reconstruction algorithms for spline wavelets on a bounded interval. </title> <type> Technical Report 294, </type> <institution> Center for Approximation Theory, Texas A&M, </institution> <year> 1993. </year>
Reference-contexts: A full description of this construction is given in <ref> [15, 61] </ref>. This interval construction, which on the real line corresponds to Equations (15) and (16), is described by the linear time procedure basis xform up that is given in Appendix A.2. <p> The sequence h and the sequence g are the convolution sequences used to construct the inner basis functions [16], while the vectors h j and the vectors g j are used to construct the boundary basis functions <ref> [15, 61] </ref>. Only the vectors for the left boundary are given, the vectors for the right boundaries are the mirror images of these vectors. It is assumed that the boundary B-spline basis functions are those that arise by placing quadruple knots at the boundaries.
Reference: [62] <author> T. Rando and J Roulier. </author> <title> Designing faired parametric surfaces. </title> <booktitle> Computer Aided Design, </booktitle> <volume> 23(7) </volume> <pages> 492-497, </pages> <month> September </month> <year> 1991. </year>
Reference-contexts: For surfaces, curvature is measured with gaussian and normal curvature [27]. Other intrinsic functionals include the minimum variation surface measure of [57] and the measures given in <ref> [62] </ref>. All of these functionals can have variable local weights over s and t, allowing the modeling material to be "stiffer" in some regions, and more flexible (and even creasable) in others [73]. <p> Future work will be required to explore the use of higher order functionals like those given in <ref> [57, 62] </ref>. Because the optimization problems resulting from those func-tionals are non-linear, they are much more computationally expensive, and it is even more important to find efficient methods. It is also important to study optimization modeling methods where constraint changes only have local effects.
Reference: [63] <author> David Salesin, Dani Lischinski, and Tony DeRose. </author> <title> Reconstructing illumination functions with selected discontinuities. </title> <booktitle> Third Eurographics Workshop on Rendering, </booktitle> <pages> pages 99-112, </pages> <year> 1992. </year> <note> BIBLIOGRAPHY 182 </note>
Reference-contexts: Once the solution (b) is computed one can simply output flat shaded surface elements to the screen, but one may also use more sophisticated methods such displaying Gouraud shaded polygons, or employing some more complicated method of reconstruction <ref> [63] </ref>. Some research has focussed on methods for solving the linear system (Equation (71)). Obviously one could use a direct matrix inversion technique such as Gaussian elimination, but this takes O (n 3 ) time.
Reference: [64] <author> Christophe Schlick. </author> <title> A customizable reflectance model for everyday rendering. </title> <booktitle> In Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 73-84, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: This can be used to compute the value of the corresponding pixel of a graphical image. Many simple lighting models, such as Phong and Torrance-Sparrow have been developed [29], and important research on BRDFs continues to the present time <ref> [50, 64] </ref>. 2 In computer graphics, color is often handled by sampling the visible spectrum at three locations for red, green, and blue values. This thesis will have no further discussion of wavelength, and will be dropped. CHAPTER 3.
Reference: [65] <author> Peter Schroder, Steven J. Gortler, Michael F. Cohen, and Pat Hanrahan. </author> <title> Wavelet projections for radiosity. </title> <booktitle> In Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 105-114, </pages> <month> June </month> <year> 1993. </year> <note> Journal version appears in Computer Graphics Forum 13(2) 141-152, </note> <month> June </month> <year> 1994. </year>
Reference-contexts: In particular this thesis will describe how the wavelet basis gives rise to a sparse linear system, which can be computed and solved quickly. 1 These chapters represent work done jointly with Peter Schroder and our advisors Professors Michael F. Cohen and Pat Hanrahan and is also reported in <ref> [40, 65] </ref>. 43 CHAPTER 3. RADIOSITY 44 incoming and outgoing directions ! i and ! o . 3.1 A Little Background The earliest attempts to render realistic looking images only focused on local reflectance properties. The goal was to mimic the way that real objects respond to real light sources. <p> The sparseness of this matrix allows for a more efficient solution method then possible with classical radiosity approaches where a dense matrix of equations must be solved. This represents work done jointly with other researchers at Princeton University, and the presentation here is adapted from the papers <ref> [40, 65] </ref>. The use of wavelet functions to quickly solve integral equations was discovered by [9, 2, 3]. This important discovery allows a large class of integral equations to be expressed in a wavelet basis by a sparse matrix with only O (n) significant entries. <p> This case is in fact better behaved (with smaller coefficients) than those of Equation (96) because there is no actual singularity for any values of s and t. (There is a singularity when viewed as a function in complex plane. For a discussion, see the Appendix of <ref> [65] </ref>). An example of a radiosity configuration with a singular kernel is one where two polygons intersect (such as a wall meeting the ceiling). <p> The representation of linear variation is possible since the dual functions are made up of ramp like functions that are piecewise constant only on the finest level. This construction can be generalized for any number of vanishing moments <ref> [65] </ref>. To construct the two-scale relationship for F 3 we would use a matrix, like that of Equation (115), where the first 3 rows are chosen to give us box functions of width 2 and the bottom 3 rows are chosen to be orthogonal to constant, linear, and quadratic variation. <p> This has been attempted in [14]. 7 This choice is justified further in <ref> [65] </ref>. CHAPTER 4. WAVELET RADIOSITY 79 . with L = 5 obtaining a 64 fi 64 element matrix (1=4 of the full symmetric matrix is shown in these figures). In this figure, the size of a dot represents the magnitude of the associated matrix coefficient. <p> WAVELET RADIOSITY 80 line segments in the finest level box basis, the standard Haar basis and the standard F 2 basis (left to right). The bottom row shows the matrix of the flatland kernel for two line segments meeting at right angles in the same three bases (from <ref> [65] </ref>). measuring the specific error incurred when using some fixed emission function E. This is also different from the k 2 matrix norm used in [9]. The k 2 matrix norm measures the worst possible error over the space of possible emission functions. <p> In effect the finest level of the representation is artificially limited so that there is a common standard CHAPTER 4. WAVELET RADIOSITY 81 (left) and the non-standard F 2 basis (right) (from <ref> [65] </ref>). basis (left) and the non-standard F 2 basis (right) (from [65]). against which to measure the error. In practice, the wavelet radiosity implementation allows the scales to become finer in a dynamic fashion as higher accuracy is requested, preventing the "bottoming out" of the graphs. <p> In effect the finest level of the representation is artificially limited so that there is a common standard CHAPTER 4. WAVELET RADIOSITY 81 (left) and the non-standard F 2 basis (right) (from <ref> [65] </ref>). basis (left) and the non-standard F 2 basis (right) (from [65]). against which to measure the error. In practice, the wavelet radiosity implementation allows the scales to become finer in a dynamic fashion as higher accuracy is requested, preventing the "bottoming out" of the graphs. Although the theoretical bounds are stronger for the non-standard basis than for CHAPTER 4. <p> Although the theoretical bounds are stronger for the non-standard basis than for CHAPTER 4. WAVELET RADIOSITY 82 error plotted against number of coefficients used with full matrices, non-standard haar, standard haar, non-standard F 2 , and standard F 2 bases (top to bottom) (from <ref> [65] </ref>). the standard basis [8], in these experiments the standard basis performed slightly better. This is consistent with the experimental results obtained in [47].
Reference: [66] <author> Peter Schroder and Pat Hanrahan. </author> <title> On the form factor between two polygons. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 163-164. </pages> <note> Siggraph, </note> <month> August </month> <year> 1993. </year>
Reference-contexts: When the integration includes a singular region of the kernel (e.g., the form factor between two intersecting polygons), Gauss-Legendre rules tend to produce inaccurate results. For flatlets, the solution has been to use an analytic form factor solution described in <ref> [66] </ref>.
Reference: [67] <author> Peter Schroder and Pat Hanrahan. </author> <title> Wavelet methods for radiance computation. </title> <booktitle> In Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 303-312, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: The work described in this thesis has been recently been extended to elegantly use texture mapped emittance and reflection patterns [34]. More significantly, there is current research extending this wavelet method to solve the general illumination rendering equation with glossy reflectance <ref> [67, 14] </ref>. CHAPTER 4. WAVELET RADIOSITY 87 rendered directly from the basis functions (from [40]). Chapter 5 Geometric Modeling There are many computer applications where it is necessary for a computer to have an internal representation of some three dimensional geometric object.
Reference: [68] <author> Francois Sillion. </author> <title> Clustering and volume scattering for hierarchical radiosity calculations. </title> <booktitle> In Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 105-118, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: A method of clustering is needed that avoids computing the interactions between each pair of tiny input objects. A number of solutions have recently been discussed <ref> [68, 70] </ref>, but more research is necessary. The second computer graphics application this thesis has discussed is geometric modeling (in particular, curve and surface modeling). In this context a wavelet basis based on uniform cubic B-splines has been used.
Reference: [69] <author> Francois Sillion and Claude Puech. </author> <title> A general two-pass method integrating specular and diffuse reflection. </title> <journal> Computer Graphics, </journal> <volume> 23(3) </volume> <pages> 335-344, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: CHAPTER 3. RADIOSITY 49 Just as ray tracing was first designed for specular reflectance, and then extended to more diffuse BRDFs, radiosity which was first designed for specular reflectance has since been extended to handle more specular-like BRDFs <ref> [69] </ref>. 3.2 Integral Equations Kajiya [49] put this whole topic in formal terms when he explained that all these methods were really trying to solve the integral rendering equation.
Reference: [70] <author> Brian Smits, James Arvo, and Donald Greenberg. </author> <title> A clustering algorithm for radiosity in complex environments. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1994, </year> <pages> pages 435-442. </pages> <note> siggraph, </note> <year> 1994. </year>
Reference-contexts: A method of clustering is needed that avoids computing the interactions between each pair of tiny input objects. A number of solutions have recently been discussed <ref> [68, 70] </ref>, but more research is necessary. The second computer graphics application this thesis has discussed is geometric modeling (in particular, curve and surface modeling). In this context a wavelet basis based on uniform cubic B-splines has been used.
Reference: [71] <author> Richard Szeliski. </author> <title> Fast surface interpolation using hierarchical basis functions. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 12(6) </volume> <pages> 513-439, </pages> <month> June </month> <year> 1990. </year>
Reference-contexts: Unlike radiosity, the matrices arising from optimal surface problems are usually sparse, with only O (n) terms of the matrix being nonzero. Unfortunately the resulting systems of equations are poorly conditioned and the iterative descent methods converge slowly when a finite element basis such as B-splines is used <ref> [72, 71] </ref>. This occurs because the solution method is always focusing on a very narrow region of the solution. This thesis discusses how geometric variational modeling problems can be solved more efficiently by using a wavelet basis. <p> Unfortunately as the number of basis functions in the set grows, the system becomes poorly conditioned resulting in the need for an excessive number of iterations to find a solution <ref> [72, 71] </ref>. One of the positive qualities of the B-spline basis for modeling paradigms, local control, is a disadvantage in the optimization framework. <p> The optimization work described in this chapter is related to the work of a variety of researchers. Qian et al. and Jaffard et al. [60, 47] use wavelets to quickly solve simple differential equations. In work more related to the topic at hand, Szeliski <ref> [71] </ref> uses a hierarchical pyramid basis change to perform efficient surface reconstruction from sparse data, to be used for machine vision problems. The pyramid basis change described there, works bottom-up starting with a uniform basis at some fixed resolution. <p> In exact arithmetic, the precise minimum should be found after considering n conjugate directions, but in floating point computation this does not occur, and further iterations are often required. Generally, conjugate gradient requires the fewest iterations for convergence. This is followed by Gauss-Seidel, which is followed by steepest descent <ref> [59, 71] </ref>. 4 Over-relaxation schemes travel a distance along the ray further than the minimizer. CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 124 7.3 Fast Convergence With Wavelets The number of iterations required to obtain a satisfactory solution is sensitive to the basis chosen for representing the problem. <p> The number of iterations required by the conjugate gradiant method to achieve convergence to within some epsilon grows proportionally to p <ref> [71, 47] </ref>. As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. <p> Secondly, since wavelets are hierarchical, a single wavelet will overlap with wavelets on all L levels. As a result there are O (n lg n) overlapping wavelet basis functions, and thus the wavelet Hessian matrix is only O (n lg n) sparse. Alternatively, there is the implicit approach <ref> [81, 71] </ref> which only computes and stores the entries of the B-spline matrices H and A (Equation (162)). <p> Various researchers have discussed using a wavelet basis to quickly solve differential equations [60, 47]. In the machine vision community, Szeliski has used a hierarchical basis to quickly solve surface reconstruction problems <ref> [71] </ref>. The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 133 basis he uses is contructed by starting with the L;j functions defined as Terzopoulos' quadratic elements [74]. Then the linear pyramid of Yserentant [81] is used to define the i;j and i;j basis functions. <p> VARIATIONAL MODELING WITH WAVELETS 147 deactivateBSpline (i,j) sparseMatrixDeleteRow (matrix= Hess, row=(i,j) ); sparseMatrixDeleteCol (matrix= Hess, col=(i,j) ); sparseMatrixDeleteCol (matrix= Constraint, col=(i,j) ); This adaptive approach is possible with the wavelets described in this thesis, but was not possible with the hierarchical construction in <ref> [71] </ref>. This is because an adaptive method must be able to compute new Hessian and constraint matrix terms on the fly, and therefore one needs an explicit expression for the hierarchical basis functions.
Reference: [72] <author> Demetri Terzopoulos. </author> <title> Image analysis using multigrid relaxation methods. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 8(2) </volume> <pages> 129-139, </pages> <month> March </month> <year> 1986. </year> <note> BIBLIOGRAPHY 183 </note>
Reference-contexts: Finding the "best" solution requires solving a variational problem. CHAPTER 1. INTRODUCTION 7 One of the most popular methods for solving this variational modeling problem is the finite element method <ref> [72] </ref>. In this method the surface is described by a large collection of basis functions. Each of these functions, or elements, describes the behavior of the surface in some very small region. <p> Unlike radiosity, the matrices arising from optimal surface problems are usually sparse, with only O (n) terms of the matrix being nonzero. Unfortunately the resulting systems of equations are poorly conditioned and the iterative descent methods converge slowly when a finite element basis such as B-splines is used <ref> [72, 71] </ref>. This occurs because the solution method is always focusing on a very narrow region of the solution. This thesis discusses how geometric variational modeling problems can be solved more efficiently by using a wavelet basis. <p> Unfortunately as the number of basis functions in the set grows, the system becomes poorly conditioned resulting in the need for an excessive number of iterations to find a solution <ref> [72, 71] </ref>. One of the positive qualities of the B-spline basis for modeling paradigms, local control, is a disadvantage in the optimization framework. <p> The running time of these altered pyrm procedures is linear in the number of active wavelets. 7.7 Comparison With Previous Approaches There are a number of researchers who have discussed wavelet/hierarchical conditioning schemes. Terzopoulos discusses a multigridding approach for surface reconstruction problems that arise in computer vision <ref> [72] </ref>. In these problems, a sensor or camera has returned a sparse set of data points on some actual surface. The goal of the reconstruction process is to obtain a reasonable representation of the complete surface, using only the sparse data.
Reference: [73] <author> Demetri Terzopoulos. </author> <title> Regularization of inverse visual problems involving dis-continuities. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 8(4) </volume> <pages> 413-424, </pages> <month> July </month> <year> 1986. </year>
Reference-contexts: Thus, for curves, this is 1 E (fl) = and for surfaces is E (fl) = This measure approximates the physical bending energy of a beam or sheet, that is bent from its original flat shape. Other measures include first derivative terms <ref> [73] </ref>, which penalize stretching, while yet other measures include third derivative terms which penalize variation in curvature [57] (favoring circles, cylinders and spheres). <p> Other intrinsic functionals include the minimum variation surface measure of [57] and the measures given in [62]. All of these functionals can have variable local weights over s and t, allowing the modeling material to be "stiffer" in some regions, and more flexible (and even creasable) in others <ref> [73] </ref>. Clearly, the intrinsic measures are the most natural ones for a geometric setting, and they produce the most desirable results [57]. The disadvantage of these measures is that the resulting optization problems are highly non-linear and very costly to compute.
Reference: [74] <author> Demetri Terzopoulos. </author> <title> The computation of visible-surface representations. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 10(4) </volume> <pages> 417-438, </pages> <month> July </month> <year> 1988. </year>
Reference-contexts: In the machine vision community, Szeliski has used a hierarchical basis to quickly solve surface reconstruction problems [71]. The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 133 basis he uses is contructed by starting with the L;j functions defined as Terzopoulos' quadratic elements <ref> [74] </ref>. Then the linear pyramid of Yserentant [81] is used to define the i;j and i;j basis functions. In this construction, the functions on each level i are not scales of each other, and they have no simple closed form.
Reference: [75] <author> Roy Troutman and Nelson Max. </author> <title> Radiosity algorithms using higher-order finite elements. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 209-212. </pages> <note> Siggraph, </note> <month> August </month> <year> 1993. </year>
Reference-contexts: The original classical radiosity algorithms (CR) used the box basis. Heckbert studied the use of a linear basis (in the context of 2D radiosity in a plane)[45]. Troutman and Max discuss the use of a linear basis in 3D radiosity <ref> [75] </ref>. And Zatz has studied using higher order Galerkin methods [82]. These higher order methods are referred to as Galerkin Radiosity (GR). This thesis discusses using a variety of wavelet bases for radiosity.
Reference: [76] <author> William Welch and Andrew Witkin. </author> <title> Variational surface modeling. </title> <journal> Computer Graphics, </journal> <volume> 26(2) </volume> <pages> 157-166, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: The magnitude of the change is measured by the sum of the squares of the change in each control point. Least square solutions can be found very inexpensively using the pseudoinverse [32] or quadratic minimization techniques <ref> [76] </ref>. Clearly the semantics of this method is sensitive to the representation used. For example if the uniform cubic B-spline basis is used, the addition of an interpolation constraint has a very local effect. <p> function E (x) = x T Hx (128) where H is the Hessian matrix H i;j = @x i @x j and the constraints are linear Ax b = 0 (130) then the optimal solution in the given space can be computed as the solution to a single linear system <ref> [76] </ref>. fi fi fi fi A 0 fi fi fi fi fi fi fi fi fi fi fi fi 0 fi fi fi (131) For thin plate curves the Hessian terms are H i;j = @x i @x j Z If the functional is not quadratic, or the constraints not linear, <p> The basis functions are "locked" and the least squared solution is found over the r d ;j coefficients. The least squared solution may be found using the pseudoinverse [32]. The least squared problem can also be posed as a minimization problem <ref> [76] </ref>, whose solution can be found by solving following linear system that is related to Equation (131): fi fi fi fi A 0 fi fi fi fi fi fi fi fi fi fi fi fi x 0 fi fi fi (146) where x 0 are the control points of the current <p> It is therefore desirable to have a solution method that adaptively chooses the appropriate basis functions given some user defined error bound. This approach was applied using hierarchical B-splines in <ref> [76] </ref>. When refinement was necessary, "thinner" B-splines basis functions were added, and the redundant original "wider" B-splines were removed. With wavelets, all that must be done is to add in new "thinner" wavelets wherever refinement is deemed necessary. <p> The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 129 oracle must decide what level of detail is required in each region of the curve or surface. In <ref> [76] </ref> two criteria for refinement were suggested. Refinement to better satisfy a constraint, and refinement to obtain any solution with lower energy.
Reference: [77] <author> Turner Whitted. </author> <title> An improved illumination model for shaded display. </title> <journal> CACM, </journal> <volume> 23(6) </volume> <pages> 343-349, </pages> <month> June </month> <year> 1980. </year>
Reference-contexts: These three functions define a geometric point (X; Y; Z) for each parametric point (s; t). In realistic image synthesis, there have also been a variety of representations used for the illumination function. One method used for realistic rendering is ray tracing <ref> [77] </ref>. In ray tracing a brightness value is computed for each pixel that makes up the image. In this method, the illumination function is represented pointwise, i.e., the function is only defined at a discrete set of points (which correspond to the surface points "seen" through each pixel). <p> Computing the correct illumination function has been one of the primary foci of computer graphics research. There are two families of methods commonly used, the ray tracing method <ref> [77] </ref>, and the radiosity method [38]. The ray tracing method simulates the light in the environment by tracing the paths of many photons. <p> In this global perspective every surface point is responsible for receiving from and reflecting to every other surface point. One of the first algorithms designed to account for some degree of global illumination was ray tracing <ref> [77] </ref>. The basic idea is simple. A ray is cast from the "eye" of the viewer through each pixel of the computer screen window into the 3D environment, until this ray hits some surface point.
Reference: [78] <author> Lance Williams. </author> <title> Pyramidal parametrics. </title> <journal> Computer Graphics, </journal> <volume> 17(4) </volume> <pages> 1-11, </pages> <year> 1983. </year>
Reference-contexts: This CHAPTER 2. WAVELETS 16 the Haar basis. construction is very similar to an image pyramid that one might use for texture mapping <ref> [78] </ref>. In such a pyramid the image is represented at different levels of resolution by successive averaging steps.
Reference: [79] <author> Goeff Wyvill, Craig McPheeters, and Brian Wyvill. </author> <title> Data structures for soft objects. </title> <journal> The Visual Computer, </journal> <volume> 2(4) </volume> <pages> 227-234, </pages> <month> April </month> <year> 1986. </year>
Reference-contexts: For implicit surfaces, one needs a way to represent the density function, F , using a finite set of scalars. The most prevalent method is the blobby object method <ref> [10, 79] </ref>, where the density function is defined by placing a collection of "field sources" in space. These field sources have simple density functions, such as a decaying Gaussian function that has the greatest value at the center, and decrease with distance.
Reference: [80] <author> Ming-Haw Yaou and Wen-Thong Chang. </author> <title> Fast surface interpolation using multi-resolution wavelet transform. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <note> 1994. to appear. </note>
Reference-contexts: Also, by using a basis derived from uniform cubic B-splines, this method is compatible with other modeling software tools. In other related work, Pentland [58] also describes a method similar to Szeliski. Independent of this work, Yaou et al. <ref> [80] </ref> discuss a wavelet optimization approach similar to the one described here. These approaches are not based on B-splines, and no adaptive refinement method is investigated. Also these researchers do not explore the implicit matrix representation, which is essential for efficiency. <p> Pentland does not explore any adaptive oracle method. In research independent of this author's, Yaou et al. use a semi-orthogonal linear B-spline wavelet for surface reconstruction <ref> [80] </ref>. This is an unusual choice for thin plate problems, since the second derivative measure is not very meaningful with bilinear basis functions. Once again, the implicit method is not pursued, and thus each of the wavelet iterations are considerably more expensive than the with finite element basis.
Reference: [81] <author> Harry Yserentant. </author> <title> On the multi-level splitting of finite element spaces. </title> <journal> Nu-merische Mathematik, </journal> <volume> 49 </volume> <pages> 379-412, </pages> <year> 1986. </year>
Reference-contexts: When a piecewise basis is used, the condition number of the resulting matrix grows as O (n 2 ) [11]. The number of iterations required by iterative methods for convergence is a function of . As discussed in <ref> [25, 81] </ref>, for a large class of differential equations, when the problem is expressed in a wavelet basis, the condition number of the resulting matrix remains constant, independent of n. This feature of wavelets can be used to obtain efficient solutions to certain optimization problems that arise in geometric modeling. <p> As a result, obtaining accurate solutions to these problems using a finite element basis is very costly. When a multiresolution basis, such as a wavelet basis is employed to solve these problems, it can be shown that the number of iterations remains constant, independent of n <ref> [81, 47, 25] </ref>. Thus, wavelets provide a practical way of quickly obtaining solutions to many differential equations. For a more detailed discussion see Appendix C. CHAPTER 7. <p> Secondly, since wavelets are hierarchical, a single wavelet will overlap with wavelets on all L levels. As a result there are O (n lg n) overlapping wavelet basis functions, and thus the wavelet Hessian matrix is only O (n lg n) sparse. Alternatively, there is the implicit approach <ref> [81, 71] </ref> which only computes and stores the entries of the B-spline matrices H and A (Equation (162)). <p> In the machine vision community, Szeliski has used a hierarchical basis to quickly solve surface reconstruction problems [71]. The CHAPTER 7. VARIATIONAL MODELING WITH WAVELETS 133 basis he uses is contructed by starting with the L;j functions defined as Terzopoulos' quadratic elements [74]. Then the linear pyramid of Yserentant <ref> [81] </ref> is used to define the i;j and i;j basis functions. In this construction, the functions on each level i are not scales of each other, and they have no simple closed form. <p> In this construction, the functions on each level i are not scales of each other, and they have no simple closed form. As a result, one must a priori choose the level of resolution L, and no adaptivity is possible. Szeliski also explores the implicit matrix representation <ref> [81] </ref> to counteract the fact that the wavelets produce denser matrices. He experiments with both conjugate gradient and Gauss-Seidel iteration, and find conjugate gradient to require fewer iterations. This corresponds to what is generally known for iterative methods. <p> Since there are only log n levels, the number of significant entries is O (n): log n X w fl length (diagonal (i)) = X w fl 2 i = O (n) (186) Appendix C Bounding the Condition Number A number of researchers <ref> [81, 47, 25] </ref> have studied the condition number of the matrices that arise from finite-element solutions to differential equations. Their main result is that when a wavelet basis is used, the condition number of the matrix remains constant, independent of n, the number of functions in the basis. <p> Thus, remains bounded <ref> [81, 47, 25] </ref>.
Reference: [82] <author> Harold R. Zatz. </author> <title> Galerkin radiosity: A higher-order solution method for global illumination. </title> <booktitle> In Computer Graphics, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pages 213-220. </pages> <note> Siggraph, </note> <month> August </month> <year> 1993. </year>
Reference-contexts: Heckbert studied the use of a linear basis (in the context of 2D radiosity in a plane)[45]. Troutman and Max discuss the use of a linear basis in 3D radiosity [75]. And Zatz has studied using higher order Galerkin methods <ref> [82] </ref>. These higher order methods are referred to as Galerkin Radiosity (GR). This thesis discusses using a variety of wavelet bases for radiosity.
References-found: 82

