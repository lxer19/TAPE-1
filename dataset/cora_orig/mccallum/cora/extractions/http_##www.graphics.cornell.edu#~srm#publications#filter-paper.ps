URL: http://www.graphics.cornell.edu/~srm/publications/filter-paper.ps
Refering-URL: http://www.graphics.cornell.edu/~srm/publications/filter-paper-abstract.html
Root-URL: http://www.cs.brown.edu/
Email: srm@graphics.cornell.edu richard@cs.auckland.ac.nz  
Title: An Evaluation of Reconstruction Filters for Volume Rendering  
Author: Stephen R. Marschner and Richard J. Lobb 
Address: Ithaca NY 14853  
Affiliation: Program of Computer Graphics Cornell University,  
Abstract: To render images from a three-dimensional array of sample values, it is necessary to interpolate between the samples. This paper is concerned with interpolation methods that are equivalent to convolving the samples with a reconstruction filter; this covers all commonly used schemes, including trilinear and cubic interpolation. We first outline the formal basis of interpolation in three-dimensional signal processing theory. We then propose numerical metrics that can be used to measure filter characteristics that are relevant to the appearance of images generated using that filter. We apply those metrics to several previously used filters and relate the results to isosurface images of the interpolations. We show that the choice of interpolation scheme can have a dramatic effect on image quality, and we discuss the cost/benefit tradeoff inherent in choosing a filter. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> K. G. Beauchamp. </author> <title> Signal Processing. </title> <publisher> George & Allen Un-win Ltd., </publisher> <year> 1973. </year>
Reference-contexts: Trilinear interpolation is equivalent to convolution by the separable filter h s (x) = <ref> [jxj &lt; 1] </ref> (1 jxj): * A two-parameter family of cubic filters, with parameters B and C, studied in two dimensions in [15]: h s (B;C)(x) = 6 &gt; &gt; &gt; &gt; &gt; &lt; (12 9B 6C)jxj 3 + if jxj &lt; 1, (12B 48C)jxj + (8B + 24C) 0 otherwise. <p> The (truncated) Gaussian filter, which is often used in splatting algorithms for volume rendering: h s (x m ; s)(x) = [jxj &lt; x m ] e x 2 =2s 2 * The cosine bell filter, which has been widely used as a window (see below) in one-dimensional signal processing <ref> [1] </ref>, but can also be used as a reconstruction filter in its own right: h s (x m )(x) = [jxj &lt; x m ] (1 + cos (px=x m )): * Windowed sinc filters. These filters approximate the ideal sinc filter by a filter with finite support. <p> The 3-sinc (which is not the same as the separable sinc defined earlier) is the inverse Fourier transform of a function that is one inside a unit sphere and zero outside. For this filter, h r (r m )(r) = <ref> [a &lt; 1] </ref>(1 + cos (pa))(sin a a cos a)=a 3 where a = r=r m . 4.3 Pass-band optimal discrete filters These filters, described by Hsu and Marzetta [8] and recommended for use in volume rendering by Carlbom [3], are separable.
Reference: [2] <author> S. Bochner and K. Chandrasekharan. </author> <title> Fourier Transforms. </title> <publisher> Princeton University Press, </publisher> <year> 1949. </year>
Reference-contexts: For spherically symmetric filters, the three dimensional integral can be simplified <ref> [2] </ref> to h r (w r ) = w r 0 The smoothing metric is obtained directly from its definition by numerical integration. The postaliasing metric is computed from the smoothing metric and the total filter energy.
Reference: [3] <author> Ingrid Carlbom. </author> <title> Optimal filter design for volume reconstruction and visualization. </title> <booktitle> In Visualization '93, </booktitle> <pages> pages 54-61, </pages> <month> October </month> <year> 1993. </year>
Reference-contexts: The splatting methods of Westover [17] and Laur & Hanrahan [11] assume a truncated Gaussian filter for interpolation, although the interpolation operation is actually merged with illumination and projection into a single fast but approximate compositing process. Carlbom <ref> [3] </ref> discusses the design of discrete optimal filters based on weighted Chebyshev minimization. All of these schemes fall within the standard signal processing framework of reconstruction by convolution with a filter, which is the model we use to analyze them. <p> For this filter, h r (r m )(r) = [a &lt; 1](1 + cos (pa))(sin a a cos a)=a 3 where a = r=r m . 4.3 Pass-band optimal discrete filters These filters, described by Hsu and Marzetta [8] and recommended for use in volume rendering by Carlbom <ref> [3] </ref>, are separable. Hence, the following discussion relates to one-dimensional interpolation; the three-dimensional filters are the products of three one-dimensional filters. <p> be 1 Z j hj 2 dV ; where R N is the Nyquist region, jR N j is the frequency-space volume of R N , and dV is an infinitesimal volume element in 4 The discrete filters were computed using the program [9], modified as described in [8] and <ref> [3] </ref>, and with f m values of 0.3 and 0.4 for the 5-point and 9-point filters respectively, as in [3]. R N . We define our postaliasing metric, P , to be P (h) = jR N j R N where R N is the complement of R N . <p> the frequency-space volume of R N , and dV is an infinitesimal volume element in 4 The discrete filters were computed using the program [9], modified as described in [8] and <ref> [3] </ref>, and with f m values of 0.3 and 0.4 for the 5-point and 9-point filters respectively, as in [3]. R N . We define our postaliasing metric, P , to be P (h) = jR N j R N where R N is the complement of R N .
Reference: [4] <author> H. E. Cline, W. E. Lorensen, S. Ludke, C. R. Crawford, and B. C. Teeter. </author> <title> Two algorithms for the three-dimensional reconstruction of tomograms. </title> <journal> Medical Physics, </journal> <volume> 15(3) </volume> <pages> 320-327, </pages> <month> May/June </month> <year> 1988. </year>
Reference-contexts: Trilinear interpolation is widely used, for example in the isosurface extraction algorithms of Wyvill, et. al. [19], and Lorensen, et. al. <ref> [13, 4] </ref>, and in many ray-tracing schemes (e.g., that of Levoy [12]). Cubic filters have also received attention: Levoy uses cubic B-splines This paper is published in the proceedings of the IEEE Visualization '94 conference.
Reference: [5] <author> Dan E. Dudgeon and Russel M. Mersereau. </author> <title> Multidimensional Signal Processing. </title> <publisher> Prentice-Hall, </publisher> <year> 1984. </year>
Reference-contexts: See <ref> [5] </ref> for a discussion of signal processing in arbitrary dimensions.
Reference: [6] <author> J. D. Foley, A. van Dam, S. K. Feiner, and J. F. Hughes. </author> <title> Computer Graphics: Principles and Practices (2nd Edition). </title> <publisher> Ad-dison Wesley, </publisher> <year> 1990. </year>
Reference-contexts: Some initial familiarity is assumed; introductions to this subject can be found in <ref> [6] </ref> and [7]. Fourier analysis allows us to write a complex-valued function g : R 2 ! C as a sum of plane waves of the form exp (i (w x x + w y y)).
Reference: [7] <author> Rafael C. Gonzalez and Paul Wintz. </author> <booktitle> Digital Image Processing (2nd Ed.). </booktitle> <publisher> Addison-Wesley, </publisher> <address> Reading, MA, </address> <year> 1987. </year>
Reference-contexts: Some initial familiarity is assumed; introductions to this subject can be found in [6] and <ref> [7] </ref>. Fourier analysis allows us to write a complex-valued function g : R 2 ! C as a sum of plane waves of the form exp (i (w x x + w y y)).
Reference: [8] <author> Kai Hsu and Thomas L. Marzetta. </author> <title> Velocity filtering of acoustic well logging waveforms. </title> <journal> IEEE Transactions on Acoustics, Speech and Signal Processing, </journal> <volume> 37(2) </volume> <pages> 265-274, </pages> <month> Febru-ary </month> <year> 1989. </year>
Reference-contexts: For this filter, h r (r m )(r) = [a &lt; 1](1 + cos (pa))(sin a a cos a)=a 3 where a = r=r m . 4.3 Pass-band optimal discrete filters These filters, described by Hsu and Marzetta <ref> [8] </ref> and recommended for use in volume rendering by Carlbom [3], are separable. Hence, the following discussion relates to one-dimensional interpolation; the three-dimensional filters are the products of three one-dimensional filters. <p> h, to be 1 Z j hj 2 dV ; where R N is the Nyquist region, jR N j is the frequency-space volume of R N , and dV is an infinitesimal volume element in 4 The discrete filters were computed using the program [9], modified as described in <ref> [8] </ref> and [3], and with f m values of 0.3 and 0.4 for the 5-point and 9-point filters respectively, as in [3]. R N .
Reference: [9] <author> J.H.McClellan, T.W.Parks, and L.R.Rabiner. </author> <title> FIR linear phase filter design program. In IEEE ASSP Society Digital Signal Processing Committee, editor, Programs for Digital Signal Processing, </title> <publisher> pages 5.1-1-5.1-13. IEEE Press, </publisher> <year> 1979. </year>
Reference-contexts: Carlbom defines an optimal interpolation filter as a set of such discrete filters, each individually optimized to minimize smoothing. For each interpolation offset, a weighted Chebyshev minimization program <ref> [9] </ref> is used to obtain a discrete filter whose Fourier transform has (approximately) a minimum weighted departure from ideal up to some frequency f m &lt; f N . <p> metric, S, of a filter h, to be 1 Z j hj 2 dV ; where R N is the Nyquist region, jR N j is the frequency-space volume of R N , and dV is an infinitesimal volume element in 4 The discrete filters were computed using the program <ref> [9] </ref>, modified as described in [8] and [3], and with f m values of 0.3 and 0.4 for the 5-point and 9-point filters respectively, as in [3]. R N .
Reference: [10] <author> Robert G. </author> <title> Keys. Cubic convolution interpolation for digital image processing. </title> <journal> IEEE Trans. Acoustics, Speech, and Signal Processing, </journal> <volume> ASSP-29(6):1153-1160, </volume> <month> December </month> <year> 1981. </year>
Reference: [11] <author> David Laur and Pat Hanrahan. </author> <title> Hierarchical splatting: A progressive refinement algorithm for volume rendering. </title> <editor> In Thomas W. Sederberg, editor, </editor> <booktitle> Computer Graphics (SIG-GRAPH '91 Proceedings), </booktitle> <volume> volume 25, </volume> <pages> pages 285-288, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: On leave from the Department of Computer Science, University of Auckland, Auckland, New Zealand until August 1994. for volume resampling, and Wilhelms and Van Gelder mention Catmull-Rom splines for isosurface topology disambiguation [18]. The splatting methods of Westover [17] and Laur & Hanrahan <ref> [11] </ref> assume a truncated Gaussian filter for interpolation, although the interpolation operation is actually merged with illumination and projection into a single fast but approximate compositing process. Carlbom [3] discusses the design of discrete optimal filters based on weighted Chebyshev minimization.
Reference: [12] <author> Marc Levoy. </author> <title> Display of surfaces from volume data. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 8(3) </volume> <pages> 29-37, </pages> <month> May </month> <year> 1988. </year>
Reference-contexts: Trilinear interpolation is widely used, for example in the isosurface extraction algorithms of Wyvill, et. al. [19], and Lorensen, et. al. [13, 4], and in many ray-tracing schemes (e.g., that of Levoy <ref> [12] </ref>). Cubic filters have also received attention: Levoy uses cubic B-splines This paper is published in the proceedings of the IEEE Visualization '94 conference.
Reference: [13] <author> William E. Lorensen and Harvey E. Cline. </author> <title> Marching cubes: A high resolution 3D surface construction algorithm. </title> <editor> In Maureen C. Stone, editor, </editor> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> volume 21, </volume> <pages> pages 163-169, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: Trilinear interpolation is widely used, for example in the isosurface extraction algorithms of Wyvill, et. al. [19], and Lorensen, et. al. <ref> [13, 4] </ref>, and in many ray-tracing schemes (e.g., that of Levoy [12]). Cubic filters have also received attention: Levoy uses cubic B-splines This paper is published in the proceedings of the IEEE Visualization '94 conference. <p> It is important that we show the exact shape of the isosurface, including small irregularities that can be seen only with detailed shading. This means we need a gradient that corresponds exactly to the reconstructed density function. The usual schemes for rendering isosurfaces (e. g., Lorensen and Cline <ref> [13] </ref>) approximate the gradients using central differences at sample points and then interpolate those gradients; the resulting estimate does not track small-scale changes in the isosurface orientation.
Reference: [14] <author> Clare McGillem and George Cooper. </author> <title> Continuous and Discrete Signal and System Analysis. </title> <publisher> Holt, Rinehart and Win-ston, </publisher> <year> 1984. </year>
Reference-contexts: Also, smoothing is often necessary to combat the Gibbs phenomenon (see below). 3.3 Ringing (overshoot) Low-pass filtering of step discontinuities results in oscillations, or ringing, just before and after the discontinuity; this is the Gibbs phenomenon (see for example <ref> [14] </ref>). Severe ringing is not necessary for band-limitedness: Figure 3 shows two band-limited approximations to a square wave, one generated with an ideal low-pass filter and the other with a filter that cuts off more gradually but with the same ultimate cut-off frequency. <p> All except the pass-band optimal filters are even functions, for which the transform simplifies to the cosine transform <ref> [14] </ref>: h (w x ; w y ; w z ) = R 3 For the separable filters, the transform further simplifies to the product of three one-dimensional transforms. <p> The postaliasing metric is computed from the smoothing metric and the total filter energy. We can compute the total energy in the space domain, where the filter has finite support, since Parseval's theorem <ref> [14] </ref> shows that the result is the same in both space and frequency domains.
Reference: [15] <author> Don P. Mitchell and Arun N. Netravali. </author> <title> Reconstruction filters in computer graphics. </title> <editor> In John Dill, editor, </editor> <booktitle> Computer Graphics (SIGGRAPH '88 Proceedings), </booktitle> <volume> volume 22, </volume> <pages> pages 221-228, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: In particular, Mitchell and Netravali <ref> [15] </ref> identified postaliasing, blur, anisotropy, and ringing as defects arising from imperfect image reconstruction. 3.1 Postaliasing Postaliasing arises when energy from the alias spectra leaks through into the reconstruction, due to the reconstruction filter being significantly non-zero at frequencies above f N . <p> Trilinear interpolation is equivalent to convolution by the separable filter h s (x) = [jxj &lt; 1] (1 jxj): * A two-parameter family of cubic filters, with parameters B and C, studied in two dimensions in <ref> [15] </ref>: h s (B;C)(x) = 6 &gt; &gt; &gt; &gt; &gt; &lt; (12 9B 6C)jxj 3 + if jxj &lt; 1, (12B 48C)jxj + (8B + 24C) 0 otherwise. This family includes the well-known B-spline (B = 1, C = 0) and Catmull-Rom spline (B = 0, C = 0:5). <p> It is perhaps a limitation of our postaliasing metric that it weights leakage at all frequencies equally. Our experience corroborates the space-domain convergence analysis of Mitchell and Netravali <ref> [15] </ref>, which suggests that filters along the line 2C + B = 1 (which includes Catmull-Rom and B-splines as extreme cases) are among the best: we find that these filters have negligible near-sample-frequency ripple.
Reference: [16] <author> Stephen K. Park and Robert A. Schowengerdt. </author> <title> Image reconstruction by parametric cubic convolution. Computer Vision, </title> <journal> Graphics, and Image Processing, </journal> <volume> 23(3) </volume> <pages> 258-272, </pages> <month> Septem-ber </month> <year> 1983. </year>
Reference: [17] <author> Lee Westover. </author> <title> Footprint evaluation for volume rendering. In Forest Baskett, editor, </title> <booktitle> Computer Graphics (SIGGRAPH '90 Proceedings), </booktitle> <volume> volume 24, </volume> <pages> pages 367-376, </pages> <month> August </month> <year> 1990. </year>
Reference-contexts: On leave from the Department of Computer Science, University of Auckland, Auckland, New Zealand until August 1994. for volume resampling, and Wilhelms and Van Gelder mention Catmull-Rom splines for isosurface topology disambiguation [18]. The splatting methods of Westover <ref> [17] </ref> and Laur & Hanrahan [11] assume a truncated Gaussian filter for interpolation, although the interpolation operation is actually merged with illumination and projection into a single fast but approximate compositing process. Carlbom [3] discusses the design of discrete optimal filters based on weighted Chebyshev minimization.
Reference: [18] <author> Jane Wilhelms and Allen Van Gelder. </author> <title> Topological consideration in isosurface generation. </title> <type> Technical report, </type> <institution> University of California, Santa Cruz, </institution> <month> April </month> <year> 1990. </year>
Reference-contexts: On leave from the Department of Computer Science, University of Auckland, Auckland, New Zealand until August 1994. for volume resampling, and Wilhelms and Van Gelder mention Catmull-Rom splines for isosurface topology disambiguation <ref> [18] </ref>. The splatting methods of Westover [17] and Laur & Hanrahan [11] assume a truncated Gaussian filter for interpolation, although the interpolation operation is actually merged with illumination and projection into a single fast but approximate compositing process.
Reference: [19] <author> Brian Wyvill, Craig McPheeters, and Geoff Wyvill. </author> <title> Data structure for soft objects. </title> <journal> The Visual Computer, </journal> <volume> 2(4) </volume> <pages> 227-234, </pages> <year> 1986. </year> <title> (a) B-spline (b) Catmull-Rom (c) Cubic (B = 0:5, C = 0:85) (d) Trilinear (e) Cubic (B = 0:26, C = 0:1) (f) Windowed sinc (r = 4:8) </title>
Reference-contexts: Given a discrete set of samples, the process of obtaining a density function that is defined throughout the volume is called interpolation or reconstruction; we use these terms interchangeably. Trilinear interpolation is widely used, for example in the isosurface extraction algorithms of Wyvill, et. al. <ref> [19] </ref>, and Lorensen, et. al. [13, 4], and in many ray-tracing schemes (e.g., that of Levoy [12]). Cubic filters have also received attention: Levoy uses cubic B-splines This paper is published in the proceedings of the IEEE Visualization '94 conference.
References-found: 19

