URL: http://www.robotics.stanford.edu/users/as/main.ps.gz
Refering-URL: http://www.robotics.stanford.edu/people/as/medical.html
Root-URL: http://www.robotics.stanford.edu
Email: fadler j asg@flamingo.stanford.edu  
Title: Planning for Camera-Guided Robotic Radiosurgery  
Author: Achim Schweikard Mohan Bodduluri flfl Rhea Tombropoulos John R. Adler Jean-Claude Latombe 
Keyword: Medical Robotics, Geometric Reasoning, Motion Planning, Collision Avoidance, Image-Guided Surgery, Treatment Planning, Radiosurgery, Radiation Therapy, Medical Physics  
Address: Stanford, CA. 94305,  Santa Clara, CA. 95054  
Affiliation: Robotics Laboratory, Department of Computer Science Department of Neurosurgery Section on Medical Informatics, School of Medicine Stanford University,  flfl Accuray Inc.,  
Note: submitted: IEEE Trans. Rob. Autom.  
Abstract: Radiosurgery is a treatment for brain tumors (and other lesions) which employs a moving beam of photon radiation. Classical radiosurgical systems rely on rigid skeletal fixation of the anatomic region to be treated. This fixation procedure is very painful for the patient and limits radiosurgical procedures to brain lesions. Furthermore, due to the necessity of rigid fixation, radiosurgical treatment with classical systems cannot be fractionated. A new camera-guided system capable of tracking patient motion during treatment has been built to overcome these problems. The radiation source is moved by a six degree-of-freedom robotic arm. In addition to offering a more cost effective, less invasive, and less painful treatment, the robotic gantry allows for arbitrary spatial motion of the radiation source. The system introduces a new class of radiosurgical procedures, termed non-stereotactic, or camera-guided radiosurgery. At the heart of these procedures are algorithms for planning both a treatment and the corresponding beam motion, given the geometric description of the tumor shape and relative locations in the particular case. Results obtained from phantom studies and clinical use suggest that we can treat non-spherical lesions with accuracies unachievable with classical radiosurgical systems. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Becker, G.; Kortmann, R., Kaulich, T.W., Duffner, F., Bamberg, M. </author> <title> Gamma knife versus stereotactic linear accelerator. Utilization, clinical results and cost-benefit relations. </title> <booktitle> Radiologe 36(4): </booktitle> <pages> 345-53, </pages> <year> 1996. </year>
Reference: [2] <author> Barth, N. H. </author> <title> An Inverse Problem in Radiation Therapy. </title> <journal> Intern. J. Radiation Oncology Biol. Phys., </journal> <volume> 18 </volume> <pages> 425-431, </pages> <year> 1990. </year>
Reference-contexts: The planned motion must be collision-free, and collision-avoidance must be performed dynamically. The inverse planning problem in conventional radiosurgery and radiation therapy has been studied extensively in the literature (see e.g. <ref> [2, 5, 8, 16, 23] </ref>). Inverse planning can be regarded as an optimization problem, with constraints stemming from medical requirements, workspace geometry and gantry kinematics.
Reference: [3] <author> Betty, O. O., Munari, C., and Rosler, R. </author> <title> Stereotactic Radiosurgery with the Linear Accelerator: Treatment of Arteriovenous Malformations. </title> <journal> Neurosurgery, </journal> <volume> 24(3) </volume> <pages> 311-321, </pages> <year> 1989. </year>
Reference-contexts: 1 Introduction In radiosurgery, brain tumors (and other brain lesions) are treated by moving an intense beam of radiation <ref> [3, 12, 15] </ref>. A necrotic dose is delivered to a tumor by cross-firing from multiple directions, to reduce the amount of energy deposited in healthy brain. The radiosurgical treatment consists of several phases. <p> In many cases, appropriate dose distributions require a large set of beam directions and/or complex motions of the radiation source. 2 Related Work The most widely used hardware systems for radiosurgery are LINAC-based gantry systems (LINAC-systems, <ref> [3, 12, 15] </ref>) and Gamma-knife systems ([1]). For LINAC-based radiosurgery the beam is moved along circular arcs in space. In contrast, Gamma-knifes do not use beam motion. Instead, a large number of static beams are generated by appropriate radioactive sources.
Reference: [4] <author> Bortfeld, T., Schlegel, W., Rhein, B. </author> <title> Decomposition of pencil beam kernels for fast dose calculations in three dimensional treatment planning. </title> <journal> Medical Physics, </journal> <volume> 20(2) </volume> <pages> 311-318, </pages> <year> 1993. </year>
Reference: [5] <author> Brahme, A. </author> <title> Optimization of stationary and moving beam radiation therapy techniques. </title> <journal> Radiother. Oncol., </journal> <volume> 12 </volume> <pages> 127-140, </pages> <year> 1988. </year>
Reference-contexts: The planned motion must be collision-free, and collision-avoidance must be performed dynamically. The inverse planning problem in conventional radiosurgery and radiation therapy has been studied extensively in the literature (see e.g. <ref> [2, 5, 8, 16, 23] </ref>). Inverse planning can be regarded as an optimization problem, with constraints stemming from medical requirements, workspace geometry and gantry kinematics.
Reference: [6] <author> Chazelle, B., Edelsbrunner, H., Guibas, L., and Sharir. M. </author> <title> A singly-exponential stratification scheme for semi-algebraic varieties and its applications. </title> <booktitle> In Proc. 16th Int. Colloq. Automata Lang. Programm., Lecture Notes in Computer Science, </booktitle> <publisher> Springer, </publisher> <pages> 372 179-192, </pages> <year> 1989. </year>
Reference: [7] <author> H. Edelsbrunner. </author> <title> Algorithms in Combinatorial Geometry. </title> <publisher> Springer, </publisher> <address> Heidelberg, </address> <year> 1987. </year>
Reference-contexts: Conversely, an arrangement of hyperplanes in 3D has at most O (n 3 ) cells (see e.g. <ref> [7] </ref>). The proof in [7] can be extended to the case of cylinders, and it can be shown that there are fi (n 3 ) inequalities in the worst case. However, we can reduce the number of inequalities by a large factor. Consider fig 7. <p> Conversely, an arrangement of hyperplanes in 3D has at most O (n 3 ) cells (see e.g. <ref> [7] </ref>). The proof in [7] can be extended to the case of cylinders, and it can be shown that there are fi (n 3 ) inequalities in the worst case. However, we can reduce the number of inequalities by a large factor. Consider fig 7.
Reference: [8] <author> Eklof, A., Ahnesjo, A., Brahme, A. </author> <title> Photon beam energy deposition kernels for inverse radiotherapy planning. </title> <journal> Acta Oncologica, </journal> <volume> 29 </volume> <pages> 447-454, </pages> <year> 1990. </year>
Reference-contexts: The planned motion must be collision-free, and collision-avoidance must be performed dynamically. The inverse planning problem in conventional radiosurgery and radiation therapy has been studied extensively in the literature (see e.g. <ref> [2, 5, 8, 16, 23] </ref>). Inverse planning can be regarded as an optimization problem, with constraints stemming from medical requirements, workspace geometry and gantry kinematics.
Reference: [9] <author> Halperin, D. and Yap, C.K. </author> <title> Combinatorial Complexity of Translating a Box in Polyhedral 3-Space 9th Annual ACM Symp. </title> <booktitle> on Computational Geometry, </booktitle> <pages> 29-37, </pages> <year> 1993. </year>
Reference: [10] <author> ICRU Report 50: Prescribing, </author> <title> recording and reporting photon beam therapy. </title> <type> Technical report. </type> <institution> Int. Comm. Radiation Units and Measurements, Bethesda, MD, </institution> <year> 1992. </year>
Reference: [11] <author> Nedzi, L. A., Kooy, H. M., Alexander, E., et. al. </author> <title> Dynamic Field Shaping for Stereotactic Radiosurgery: A Modeling Study Intern. </title> <journal> J. Radiation Oncology Biol. Phys., </journal> <volume> 25 </volume> <pages> 859-869, </pages> <year> 1993. </year>
Reference-contexts: The resulting set of equations is then solved with the (simplex-based) MINOS linear programming system ([14]). Fig. 13 summarizes the planning steps. Several paradigms for evaluating radiosurgical and radiotherapeutical dose distributions are in clinical use. The main paradigms are dose-volume histograms <ref> [11, 12, 15] </ref> and color representations of distributions in 2D overlaid upon tomographic images. A dose-volume histogram (DVH) shows the volume (ordinate values) absorbing a dose x as a function of x (abscissa values). <p> A separate DVH is computed for the tumor, critical tissue, and for tissue surrounding the tumor. In addition, the system uses 3D isodose surfaces overlaid on reconstructions of anatomic regions, tissue-volume ratios <ref> [11] </ref>, and integrals over dose-volume histograms. These paradigms refer to dose distributions computed in simulation. Calibrated photographic film phantoms (CFP) are used for verification. Film phantoms are processed electronically to validate distributions computed in simulation. Thus dose-volume histograms can be computed directly from actual radiation exposure and not from simulation.
Reference: [12] <author> Lutz, W., Winston, K. R., and Maleki, N. </author> <title> A System for stereotactic radiosurgery with a linear accelerator. </title> <journal> Int. J. Radiation Oncology Biol. Phys., </journal> <volume> 14 </volume> <pages> 373-381, </pages> <year> 1988. </year> <month> 17 </month>
Reference-contexts: 1 Introduction In radiosurgery, brain tumors (and other brain lesions) are treated by moving an intense beam of radiation <ref> [3, 12, 15] </ref>. A necrotic dose is delivered to a tumor by cross-firing from multiple directions, to reduce the amount of energy deposited in healthy brain. The radiosurgical treatment consists of several phases. <p> Small movements of the patient are compensated for by a corresponding motion of the manipulator arm. In appropriate cases, the treatment is interrupted to change the collimator. The new system offers the following advantages over earlier radiosurgical and radiotherapeutical systems (see e.g. <ref> [12, 15, 23] </ref>): * The tissue does not have to be fixed in space. In earlier radiosurgical systems this was done with stereotaxic frames (fig. 2). <p> In many cases, appropriate dose distributions require a large set of beam directions and/or complex motions of the radiation source. 2 Related Work The most widely used hardware systems for radiosurgery are LINAC-based gantry systems (LINAC-systems, <ref> [3, 12, 15] </ref>) and Gamma-knife systems ([1]). For LINAC-based radiosurgery the beam is moved along circular arcs in space. In contrast, Gamma-knifes do not use beam motion. Instead, a large number of static beams are generated by appropriate radioactive sources. <p> The resulting set of equations is then solved with the (simplex-based) MINOS linear programming system ([14]). Fig. 13 summarizes the planning steps. Several paradigms for evaluating radiosurgical and radiotherapeutical dose distributions are in clinical use. The main paradigms are dose-volume histograms <ref> [11, 12, 15] </ref> and color representations of distributions in 2D overlaid upon tomographic images. A dose-volume histogram (DVH) shows the volume (ordinate values) absorbing a dose x as a function of x (abscissa values). <p> In a test series, all cases treated during a comparison period with an earlier system for frame-based stereotactic 14 representation of tumor delineation (c) Isodose surface (d) Isodose surface overlaid on tumor reconstruc tion radiosurgery (LINAC-system, <ref> [12] </ref>) were considered. In each case, data for the actual treatment were retrieved. Plans for the same cases were then computed for the new system. The comparison is based on dose-volume histograms, 2D and 3D dose visualization paradigms as well as photographic film phantom studies in water.
Reference: [13] <author> J. J. More', S. J. Wright. </author> <note> Optimization Software Guide. Frontiers in Applied Mathematics, 14, SIAM, 1993. See also: "http://www.mcs.anl.gov/home/ otc/Guide/SoftwareGuide/". </note>
Reference: [14] <author> Murtagh, B. A., Saunders, M. A., </author> <title> Minos 5.4 user's guide. </title> <type> Technical Report SOL 83-20R, </type> <institution> Dept. of Operations Research, Stanford University, </institution> <year> 1983. </year>
Reference: [15] <author> Podgorsak, E. B., et al. </author> <title> Dynamic Stereotactic Radiosurgery. </title> <journal> Intern. J. Radiation Oncology Biol. Phys., </journal> <volume> 14 </volume> <pages> 115-126, </pages> <year> 1988. </year>
Reference-contexts: 1 Introduction In radiosurgery, brain tumors (and other brain lesions) are treated by moving an intense beam of radiation <ref> [3, 12, 15] </ref>. A necrotic dose is delivered to a tumor by cross-firing from multiple directions, to reduce the amount of energy deposited in healthy brain. The radiosurgical treatment consists of several phases. <p> Small movements of the patient are compensated for by a corresponding motion of the manipulator arm. In appropriate cases, the treatment is interrupted to change the collimator. The new system offers the following advantages over earlier radiosurgical and radiotherapeutical systems (see e.g. <ref> [12, 15, 23] </ref>): * The tissue does not have to be fixed in space. In earlier radiosurgical systems this was done with stereotaxic frames (fig. 2). <p> In many cases, appropriate dose distributions require a large set of beam directions and/or complex motions of the radiation source. 2 Related Work The most widely used hardware systems for radiosurgery are LINAC-based gantry systems (LINAC-systems, <ref> [3, 12, 15] </ref>) and Gamma-knife systems ([1]). For LINAC-based radiosurgery the beam is moved along circular arcs in space. In contrast, Gamma-knifes do not use beam motion. Instead, a large number of static beams are generated by appropriate radioactive sources. <p> The direct dosimetry problem, or forward planning problem is to compute the dose distribution in a tissue given a treatment plan. It relies on a model of fluency in tissue structures of different types, measured in phantom studies (see e.g. <ref> [15, 17] </ref>) The inverse dosimetry problem, also called inverse planning problem is to find a treatment plan whose execution will achieve a desired dose distribution. The inverse problem in radiosurgery is related to the problem of finding treatment plans in radiation therapy. <p> The resulting set of equations is then solved with the (simplex-based) MINOS linear programming system ([14]). Fig. 13 summarizes the planning steps. Several paradigms for evaluating radiosurgical and radiotherapeutical dose distributions are in clinical use. The main paradigms are dose-volume histograms <ref> [11, 12, 15] </ref> and color representations of distributions in 2D overlaid upon tomographic images. A dose-volume histogram (DVH) shows the volume (ordinate values) absorbing a dose x as a function of x (abscissa values).
Reference: [16] <author> Renner, W. D., O'Connor, T. P., Bermudez, N. M. </author> <title> An algorithm for design of beam compensators. </title> <journal> Intern. J. Radiation Oncology Biol. Phys., </journal> <volume> 17: </volume> <pages> 227-34, </pages> <year> 1989. </year>
Reference-contexts: The planned motion must be collision-free, and collision-avoidance must be performed dynamically. The inverse planning problem in conventional radiosurgery and radiation therapy has been studied extensively in the literature (see e.g. <ref> [2, 5, 8, 16, 23] </ref>). Inverse planning can be regarded as an optimization problem, with constraints stemming from medical requirements, workspace geometry and gantry kinematics. <p> The second step assigns weights to each of the selected beam configurations. Linear programming methods for computing such weights in radiation therapy have been proposed by several authors (see e.g. <ref> [16, 18] </ref>). We describe a framework for the application of linear programming in robotic radiosurgery, which relies on a standardized description of the constraints for a desired distribution. A particularly simple beam model allows for an efficient ad hoc reduction of the number of constraints.
Reference: [17] <author> Rice, R. K., et al. </author> <title> Measurements of Dose Distributions in Small Beams of 6 MeV X-Rays. </title> <journal> Phys. Med. Biol., </journal> <volume> 32 </volume> <pages> 1087-1099, </pages> <year> 1987. </year>
Reference-contexts: The direct dosimetry problem, or forward planning problem is to compute the dose distribution in a tissue given a treatment plan. It relies on a model of fluency in tissue structures of different types, measured in phantom studies (see e.g. <ref> [15, 17] </ref>) The inverse dosimetry problem, also called inverse planning problem is to find a treatment plan whose execution will achieve a desired dose distribution. The inverse problem in radiosurgery is related to the problem of finding treatment plans in radiation therapy.
Reference: [18] <author> Rosen, I., Lane, R. G., Morrill, S. M., Belli, J. A. </author> <title> Treatment Plan Optimization using Linear Programming. </title> <journal> Medical Physics, </journal> <volume> 18 </volume> <pages> 141-152, </pages> <year> 1991. </year>
Reference-contexts: The second step assigns weights to each of the selected beam configurations. Linear programming methods for computing such weights in radiation therapy have been proposed by several authors (see e.g. <ref> [16, 18] </ref>). We describe a framework for the application of linear programming in robotic radiosurgery, which relies on a standardized description of the constraints for a desired distribution. A particularly simple beam model allows for an efficient ad hoc reduction of the number of constraints.
Reference: [19] <author> Schweikard, A., Tombropoulos, R. Z., Kavraki, L., Adler, J.R., and Latombe, </author> <title> J.C., Treatment Planning for a Radiosurgical System with General Kinematics. </title> <booktitle> Proc. IEEE Int. Conf. Robotics and Automation, </booktitle> <address> San Diego, CA, 1720-1727, </address> <year> 1994. </year>
Reference-contexts: In the case of fig. 8, the number of inequalities is reduced by a factor of ( 2n n ) 3 ~ 8. Beam model: In the above description it was assumed that each beam is a cylinder with constant fluency. A geometric beam model described in <ref> [19] </ref> allows a more accurate representation of the physical characteristics of photon beams. This model takes into account the decrease of dose with depth in tissue and distance from the beam's central axis, as well as the beam widening with distance from the source.
Reference: [20] <author> Schweikard, A., Hommel, G., </author> <title> Berechnung erreichbarer Effektorstellungen fur Handhabungsgerate mit weniger als sechs Freiheit-graden. (Calculation of reachable effector configurations for manipulators with less than six degrees of freedom). </title> <journal> Robotersysteme, </journal> <volume> 4, </volume> <pages> 177-182, </pages> <year> 1988. </year>
Reference-contexts: We thus resolve the remaining kinematic redundancy in such a way, that posture changes along the template path are entirely avoided. This is done based on methods in <ref> [20] </ref>. For verification, the template path in fig. 9-b was executed and a photographic film in a phantom skull (Plexiglas reconstruction of a skull, filled with water) was exposed to the generated radiation.
Reference: [21] <author> Troccaz, J. et al. </author> <title> Conformal External Radiotherapy of Prostatic Carcinoma: Requirements and Preliminary Results, </title> <type> Rep. </type> <institution> No. 912I, TIMC-IMAG, Faculte de Medecine, Grenoble, </institution> <year> 1993. </year>
Reference: [22] <author> Turk, G. </author> <title> Re-Tiling Polygonal Surfaces. </title> <journal> Computer Graphics, </journal> <volume> 26(3) </volume> <pages> 55-64, </pages> <year> 1992. </year>
Reference-contexts: The choice of orientation of this polyhedron is problematic if there are critical healthy structures in the tumor vicinity. Furthermore there is no such regular polyhedron with more than 20 vertices. A more even distribution is obtained using more directions. The methods in <ref> [22] </ref> provide point grids on spheres which are adequate for our purposes. Our planning method thus uses a large set of beams (typically n 100) for a single sphere, and addresses the presence of critical regions not during the beam selection phase, but during the beam weighting phase. <p> A beam with rectangular cross-section avoids this problem. (figure 5 b). Treated Volumes of General Shape: The above approach is restricted to the pseudo-cylindrical shapes shown in figure 4 and shapes obtained from bending such shapes. A direct generalization of this scheme is the following. With an algorithm in <ref> [22] </ref>, we compute a grid of n points on the tumor surface. Each such point is now treated as an isocenter. As above, a single beam is placed through each isocenter.
Reference: [23] <author> Webb, S. </author> <title> The Physics of Three-dimensional Radiation Therapy, </title> <publisher> Institute of Physics Publishing, </publisher> <address> Bristol and Philadelphia: </address> <year> 1993. </year> <month> 18 </month>
Reference-contexts: Small movements of the patient are compensated for by a corresponding motion of the manipulator arm. In appropriate cases, the treatment is interrupted to change the collimator. The new system offers the following advantages over earlier radiosurgical and radiotherapeutical systems (see e.g. <ref> [12, 15, 23] </ref>): * The tissue does not have to be fixed in space. In earlier radiosurgical systems this was done with stereotaxic frames (fig. 2). <p> The planned motion must be collision-free, and collision-avoidance must be performed dynamically. The inverse planning problem in conventional radiosurgery and radiation therapy has been studied extensively in the literature (see e.g. <ref> [2, 5, 8, 16, 23] </ref>). Inverse planning can be regarded as an optimization problem, with constraints stemming from medical requirements, workspace geometry and gantry kinematics.
References-found: 23

