URL: ftp://ftp.cs.unc.edu/pub/users/manocha/PAPERS/KINEMATICS/ieeetra.ps.Z
Refering-URL: http://www.cs.unc.edu/Research/graphics/pubs.html
Root-URL: http://www.cs.unc.edu
Title: Efficient Inverse Kinematics for General 6R Manipulators  
Author: Dinesh Manocha and John F. Canny 
Keyword: inverse kinematics, serial manipulators, efficiency, eigenvalues  
Note: To Appear in IEEE Transactions on Robotics and Automation  
Abstract: The inverse kinematics of serial manipulators is a central problem in the automatic control of robot manipulators. The main interest has been in inverse kinematics of a six revolute (6R) jointed manipulator with arbitrary geometry. It has been recently shown that the joints of a general 6R manipulator can orient themselves in 16 different configurations (at most), for a given pose of the end-effector. However, there are no good practical solutions available, which give a level of performance expected of industrial manipulators. In this paper, we present an algorithm and implementation for efficient inverse kinematics for a general 6R manipulator. When stated mathematically, the problem reduces to solving a system of multivariate equations. We make use of the algebraic properties of the system and the symbolic formulation used for reducing the problem to solving a univariate polynomial. However, the polynomial is expressed as a matrix determinant and its roots are computed by reducing to an eigenvalue problem. The other roots of the multivariate system are obtained by computing eigenvectors and substitution. The algorithm involves symbolic preprocessing, matrix computations and a variety of other numerical techniques. The average running time of the algorithm, for most cases, is 11 milliseconds on an IBM RS/6000 workstation. This approach is applicable to inverse kinematics of all serial manipulators. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> H. Albala and J. </author> <title> Angeles. Numerical solution to the input output displacement equation of the general 7R spatial mechanism. </title> <booktitle> In Proceedings of the Fifth World Congress on Theory of Machines and Mechanisms, </booktitle> <pages> pages 1008-1011, </pages> <year> 1979. </year>
Reference: [2] <author> E. Anderson, Z. Bai, C. Bischof, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum, S. Hammarling, and D. Sorensen. </author> <title> LAPACK User's Guide, Release 1.0. </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1992. </year>
Reference-contexts: The eigenvectors have the same structure as (15), except that x 3 is replaced by x 3 . V. Implementation 6 We have implemented the algorithm on an IBM RS/6000. We have used many routines from EISPACK and LAPACK for matrix operations <ref> [2] </ref>. These routines are available in Fortran and we interfaced them with our C programs. Many of the algorithms for matrix computations have been specialized to our application. The details are given below. A. Eigendecomposition In the previous section we reduced the problem of root finding to an eigenvalue problem.
Reference: [3] <author> Z. Bai, J. Demmel, and A. McKenney. </author> <title> On the conditioning of the nonsymmetric eigenproblem: Theory and software. </title> <institution> Computer Science Dept. </institution> <type> Technical Report 469, </type> <institution> Courant Institute, </institution> <address> New York, NY, </address> <month> October </month> <year> 1989. </year> <note> (LAPACK Working Note #13). </note>
Reference-contexts: It turns out that each of the perturbed eigenvalue, ff i can be ill-conditioned, the arithmetic mean of the perturbed eigenvalues, ff m is well-conditioned <ref> [3] </ref>. We actually verify the accuracy of these computations by computing the condition number of the eigenvalue and the condition number of a cluster of eigenvalues. Routines to compute this condition number of a cluster are available as part of LAPACK. C.
Reference: [4] <author> J. Denavit and R.S. Hartenberg. </author> <title> A kinematic notation for lower-pair mechanisms based upon matrices. </title> <journal> Journal of Applied Mechanics, </journal> <volume> 77 </volume> <pages> 215-221, </pages> <year> 1955. </year>
Reference-contexts: The numerical accuracy, implementation and performance of the algorithm are discussed in Section V. In Section VI we discuss extensions of the algorithm to general serial manipulators. A preliminary version of this paper had appeared in [13]. II. Inverse Kinematics A. Problem Formulation We use Denavit-Hartenberg formalism, <ref> [4] </ref>, to model a 6R manipulator. Each link is represented by the line along its joint axis and the common normal to the next joint axis. In the case of parallel joints, any of the common nor-mals can be chosen.
Reference: [5] <author> J. Duffy and C. Crane. </author> <title> A displacement analysis of the general spatial 7R mechanism. </title> <journal> Mechanisms and Machine Theory, </journal> <volume> 15 </volume> <pages> 153-169, </pages> <year> 1980. </year>
Reference: [6] <author> I. Gohberg, P. Lancaster, and L. Rodman. </author> <title> Matrix Polynomials. </title> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1982. </year>
Reference-contexts: When A k = I, the identity matrix, the matrix polynomial is said to be monic. More details on matrix polynomials and their properties are given in <ref> [6] </ref>. In our application we will be dealing with matrix polynomials in the context of solving non-linear polynomial equations (as shown in (5)). <p> Q.E.D. The matrix polynomials have been used to solve general systems of non-linear polynomial equations. More details are given in [11,12]. The relationship between the eigenval-ues of C and the roots of P () has also been proved using similarity transformations in <ref> [6] </ref>. Many a time the leading matrix A k is singular or close to being singular (due to high condition number). It may still be possible to reduce the problem to an eigenvalue problem using linear transformations (explained in detail in Section IV.C).
Reference: [7] <author> G.H. Golub and C.F. Van Loan. </author> <title> Matrix Computations. </title> <publisher> John Hopkins Press, </publisher> <address> Baltimore, </address> <year> 1989. </year>
Reference-contexts: Let the corresponding numerical matrices (obtained after substitution) be P 1 ; P 2 ; Q 1 ; Q 2 . We use singular value decompositions to compute the ranks of Q 1 and Q 2 <ref> [7] </ref>. The singular vectors obtained are also used to eliminate 1 and 2 from (10) and (11). <p> In other words, and are eigenvalues of M of multiplicity 4 each, where = p 1. If we transform the variable x 3 , as shown in (16), these eigenvalues are suitably transformed. We make use the structure of M along with the QR algorithm for eigenvalue computation <ref> [7] </ref>. In the double shift QR algorithm we chose the shift value for the first few iterations corresponding to and . It uses at most four iterations of the double shift algorithm to reduce the problem to computing the eigenvalues of a 16 fi 16 matrix. B. <p> Routines to compute this condition number of a cluster are available as part of LAPACK. C. Eigenvector computation The eigenvector corresponding to a real eigenvalue is computed by solving a quasi-upper triangular system <ref> [7] </ref>. Given an eigenvector V, we use its structure, (15), to accurately compute x 4 and x 5 from it. However, due to floating point errors each component of the eigenvector undergoes a slight perturbation.
Reference: [8] <author> S.A. Hayati. </author> <title> Robot arm geometric link calibration. </title> <booktitle> In IEEE Control and Decision Conference, </booktitle> <pages> pages 1477-1483, </pages> <year> 1983. </year>
Reference: [9] <author> H.Y. Lee and C.G. Liang. </author> <title> Displacement analysis of the general spatial 7-link 7R mechanism. </title> <journal> Mechanisms and Machine Theory, </journal> <volume> 23(3) </volume> <pages> 219-226, </pages> <year> 1988. </year>
Reference: [10] <author> H.Y. Lee and C.G. Liang. </author> <title> A new vector theory for the analysis of spatial mechanisms. </title> <journal> Mechanisms and Machine Theory, </journal> <volume> 23(3) </volume> <pages> 209-217, </pages> <year> 1988. </year>
Reference: [11] <author> D. Manocha. </author> <title> Algebraic and Numeric Techniques for Modeling and Robotics. </title> <type> PhD thesis, </type> <institution> Computer Science Division, Department of Electrical Engineering and Computer Science, University of California, Berkeley, </institution> <month> May </month> <year> 1992. </year>
Reference: [12] <author> D. Manocha. </author> <title> Solving systems of polynomial equations. </title> <journal> IEEE Computer Graphics and Applications, </journal> <pages> pages 46-55, </pages> <month> March </month> <year> 1994. </year> <note> Special Issue on Solid Modeling. </note>
Reference: [13] <author> D. Manocha and J.F. Canny. </author> <title> Real time inverse kinematics of general 6R manipulators. </title> <booktitle> In Proceedings of IEEE Conference on Robotics and Automation, </booktitle> <pages> pages 383-389, </pages> <year> 1992. </year> <month> 9 </month>
Reference-contexts: The numerical accuracy, implementation and performance of the algorithm are discussed in Section V. In Section VI we discuss extensions of the algorithm to general serial manipulators. A preliminary version of this paper had appeared in <ref> [13] </ref>. II. Inverse Kinematics A. Problem Formulation We use Denavit-Hartenberg formalism, [4], to model a 6R manipulator. Each link is represented by the line along its joint axis and the common normal to the next joint axis.
Reference: [14] <author> D. Manocha and Y. Zhu. </author> <title> A fast algorithm and system for in-verse kinematics of general serial manipulators. </title> <booktitle> In Proceedings of IEEE Conference on Robotics and Automation, </booktitle> <year> 1994. </year>
Reference-contexts: The 16 solutions for this position and orientation of the end-effector are given in Table 3. VI. General Serial Manipulators The techniques presented have been extended to all serial manipulators with a finite number of solutions <ref> [14] </ref> by making use of the matrix structures. The joints may be pris matic or revolute. In particular, Raghavan and Roth have shown that for many cases of manipulators with six joints (revolute or prismatic) the problem of inverse kinematics reduces to finding roots of a univariate polynomial [21].
Reference: [15] <author> R. Manseur and K.L. Doty. </author> <title> A robot manipulator with 16 real inverse kinematic solution set. </title> <journal> International Journal of Robotics Research, </journal> <volume> 8(5) </volume> <pages> 75-79, </pages> <year> 1989. </year>
Reference-contexts: Example .3 Let us consider the manipulator presented in [26] along with a pose of the end effector. This is problem 6 in [21] and corresponds to a slight variation of the manipulator presented in <ref> [15] </ref>. For this configuration the problem of inverse kinematics has 16 real solutions. The robot parameters are given in Table 1.
Reference: [16] <author> B. Paden and S. Sastry. </author> <title> Optimal kinematic design of 6R manipulators. </title> <journal> International Journal of Robotics Research, </journal> <volume> 7(2) </volume> <pages> 43-61, </pages> <year> 1988. </year>
Reference: [17] <author> C.J. Paredis and P.K. Khosla. </author> <title> An approach for mapping kinematic task specification into a manipulator design. </title> <booktitle> In Fifth International Conference on Advanced Robotics, </booktitle> <address> Pisa, Italy, </address> <month> June </month> <year> 1991. </year>
Reference: [18] <author> D. Pieper. </author> <title> The kinematics of manipulators under computer control. </title> <type> PhD thesis, </type> <institution> Stanford University, </institution> <year> 1968. </year>
Reference: [19] <author> E.J.F. Primrose. </author> <title> On the input-output equation of the general 7R-mechanism. </title> <journal> Mechanisms and Machine Theory, </journal> <volume> 21 </volume> <pages> 509-510, </pages> <year> 1986. </year>
Reference: [20] <author> M. Raghavan and B. Roth. </author> <title> Kinematic analysis of the 6R manipulator of general geometry. </title> <booktitle> In International Symposium on Robotics Research, </booktitle> <pages> pages 314-320, </pages> <address> Tokyo, </address> <year> 1989. </year>
Reference-contexts: Thus, the problem of inverse kinematics of general 6R manipulators corresponds to solving 6 equations for 6 unknowns. B. Raghavan and Roth Solution We briefly describe the lower dimensional approach described by Raghavan and Roth <ref> [20] </ref>. They reduce the multi-variate system to a degree 16 polynomial in tan ( 3 2 ), such that the joint angle 3 can be computed from its roots. The other joint angles are computed from substitution and solving for some intermediate equations. <p> In the next section we show the equivalence between this formulation and the non-linear eigenvalue problem. Given 3 , other angles are computed by solving a system of linear equations <ref> [20] </ref>. III. Matrix Polynomials In this section, we review some literature on matrix polynomials and present techniques to solve the non-linear eigen value problem. <p> The proof of this theorem is similar to that of Theorem .1. IV. Algorithm In this section we describe our algorithm in detail. The initial steps in our algorithm make use of the results presented in <ref> [20] </ref>. However, we perform symbolic preprocessing and make certain checks for condition numbers and degeneracy to improve the accuracy of the overall algorithm . The overall algorithm proceeds in the following manner: 1. <p> Many geometric properties of manipulators can be interpreted from the linear algebra structure of these matrices. It corresponds to symbolic elimination and is performed using the properties highlighted in <ref> [20] </ref>. However, it is performed only once for general 6R manipulators. An equivalent symbolic elimination can be performed for a serial ma nipulator with prismatic and revolute joints. 2. <p> The details are given below. A. Eigendecomposition In the previous section we reduced the problem of root finding to an eigenvalue problem. The 24 fi 24 matrix, M , has 24 eigenvalues. However, following the properties of the symbolic formulation in <ref> [20] </ref>, 8 of the eigenvalues correspond to the roots of the polynomial (1 + x 2 3 ) 4 = 0. In other words, and are eigenvalues of M of multiplicity 4 each, where = p 1.
Reference: [21] <author> M. Raghavan and B. Roth. </author> <title> Inverse kinematics of the general 6R manipulator and related linkages. </title> <journal> Transactions of ASME, Journal of Mechanical Design, </journal> <note> 1992. To appear. </note>
Reference-contexts: As a result we reduce the resulting problem to a generalized eigenvalue problem, which slows down the algorithm. Example .3 Let us consider the manipulator presented in [26] along with a pose of the end effector. This is problem 6 in <ref> [21] </ref> and corresponds to a slight variation of the manipulator presented in [15]. For this configuration the problem of inverse kinematics has 16 real solutions. The robot parameters are given in Table 1. <p> The joints may be pris matic or revolute. In particular, Raghavan and Roth have shown that for many cases of manipulators with six joints (revolute or prismatic) the problem of inverse kinematics reduces to finding roots of a univariate polynomial <ref> [21] </ref>. It involves taking suitable minors of matrix and reduction to an eigenvalue problem. VII. Conclusion In this paper we presented efficient algorithm for inverse kinematics of a 6R manipulator of general geometry.
Reference: [22] <author> B. Roth, J. Rastegar, and V. Scheinman. </author> <title> On the design of computer controlled manipulators. </title> <booktitle> In On the Theory and Practice of Robots and Manipulators, </booktitle> <pages> pages 93-113. </pages> <booktitle> First CISM IFToMM Symposium, </booktitle> <year> 1973. </year>
Reference: [23] <author> M.W. Spong and M. Vidyasagar. </author> <title> Robot Dynamics and Control. </title> <publisher> John Wiley and Sons, </publisher> <year> 1989. </year>
Reference-contexts: The coordinate system attached to the ith link is numbered i. More details of the model are given in [23,24]. The 4 fi 4 transformation matrix relating i + 1 coordinate system to i coordinate system is <ref> [23] </ref>: A i = B @ s i c i i c i i a i s i 0 0 0 1 C A ; (1) where s i = sin i ; c i = cos i ; i is the ith joint rotation angle; i = sinff i ; <p> In this case the upper bound on the number of solutions may be less than 16. For example, a PUMA manipulator has a total of at most 8 solutions for any pose of the end-effector <ref> [23] </ref>. 4. Numeric Elimination: Eliminate the variables 1 and 2 from (4). This elimination is performed by computing a minor of maximum rank of Q and using that minor to represent 1 and 2 as functions of 4 and 5 . 5.
Reference: [24] <author> L.W. Tsai and A.P. Morgan. </author> <title> Solving the kinematics of the most general six and five-degree-of-freedom manipulators by continuation methods. </title> <journal> Transactions of the ASME, Journal of Mechanisms, Transmissions and Automation in Design, </journal> <volume> 107 </volume> <pages> 189-200, </pages> <year> 1985. </year>
Reference: [25] <author> W.K. Veitschegger and C. Wu. </author> <title> A method for calibrating and compensating robot kinematic errors. </title> <booktitle> In IEEE Conference on Robotics and Automation, </booktitle> <pages> pages 39-43, </pages> <year> 1987. </year>
Reference: [26] <author> C. Wampler and A.P. Morgan. </author> <title> Solving the 6R inverse position problem using a generic-case solution methodology. </title> <journal> Mechanisms and Machine Theory, </journal> <volume> 26(1) </volume> <pages> 91-106, </pages> <year> 1991. </year>
Reference-contexts: F. Performance We have applied our algorithm to many examples. In particular, we used it on 21 problem instances given in <ref> [26] </ref> and verified the accuracy of our algorithm. All these problems can be accurately solved using double precision arithmetic. In many cases we are able to compute solutions up to 11 12 digits of accuracy. <p> In these instances the matrices A; B; C in (14) are ill-conditioned and have singular pencils. As a result we reduce the resulting problem to a generalized eigenvalue problem, which slows down the algorithm. Example .3 Let us consider the manipulator presented in <ref> [26] </ref> along with a pose of the end effector. This is problem 6 in [21] and corresponds to a slight variation of the manipulator presented in [15]. For this configuration the problem of inverse kinematics has 16 real solutions. The robot parameters are given in Table 1.
Reference: [27] <author> J.H. Wilkinson. </author> <title> The evaluation of the zeros of ill-conditioned polynomials. parts i and ii. </title> <journal> Numer. Math., </journal> <volume> 1 </volume> <pages> 150-166 and 167-180, </pages> <year> 1959. </year>

References-found: 27

