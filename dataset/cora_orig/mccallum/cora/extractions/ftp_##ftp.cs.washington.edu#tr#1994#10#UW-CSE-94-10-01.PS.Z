URL: ftp://ftp.cs.washington.edu/tr/1994/10/UW-CSE-94-10-01.PS.Z
Refering-URL: http://www.cs.washington.edu/research/projects/grail2/www/projects/glob-illum/
Root-URL: 
Title: Global Illumination of Glossy Environments using Wavelets and Importance  
Author: Per H. Christensen Eric J. Stollnitz David H. Salesin Tony D. DeRose 
Date: November 3, 1994  
Address: Seattle, Washington 98195  
Affiliation: Department of Computer Science and Engineering Department of Applied Mathematics University of Washington  
Abstract: We show how importance-driven refinement and a wavelet basis can be combined to provide an efficient solution to the global illumination problem with glossy and diffuse reflections. Importance is used to focus the computation on the interactions having the greatest impact on the visible solution. Wavelets are used to provide an efficient representation of radiance, importance, and the transport operator. We discuss a number of choices that must be made when constructing an algorithm for a finite-element solution method for glossy global illumination. The main contributions of this paper are a four-dimensional wavelet representation for spatially- and angularly-varying radiance distributions (which allows for sparse representation and fast evaluation), the use of the standard wavelet decomposition of the transport operator, and the formulation of a type of importance suited for light transports using a finite element radiance representation. Our implementation supports curved surfaces and spatially-varying anisotropic BRDFs. We use a final gathering step to improve the visual quality of the solution. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Bradley K. Alpert. </author> <title> Sparse Representations of Smooth Linear Operators. </title> <type> PhD thesis, </type> <institution> Yale University, </institution> <year> 1990. </year>
Reference-contexts: Results by Beylkin et al. [4, 5], Alpert <ref> [1] </ref>, Gortler et al. [20], Hanrahan et al. [21] and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions. <p> The scaling functions spanning V 0 represent coarse variation, while the wavelets provide detail at increasing resolutions. 3.2 Choice of wavelet basis The simplest multiresolution basis is the Haar basis in one dimension. The space V j consists of piecewise-constant functions on <ref> [0; 1] </ref> with discontinuities at f0; 1=2 j ; 2=2 j ; :::; 1g. The space V j is spanned by piecewise-constant scaling functions j i (u), known as the Haar functions or "box" functions. The wavelet spaces W j are spanned by piecewise-constant wavelets j i (u). <p> The Haar basis has many advantages, including a single scaling function in V 0 , orthonormality (and therefore self-duality), compact support, and simple integration formulas. Flatlets, as an alternative, have more vanishing moments than the Haar basis, which increases the sparsity of a discretized smooth operator <ref> [1, 20] </ref>. But at the same time, flatlets have wider support and more costly integration formulas. Similarly, multiwavelets (which are constructed from higher-order polynomials) also require costly integration formulas. <p> As is common, we split the surfaces into patches such that the spatial variables on each patch can be parameterized on the unit square <ref> [0; 1] </ref> 2 ; see Figure 3. The domain of the radiance distribution on each path is then [0; 1] 2 fi H 2 , where H 2 is the unit hemisphere. By mapping H 2 onto [0; 1] 2 , we can use tensor products of one-dimensional basis functions for <p> As is common, we split the surfaces into patches such that the spatial variables on each patch can be parameterized on the unit square <ref> [0; 1] </ref> 2 ; see Figure 3. The domain of the radiance distribution on each path is then [0; 1] 2 fi H 2 , where H 2 is the unit hemisphere. By mapping H 2 onto [0; 1] 2 , we can use tensor products of one-dimensional basis functions for both angular and spatial variations. <p> the spatial variables on each patch can be parameterized on the unit square <ref> [0; 1] </ref> 2 ; see Figure 3. The domain of the radiance distribution on each path is then [0; 1] 2 fi H 2 , where H 2 is the unit hemisphere. By mapping H 2 onto [0; 1] 2 , we can use tensor products of one-dimensional basis functions for both angular and spatial variations. <p> After the projection, the distribution is still continuous, but has a first-derivative discontinuity along the diagonals of the unit square. 3.4 A four-dimensional wavelet basis We want to construct basis functions on the four-dimensional hypercube <ref> [0; 1] </ref> 4 using tensor products of univariate basis functions. There are two alternative methods, the so-called "standard" and "non-standard" constructions [4]. The standard construction forms a basis from all possible tensor products of univariate basis functions. <p> In the unnormalized case, functions are +1 where plus signs appear, 1 where minus signs appear, and 0 in gray regions. Let u = (u 1 ; u 2 ; u 3 ; u 4 ) denote a point in <ref> [0; 1] </ref> 4 , and let i = (i 1 ; i 2 ; i 3 ; i 4 ) denote a four-component multi-index of integers. <p> For example, the influence of wavelet j i (u s ) on wavelet j 0 j 0 j i i. The domain of radiance is position and direction, for example x and !, while the domain of our tensor-product basis functions is the four-dimensional hypercube <ref> [0; 1] </ref> 4 .
Reference: [2] <author> Larry Aupperle and Pat Hanrahan. </author> <title> A hierarchical illumination algorithm for surfaces with glossy reflection. </title> <booktitle> In Proceedings of SIGGRAPH 93, </booktitle> <pages> pages 155-162, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: The first choice is in the parameterization of the unknown light distribution. One possibility is to use radiance distributions, which are functions of surface position and direction [23, 34]. The alternative is to use two-point transport intensities, which are functions of two surface positions <ref> [2, 32] </ref>. We describe our motivation for using radiance distributions. A second area of choice in designing a glossy global illumination algorithm is that of basis functions. One can use a single fixed resolution or a hierarchy of multiresolution basis functions. <p> Immel et al. [23] and Sillion et al. [34] represent the light in the scene as radiance distributions, a function of two spatial and two angular variables on each surface patch. By contrast, Aupperle and Hanrahan <ref> [2] </ref>, Pattanaik and Bouatouch [28], and Schroder and Hanrahan [32] use a "two-point transport intensity," a function of four spatial variables, which represents the amount of light traveling from a point on a patch to a point on another.
Reference: [3] <author> Larry Aupperle and Pat Hanrahan. </author> <title> Importance and discrete three point transport. </title> <booktitle> In Proceedings of the Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 85-94, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: Incident directional importance can be defined as the fraction of radiance that reaches the eye. This type of importance was used by Pattanaik and Mudur [27] for a Monte Carlo solution method and Aupperle et al. <ref> [3] </ref> for a finite-element solution method. Incident directional importance is represented and transported like differential irradiance.
Reference: [4] <author> G. Beylkin, R. Coifman, and V. Rokhlin. </author> <title> Fast wavelet transforms and numerical algorithms I. </title> <journal> Communications on Pure and Applied Mathematics, </journal> <volume> 44 </volume> <pages> 141-183, </pages> <year> 1991. </year>
Reference-contexts: Results by Beylkin et al. <ref> [4, 5] </ref>, Alpert [1], Gortler et al. [20], Hanrahan et al. [21] and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions. <p> There are two alternative methods, the so-called "standard" and "non-standard" constructions <ref> [4] </ref>. The standard construction forms a basis from all possible tensor products of univariate basis functions. <p> By contrast, we use a wavelet representation, in which all basis functions are orthogonal to basis functions at other levels. 3.5 Transport matrix decomposition Just as there are two different tensor-product constructions for multidimensional bases, so are there two ways to decompose a matrix: the so-called "standard" and "non-standard" decompositions <ref> [4] </ref>. Gortler et al. [20] and Schroder and Hanrahan [32] use the non-standard decomposition of the transport matrix, in which each transport coefficient relates two basis functions at the same level of the hierarchy. These transports are followed by "pushing" and "pulling" operations [20]. <p> Here we describe how entries of e T are selected for computation. In many applications of wavelets in numerical analysis <ref> [4] </ref>, the goal is to obtain a sparse representation of a given matrix, thereby making repeated matrix-vector multiplications much faster.
Reference: [5] <author> G. Beylkin, R. R. Coifman, and V. Rokhlin. </author> <title> Wavelets in numerical analysis. </title> <editor> In Mary Beth Rushkai et al., editors, </editor> <booktitle> Wavelets and Their Applications, </booktitle> <pages> pages 181-210. </pages> <publisher> Jones and Bartlett, </publisher> <year> 1992. </year>
Reference-contexts: Results by Beylkin et al. <ref> [4, 5] </ref>, Alpert [1], Gortler et al. [20], Hanrahan et al. [21] and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions.
Reference: [6] <author> Per H. Christensen, David H. Salesin, and Tony D. DeRose. </author> <title> A continuous adjoint formulation for radiance transport. </title> <booktitle> In Proceedings of the Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 95-104, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: For this reason, we define a type of exitant directional importance (which we will call importance for short). For glossy reflection, this exitant type of importance is a continuous function of direction at any surface point. In addition, as preliminary results in Christensen et al. <ref> [6] </ref> showed, using an exitant formulation for importance also makes it simple to develop an importance-driven glossy global illumination algorithm, since it allows light and importance to be transported identically. 4.2 Importance transport Christensen et al. [6] showed that importance can be considered an exitant quantity like radiance and can be <p> In addition, as preliminary results in Christensen et al. <ref> [6] </ref> showed, using an exitant formulation for importance also makes it simple to develop an importance-driven glossy global illumination algorithm, since it allows light and importance to be transported identically. 4.2 Importance transport Christensen et al. [6] showed that importance can be considered an exitant quantity like radiance and can be transported like light, thus simplifying a finite element representation. That presentation was based on adjoints. Here we present a simpler and more intuitive (but equivalent) definition and proof.
Reference: [7] <author> Per H. Christensen, Eric J. Stollnitz, David H. Salesin, and Tony D. DeRose. </author> <title> Importance-driven wavelet radiance. </title> <type> Technical Report 94-01-05, </type> <institution> Department of Computer Science and Engineering, University of Washington, </institution> <month> January </month> <year> 1994. </year>
Reference-contexts: Discontinuous wavelet bases that have been used for radiosity include the Haar basis, multiwavelets, and flatlets [20]. A final gathering step [25, 30, 36] can be used to smooth out discontinuities in the basis and at patch boundaries. We have experimented with bounded-interval B-spline wavelets <ref> [7] </ref>, Daubechies wavelets, and the Haar basis. As a result of these experiments, we have chosen to implement our glossy global illumination algorithm using the Haar basis.
Reference: [8] <author> Per H. Christensen, Eric J. Stollnitz, David H. Salesin, and Tony D. DeRose. </author> <title> Wavelet radiance. </title> <booktitle> In Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 287-302, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: The implementation also supports curved surfaces and spatially-varying anisotropic bidirectional reflectance distribution functions (BRDFs). Both emission and reflection can be described by texture maps. A preliminary version of this paper was presented at the Eurographics Workshop on Rendering <ref> [8] </ref>. In this article, we give motivations for the choices we made, as well as comparisons with alternative approaches. New theoretical results here include a proof concerning exitant directional 2 importance, a different adaptive numerical integration method, and a more efficient final gathering step.
Reference: [9] <author> Charles K. Chui. </author> <title> An Introduction to Wavelets. </title> <publisher> Academic Press, </publisher> <address> Boston, </address> <year> 1992. </year>
Reference-contexts: Multiresolution analysis as formulated by Mallat [26] provides a convenient framework for studying multiresolution bases. More elaborate explanations of multiresolution bases are given by Chui <ref> [9] </ref>, Daubechies [14], and DeRose et al. [15].
Reference: [10] <author> Charles K. Chui and Ewald Quak. </author> <title> Wavelets on a bounded interval. Numerical Methods of Approximation Theory, </title> <booktitle> 9 </booktitle> <pages> 53-75, </pages> <year> 1992. </year>
Reference-contexts: We have found it more convenient to use wavelets defined on a bounded interval, such as flatlets, multiwavelets [20], or B-spline wavelets adapted to a bounded interval <ref> [10, 15] </ref>. * A single scaling function in V 0 . Some wavelet bases have more than one scaling function in space V 0 . <p> Among the wavelet bases that have bounded domains, there are both continuous and discontinuous choices. There are two families of bounded-interval continuous wavelets in the literature: Daubechies wavelets adapted to the bounded interval [11], and bounded-interval B-spline wavelets <ref> [10] </ref>. Having continuous basis functions on each patch is not sufficient to ensure a continuous solution; continuity must also be enforced across boundaries between adjacent patches, or the basis functions must be defined over complex shapes with arbitrary topology (for example, the floor in Figure 21).
Reference: [11] <author> A. Cohen, I. Daubechies, and J. C. Feauveau. </author> <title> Biorthogonal bases of compactly supported wavelets. </title> <journal> Communications on Pure and Applied Mathematics, </journal> <volume> 45 </volume> <pages> 485-500, </pages> <year> 1992. </year>
Reference-contexts: It is advantageous to use basis functions for which we can develop inexpensive numerical integration formulas. Among the wavelet bases that have bounded domains, there are both continuous and discontinuous choices. There are two families of bounded-interval continuous wavelets in the literature: Daubechies wavelets adapted to the bounded interval <ref> [11] </ref>, and bounded-interval B-spline wavelets [10].
Reference: [12] <author> Michael F. Cohen and John R. Wallace. </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press Professional, </publisher> <address> Cambridge, Massachusets, </address> <year> 1993. </year>
Reference-contexts: Radiance L is measured in [watt meter 2 steradian 1 ]. The equilibrium distribution of radiance satisfies the following light transport equation <ref> [12] </ref>: L (y; !) = L e (y; !) + x This equation states that the radiance L from a point y in direction ! is the sum of two terms: emitted radiance L e and radiance reflected from all other points x. <p> More complex effects such as a slide projector or sunlight through a stained-glass window could be modeled by combining spatial and angular variations in an emitter. 19 6.4 Data structure for basis function coefficients As in previous hierarchical radiosity algorithms <ref> [12] </ref>, the matrices e T, e L, e L e , e , and e e are never formed explicitly.
Reference: [13] <author> Robert L. Cook. </author> <title> Distributed ray tracing. </title> <booktitle> In Proceedings of SIGGRAPH 84, </booktitle> <pages> pages 137-146, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: The improvement brought about by the final gather can be seen by comparing Figures 21 (e) and (f ). The convergence improvement from final gather is described in Section 7.1. Another way of thinking about the final gathering step is in the context of distribution ray tracing <ref> [13] </ref>. When a ray cast from the eye intersects a surface in the scene, a group of reflected rays are traced from the intersection point to points on other surfaces in the scene.
Reference: [14] <author> Ingrid Daubechies. </author> <title> Ten Lectures on Wavelets. </title> <publisher> SIAM, </publisher> <year> 1992. </year>
Reference-contexts: Multiresolution analysis as formulated by Mallat [26] provides a convenient framework for studying multiresolution bases. More elaborate explanations of multiresolution bases are given by Chui [9], Daubechies <ref> [14] </ref>, and DeRose et al. [15]. There are two basic ingredients for a multiresolution analysis: an infinite chain of nested linear function spaces V 0 V 1 V 2 , and an inner product hf j gi defined on any pair of functions f; g 2 V j . <p> Multiresolution analysis is usually formulated for functions on the unbounded real line, while we wish to represent radiance distributions defined on bounded domains. Unbounded wavelets could be used on a bounded interval by artificially extending the functions of interest <ref> [14] </ref>, but it is unclear how radiance would be extended beyond the geometric extent of surface patches without introducing a number of artifacts.
Reference: [15] <author> Tony D. DeRose, David H. Salesin, and Eric J. Stollnitz. </author> <title> Wavelets for computer graphics: A primer. </title> <booktitle> In SIGGRAPH 94 Computational Representations of Geometry, Course Notes 23, </booktitle> <pages> pages 113-141, </pages> <month> July </month> <year> 1994. </year>
Reference-contexts: Multiresolution analysis as formulated by Mallat [26] provides a convenient framework for studying multiresolution bases. More elaborate explanations of multiresolution bases are given by Chui [9], Daubechies [14], and DeRose et al. <ref> [15] </ref>. There are two basic ingredients for a multiresolution analysis: an infinite chain of nested linear function spaces V 0 V 1 V 2 , and an inner product hf j gi defined on any pair of functions f; g 2 V j . <p> We have found it more convenient to use wavelets defined on a bounded interval, such as flatlets, multiwavelets [20], or B-spline wavelets adapted to a bounded interval <ref> [10, 15] </ref>. * A single scaling function in V 0 . Some wavelet bases have more than one scaling function in space V 0 .
Reference: [16] <author> Gerald Farin. </author> <title> Curves and Surfaces for Computer Aided Geometric Design: A Practical Guide. </title> <publisher> Academic Press, </publisher> <address> Boston, third edition, </address> <year> 1993. </year>
Reference-contexts: In our implementation, a patch can be either a Bezier surface or a quadrilateral. It would also be straightforward to add non-uniform rational B-spline surfaces <ref> [16] </ref>. In fact, the only requirements are that we need to be able to quickly compute a position, surface normal, and differential area associated with a given parametric point (u 1 ; u 2 ), and be able to determine the intersection of a ray with the surface.
Reference: [17] <author> Reid Gershbein, Peter Schroder, and Pat Hanrahan. </author> <title> Textures and radiosity: Controlling emission and reflection with texture maps. </title> <booktitle> In Proceedings of SIGGRAPH 94, </booktitle> <pages> pages 51-58, </pages> <month> July </month> <year> 1994. </year>
Reference-contexts: Multiresolution textures could be incorporated in our method by using a pyramid of texture averages instead of sampling. This approach would eliminate sampling errors from sampling the texture. Gershbein et al. <ref> [17] </ref> present an alternative approach, using wavelet decompositions of textures for radiosity. 6.3 Light sources By storing the wavelet decomposition of an image as the initial coefficients on a patch, we can model a light source that emits a spatially-varying radiance (such as a television screen).
Reference: [18] <author> Gene H. Golub and Charles F. Van Loan. </author> <title> Matrix Computations. </title> <publisher> The Johns Hopkins University Press, </publisher> <address> Baltimore, Maryland, </address> <note> second edition, 1989. 25 </note>
Reference-contexts: Likewise, radiance is used to refine the importance solution only in bright parts of the scene. The main loop iterates until visual convergence is achieved, that is, until further refinement does not significantly change the computed image. We use Gauss-Seidel iteration <ref> [18] </ref> to solve the approximate transport equations e L = e L e + e T e L and e = e e + e T e .
Reference: [19] <author> Cindy M. Goral, Kenneth E. Torrance, Donald P. Greenberg, and Bennett Battaile. </author> <title> Modeling the interaction of light between diffuse surfaces. </title> <booktitle> In Proceedings of SIGGRAPH 84, </booktitle> <pages> pages 213-222, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: When no confusion can arise, we suppress the arguments and simply write L = BL : In the original formulation of radiosity, piecewise-constant functions were used as a basis for spatial variation <ref> [19] </ref>. In subsequent work on radiosity, Heckbert [22], Zatz [40], and Troutman and Max [38] used orthogonal polynomials, and Gortler et al. [20] used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation.
Reference: [20] <author> Steven J. Gortler, Peter Schroder, Micheal F. Cohen, and Pat Hanrahan. </author> <title> Wavelet radiosity. </title> <booktitle> In Proceedings of SIGGRAPH 93, </booktitle> <pages> pages 221-230, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: One can use a single fixed resolution or a hierarchy of multiresolution basis functions. The benefits of a multiresolution representation are apparent from the radiosity algorithms presented by Hanrahan et al. [21] and Gortler et al. <ref> [20, 31] </ref>. <p> In subsequent work on radiosity, Heckbert [22], Zatz [40], and Troutman and Max [38] used orthogonal polynomials, and Gortler et al. <ref> [20] </ref> used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation. Immel et al. [23] used piecewise-constant basis functions for both spatial and angular variation. <p> Results by Beylkin et al. [4, 5], Alpert [1], Gortler et al. <ref> [20] </ref>, Hanrahan et al. [21] and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions. <p> We have found it more convenient to use wavelets defined on a bounded interval, such as flatlets, multiwavelets <ref> [20] </ref>, or B-spline wavelets adapted to a bounded interval [10, 15]. * A single scaling function in V 0 . Some wavelet bases have more than one scaling function in space V 0 . <p> Both approaches seem unnecessarily complicated compared to the alternative, a discontinuous basis. Discontinuous wavelet bases that have been used for radiosity include the Haar basis, multiwavelets, and flatlets <ref> [20] </ref>. A final gathering step [25, 30, 36] can be used to smooth out discontinuities in the basis and at patch boundaries. We have experimented with bounded-interval B-spline wavelets [7], Daubechies wavelets, and the Haar basis. <p> The Haar basis has many advantages, including a single scaling function in V 0 , orthonormality (and therefore self-duality), compact support, and simple integration formulas. Flatlets, as an alternative, have more vanishing moments than the Haar basis, which increases the sparsity of a discretized smooth operator <ref> [1, 20] </ref>. But at the same time, flatlets have wider support and more costly integration formulas. Similarly, multiwavelets (which are constructed from higher-order polynomials) also require costly integration formulas. <p> The duals to each of the scaling functions and wavelets follow from the univariate duals since duals of products are products of duals. For example, j j j j j Gortler et al. <ref> [20] </ref> use a scaling function representation at all levels for radiosity. Their approach therefore requires "pushing" and "pulling" to distribute transported radiance to other levels of the hierarchy before the next transport iteration. <p> Gortler et al. <ref> [20] </ref> and Schroder and Hanrahan [32] use the non-standard decomposition of the transport matrix, in which each transport coefficient relates two basis functions at the same level of the hierarchy. These transports are followed by "pushing" and "pulling" operations [20]. <p> Gortler et al. <ref> [20] </ref> and Schroder and Hanrahan [32] use the non-standard decomposition of the transport matrix, in which each transport coefficient relates two basis functions at the same level of the hierarchy. These transports are followed by "pushing" and "pulling" operations [20]. By contrast, we use the standard decomposition of the operator matrix, in which transport coefficients include interactions between basis functions at different levels of the hierarchy. <p> The algorithm computes a view-dependent solution to the radiance equation; that is, the solution is refined most in the areas that contribute most to the image. In some respects, our algorithm is similar to the approach described by Gortler et al. <ref> [20] </ref> for wavelet radiosity. However, there are a number of areas, in addition to the higher dimensionality, in which our algorithm differs significantly from this previous work. <p> Each transport coefficient is defined in Equation (4) as a six-dimensional integral, which we approximate using numerical integration. Four-dimensional numerical integration formulas for wavelet radiosity are discussed by Gortler et al. <ref> [20] </ref>. The transport coefficients T r s are computed as inner products. For example, the influence of wavelet j i (u s ) on wavelet j 0 j 0 j i i. <p> We approximate integrals such as (5) using slightly jittered uniform sampling of the integrand. More accurate rules such as Gauss-Legendre or Gauss-Kronrod quadrature could be employed instead <ref> [20, 29, 40] </ref>. 15 5.3 Refinement In the algorithm, the approximate transport matrix e T is progressively refined. Here we describe how entries of e T are selected for computation. <p> In this section we describe how our oracle reduces truncation error. Section 5.4 outlines a method for simultaneously reducing integration errors. The refinement oracle uses concepts from the brightness refinement criterion for hierarchical radiosity [21], the oracle used by Gortler et al. for wavelet radiosity <ref> [20] </ref>, and the importance-based refinement strategy used by Smits et al. [37]. The idea is to estimate the influence on the visible image that would result if a new transport coefficient were to be added to e T. <p> By contrast, the approach described by Gortler et al. <ref> [20] </ref> removes a link at one level of the hierarchy and replaces it with multiple links at a finer level of detail (because they use a scaling function representation at all levels of detail). The adaptive numerical integration takes place after new links have been set up.
Reference: [21] <author> Pat Hanrahan, David Salzman, and Larry Aupperle. </author> <title> A rapid hierarchical radiosity algorithm. </title> <booktitle> In Proceedings of SIGGRAPH 91, </booktitle> <pages> pages 197-206, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: A second area of choice in designing a glossy global illumination algorithm is that of basis functions. One can use a single fixed resolution or a hierarchy of multiresolution basis functions. The benefits of a multiresolution representation are apparent from the radiosity algorithms presented by Hanrahan et al. <ref> [21] </ref> and Gortler et al. [20, 31]. <p> Results by Beylkin et al. [4, 5], Alpert [1], Gortler et al. [20], Hanrahan et al. <ref> [21] </ref> and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions. Sillion et al. [34] used spherical harmonics as basis functions for the angular variation of radiance. <p> In this section we describe how our oracle reduces truncation error. Section 5.4 outlines a method for simultaneously reducing integration errors. The refinement oracle uses concepts from the brightness refinement criterion for hierarchical radiosity <ref> [21] </ref>, the oracle used by Gortler et al. for wavelet radiosity [20], and the importance-based refinement strategy used by Smits et al. [37]. The idea is to estimate the influence on the visible image that would result if a new transport coefficient were to be added to e T.
Reference: [22] <author> Paul S. Heckbert. </author> <title> Simulating Global Illumination Using Adaptive Meshing. </title> <type> PhD thesis, </type> <institution> Department of EECS, UC Berkeley, California, </institution> <month> June </month> <year> 1991. </year>
Reference-contexts: When no confusion can arise, we suppress the arguments and simply write L = BL : In the original formulation of radiosity, piecewise-constant functions were used as a basis for spatial variation [19]. In subsequent work on radiosity, Heckbert <ref> [22] </ref>, Zatz [40], and Troutman and Max [38] used orthogonal polynomials, and Gortler et al. [20] used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation.
Reference: [23] <author> David S. Immel, Michael F. Cohen, and Donald P. Greenberg. </author> <title> A radiosity method for non-diffuse environments. </title> <booktitle> In Proceedings of SIGGRAPH 86, </booktitle> <pages> pages 133-142, </pages> <month> August </month> <year> 1986. </year>
Reference-contexts: The result is an efficient algorithm, which we demonstrate using both simple and complex scenes. The first choice is in the parameterization of the unknown light distribution. One possibility is to use radiance distributions, which are functions of surface position and direction <ref> [23, 34] </ref>. The alternative is to use two-point transport intensities, which are functions of two surface positions [2, 32]. We describe our motivation for using radiance distributions. A second area of choice in designing a glossy global illumination algorithm is that of basis functions. <p> Immel et al. <ref> [23] </ref> and Sillion et al. [34] represent the light in the scene as radiance distributions, a function of two spatial and two angular variables on each surface patch. <p> In subsequent work on radiosity, Heckbert [22], Zatz [40], and Troutman and Max [38] used orthogonal polynomials, and Gortler et al. [20] used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation. Immel et al. <ref> [23] </ref> used piecewise-constant basis functions for both spatial and angular variation. Later, Sillion et al. [34] used spherical harmonics for the angular variation and piecewise-constant basis functions for the spatial variation. <p> Results by Beylkin et al. [4, 5], Alpert [1], Gortler et al. [20], Hanrahan et al. [21] and others indicate that significant performance gains can be achieved by using a multiresolution basis. By contrast, Immel et al. <ref> [23] </ref> used a single-resolution representation of radiance distributions using piecewise-constant basis functions. Sillion et al. [34] used spherical harmonics as basis functions for the angular variation of radiance. Their implementation also used a single-resolution representation: a fixed number of spherical harmonics interact at each light transport.
Reference: [24] <author> S. Jaffard and Ph. Lauren~cot. </author> <title> Orthonormal wavelets, analysis of operators, and applications to numerical analysis. </title> <editor> In Charles K. Chui, editor, </editor> <booktitle> Wavelets: A Tutorial in Theory and Applications, </booktitle> <pages> pages 543-602. </pages> <publisher> Academic Press, </publisher> <year> 1992. </year>
Reference-contexts: These results indicate that in practice the standard decomposition is often more sparse than the non-standard decomposition. Similar conclusions were reached by Schroder et al. [31] for radiosity, and by Jaffard and Lauren~cot <ref> [24] </ref> for more general operators. For these reasons, we use the standard decomposition of the operator matrix. 4 Importance for glossy scenes In order to maintain a tractably small problem for complex scenes, we use importance-driven refinement to compute a view-dependent solution.
Reference: [25] <author> Dani Lischinski, Filippo Tampieri, and Donald P. Greenberg. </author> <title> Combining hierarchical radiosity and discontinuity meshing. </title> <booktitle> In Proceedings of SIGGRAPH 93, </booktitle> <pages> pages 199-208, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: A complete solution to the global illumination problem should be both physically accurate and visually pleasing. However, certain good approximations may have artifacts that are very obvious to the human eye. We therefore use a final gathering step <ref> [25, 30, 36] </ref> to improve the visual quality of the solution. We have implemented an algorithm based on these choices. Adaptive numerical integration is used to compute accurate light transports where needed. The implementation also supports curved surfaces and spatially-varying anisotropic bidirectional reflectance distribution functions (BRDFs). <p> Both approaches seem unnecessarily complicated compared to the alternative, a discontinuous basis. Discontinuous wavelet bases that have been used for radiosity include the Haar basis, multiwavelets, and flatlets [20]. A final gathering step <ref> [25, 30, 36] </ref> can be used to smooth out discontinuities in the basis and at patch boundaries. We have experimented with bounded-interval B-spline wavelets [7], Daubechies wavelets, and the Haar basis. <p> Following the ideas that Reichert [30], Lischinski et al. <ref> [25] </ref>, and Smits [36] used for radiosity, we have implemented a final radiance gathering step. For each pixel in the final image, we perform a final gathering of light to the surface point that corresponds to the midpoint of the pixel. Call this point y.
Reference: [26] <author> Stephane Mallat. </author> <title> A theory for multiresolution signal decomposition: The wavelet representation. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> 11(7) </volume> <pages> 674-693, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: Multiresolution analysis as formulated by Mallat <ref> [26] </ref> provides a convenient framework for studying multiresolution bases. More elaborate explanations of multiresolution bases are given by Chui [9], Daubechies [14], and DeRose et al. [15].
Reference: [27] <author> S. N. Pattanaik and S. P. Mudur. </author> <title> Efficient potential equation solutions for global illumination computation. </title> <journal> Computers and Graphics, </journal> <volume> 17(4) </volume> <pages> 387-396, </pages> <year> 1993. </year>
Reference-contexts: The most direct generalization of this quantity to radiance is an incident type of directional importance. Incident directional importance can be defined as the fraction of radiance that reaches the eye. This type of importance was used by Pattanaik and Mudur <ref> [27] </ref> for a Monte Carlo solution method and Aupperle et al. [3] for a finite-element solution method. Incident directional importance is represented and transported like differential irradiance.
Reference: [28] <author> Sumanta N. Pattanaik and Kadi Bouatouch. </author> <title> Haar wavelet: A solution to global illumination with general surface properties. </title> <booktitle> In Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 273-286, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: Immel et al. [23] and Sillion et al. [34] represent the light in the scene as radiance distributions, a function of two spatial and two angular variables on each surface patch. By contrast, Aupperle and Hanrahan [2], Pattanaik and Bouatouch <ref> [28] </ref>, and Schroder and Hanrahan [32] use a "two-point transport intensity," a function of four spatial variables, which represents the amount of light traveling from a point on a patch to a point on another.
Reference: [29] <author> Robert Piessens, Elise de Doncker-Kapenga, Christoph W. Uberhuber, and David K. Kahaner. QUAD-PACK: </author> <title> A subroutine package for automatic integration. </title> <publisher> Springer-Verlag, </publisher> <address> Berlin, </address> <year> 1983. </year>
Reference-contexts: We approximate integrals such as (5) using slightly jittered uniform sampling of the integrand. More accurate rules such as Gauss-Legendre or Gauss-Kronrod quadrature could be employed instead <ref> [20, 29, 40] </ref>. 15 5.3 Refinement In the algorithm, the approximate transport matrix e T is progressively refined. Here we describe how entries of e T are selected for computation.
Reference: [30] <author> Mark C. Reichert. </author> <title> A Two-Pass Radiosity Method Driven by Lights and Viewer Position. </title> <type> Master's thesis, </type> <institution> Program of Computer Graphics, Cornell University, </institution> <address> Ithaca, New York, </address> <month> January </month> <year> 1992. </year>
Reference-contexts: A complete solution to the global illumination problem should be both physically accurate and visually pleasing. However, certain good approximations may have artifacts that are very obvious to the human eye. We therefore use a final gathering step <ref> [25, 30, 36] </ref> to improve the visual quality of the solution. We have implemented an algorithm based on these choices. Adaptive numerical integration is used to compute accurate light transports where needed. The implementation also supports curved surfaces and spatially-varying anisotropic bidirectional reflectance distribution functions (BRDFs). <p> Both approaches seem unnecessarily complicated compared to the alternative, a discontinuous basis. Discontinuous wavelet bases that have been used for radiosity include the Haar basis, multiwavelets, and flatlets [20]. A final gathering step <ref> [25, 30, 36] </ref> can be used to smooth out discontinuities in the basis and at patch boundaries. We have experimented with bounded-interval B-spline wavelets [7], Daubechies wavelets, and the Haar basis. <p> Following the ideas that Reichert <ref> [30] </ref>, Lischinski et al. [25], and Smits [36] used for radiosity, we have implemented a final radiance gathering step. For each pixel in the final image, we perform a final gathering of light to the surface point that corresponds to the midpoint of the pixel. Call this point y.
Reference: [31] <author> Peter Schroder, Steven J. Gortler, Micheal F. Cohen, and Pat Hanrahan. </author> <title> Wavelet projections for radiosity. </title> <booktitle> In Proceedings of the Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 95-104, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: One can use a single fixed resolution or a hierarchy of multiresolution basis functions. The benefits of a multiresolution representation are apparent from the radiosity algorithms presented by Hanrahan et al. [21] and Gortler et al. <ref> [20, 31] </ref>. <p> These results indicate that in practice the standard decomposition is often more sparse than the non-standard decomposition. Similar conclusions were reached by Schroder et al. <ref> [31] </ref> for radiosity, and by Jaffard and Lauren~cot [24] for more general operators. For these reasons, we use the standard decomposition of the operator matrix. 4 Importance for glossy scenes In order to maintain a tractably small problem for complex scenes, we use importance-driven refinement to compute a view-dependent solution.
Reference: [32] <author> Peter Schroder and Pat Hanrahan. </author> <title> Wavelet methods for radiance computations. </title> <booktitle> In Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 303-311, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: The first choice is in the parameterization of the unknown light distribution. One possibility is to use radiance distributions, which are functions of surface position and direction [23, 34]. The alternative is to use two-point transport intensities, which are functions of two surface positions <ref> [2, 32] </ref>. We describe our motivation for using radiance distributions. A second area of choice in designing a glossy global illumination algorithm is that of basis functions. One can use a single fixed resolution or a hierarchy of multiresolution basis functions. <p> Immel et al. [23] and Sillion et al. [34] represent the light in the scene as radiance distributions, a function of two spatial and two angular variables on each surface patch. By contrast, Aupperle and Hanrahan [2], Pattanaik and Bouatouch [28], and Schroder and Hanrahan <ref> [32] </ref> use a "two-point transport intensity," a function of four spatial variables, which represents the amount of light traveling from a point on a patch to a point on another. <p> There are many alternatives to the Haar basis, each with advantages and disadvantages. Schroder and Hanrahan <ref> [32] </ref> have presented a comparison of wavelet bases for radiance, in which they exam 7 ined rates of convergence, integration expense and accuracy, and the amount of work required to obtain a solution of a given accuracy. <p> Gortler et al. [20] and Schroder and Hanrahan <ref> [32] </ref> use the non-standard decomposition of the transport matrix, in which each transport coefficient relates two basis functions at the same level of the hierarchy. These transports are followed by "pushing" and "pulling" operations [20].
Reference: [33] <author> Fran~cois Sillion. </author> <title> Clustering and volume scattering for hierarchical radiosity calculations. </title> <booktitle> In Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 105-117, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: Therefore, the initial, very rough, solution of the light transport equation requires O (n 2 ) interactions between radiance distributions on patches, as opposed to O (n 3 ) interactions for matching two-point transport intensities. 1 1 With a clustering technique to group patches (similar to Sillion <ref> [33] </ref> and Smits et al. [35] for purely diffuse reflection), the initial number of clusters could potentially be very small even in a complex scene, and the reduction to O (n 2 ) might not make much difference. <p> Surfaces that transmit light in addition to reflecting it could be incorporated into our algorithm by using wavelet basis functions defined for the entire sphere of directions. It may also be possible to extend the clustering algorithms developed for radiosity by Sillion <ref> [33] </ref> and Smits et al. [35] to handle glossy reflections, for example by storing radiance distributions representing radiance from entire clusters of patches. 24 Acknowledgements This work was supported by an NSF Young Investigator award (CCR-9357790), an NSF Graduate Research Fellowship, and the University of Washington Graduate Research Fund (award 75-1721).
Reference: [34] <author> Fran~cois X. Sillion, James R. Arvo, Stephen H. Westin, and Donald P. Greenberg. </author> <title> A global illumination solution for general reflectance distributions. </title> <booktitle> In Proceedings of SIGGRAPH 91, </booktitle> <pages> pages 187-196, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: The result is an efficient algorithm, which we demonstrate using both simple and complex scenes. The first choice is in the parameterization of the unknown light distribution. One possibility is to use radiance distributions, which are functions of surface position and direction <ref> [23, 34] </ref>. The alternative is to use two-point transport intensities, which are functions of two surface positions [2, 32]. We describe our motivation for using radiance distributions. A second area of choice in designing a glossy global illumination algorithm is that of basis functions. <p> Immel et al. [23] and Sillion et al. <ref> [34] </ref> represent the light in the scene as radiance distributions, a function of two spatial and two angular variables on each surface patch. <p> In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation. Immel et al. [23] used piecewise-constant basis functions for both spatial and angular variation. Later, Sillion et al. <ref> [34] </ref> used spherical harmonics for the angular variation and piecewise-constant basis functions for the spatial variation. In Section 3 we motivate and introduce our choice of basis, a hierarchical wavelet basis for both spatial and angular variation. <p> By contrast, Immel et al. [23] used a single-resolution representation of radiance distributions using piecewise-constant basis functions. Sillion et al. <ref> [34] </ref> used spherical harmonics as basis functions for the angular variation of radiance. Their implementation also used a single-resolution representation: a fixed number of spherical harmonics interact at each light transport. <p> There are many possible extensions of the present algorithm. Wavelet bases, like all finite-element bases, are not suited to the representation of ideal specular reflections. Instead, a ray tracing step for ideal specular reflection could be incorporated in the same fashion as in Sillion et al. <ref> [34] </ref>. Surfaces that transmit light in addition to reflecting it could be incorporated into our algorithm by using wavelet basis functions defined for the entire sphere of directions.
Reference: [35] <author> Brian Smits, James Arvo, and Donald Greenberg. </author> <title> A clustering algorithm for radiosity in complex environments. </title> <booktitle> In Proceedings of SIGGRAPH 94, </booktitle> <pages> pages 435-442, </pages> <month> August </month> <year> 1994. </year>
Reference-contexts: initial, very rough, solution of the light transport equation requires O (n 2 ) interactions between radiance distributions on patches, as opposed to O (n 3 ) interactions for matching two-point transport intensities. 1 1 With a clustering technique to group patches (similar to Sillion [33] and Smits et al. <ref> [35] </ref> for purely diffuse reflection), the initial number of clusters could potentially be very small even in a complex scene, and the reduction to O (n 2 ) might not make much difference. <p> Surfaces that transmit light in addition to reflecting it could be incorporated into our algorithm by using wavelet basis functions defined for the entire sphere of directions. It may also be possible to extend the clustering algorithms developed for radiosity by Sillion [33] and Smits et al. <ref> [35] </ref> to handle glossy reflections, for example by storing radiance distributions representing radiance from entire clusters of patches. 24 Acknowledgements This work was supported by an NSF Young Investigator award (CCR-9357790), an NSF Graduate Research Fellowship, and the University of Washington Graduate Research Fund (award 75-1721).
Reference: [36] <author> Brian E. Smits. </author> <title> Efficient Hierarchical Radiosity in Complex Environments. </title> <type> PhD thesis, </type> <institution> Department of Computer Science, Cornell University, </institution> <month> August </month> <year> 1994. </year> <type> TR 94-1443. </type>
Reference-contexts: A complete solution to the global illumination problem should be both physically accurate and visually pleasing. However, certain good approximations may have artifacts that are very obvious to the human eye. We therefore use a final gathering step <ref> [25, 30, 36] </ref> to improve the visual quality of the solution. We have implemented an algorithm based on these choices. Adaptive numerical integration is used to compute accurate light transports where needed. The implementation also supports curved surfaces and spatially-varying anisotropic bidirectional reflectance distribution functions (BRDFs). <p> Both approaches seem unnecessarily complicated compared to the alternative, a discontinuous basis. Discontinuous wavelet bases that have been used for radiosity include the Haar basis, multiwavelets, and flatlets [20]. A final gathering step <ref> [25, 30, 36] </ref> can be used to smooth out discontinuities in the basis and at patch boundaries. We have experimented with bounded-interval B-spline wavelets [7], Daubechies wavelets, and the Haar basis. <p> Following the ideas that Reichert [30], Lischinski et al. [25], and Smits <ref> [36] </ref> used for radiosity, we have implemented a final radiance gathering step. For each pixel in the final image, we perform a final gathering of light to the surface point that corresponds to the midpoint of the pixel. Call this point y. We have tried three different final gathering methods.
Reference: [37] <author> Brian E. Smits, James R. Arvo, and David H. Salesin. </author> <title> An importance-driven radiosity algorithm. </title> <booktitle> In Proceedings of SIGGRAPH 92, </booktitle> <pages> pages 273-282, </pages> <month> July </month> <year> 1992. </year> <month> 26 </month>
Reference-contexts: As a third area of choice, one must decide whether or not a view-independent solution is necessary. A view-dependent solution can be computed more efficiently using importance, as shown by Smits et al. <ref> [37] </ref> for radiosity. Assuming we are interested in accelerating our solution procedure using importance, we must choose between two types of importance. We introduce a type of importance whose angular distributions are in general continuous functions, and therefore can be efficiently represented with finite elements such as wavelets. <p> In this section, we introduce a type of importance that satisfies the same equilibrium equation as radiance. Radiance and importance can be used together to compute a solution, as described in Section 5. Smits et al. <ref> [37] </ref> showed that diffuse importance gives a substantial speed-up for a complex diffuse scene. <p> For glossy reflections, the gain in speed is even greater, due to the directionality of radiance and importance: a directional interaction is refined only if the radiance in that direction is sufficiently large, inaccurate, and important. 4.1 Incident and exitant directional importance Smits et al. <ref> [37] </ref> define the "importance" at a point to be the fraction of light leaving that point that reaches the eye. <p> The form of diffuse importance defined by Smits et al. <ref> [37] </ref> for radiosity is an incident quantity similar to irradiance. For radiosity, storing and transporting incident importance is equivalent (up to a constant) to storing and transporting exitant importance, since the radiosity leaving a point is proportional to the irradiance received at that point. <p> Section 5.4 outlines a method for simultaneously reducing integration errors. The refinement oracle uses concepts from the brightness refinement criterion for hierarchical radiosity [21], the oracle used by Gortler et al. for wavelet radiosity [20], and the importance-based refinement strategy used by Smits et al. <ref> [37] </ref>. The idea is to estimate the influence on the visible image that would result if a new transport coefficient were to be added to e T.
Reference: [38] <author> Roy Troutman and Nelson L. Max. </author> <title> Radiosity algorithms using higher order finite elements. </title> <booktitle> In Proceed--ings of SIGGRAPH 93, </booktitle> <pages> pages 209-212, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: When no confusion can arise, we suppress the arguments and simply write L = BL : In the original formulation of radiosity, piecewise-constant functions were used as a basis for spatial variation [19]. In subsequent work on radiosity, Heckbert [22], Zatz [40], and Troutman and Max <ref> [38] </ref> used orthogonal polynomials, and Gortler et al. [20] used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation. Immel et al. [23] used piecewise-constant basis functions for both spatial and angular variation.
Reference: [39] <author> Gregory J. Ward. </author> <title> Measuring and modeling anisotropic reflection. </title> <booktitle> In Proceedings of SIGGRAPH 92, </booktitle> <pages> pages 265-273, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: The images in Figure 18 show a teapot consisting of 28 Bezier patches. 6.2 Reflection models and texture maps We use the Ward isotropic and anisotropic reflection models <ref> [39] </ref> since they are physically valid and fast to evaluate. Examples of this reflection model can be seen in Figure 18. In addition to angular variation in reflectance, we use spatially varying reflectances to simulate details of the materials in the scene. <p> The geometry is shown in Figure 12. Patch 1 is emitting radiance L e , and this light is reflected by patch 2 according to Ward's glossy reflection model <ref> [39] </ref> with ff = 0:2. This glossy reflection results in a directional radiance distribution on patch 2. <p> The scene consists of 152 patches, including 28 Bezier patches, and has 12,603 mutually visible pairs of patches. The teapot's reflectance function uses Ward's reflection model <ref> [39] </ref>, and is anisotropic with specularities ff u = 0:2 and ff v = 0:5, specular reflectivity s = (0:1; 0:1; 0:1) and diffuse reflectivity d = (0:2; 0:15; 0). The illumination consists of 24 "spotlights," patches that emit directional radiance.
Reference: [40] <author> Harold R. Zatz. </author> <title> Galerkin radiosity. </title> <booktitle> In Proceedings of SIGGRAPH 93, </booktitle> <pages> pages 213-220, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: When no confusion can arise, we suppress the arguments and simply write L = BL : In the original formulation of radiosity, piecewise-constant functions were used as a basis for spatial variation [19]. In subsequent work on radiosity, Heckbert [22], Zatz <ref> [40] </ref>, and Troutman and Max [38] used orthogonal polynomials, and Gortler et al. [20] used wavelets. In the more general context of radiance, the distribution of light leaving a patch has both spatial and angular variation. Immel et al. [23] used piecewise-constant basis functions for both spatial and angular variation. <p> We approximate integrals such as (5) using slightly jittered uniform sampling of the integrand. More accurate rules such as Gauss-Legendre or Gauss-Kronrod quadrature could be employed instead <ref> [20, 29, 40] </ref>. 15 5.3 Refinement In the algorithm, the approximate transport matrix e T is progressively refined. Here we describe how entries of e T are selected for computation.
References-found: 40

