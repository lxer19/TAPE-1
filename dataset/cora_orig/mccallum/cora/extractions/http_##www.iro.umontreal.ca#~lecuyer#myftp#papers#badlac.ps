URL: http://www.iro.umontreal.ca/~lecuyer/myftp/papers/badlac.ps
Refering-URL: http://www.iro.umontreal.ca/~lecuyer/papers.html
Root-URL: http://www.iro.umontreal.ca
Title: Bad Lattice Structures for Vectors of Non-Successive Values Produced by Some Linear Recurrences  
Author: PIERRE L'ECUYER P. L'Ecuyer, 
Keyword: Additional Key Words and Phrases: Random Number Generation; Linear Con-gruential Generators; Lattice Structure; Spectral Test  
Address: Montreal  Montreal, C.P. 6128, Succ. Centre-Ville, Montreal, H3C 3J7, Canada;  
Affiliation: Universite de  Departement d'Informatique et de Recherche Operationnelle (IRO), Universite de  
Note: Version:  To appear in: INFORMS J. on Computing,  Author's  
Email: Address:  e-mail: lecuyer@iro.umontreal.ca  
Date: December 16, 1996  9 (1), Winter 1997  
Abstract: Usually, the t-dimensional spectral test for linear congruential generators examines the lattice structure of all the points formed by taking t successive values in the sequence. In this paper, we consider the case where the t values taken are not successive, but separated by lags that are chosen a priori. For certain classes of linear congruential and multiple recursive generators, and for certain choices of the lags, we give lower bounds on the distance between hyperplanes. In some cases, those lower bounds are quite large, even in dimensions as small as t = 3. We give illustrations with specific classes of generators that have been proposed in the literature, and discuss the possible implications. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> R. Couture and P. L'Ecuyer, </author> <year> 1994. </year> <title> On the Lattice Structure of Certain Linear Congru-ential Sequences Related to AWC/SWB Generators, </title> <booktitle> Mathematics of Computation 62, </booktitle> <pages> 798-808. </pages>
Reference-contexts: Under appropriate conditions on m, k, and the a i (see [5, 6, 8, 9]), the sequence fu n ; n 0g could be a reasonably good imitation of a sequence of independent and identically distributed (i.i.d.) uniform random variables over the interval <ref> [0; 1] </ref>. <p> The lattice structure for most of the examples 2 we consider here was already analyzed in previous papers <ref> [1, 2, 9, 17] </ref>, but only for the case of successive indices. When considering lacunary indices, we obtain bad stuctures in much smaller dimensions. It is not clear how those properties really affect the results of typical simulations in practice. <p> The result follows. 2 A class of add-with-carry and subtract-with-borrow (AWC/SWB) generators has been proposed by Marsaglia and Zaman [13] and studied further in <ref> [1, 17] </ref>. These generators turn out to be practically equivalent to LCGs with multiplier a and modulus m = a k a r 1. More precisely, the absolute difference between the u n produced by the approximating LCG and that produced by the AWC/SWB generator is bounded by 1=a. <p> But it follows from the proposition that the three-dimensional vectors (u n ; u n+r ; u n+k ) produced by those LCGs lie in parallel planes that are at least 1= p 3 apart, as was the case in Example 2. It was already shown in <ref> [1] </ref> that the t-dimensional vectors of successive values produced by the approximating LCG lie in parallel hyperplanes which are exactly 1= p 3 apart for k t t fl for some t fl (and 1= p 2 apart thereafter). <p> which is equivalent to a LCG with modulus m 1 = a k a r 1 with, say, a LCG with modulus m 2 , by adding or subtracting their states, then the combined generator is often well approximated by a LCG with modulus m = m 1 m 2 <ref> [1] </ref>. 6 Typically, the bound given by Proposition 3 is not very useful in that case, but other results proved in [1] can be used to obtain a short vector in the dual lattice, as illustrated by the next example. <p> modulus m 2 , by adding or subtracting their states, then the combined generator is often well approximated by a LCG with modulus m = m 1 m 2 <ref> [1] </ref>. 6 Typically, the bound given by Proposition 3 is not very useful in that case, but other results proved in [1] can be used to obtain a short vector in the dual lattice, as illustrated by the next example. <p> The combination is defined by subtracting the state of the LCG from that of the SWB, modulo m 2 = 2 32 , and then dividing by 2 32 . As shown in <ref> [1] </ref>, that generator can be approximated by a LCG with modulus m = m 1 m 2 = 2 32 (a 43 a 22 + 1) and multiplier a such that a mod m 1 = a 1 and a mod m 2 = a 2 = 1, with a difference <p> From the results of Table 1 in <ref> [1] </ref>, one can also easily deduce that in dimension 45, a shortest vector is W = e 44 (45) e 23 (45) +e 1 (45) (e 45 (45) e 24 (45) +e 2 (45) ).
Reference: [2] <author> R. Couture and P. L'Ecuyer, </author> <year> 1996. </year> <title> Orbits and Lattices for Linear Random Number Generators with Composite Moduli, </title> <booktitle> Mathematics of Computation 65, </booktitle> <pages> 189-201. </pages>
Reference-contexts: The lattice structure for most of the examples 2 we consider here was already analyzed in previous papers <ref> [1, 2, 9, 17] </ref>, but only for the case of successive indices. When considering lacunary indices, we obtain bad stuctures in much smaller dimensions. It is not clear how those properties really affect the results of typical simulations in practice. <p> Other related techniques developed in <ref> [2] </ref> can also be used to find a short vector in the dual lattice associated with certain classes of combined LCGs; our last example gives an illustration of how this may sometimes provide us with a bad set I of lacunary indices. Example 4. <p> It is based on the recurrences y n = (y n97 y n33 ) mod 2 24 x n = (y n z n ) mod 2 24 ; and the output at step n is u n = 2 24 x n . It can be verified <ref> [2] </ref> that this generator can be closely approximated (one has j~x n x n j 3 fi 2 24 ) by the MRG based on the recurrence: ~x n = (187649956511744~x n1 + 187649956511743~x n33 The latter MRG has main subcycles of length 2 144 (much less than the size of <p> It turns out that the lattice generated by each of the main subcycles is a strict sublattice of that generated by the full state space. Those sublattices are analyzed in <ref> [2] </ref>. In particular, in dimension 99, the following vector belongs to the dual basis: W = e 99 (99) e 98 (99) + e 66 (99) e 65 (99) e 2 (99) + e 1 (99) .
Reference: [3] <author> A. M. Ferrenberg, D. P. Landau, and Y. J. Wong, </author> <year> 1992. </year> <title> Monte Carlo Simulations: Hidden Errors from "Good" Random Number Generators, </title> <journal> Physical Review Letters 69 , 23, </journal> <pages> 3382-3384. </pages>
Reference-contexts: But that could happen, and if it does, disaster will strike. There are also classes of applications dealing specifically with random points in high dimensional space, and where those bad structures could have a dramatic effect. Such applications arise, for example, in computational physics <ref> [3] </ref>, or in statistics, when estimating complicated (perhaps multidimensional) distributions or expectations by simulation [7]. 1.
Reference: [4] <author> F. James, </author> <year> 1990. </year> <title> A review of pseudorandom number generators, </title> <journal> Computer Physics Communications 60 , 329-344. </journal>
Reference-contexts: Combined with our Proposition 3, this implies that d t (I) = 1= p whenever I contains f0; r; kg and i t t fl . Example 3. One SWB generator recommended in <ref> [4] </ref> has k = 24, r = 10, a = 2 24 , and m = a 24 a 10 + 1. <p> Then, d 6 (I) 1= p 6 0:408. It is relatively easy to design empirical statistical tests in 6 dimensions that will detect that structure. Example 5. Marsaglia, Zaman, and Tsang [15] proposed a combined generator now widely available and known under the name of RANMAR. James <ref> [4] </ref> gives a FORTRAN implemen tation. It is based on the recurrences y n = (y n97 y n33 ) mod 2 24 x n = (y n z n ) mod 2 24 ; and the output at step n is u n = 2 24 x n .
Reference: [5] <author> D. E. Knuth, </author> <year> 1981. </year> <booktitle> The Art of Computer Programming : Seminumerical Algorithms, </booktitle> <volume> vol. 2, </volume> <booktitle> second edition. </booktitle> <publisher> Addison-Wesley, </publisher> <address> Reading, Mass. </address>
Reference-contexts: Under appropriate conditions on m, k, and the a i (see <ref> [5, 6, 8, 9] </ref>), the sequence fu n ; n 0g could be a reasonably good imitation of a sequence of independent and identically distributed (i.i.d.) uniform random variables over the interval [0; 1]. <p> Traditionally, computing d t (I) has been called the spectral test, with the set I usually comprised of successive indices: i j = j for all j; this is the classical spectral test <ref> [5] </ref>. The construction (2) is more general, in the sense that the vectors of T t (I) are constructed with values that can be some distance apart in the sequence. For that reason, we call I the set of lacunary indices. <p> (I) and the distance d t (I) is equal to one over the length of the shortest non-zero vector in L fl t (I), 1 = min kW k j W = i=1 t X jz i j &gt; 0 ; (3) where k k denotes the Euclidean norm (see <ref> [5] </ref>). 2. Lower Bounds on d t (I ) for MRGs In this section, we shall assume that t k + 1 and that the set I of lacunary indices satisfies 0 = i 1 &lt; i 2 &lt; &lt; i t = k. <p> This yields extremely fast generators. For example, Mitchell and Moore devised in 1958 a generator based on the recurrence x n = (x n24 + x n55 ) mod 2 e : This generator is proposed and described in Knuth <ref> [5, pp.26-27] </ref>. <p> This highly unfavorable structure can be detected by simple empirical statistical tests such as the serial test in three dimensions <ref> [5, p.60] </ref>, provided that we choose the appropriate (non-successive) dimensions. <p> n98 + x n97 + x n34 x n33 + x n1 + 7654321) mod 2 24 : It is well known that the structure of the lattice L t (I) associated with such a recurrence does not depend on the constant term 7654321; that constant just shifts the lattice <ref> [5] </ref>. Therefore, it would then follow from Proposition 2 that d t (I) 1= p 6 for (once again) t = 6 and I = f0; 1; 64; 65; 97; 98g. Acknowledgments This work has been supported by NSERC-Canada grant # ODGP0110050 and FCAR-Quebec grant # 93ER1654.
Reference: [6] <author> P. L'Ecuyer, </author> <year> 1990. </year> <title> Random Numbers for Simulation, </title> <journal> Communications of the ACM 33, </journal> <pages> 10 , 85-97. </pages>
Reference-contexts: Under appropriate conditions on m, k, and the a i (see <ref> [5, 6, 8, 9] </ref>), the sequence fu n ; n 0g could be a reasonably good imitation of a sequence of independent and identically distributed (i.i.d.) uniform random variables over the interval [0; 1]. <p> For example, if we assume that each ja i j is smaller than p m, as is sometimes suggested to facilitate the implementation <ref> [6] </ref>, then d 3 (I) (1 + 2 (m 1)) 1=2 &gt; 1= 2m: (6) Example 1. Let m = 2 31 1. Suppose that the recurrence has only two non-zero coefficients a r and a k , with k 3, and let t = 3.
Reference: [7] <author> P. L'Ecuyer, </author> <year> 1992. </year> <title> Testing Random Number Generators, </title> <booktitle> Proceedings of the 1992 Winter Simulation Conference (Arlington, </booktitle> <address> Virginia), </address> <publisher> IEEE Press, </publisher> <address> Pistacaway, N.J., </address> <pages> 305-313. </pages>
Reference-contexts: There are also classes of applications dealing specifically with random points in high dimensional space, and where those bad structures could have a dramatic effect. Such applications arise, for example, in computational physics [3], or in statistics, when estimating complicated (perhaps multidimensional) distributions or expectations by simulation <ref> [7] </ref>. 1.
Reference: [8] <author> P. L'Ecuyer, </author> <year> 1994. </year> <title> Uniform Random Number Generation, </title> <note> Annals of Operations Research 53 , 77-120. </note>
Reference-contexts: Under appropriate conditions on m, k, and the a i (see <ref> [5, 6, 8, 9] </ref>), the sequence fu n ; n 0g could be a reasonably good imitation of a sequence of independent and identically distributed (i.i.d.) uniform random variables over the interval [0; 1].
Reference: [9] <author> P. L'Ecuyer, F. Blouin, and R. Couture, </author> <year> 1993. </year> <title> A Search for Good Multiple Recursive Generators, </title> <booktitle> ACM Transactions on Modeling and Computer Simulation 3 , 87-98. </booktitle>
Reference-contexts: Under appropriate conditions on m, k, and the a i (see <ref> [5, 6, 8, 9] </ref>), the sequence fu n ; n 0g could be a reasonably good imitation of a sequence of independent and identically distributed (i.i.d.) uniform random variables over the interval [0; 1]. <p> In Section 3, we look at special cases, namely the case where the number of non-zero coefficients in (1) is less than k, and the case where those coefficients are small. We derive lower bounds on d t (I). These bounds explain in particular some empirical results obtained in <ref> [9] </ref> and imply further limitations for the class of generators proposed there. Specific numerical examples are given. <p> The lattice structure for most of the examples 2 we consider here was already analyzed in previous papers <ref> [1, 2, 9, 17] </ref>, but only for the case of successive indices. When considering lacunary indices, we obtain bad stuctures in much smaller dimensions. It is not clear how those properties really affect the results of typical simulations in practice. <p> If i 62 I implies a ki+1 = 0, then d t (I) 1 + i=1 i : As a further special case, suppose that the recurrence has only two non-zero coefficients, say a r and a k , as suggested in <ref> [9] </ref> (i.e., its characteristic polynomial is a trinomial of the form f (x) = x k a r x kr a k ). Let t = 3. If k 3 and 0 = i 1 &lt; i 2 &lt; k, then d 3 (I) = 1=m. <p> However, if ja k j and ja r j are less than p m, then (6) gives d 3 (I) 1:5259 fi 10 5 . That explains the small values of d t and q t obtained in <ref> [9] </ref> for t &gt; k when the coefficients satisfied those conditions. Example 2.
Reference: [10] <author> P. L'Ecuyer and R. Couture, </author> <year> 1997. </year> <title> An Implementation of the Lattice and Spectral Tests for Multiple Recursive Linear Random Number Generators, </title> <journal> INFORMS Journal on Computing, </journal> <note> to appear. 8 </note>
Reference-contexts: These k + t vectors generate L t (I) and one can construct a basis fV 1 ; : : : ; V t g of L t (I) by constructing t linearly independent vectors from the linear combinations of elements of that set (see <ref> [10] </ref> for further details).
Reference: [11] <author> P. L'Ecuyer and S. Tezuka, </author> <year> 1991. </year> <title> Structural Properties for Two Classes of Combined Random Number Generators. </title> <note> Mathematics of Computation 57 , 735-746. </note>
Reference: [12] <author> G. Marsaglia, </author> <year> 1985. </year> <title> A Current View of Random Number Generation, </title> <booktitle> Computer Science and Statistics, Proceedings of the Sixteenth Symposium on the Interface, </booktitle> <publisher> Elsevier Science Publ. (North-Holland), </publisher> <pages> 3-10. </pages>
Reference-contexts: Another example is the generator based on x n = (x n5 + x n17 ) mod 2 24 ; suggested by Marsaglia <ref> [12] </ref>. It follows from our results that these generators have highly unfavorable properties and should be avoided. 3.
Reference: [13] <author> G. Marsaglia and A. Zaman, </author> <year> 1991. </year> <title> A New Class of Random Number Generators, </title> <journal> The Annals of Applied Probability 1 , 462-480. </journal>
Reference-contexts: Consider the vector W = W 1 + j=2 This vector belongs to the dual lattice and its square length is kW k 2 = P t i j . The result follows. 2 A class of add-with-carry and subtract-with-borrow (AWC/SWB) generators has been proposed by Marsaglia and Zaman <ref> [13] </ref> and studied further in [1, 17]. These generators turn out to be practically equivalent to LCGs with multiplier a and modulus m = a k a r 1.
Reference: [14] <author> G. Marsaglia, B. Narasimhan, and A. Zaman, </author> <year> 1990. </year> <title> A Random Number Generator for PC's, </title> <journal> Computer Physics Communications 60 , 345-349. </journal>
Reference-contexts: Such serious structural limitations will obviously show up in empirical statistical tests when the parameters of the tests are chosen accordingly. Finally, we examine two combined generators proposed in <ref> [14, 15] </ref> and which can be approximated by linear congruential generators for which d 6 (I) 1= p 6 0:408 for certain sets I. <p> Example 4. Marsaglia, Narasimhan, and Zaman <ref> [14] </ref> have proposed a combined generator whose first component is the SWB with k = 43, r = 22, a = a 1 = 2 32 5, and m = m 1 = a 43 1 + 1, whereas the second component is a LCG based on the recurrence z n+1
Reference: [15] <author> G. Marsaglia, A. Zaman, and W. W. Tsang, </author> <year> 1990. </year> <title> Towards a Universal Random Number Generator, </title> <journal> Stat. and Prob. </journal> <note> Letters 8 , 35-39. </note>
Reference-contexts: Such serious structural limitations will obviously show up in empirical statistical tests when the parameters of the tests are chosen accordingly. Finally, we examine two combined generators proposed in <ref> [14, 15] </ref> and which can be approximated by linear congruential generators for which d 6 (I) 1= p 6 0:408 for certain sets I. <p> Then, d 6 (I) 1= p 6 0:408. It is relatively easy to design empirical statistical tests in 6 dimensions that will detect that structure. Example 5. Marsaglia, Zaman, and Tsang <ref> [15] </ref> proposed a combined generator now widely available and known under the name of RANMAR. James [4] gives a FORTRAN implemen tation.
Reference: [16] <author> Sun Microsystems, </author> <year> 1991. </year> <title> Numerical Computations Guide, Document number 800-5277-10. </title>
Reference-contexts: The generator addrans provided by the mathematical library libm.a of the SunOS operating system <ref> [16, Chap. 4] </ref> is a slight variant of that same generator: the plus sign has just been replaced by a minus sign. Another example is the generator based on x n = (x n5 + x n17 ) mod 2 24 ; suggested by Marsaglia [12].
Reference: [17] <author> S. Tezuka, P. L'Ecuyer, and R. Couture, </author> <year> 1993. </year> <title> On the Lattice Structure of the Add-with-Carry and Subtract-with-Borrow Random Number Generators, </title> <booktitle> ACM Transactions of Modeling and Computer Simulation 3 , 315-331. </booktitle> <pages> 9 </pages>
Reference-contexts: The lattice structure for most of the examples 2 we consider here was already analyzed in previous papers <ref> [1, 2, 9, 17] </ref>, but only for the case of successive indices. When considering lacunary indices, we obtain bad stuctures in much smaller dimensions. It is not clear how those properties really affect the results of typical simulations in practice. <p> The result follows. 2 A class of add-with-carry and subtract-with-borrow (AWC/SWB) generators has been proposed by Marsaglia and Zaman [13] and studied further in <ref> [1, 17] </ref>. These generators turn out to be practically equivalent to LCGs with multiplier a and modulus m = a k a r 1. More precisely, the absolute difference between the u n produced by the approximating LCG and that produced by the AWC/SWB generator is bounded by 1=a.
References-found: 17

