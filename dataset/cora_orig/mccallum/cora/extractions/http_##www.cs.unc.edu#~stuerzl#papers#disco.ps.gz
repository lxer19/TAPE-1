URL: http://www.cs.unc.edu/~stuerzl/papers/disco.ps.gz
Refering-URL: http://www.cs.unc.edu/~stuerzl/publications.html
Root-URL: http://www.cs.unc.edu
Title: Adaptive Mesh Refinement with Discontinuities for the Radiosity Method  
Author: W. Sturzlinger 
Address: A-4040 Linz, Austria, Europe  
Affiliation: wrzl@gup.uni-linz.ac.at, Johannes Kepler University,  
Abstract: The radiosity method simulates the interaction of light between diffuse reflecting surfaces, thereby accurately predicting global illumination effects. One of the main problems of the original algorithm is the inability to represent correctly the shadows cast onto surfaces. Adaptive subdivision techniques were tried but the results are not good enough for general purposes. The conceptually different discontinuity meshing algorithm produces exact pictures of shadow boundaries but is computationally expensive. The newly presented adaptive discontinuity meshing method combines the speed of adaptive subdivision with the quality of the discontinuity meshing method. 
Abstract-found: 1
Intro-found: 1
Reference: [BRW89] <author> Baum, D. R., Rushmeier, H. E., Winget, J. M.: </author> <title> Improving Radiosity Solutions through the Use of Analytically Determined Form-Factors. </title> <note> Computer Graphics (SIGGRAPH '89) 23:3 (1989) 51-60 </note>
Reference-contexts: Many artifacts appear also at the boundary of a region where elements were split by discontinuity segments and others were not (e.g. figure 3), The artifacts are caused by t-vertices and can be avoided by the anchoring scheme described by Baum <ref> [BRW89] </ref>. Fig. 3. T-vertices (left) and anchoring (right). Discontinuity segments are drawn in bold.
Reference: [Ca94] <author> Carter, M.: </author> <title> Private communications. </title>
Reference-contexts: The potential effect of higher order interpolation methods remains to be investigated. Hierarchical discontinuity meshing [LTG93] is another practicable way to improve image quality and to obtain the image quickly as well. A noteable disadvantage of all hierarchical methods reported by <ref> [Ca94, To94] </ref> are significant problems in parallelizing them for distributed memory machines. 5.1 Acknowledgements The author thanks G. Schaufler for reading an early version.
Reference: [CGIB86] <author> Cohen, M., Greenberg, D. P., Immel, D. S., Brock, P. J.: </author> <title> An Efficient Ra-diosity Approach for Realistic Image Synthesis. </title> <journal> IEEE Computer Graphics and Applications 6:3 (March 1986) 26-35 10 W. Sturzlinger </journal>
Reference-contexts: Cohen <ref> [CGIB86] </ref> proposed a two-level hierarchy to partially overcome this problem. The patches are further subdivided into elements. The illumination is computed for the elements and are also used to display the final image. The average of the element radiosities gives a good approximation to the radiosity of the respective patch.
Reference: [CCWG88] <author> Cohen, M., Chen, S. E., Wallace, J. R., Greenberg, D. P.: </author> <title> A Progressive Refinement Approach to Fast Radiosity Image Generation. </title> <note> Computer Graphics (SIGGRAPH '88) 22:4 (1988) 75-84 </note>
Reference-contexts: These patches are used to store the radiosity on the respective part of the surface. The global illumination is then approximated by formulating a linear equation system for the interaction of radiosity between the patches. The progressive refinement method <ref> [CCWG88] </ref> uses a reordering of the solution process to speed up the calculation. This method works as follows: An iteration step distributes ("shoots") the radiosity of the patch with the maximum unshot radiosity to all other patches in the environment.
Reference: [CW93] <author> Cohen, M. F., Wallace, J. R.: </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press (1993) </publisher>
Reference-contexts: Afterwards the algorithm is recursively applied to the new mesh elements. This improved technique may still yield visually annoying artefacts because the resulting mesh density varies (too) quickly near shadow boundaries causing interpolation errors in the final image. A restricted quadtree scheme (see e.g. <ref> [CW93] </ref>) can be used to ensure a gradually varying mesh density. Fortunately it is not necessary to compute the illumination for all sampling points in every iteration. In surface regions evenly lit by the current shooter only the radiosity of the original elements and associated sampling needs to be calculated.
Reference: [FKN80] <author> Fuchs, H., Kedem, Z. M., Naylor, B.: </author> <title> On Visibile Surface Generation by a Priori Tree Structures. </title> <note> Computer Graphics (SIGGRAPH '80) 14:3 (July 1980) 124-133 </note>
Reference-contexts: Fig. 1. Penumbra and umbra regions. Lischinski [LTG92] presented an algorithm which calculates all shadow boundaries. Shadows cast by the current shooter onto all other surfaces are constructed exactly. The use of a BSP-tree (Binary Space Partition tree, see <ref> [FKN80] </ref>) optimizes this costly operation. The contribution of the current shooter is stored in a separate mesh. This mesh is "added" to the overall mesh after each iteration.
Reference: [GTGB84] <author> Goral, C. M., Torrance, K. E., Greenberg, D. P., Battaile, B.: </author> <title> Modelling the Interaction of Light Between Diffuse Surfaces. </title> <note> Computer Graphics (SIGGRAPH '84) 18:3 (1984) 212-222 </note>
Reference-contexts: 1 Introduction Radiosity has become a popular method for image synthesis due to its ability to generate images of high realism. It was first introduced to computer graphics by Goral <ref> [GTGB84] </ref>. The radiosity method models the interaction of light between diffuse surfaces ("patches"). These patches are used to store the radiosity on the respective part of the surface. The global illumination is then approximated by formulating a linear equation system for the interaction of radiosity between the patches.
Reference: [He92] <author> Heckbert, P.: </author> <title> Discontinuity Meshing for Radiosity. </title> <booktitle> Third Eurographics Workshop on Rendering (May 1992) 203-226 </booktitle>
Reference-contexts: The penumbra region is separated from the umbra region and the fully lit part by line segments (see Figure 1). The illumination function has discontinuities of first or second order across these line segments (see e.g. <ref> [He92, LTG92] </ref>). Fig. 1. Penumbra and umbra regions. Lischinski [LTG92] presented an algorithm which calculates all shadow boundaries. Shadows cast by the current shooter onto all other surfaces are constructed exactly. The use of a BSP-tree (Binary Space Partition tree, see [FKN80]) optimizes this costly operation. <p> The use of a BSP-tree (Binary Space Partition tree, see [FKN80]) optimizes this costly operation. The contribution of the current shooter is stored in a separate mesh. This mesh is "added" to the overall mesh after each iteration. Heckbert <ref> [He92] </ref> calculated the shadow boundaries using a different approach based on wedges and a sweep line algorithm. 3 Adaptive Discontinuity Meshing 3.1 Motivation The major drawback of adaptive subdivision is the fact that the required subdivision level depends on the viewing perspective of the final image. Therefore, 4 W.
Reference: [HSA91] <author> Hanrahan, P., Salzman, D., Aupperle, L.: </author> <title> A Rapid Hierarchical Radiosity Algorithm. </title> <note> Computer Graphics (SIGGRAPH '91) 25:4 (July 1991) 197-206 </note>
Reference-contexts: The illumination is computed for the elements and are also used to display the final image. The average of the element radiosities gives a good approximation to the radiosity of the respective patch. The errors caused by shooting the radiosity from patches are sufficiently small. Hanrahan <ref> [HSA91] </ref> generalized the subdivision hierarchy to multiple level and used an adaption of n-body problem algorithms to speed up the calculations. 2.2 Adaptive Subdivision The radiosity algorithm with patches and elements yields unsatisfactory results when applied to general scenes as one cannot determine in advance which level of subdivision will be
Reference: [LBT92] <author> Languenou, E., Bouatouch, K., Tellier, P.: </author> <title> An adaptive Discretization Method for Radiosity. </title> <booktitle> Proceedings of Eurographics 1992 11:3 (1992) 205-216 </booktitle>
Reference-contexts: Adaptive subdivision is used to overcome this problem (see e.g. <ref> [VP91, LBT92, PWWP93] </ref>). The mesh is refined locally if the radiosity values at the element vertices vary to much or in regions with a high radiosity gradient across elements [VP91]. Such elements are considered unevenly lit, the mesh is subdivided and new radiosity values are computed for the added elements.
Reference: [LTG92] <author> Lischinski, D., Tampieri, F., Greenberg, D. P.: </author> <title> A Discontinuity Meshing Algorithm for Accurate Radiosity. </title> <journal> IEEE Computer Graphics and Applications 12:6 (Nov 1992) 25-39 </journal>
Reference-contexts: The penumbra region is separated from the umbra region and the fully lit part by line segments (see Figure 1). The illumination function has discontinuities of first or second order across these line segments (see e.g. <ref> [He92, LTG92] </ref>). Fig. 1. Penumbra and umbra regions. Lischinski [LTG92] presented an algorithm which calculates all shadow boundaries. Shadows cast by the current shooter onto all other surfaces are constructed exactly. The use of a BSP-tree (Binary Space Partition tree, see [FKN80]) optimizes this costly operation. <p> The penumbra region is separated from the umbra region and the fully lit part by line segments (see Figure 1). The illumination function has discontinuities of first or second order across these line segments (see e.g. [He92, LTG92]). Fig. 1. Penumbra and umbra regions. Lischinski <ref> [LTG92] </ref> presented an algorithm which calculates all shadow boundaries. Shadows cast by the current shooter onto all other surfaces are constructed exactly. The use of a BSP-tree (Binary Space Partition tree, see [FKN80]) optimizes this costly operation. The contribution of the current shooter is stored in a separate mesh. <p> However, this method only applies to static images. Philips [PWWP93] remarked that adaptive subdivision produces good results if exact shadow boundaries are used to subdivide the mesh but reasoned that they are too expensive to calculate. The runtimes reported by Lischinski <ref> [LTG92] </ref> for discontinuity meshing are not far from dominating the whole illumination computation time even though a BSP-tree is used to speed up the calculation. One reason is that all discontinuity segments are calculated, regardless if noticeable or not. <p> These locations correspond to wedges defined by the geometries of the shooting patch and the patch which causes the shadow and can be stored in a shadow BSP-tree. For a more thorough discussion see <ref> [LTG92] </ref>. In contrast to Lischinski the approach presented in this paper does not require to construct the shadow BSP-tree for the whole scene. Instead only two patches (the shooter and a "blocker") must be considered for the construction of the shadow BSP-tree caused by the blocking patch. <p> Primary lightsources and strong secondary lightsources cause the most prominent discontinuities. These will be detected reliably by the algorithm. Unnoticeable i.e. weak shadow boundaries are ignored and cause no discontinuity segments to be generated. In contrast to Lischinski <ref> [LTG92] </ref> who used the heuristic of computing the discontinuities only for the primary lightsources, this algorithm computes shadow boundaries only where neccessary, i.e. where they are visible in the final images or walk through environment. 3.3 Improved Adaptive Discontinuity Meshing Due to the regular grid of the original elements aliasing effects <p> The resulting illumination function is continuous in value (C 0 ). This technique allows an interactive walkthrough of the environment. As illumination varies smoothly across surfaces (except at shadow boundaries) higher order reconstruction methods can be used, as an alternative. Lischin-ski <ref> [LTG92] </ref> used quadratic and Salesin [SLR92] cubic Bezier-triangles. Both approaches exploit the precalculated discontinuities to correctly approximate the illumination function. <p> The reconstruction algorithm of Salesin [SLR92] provides a C 1 -smooth interpolation of the surface illumination. 4 Implementation and Results Our simple test scene consisted of a cube floating above a plane lighted by two lightsources was modeled (analguous to <ref> [LTG92] </ref>). in the lower part of the picture. The pictures were generated without the modifications discussed in section 3.3. The statistics for the two versions are given in the following table, where AS stands for the original adaptive subdivision method and ADM stands for the new adaptive discontinuity meshing method.
Reference: [LTG93] <author> Lischinski, D., Tampieri, F., Greenberg, D. P.: </author> <title> Combining Hierarchical Radiosity and Discontinuity Meshing Computer Graphics (SIGGRAPH '93) 27:4 (August 1993) 199-208 </title>
Reference-contexts: Adaptive Discontinuity Meshing 9 Fig. 5. Complex scene with adaptive discontinuity meshing. In this paper only Gouraud shading was used for the resulting images. The potential effect of higher order interpolation methods remains to be investigated. Hierarchical discontinuity meshing <ref> [LTG93] </ref> is another practicable way to improve image quality and to obtain the image quickly as well. A noteable disadvantage of all hierarchical methods reported by [Ca94, To94] are significant problems in parallelizing them for distributed memory machines. 5.1 Acknowledgements The author thanks G. Schaufler for reading an early version.
Reference: [PWWP93] <author> Philips, S., Worrall, A., Willis, C., Paddon, D.: </author> <title> Adaptive Mesh Refinement for the Radiosity Method. </title> <booktitle> Proceedings of Compugraphics (1993) 178-186 </booktitle>
Reference-contexts: Adaptive subdivision is used to overcome this problem (see e.g. <ref> [VP91, LBT92, PWWP93] </ref>). The mesh is refined locally if the radiosity values at the element vertices vary to much or in regions with a high radiosity gradient across elements [VP91]. Such elements are considered unevenly lit, the mesh is subdivided and new radiosity values are computed for the added elements. <p> This method avoids a steady increase of sample contributions to be calculated, which would cause a slowdown of subsequent iterations. Adaptive Discontinuity Meshing 3 2.3 Discontinuity Meshing A better approach would use the exact shadow boundaries for the mesh subdivision <ref> [PWWP93] </ref>. The umbra and penumbra regions can be computed exactly for a patch casting a shadow onto a plane when lit by a polgonal lightsource. The penumbra region is separated from the umbra region and the fully lit part by line segments (see Figure 1). <p> On the other hand surfaces far away from the camera can do with much coarser subdivision. Therefore, the distance of a surface to the camera could be used to compute a maxmimum subdivision level. However, this method only applies to static images. Philips <ref> [PWWP93] </ref> remarked that adaptive subdivision produces good results if exact shadow boundaries are used to subdivide the mesh but reasoned that they are too expensive to calculate.
Reference: [SLR92] <author> Salesin, D., Lischinski, D., DeRose, T.: </author> <title> Reconstructing Illumination Functions with Selected Discontinuities. </title> <booktitle> Third Eurographics Workshop on Rendering (May 1992) 99-112 </booktitle>
Reference-contexts: The resulting illumination function is continuous in value (C 0 ). This technique allows an interactive walkthrough of the environment. As illumination varies smoothly across surfaces (except at shadow boundaries) higher order reconstruction methods can be used, as an alternative. Lischin-ski [LTG92] used quadratic and Salesin <ref> [SLR92] </ref> cubic Bezier-triangles. Both approaches exploit the precalculated discontinuities to correctly approximate the illumination function. The reconstruction algorithm of Salesin [SLR92] provides a C 1 -smooth interpolation of the surface illumination. 4 Implementation and Results Our simple test scene consisted of a cube floating above a plane lighted by two lightsources <p> As illumination varies smoothly across surfaces (except at shadow boundaries) higher order reconstruction methods can be used, as an alternative. Lischin-ski [LTG92] used quadratic and Salesin <ref> [SLR92] </ref> cubic Bezier-triangles. Both approaches exploit the precalculated discontinuities to correctly approximate the illumination function. The reconstruction algorithm of Salesin [SLR92] provides a C 1 -smooth interpolation of the surface illumination. 4 Implementation and Results Our simple test scene consisted of a cube floating above a plane lighted by two lightsources was modeled (analguous to [LTG92]). in the lower part of the picture.
Reference: [St94] <author> Sturzlinger, W., Wild, C.: </author> <title> Parallel Progressive Radiosity with Parallel Visibility Computations, </title> <booktitle> Winter School of Computer Graphics 94 (Plzen, </booktitle> <address> CZ) (Feb. </address> <year> 1994) </year> <month> 66-74 </month>
Reference-contexts: Due to the improved shadow boundary representation the resulting images are visually more accurate. This method introduces an new approach for reliable adaptive subdivision criteria. Adaptive discontinuity meshing can be used as an extension to existing ra-diosty systems and/or parallel implementations of the radiosity algorithm (e.g. <ref> [St94] </ref>). Adaptive Discontinuity Meshing 9 Fig. 5. Complex scene with adaptive discontinuity meshing. In this paper only Gouraud shading was used for the resulting images. The potential effect of higher order interpolation methods remains to be investigated.
Reference: [To94] <author> Tobler, R. F.: </author> <title> Private communications. </title>
Reference-contexts: The potential effect of higher order interpolation methods remains to be investigated. Hierarchical discontinuity meshing [LTG93] is another practicable way to improve image quality and to obtain the image quickly as well. A noteable disadvantage of all hierarchical methods reported by <ref> [Ca94, To94] </ref> are significant problems in parallelizing them for distributed memory machines. 5.1 Acknowledgements The author thanks G. Schaufler for reading an early version.
Reference: [VP91] <author> Vedel, C., Puech, C.: </author> <title> A testbed for adaptive subdivision in progressive radiosity, </title> <booktitle> Second Eurographics Workshop on Rendering (May 1991) </booktitle>
Reference-contexts: Adaptive subdivision is used to overcome this problem (see e.g. <ref> [VP91, LBT92, PWWP93] </ref>). The mesh is refined locally if the radiosity values at the element vertices vary to much or in regions with a high radiosity gradient across elements [VP91]. Such elements are considered unevenly lit, the mesh is subdivided and new radiosity values are computed for the added elements. <p> Adaptive subdivision is used to overcome this problem (see e.g. [VP91, LBT92, PWWP93]). The mesh is refined locally if the radiosity values at the element vertices vary to much or in regions with a high radiosity gradient across elements <ref> [VP91] </ref>. Such elements are considered unevenly lit, the mesh is subdivided and new radiosity values are computed for the added elements. Afterwards the algorithm is recursively applied to the new mesh elements.
Reference: [WEH89] <author> Wallace, J. R., Elmquist, K. A., Haines, E. A.: </author> <title> A Ray Tracing Algorithm for Progressive Radiosity. Computer Graphics (SIGGRAPH '89) 23:3 (July 1989) 315-324 This article was processed using the L A T E X macro package with LMAMULT style </title>
Reference-contexts: Displaying the results after each iteration step provides the user with progressively refined approximations to the resulting picture. To describe the influence the illumination of one patch onto another, a value called formfactor must be computed. These formfactors were first computed using the relatively inexact hemicube method. Wallace <ref> [WEH89] </ref> improved the accuracy by using analytic approximations for small parts of the shooting patch and ray tracing for the visibility calculations. 2 W. Sturzlinger Another noteworthy property of the radiosity method is that it computes the illumination globally, i.e. independent of the camera position. <p> Formfactors are calculated by raytracing <ref> [WEH89] </ref>. The subdivision algorithm is modified to use a different test and subdivision strategy. If a shadow boundary crossing an element is detected the exact shadow boundary is computed and used for mesh subdivision.
References-found: 18

