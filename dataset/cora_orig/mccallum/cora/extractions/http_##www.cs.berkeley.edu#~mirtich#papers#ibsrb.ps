URL: http://www.cs.berkeley.edu/~mirtich/papers/ibsrb.ps
Refering-URL: http://www.cs.berkeley.edu/~mirtich/publications.html
Root-URL: 
Title: Impulse-based Simulation of Rigid Bodies  
Author: Brian Mirtich John Canny 
Address: Berkeley  
Affiliation: University of California at  
Abstract: We introduce a promising new approach to rigid body dynamic simulation called impulse-based simulation. The method is well suited to modeling physical systems with large numbers of collisions, or with contact modes that change frequently. All types of contact (colliding, rolling, sliding, and resting) are modeled through a series of collision impulses between the objects in contact, hence the method is simpler and faster than constraint-based simulation. We have implemented an impulse-based simulator that can currently achieve interactive simulation times, and real time simulation seems within reach. In addition, the simulator has produced physically accurate results in several qualitative and quantitative experiments. After giving an overview of impulse-based dynamic simulation, we discuss collision detection and collision response in this context, and present results from several experiments. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Baraff, David. </author> <title> Analytical Methods for Dynamic Simulation of Non-penetrating Rigid Bodies. </title> <journal> Computer Graphics, </journal> <volume> 23(3) </volume> <pages> 223-232, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: Cremer and Stewart describe Newton [7, 17], probably the most advanced general-purpose dynamic simulator in use today. Newton's forte is the formulation and simulation of constraint-based dynamics for linked rigid bodies, although the contact modeling is fairly simplistic. Baraff has studied multiple rigid bodies in contact <ref> [1, 2] </ref>, and shown that computing contact forces in the presence of friction is NP-hard [3]. A summary of his work in this area appears in [4]. There are few full treatments of frictional collisions. <p> Finally, impacts are not easily incorporated into the constraint model, as they generally give rise to impulses, not constraint forces present over some interval. These collision impulses must be handled separately, as in <ref> [1] </ref>. In contrast to constraint-based methods, impulse-based dynamics involves no explicit constraints on the configurations of the moving objects; when the objects are not colliding, they are in ballistic trajectories.
Reference: [2] <author> Baraff, David. </author> <title> Curved Surfaces and Coherence for Non-penetrating Rigid Body Simulation. </title> <journal> Computer Graphics, </journal> <volume> 24(4) </volume> <pages> 19-28, </pages> <month> August </month> <year> 1990. </year>
Reference-contexts: Cremer and Stewart describe Newton [7, 17], probably the most advanced general-purpose dynamic simulator in use today. Newton's forte is the formulation and simulation of constraint-based dynamics for linked rigid bodies, although the contact modeling is fairly simplistic. Baraff has studied multiple rigid bodies in contact <ref> [1, 2] </ref>, and shown that computing contact forces in the presence of friction is NP-hard [3]. A summary of his work in this area appears in [4]. There are few full treatments of frictional collisions.
Reference: [3] <author> Baraff, David. </author> <title> Coping with Friction for Non-penetrating Rigid Body Simulation. </title> <journal> Computer Graphics, </journal> <volume> 25(4) </volume> <pages> 31-40, </pages> <month> August </month> <year> 1991. </year>
Reference-contexts: Newton's forte is the formulation and simulation of constraint-based dynamics for linked rigid bodies, although the contact modeling is fairly simplistic. Baraff has studied multiple rigid bodies in contact [1, 2], and shown that computing contact forces in the presence of friction is NP-hard <ref> [3] </ref>. A summary of his work in this area appears in [4]. There are few full treatments of frictional collisions. Routh [16] is still considered the authority on this subject, and more recently, Keller gives an excellent treatment of frictional collisions [10]. <p> During this integration, u z will increase 1 . When it reaches zero, the point of maximum compression has been attained. 1 Baraff and others have noted that it is possible to construct cases for which u z decreases as p z increases <ref> [3] </ref>. However, this situation seems to be extremely rare; it has not occurred in any of our simulations. the u x -u y plane. At this point, p z is the total normal impulse which has been applied during compression. <p> Constraint-based simulators have trouble with this example because of the large number of mutual contacts between the racked balls. Baraff has shown that the problem of finding a set of contact forces that instantaneously obey the Coulomb friction law at every contact point is NP-hard <ref> [3] </ref>. Furthermore, the contact constraints are quite transient, making it difficult to integrate along equations of motion derived from them. The impulse-based method avoids these problems by treating the contacts as a series of closely spaced collisions. The racked balls (of standard size) were initially placed 0.1 millimeters apart.
Reference: [4] <author> Baraff, David. </author> <title> Issues in Computing Contact Forces for Non-penetrating Rigid Bodies. </title> <journal> Algorithmica, </journal> <volume> 10 </volume> <pages> 292-352, </pages> <year> 1993. </year>
Reference-contexts: Baraff has studied multiple rigid bodies in contact [1, 2], and shown that computing contact forces in the presence of friction is NP-hard [3]. A summary of his work in this area appears in <ref> [4] </ref>. There are few full treatments of frictional collisions. Routh [16] is still considered the authority on this subject, and more recently, Keller gives an excellent treatment of frictional collisions [10]. <p> Most of the work which has been done in this area falls into the category of constraint-based methods <ref> [4, 5, 7, 19] </ref>. An example will illustrate the approach. Consider a ball rolling along a table top. The normal force which the table exerts on the ball is a constraint force that does no work on the ball, but only enforces a non-penetration constraint.
Reference: [5] <author> Barzel, Ronen and Barr, Alan H. </author> <title> A Modeling System Based on Dynamic Constraints. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 179-188, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: Wang and Mason have studied two-dimensional impact dynamics for robotic applications, based on Routh's approach [18]. Finally, a number of researchers have investigated several problems and paradigms for dynamic simulation and physical-based modeling <ref> [5, 19, 20] </ref>. 2 The impulse-based method One of the most difficult aspects of dynamic simulation is dealing with the interactions between bodies in contact. Most of the work which has been done in this area falls into the category of constraint-based methods [4, 5, 7, 19]. <p> Most of the work which has been done in this area falls into the category of constraint-based methods <ref> [4, 5, 7, 19] </ref>. An example will illustrate the approach. Consider a ball rolling along a table top. The normal force which the table exerts on the ball is a constraint force that does no work on the ball, but only enforces a non-penetration constraint.
Reference: [6] <author> Bhatt, Vivek and Koechling, Jeff. </author> <title> Classifying Dynamic Behavior During Three Dimensional Frictional Rigid Body Impact. </title> <booktitle> In International Conference on Robotics and Automation. IEEE, </booktitle> <month> May </month> <year> 1994. </year>
Reference-contexts: Our analysis is extremely similar to that of Bhatt and Koechling, who independently derived the same key equation for integration of relative contact velocities during impact. They give a classification of frictional collisions, based on the flow patterns of tangential contact velocity <ref> [6] </ref>. Wang and Mason have studied two-dimensional impact dynamics for robotic applications, based on Routh's approach [18]. <p> Our approach for analyzing general frictional impacts is similar to that of Routh [16], although we derive equations which are more amenable to numerical integration. Keller also gives an excellent treatment [10], and Bhatt and Koechling's analysis is quite similar to ours <ref> [6] </ref>. There are three assumptions central to our analysis: 1. Infinitesimal collision time 2. Poisson's hypothesis 3. Coulomb friction model The infinitesimal collision time assumption is commonly made in dynamic simulation [10].
Reference: [7] <author> Cremer, James F. and Stewart, A. James. </author> <title> The Architecture of Newton, a General-purpose Dynamics Simulator. </title> <booktitle> In International Conference on Robotics and Automation, </booktitle> <pages> pages 1806-1811. </pages> <publisher> IEEE, </publisher> <month> May </month> <year> 1989. </year>
Reference-contexts: These early approaches all suffered from inefficient collision detection and unrealistic assumptions concerning impact dynamics (e.g. infinite friction at the contact point). Cremer and Stewart describe Newton <ref> [7, 17] </ref>, probably the most advanced general-purpose dynamic simulator in use today. Newton's forte is the formulation and simulation of constraint-based dynamics for linked rigid bodies, although the contact modeling is fairly simplistic. <p> Most of the work which has been done in this area falls into the category of constraint-based methods <ref> [4, 5, 7, 19] </ref>. An example will illustrate the approach. Consider a ball rolling along a table top. The normal force which the table exerts on the ball is a constraint force that does no work on the ball, but only enforces a non-penetration constraint.
Reference: [8] <author> Hahn, James K. </author> <title> Realistic Animation of Rigid Bodies. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 299-308, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: Supported in part by NSF grant #FD93-19412. 1.1 Related work Moore and Wilhelms give one of the earliest treatments of two fundamental problems in dynamic simulation: collision detection and collision response [14]. Hahn also pioneered dynamic simulation, modeling sliding and rolling contacts using impact equations <ref> [8] </ref>. His work is the precursor of our method, although we extend the applicability of impulse dynamics to resting contacts, and model multiple objects in contact with impulse trains as well. <p> Hahn found collision detection to be the bottleneck in dynamic simulation <ref> [8] </ref>, and efficient data structures and algorithms are needed to make impulse-based simulation feasible. Currently in our simulator, all objects are geometrically modeled as convex polyhedra or combinations of them.
Reference: [9] <author> Hopcroft, John E. </author> <title> Electronic Prototyping. </title> <booktitle> Computer, </booktitle> <pages> pages 55-57, </pages> <month> March </month> <year> 1989. </year>
Reference-contexts: 1 Introduction The foremost requirement of a dynamic simulator is physical accuracy. The simulation is to take the place of a physical model, and hence its utility is directly related to how well it mimics this model. A second important requirement is computational efficiency. Many applications (e.g. electronic prototyping <ref> [9] </ref>) benefit most from interactive simulation; others (e.g. virtual reality) demand real time speeds. This paper discusses a new approach to dynamic simulation called impulse-based simulation, founded on the twin goals of physical accuracy and computational efficiency.
Reference: [10] <author> Keller, J. B. </author> <title> Impact with Friction. </title> <journal> Journal of Applied Mechanics, </journal> <volume> 53, </volume> <month> March </month> <year> 1986. </year>
Reference-contexts: A summary of his work in this area appears in [4]. There are few full treatments of frictional collisions. Routh [16] is still considered the authority on this subject, and more recently, Keller gives an excellent treatment of frictional collisions <ref> [10] </ref>. Our analysis is extremely similar to that of Bhatt and Koechling, who independently derived the same key equation for integration of relative contact velocities during impact. They give a classification of frictional collisions, based on the flow patterns of tangential contact velocity [6]. <p> Our approach for analyzing general frictional impacts is similar to that of Routh [16], although we derive equations which are more amenable to numerical integration. Keller also gives an excellent treatment <ref> [10] </ref>, and Bhatt and Koechling's analysis is quite similar to ours [6]. There are three assumptions central to our analysis: 1. Infinitesimal collision time 2. Poisson's hypothesis 3. Coulomb friction model The infinitesimal collision time assumption is commonly made in dynamic simulation [10]. <p> Keller also gives an excellent treatment <ref> [10] </ref>, and Bhatt and Koechling's analysis is quite similar to ours [6]. There are three assumptions central to our analysis: 1. Infinitesimal collision time 2. Poisson's hypothesis 3. Coulomb friction model The infinitesimal collision time assumption is commonly made in dynamic simulation [10]. It implies that the positions of the objects can be treated as constant over the course of a collision. Furthermore, the effect of one object on the other can be described by an impulse, which unlike a normal force can instantaneously change velocities.
Reference: [11] <author> Lewis, A. and M'Closkey, R. and Murray, Richard. </author> <title> Modelling Constraints and the Dynamics of a Rolling Ball on a Spinning Table. </title> <type> Technical report, </type> <institution> California Institute of Technology, </institution> <year> 1993. </year> <type> Preprint. </type>
Reference-contexts: Moreover, it is not even always clear what type of constraint should be applied; there exist at least two models for rolling contact which in some cases predict different behaviors <ref> [11] </ref>. Finally, impacts are not easily incorporated into the constraint model, as they generally give rise to impulses, not constraint forces present over some interval. These collision impulses must be handled separately, as in [1]. <p> The example is interesting because of the nonholonomic constraint between the ball and disc, and in fact there are two classical models for this rolling contact which predict different behaviors! Experimental results show that the ball rolls in circles of gradually increasing radii, eventually rolling off the platter <ref> [11] </ref>. Our impulse-based simulator produces this result, demonstrating correct macroscopic behavior from the impulse-based contact model. Block dropped on block. One block is dropped onto another, the former coming to rest on the latter. Dominos. A line of seven dominos is set in motion by bumping the lead domino.
Reference: [12] <author> Lin, Ming C. and Canny, John F. </author> <title> A Fast Algorithm for Incremental Distance Calculation. </title> <booktitle> In International Conference on Robotics and Automation, </booktitle> <pages> pages 1008-1014. </pages> <publisher> IEEE, </publisher> <month> May </month> <year> 1991. </year>
Reference-contexts: After an integration step, the distance between the objects on the top of the heap (call them A and B) must be recomputed. In our implementation, we use the Lin-Canny closest features algorithm <ref> [12] </ref>. This is an extremely efficient algorithm which maintains the closest features (vertices, edges, or faces) between a pair of convex polyhedra. It is fastest in applications like dynamic simulation, when the objects move continuously through space and geometric coherence can be exploited.
Reference: [13] <author> Mirtich, Brian and Canny, John. </author> <title> Impulse-based Dynamic Simulation. </title> <editor> In K. Goldberg, D. Halperin, J.C. Latombe, and R. Wilson, editors, </editor> <booktitle> The Algorithmic Foundations of Robotics. </booktitle> <editor> A. K. Peters, </editor> <address> Boston, MA, </address> <year> 1995. </year> <note> Proceedings from the workshop held in February, </note> <year> 1994. </year>
Reference-contexts: Accurate computation of this impulse is critical to the physical accuracy of the simulator. We now discuss how p may be computed; a more detailed discussion can be found in <ref> [13] </ref>. 4.1 Assumptions for collisions For impulse-based simulation, it is not feasible to make gross simplifying assumptions such as frictionless contacts or perfectly elastic collisions. Our approach for analyzing general frictional impacts is similar to that of Routh [16], although we derive equations which are more amenable to numerical integration. <p> Let u (fl) denote the total change in relative contact velocity at point fl in the collision, and p (fl) be the impulse delivered to body 1 up to this point. Straightforward physics leads to the equation u (fl) = M p (fl) (7) (see <ref> [13] </ref> for a detailed analysis). Here, M is a 3 fi 3 matrix dependent only upon the masses and mass matrices of the colliding bodies, and the locations of the contact points relative to their centers of mass.
Reference: [14] <author> Moore, Matthew and Wilhelms, Jane. </author> <title> Collision Detection and Response for Computer Animation. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 289-298, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: Supported in part by NSF grant #FD93-19412. 1.1 Related work Moore and Wilhelms give one of the earliest treatments of two fundamental problems in dynamic simulation: collision detection and collision response <ref> [14] </ref>. Hahn also pioneered dynamic simulation, modeling sliding and rolling contacts using impact equations [8]. His work is the precursor of our method, although we extend the applicability of impulse dynamics to resting contacts, and model multiple objects in contact with impulse trains as well.
Reference: [15] <author> Overmars, Mark. </author> <title> Point Location in Fat Subdivisions. </title> <journal> Information Processing Letters, </journal> <volume> 44 </volume> <pages> 261-265, </pages> <year> 1992. </year>
Reference-contexts: To alleviate this problem, we employ a spatial tiling technique based on Overmars' efficient point-location algorithms in fat subdivisions <ref> [15] </ref>. For each object i in the simulation, one can easily find an enclosing, axis-aligned rectangular volume B i which is guaranteed to contain the object during the next integration step. This is possible because of the ballistic trajectory assumption. <p> The hierarchy is needed to keep the rate of bucket updates small. See Overmars for more information on this multiple resolution hashing scheme <ref> [15] </ref>. 3.3 Time of impact estimator The time of impact (TOI) estimator takes the current dynamic state (pose and velocity) of two objects as well as the closest points between them, and returns a lower bound on the time of impact for those two objects.
Reference: [16] <author> Routh, Edward J. </author> <title> Elementary Rigid Dynamics. </title> <year> 1905. </year>
Reference-contexts: Baraff has studied multiple rigid bodies in contact [1, 2], and shown that computing contact forces in the presence of friction is NP-hard [3]. A summary of his work in this area appears in [4]. There are few full treatments of frictional collisions. Routh <ref> [16] </ref> is still considered the authority on this subject, and more recently, Keller gives an excellent treatment of frictional collisions [10]. Our analysis is extremely similar to that of Bhatt and Koechling, who independently derived the same key equation for integration of relative contact velocities during impact. <p> Our approach for analyzing general frictional impacts is similar to that of Routh <ref> [16] </ref>, although we derive equations which are more amenable to numerical integration. Keller also gives an excellent treatment [10], and Bhatt and Koechling's analysis is quite similar to ours [6]. There are three assumptions central to our analysis: 1. Infinitesimal collision time 2. Poisson's hypothesis 3.
Reference: [17] <author> Stewart, A. James and Cremer, James F. </author> <title> Algorithmic Control of Walking. </title> <booktitle> In International Conference on Robotics and Automation, </booktitle> <pages> pages 1598-1603. </pages> <publisher> IEEE, </publisher> <month> May </month> <year> 1989. </year>
Reference-contexts: These early approaches all suffered from inefficient collision detection and unrealistic assumptions concerning impact dynamics (e.g. infinite friction at the contact point). Cremer and Stewart describe Newton <ref> [7, 17] </ref>, probably the most advanced general-purpose dynamic simulator in use today. Newton's forte is the formulation and simulation of constraint-based dynamics for linked rigid bodies, although the contact modeling is fairly simplistic.
Reference: [18] <author> Wang, Yu and Mason, Matthew T. </author> <title> Modeling Impact Dynamics for Robotic Operations. </title> <booktitle> In International Conference on Robotics and Automation, </booktitle> <pages> pages 678-685. </pages> <publisher> IEEE, </publisher> <month> May </month> <year> 1987. </year>
Reference-contexts: They give a classification of frictional collisions, based on the flow patterns of tangential contact velocity [6]. Wang and Mason have studied two-dimensional impact dynamics for robotic applications, based on Routh's approach <ref> [18] </ref>. Finally, a number of researchers have investigated several problems and paradigms for dynamic simulation and physical-based modeling [5, 19, 20]. 2 The impulse-based method One of the most difficult aspects of dynamic simulation is dealing with the interactions between bodies in contact.
Reference: [19] <author> Witkin, Andrew and Gleicher, Michael and Welch, William. </author> <title> Interactive Dynamics. </title> <journal> Computer Graphics, </journal> <volume> 24(2) </volume> <pages> 11-22, </pages> <month> March </month> <year> 1990. </year>
Reference-contexts: Wang and Mason have studied two-dimensional impact dynamics for robotic applications, based on Routh's approach [18]. Finally, a number of researchers have investigated several problems and paradigms for dynamic simulation and physical-based modeling <ref> [5, 19, 20] </ref>. 2 The impulse-based method One of the most difficult aspects of dynamic simulation is dealing with the interactions between bodies in contact. Most of the work which has been done in this area falls into the category of constraint-based methods [4, 5, 7, 19]. <p> Most of the work which has been done in this area falls into the category of constraint-based methods <ref> [4, 5, 7, 19] </ref>. An example will illustrate the approach. Consider a ball rolling along a table top. The normal force which the table exerts on the ball is a constraint force that does no work on the ball, but only enforces a non-penetration constraint.
Reference: [20] <author> Witkin, Andrew and Welch, William. </author> <title> Fast Animation and Control of Nonrigid Structures. </title> <journal> Computer Graphics, </journal> <volume> 24(4) </volume> <pages> 243-252, </pages> <month> August </month> <year> 1990. </year>
Reference-contexts: Wang and Mason have studied two-dimensional impact dynamics for robotic applications, based on Routh's approach [18]. Finally, a number of researchers have investigated several problems and paradigms for dynamic simulation and physical-based modeling <ref> [5, 19, 20] </ref>. 2 The impulse-based method One of the most difficult aspects of dynamic simulation is dealing with the interactions between bodies in contact. Most of the work which has been done in this area falls into the category of constraint-based methods [4, 5, 7, 19].
References-found: 20

