URL: http://www.cs.colorado.edu/homes/cai/public_html/papers/ckv_dd8.ps.gz
Refering-URL: http://www.cs.colorado.edu/homes/cai/public_html/mypapers.html
Root-URL: http://www.cs.colorado.edu
Title: An Implicit Solver for CFD  
Author: X.-C. CAI, D. E. KEYES V. VENKATAKRISHNAN XIAO-CHUAN CAI DAVID E. KEYES and V. VENKATAKRISHNAN 
Note: 1.2 INTRODUCTION  
Date: Newton-Krylov-Schwarz:  
Abstract: 1.1 ABSTRACT Newton-Krylov methods and Krylov-Schwarz (domain decomposition) methods have begun to become established in computational fluid dynamics (CFD) over the past decade. The former employ a Krylov method inside of Newton's method in a Jacobian-free manner, through directional differencing. The latter employ an overlapping Schwarz domain decomposition to derive a preconditioner for the Krylov accelerator that relies primarily on local information, for data-parallel concurrency. They may be composed as Newton-Krylov-Schwarz (NKS) methods, which seem particularly well suited for solving nonlinear elliptic systems in high-latency, distributed-memory environments. We give a brief description of this family of algorithms, with an emphasis on domain decomposition iterative aspects. We then describe numerical simulations with Newton-Krylov-Schwarz methods on aerodynamics applications emphasizing comparisons with a standard defect-correction approach, subdomain preconditioner consistency, subdomain preconditioner quality, and the effect of a coarse grid. Several trends contribute to the importance of parallel implicit algorithms in CFD. Multidisciplinary analysis and optimization put a premium on the ability of algorithms to achieve low residual solutions rapidly, since analysis codes for individual components 
Abstract-found: 1
Intro-found: 1
Reference: [BPS86] <author> Bramble J. H., Pasciak J. E., and Schatz A. H. </author> <title> (1986) The construction of preconditioners for elliptic problems by substructuring, I. </title> <booktitle> Mathematics of Computation 47: </booktitle> <pages> 103-134. </pages>
Reference-contexts: The theory, which has evolved over a decade to cover nonsmooth, nonsymmetric and indefinite problems, as well as nonnested spaces, is digested among other places in [CM94] and [SBG95]. Two such numerically optimal methods for the scalar self-adjoint elliptic problem are the two-level additive Schwarz method [DW87] and BPS-I <ref> [BPS86] </ref>, which is a wire root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) 6 X.-C. CAI, D. E. KEYES & V.
Reference: [BS90] <author> Brown P. and Saad Y. </author> <title> (1990) Hybrid Krylov methods for nonlinear systems of equations. </title> <journal> SIAM Journal of Scientific and Statistical Computing 11: </journal> <pages> 450-481. </pages>
Reference-contexts: Meanwhile, the never slackening demand for resolution and prompt turnaround forces consideration of parallelism, and, for cost effectiveness, particularly parallelism of the high-latency, low-bandwidth variety represented by workstation clusters. A Newton-Krylov-Schwarz (NKS) method combines a Newton-Krylov (NK) method such as nonlinear GMRES <ref> [BS90] </ref>, with a Krylov-Schwarz (KS) method, such as additive Schwarz [DW87]. The key linkage is provided by the Krylov method, of which the restarted form of GMRES [SS86] is perhaps the best-known example for nonselfadjoint problems. <p> When less is known about the scaling of u n and v, a reasonable choice is p " mach (u n ; v)=jjvjj 2 , with guard code to set h = p " mach if jjvjj is too small. For a fuller discussion, see <ref> [BS90] </ref>. For numerical experiments demonstrating the importance of the relative scaling of h in the CFD context, see [KM93, NWAK95].
Reference: [CFS96] <author> Cai X.-C., Farhat C., and Sarkis M. </author> <title> (1996) Schwarz methods for the unsteady compressible Navier-Stokes equations on unstructured meshes. </title> <editor> In Glowinski R., Periaux J., Shi Z., and Widlund O. </editor> <title> (eds) Domain Decomposition Methods in Sciences and Engineering. </title> <publisher> Wiley, </publisher> <address> Chichester. </address>
Reference-contexts: This work has been extended to three-dimensional problems in [NWAK95]. Large-scale time-dependent problems suffering from multiple scales often require parallel implicit algorithms. The KS technique has been shown effective in the unsteady Navier-Stokes context in <ref> [CFS96] </ref>. In [CFS96], two of the same parameters explored herein (level of fill in the local ILU factorizations and subdomain overlap) are varied to produce a Schwarz preconditioner whose strength can be adjusted to adapt to the varying time-evolving ill-conditioning of the linear system arising at each implicit time step. <p> This work has been extended to three-dimensional problems in [NWAK95]. Large-scale time-dependent problems suffering from multiple scales often require parallel implicit algorithms. The KS technique has been shown effective in the unsteady Navier-Stokes context in <ref> [CFS96] </ref>. In [CFS96], two of the same parameters explored herein (level of fill in the local ILU factorizations and subdomain overlap) are varied to produce a Schwarz preconditioner whose strength can be adjusted to adapt to the varying time-evolving ill-conditioning of the linear system arising at each implicit time step.
Reference: [CGK94] <author> Cai X.-C., Gropp W. D., and Keyes D. E. </author> <title> (1994) A comparison of some domain decomposition and ILU preconditioned iterative methods for nonsymmetric elliptic problems. </title> <journal> Journal of Numerical Linear Algebra and Applications 1: </journal> <pages> 477-504. </pages>
Reference-contexts: The two-level form of additive Schwarz can be proved to possess mesh-independent and granularity-independent condition number in elliptically dominated problems, including nonsymmetric and indefinite problems, when the coarse global and fine local operators are solved with sufficient precision. Ref. <ref> [CGK94] </ref> contains several examples demonstrating this optimality when exact subdomain solvers are used, and thus shows their superiority to global incomplete LU factorizations. Architecturally adaptive strategies for dealing with the coarse-grid component of the preconditioner are outlined in [GK89].
Reference: [CGK95] <author> Cai X.-C., Gropp W. D., and Keyes D. E. </author> <title> (1995) Parallel implementation of Newton-Krylov-Schwarz algorithms for the transonic full potential equation. </title> <type> ICASE Technical Report, </type> <note> in preparation. </note>
Reference-contexts: The coarse grid is not necessarily nested in the underlying decomposition into subdomains, which would be an impractical restriction in real world problems with adaptively refined meshes. Full details may be found in <ref> [CGK95] </ref>; we summarize some representative trends. Consider the scalar nonlinear BVP r ((jjrjj)r) = 0; where = 1 1 + 2 1 (1 q 2 ) (fl1) and where q jjrjj. M 1 q 1 =a 1 is the free-stream Mach number.
Reference: [CGKT94] <author> Cai X.-C., Gropp W. D., Keyes D. E., and Tidriri M. D. </author> <title> (1994) Newton-Krylov-Schwarz methods in CFD. </title> <editor> In Hebeker F. and Rannacher R. </editor> <booktitle> (eds) Proceedings of an International Workshop on Numerical Methods for the Navier-Stokes Equations, </booktitle> <pages> pages 17-30. </pages> <publisher> Vieweg Verlag, Braunschweig. </publisher>
Reference-contexts: This is due to the relatively small communicationto-computation ratio for Krylov-Schwarz methods, and is encouraging for cost-effective large-scale CFD computations, at least for dedicated clusters. Parallel workstation cluster implementations <ref> [CGKT94] </ref> of structured-grid Euler problems reveal the vulnerability of highly synchronous algorithms, including Krylov methods with their frequent inner product calls, to a non-dedicated environment.
Reference: [CM94] <author> Chan T. F. and Mathew T. </author> <title> (1994) Domain decomposition algorithms. </title> <journal> Acta Numerica pages 61-143. </journal>
Reference-contexts: In turn, h and H can be inversely related to n and p in simple problems. The theory, which has evolved over a decade to cover nonsmooth, nonsymmetric and indefinite problems, as well as nonnested spaces, is digested among other places in <ref> [CM94] </ref> and [SBG95]. Two such numerically optimal methods for the scalar self-adjoint elliptic problem are the two-level additive Schwarz method [DW87] and BPS-I [BPS86], which is a wire root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) 6 X.-C. CAI, D. E. KEYES & V.
Reference: [DW87] <author> Dryja M. and Widlund O. B. </author> <title> (1987) An additive variant of the Schwarz alternating method for the case of many subregions. </title> <type> Technical Report 339, </type> <institution> Courant Institute, NYU. </institution>
Reference-contexts: A Newton-Krylov-Schwarz (NKS) method combines a Newton-Krylov (NK) method such as nonlinear GMRES [BS90], with a Krylov-Schwarz (KS) method, such as additive Schwarz <ref> [DW87] </ref>. The key linkage is provided by the Krylov method, of which the restarted form of GMRES [SS86] is perhaps the best-known example for nonselfadjoint problems. <p> The theory, which has evolved over a decade to cover nonsmooth, nonsymmetric and indefinite problems, as well as nonnested spaces, is digested among other places in [CM94] and [SBG95]. Two such numerically optimal methods for the scalar self-adjoint elliptic problem are the two-level additive Schwarz method <ref> [DW87] </ref> and BPS-I [BPS86], which is a wire root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) 6 X.-C. CAI, D. E. KEYES & V.
Reference: [GK89] <author> Gropp W. D. and Keyes D. E. </author> <title> (1989) Domain decomposition on parallel computers. </title> <booktitle> Impact of Computing in Science and Engineering 1: </booktitle> <pages> 421-439. </pages>
Reference-contexts: Ref. [CGK94] contains several examples demonstrating this optimality when exact subdomain solvers are used, and thus shows their superiority to global incomplete LU factorizations. Architecturally adaptive strategies for dealing with the coarse-grid component of the preconditioner are outlined in <ref> [GK89] </ref>. The collection [KX95] is representative of the state of the art of algorithms, applications, and parallel implementations. The NKS technique is compared in this paper against a defect correction algorithm common to many implicit codes.
Reference: [GMS95] <author> Gropp W. D., McInnes L. C., and Smith B. F. </author> <title> (1995) PETSc 2.0 users guide. </title> <type> Technical Report ANL 95/11, </type> <institution> Argonne National Laboratory. </institution>
Reference-contexts: A two-level Schwarz preconditioner was implemented on top of an early version of the PETSc <ref> [GMS95] </ref> library, offering variable-fill incomplete factorization, a variety of subdomain preconditionings, variable subdomain overlap, and a coarse grid of variable density. The coarse grid is not necessarily nested in the underlying decomposition into subdomains, which would be an impractical restriction in real world problems with adaptively refined meshes.
Reference: [Hir90] <author> Hirsch C. </author> <title> (ed) (1990) Numerical Computation of Internal and External Flows, </title> <journal> Vol. </journal> <volume> 2. </volume> <publisher> Wiley, </publisher> <address> Chichester. </address>
Reference-contexts: Under additional restrictive assumptions of irrotationality (v = r) and isentropy root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) 8 X.-C. CAI, D. E. KEYES & V. VENKATAKRISHNAN (r (p= fl ) = 0), one can derive <ref> [Hir90] </ref> a scalar equation for the velocity potential : r (r) = 0: (1:13) We report on a model computation based on (1.13), which has the advantage of being simple in structure, and hence relatively easy to test algorithmic varieties upon.
Reference: [Hwa93] <author> Hwang K. </author> <title> (1993) Advanced Computer Architectures: Parallelism, Scalability, </title> <journal> and Programmability (Chap. </journal> <volume> 3). </volume> <publisher> McGraw-Hill, </publisher> <address> New York. </address>
Reference-contexts: Without digressing into the refined nomenclature of scability analysis <ref> [Hwa93] </ref>, we loosely call an algorithm/architecture combination "scalable" if its parallel efficiency is constant asymptotically, in any of several coordinated limits of discrete problem size n and parallel granularity p.
Reference: [JF95] <author> Jiang H. and Forsyth P. A. </author> <title> (1995) Robust linear and nonlinear strategies for solution of the transonic Euler equations. </title> <booktitle> Computers & Fluids 24: </booktitle> <pages> 753-770. </pages>
Reference-contexts: A more comprehensive set of comparisons of this type, comparing (1.7), (1.8), and ( ~ J high ) 1 J high (u n ) ffiu = ( ~ J high ) 1 f high (u n ) (1:9) may be found in <ref> [JF95] </ref>. Of course, (1.9) relies on possessing the full high-order Jacobian, and is not a matrix-free method. We might mislead if we closed this section while failing to emphasize the importance of a globalization strategy when using any of the methods (1.7-1.9).
Reference: [Key95] <author> Keyes D. E. </author> <title> (1995) Aerodynamic applications of Newton-Krylov-Schwarz solvers. </title> <editor> In Narasimha R. </editor> <booktitle> (ed) Proceedings of the 14th International Conference on Numerical Methods in Fluid Dynamics. </booktitle> <publisher> Springer Verlag, </publisher> <address> New York. </address>
Reference-contexts: The NK technique has been compared with V-cycle multigrid on Euler and Navier-Stokes problems without parallelizing the preconditioning in <ref> [Key95, NWAK95] </ref>. For a subsonic unstructured grid example, NK trails multigrid in execution time by a factor of only about 1.5.
Reference: [KG87] <author> Keyes D. E. and Gropp W. D. </author> <title> (1987) A comparison of domain decomposition techniques for elliptic partial differential equations and their parallel implementation. </title> <journal> SIAM Journal of Scientific and Statistical Computing 8: </journal> <month> s166-s202. </month> <title> Domain Decomposition Methods in Sciences and Engineering Editor R. </title> <publisher> Glowinski c fl1996 John Wiley & Sons Ltd. root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, </publisher> <address> 12-1-1995) 16 REFERENCES </address>
Reference-contexts: Before presenting parallel CFD results, we illustrate the performance achievable by such methods on contemporary parallel systems. Implementation efficiencies have improved substantially since we conducted our first such study in 1985. A message-passing code for the Poisson problem on a unit square described in <ref> [KG87] </ref> was converted to MPI [MPI94] and ported to several machines. With convergence defined as five orders of magnitude reduction in (unpreconditioned) residual, as in [KG87], we tested both fixed-size scalability and fixed-memory-per-node scalability on an Intel Paragon with 1, 4, 16, or 64 subdomains, with one subdomain per processor. <p> A message-passing code for the Poisson problem on a unit square described in <ref> [KG87] </ref> was converted to MPI [MPI94] and ported to several machines. With convergence defined as five orders of magnitude reduction in (unpreconditioned) residual, as in [KG87], we tested both fixed-size scalability and fixed-memory-per-node scalability on an Intel Paragon with 1, 4, 16, or 64 subdomains, with one subdomain per processor. The results for a fixed-size 512 fi 512 grid are shown in Table 1.1.
Reference: [KM93] <author> Knoll D. A. and McHugh P. R. </author> <title> (1993) Inexact Newton's method solutions to the incompressible Navier-Stokes and energy equations using standard and matrix-free implementations. </title> <type> Technical Report 93-3332, </type> <institution> AIAA. </institution>
Reference-contexts: For a fuller discussion, see [BS90]. For numerical experiments demonstrating the importance of the relative scaling of h in the CFD context, see <ref> [KM93, NWAK95] </ref>.
Reference: [KX95] <author> Keyes D. E. and Xu J. </author> <booktitle> (eds) (1995) Proceedings of the Seventh International Conference on Domain Decomposition Methods. Number 180 in Contemporary Mathematics. AMS, </booktitle> <address> Providence. </address>
Reference-contexts: Ref. [CGK94] contains several examples demonstrating this optimality when exact subdomain solvers are used, and thus shows their superiority to global incomplete LU factorizations. Architecturally adaptive strategies for dealing with the coarse-grid component of the preconditioner are outlined in [GK89]. The collection <ref> [KX95] </ref> is representative of the state of the art of algorithms, applications, and parallel implementations. The NKS technique is compared in this paper against a defect correction algorithm common to many implicit codes.
Reference: [ML85] <author> Mulder W. and Leer B. V. </author> <title> (1985) Experiments with implicit upwind methods for the Euler equations. </title> <journal> Journal of Computational Physics 59: </journal> <pages> 232-246. </pages>
Reference-contexts: Both solvers utilize a residual-adaptive setting of the CFL number (related to the size of the time step ffit in the pseudo-transient code), known as "switched evolution/relaxation" (SER) <ref> [ML85] </ref>. Starting from some small initial CFL number, CFL is adaptively advanced according to: jjf (u) l1 jj : As jjf (u l )jj ! 0, ffit ! 1.
Reference: [MPI94] <author> MPI Forum (1994) MPI: </author> <title> A message-passing interface standard. </title> <journal> International Journal of Supercomputer Applications 8(3/4). </journal>
Reference-contexts: Before presenting parallel CFD results, we illustrate the performance achievable by such methods on contemporary parallel systems. Implementation efficiencies have improved substantially since we conducted our first such study in 1985. A message-passing code for the Poisson problem on a unit square described in [KG87] was converted to MPI <ref> [MPI94] </ref> and ported to several machines. With convergence defined as five orders of magnitude reduction in (unpreconditioned) residual, as in [KG87], we tested both fixed-size scalability and fixed-memory-per-node scalability on an Intel Paragon with 1, 4, 16, or 64 subdomains, with one subdomain per processor.
Reference: [NWAK95] <author> Nielsen E. J., Walters R. W., Anderson W. K., and Keyes D. E. </author> <title> (1995) Application of Newton-Krylov methodology to a three-dimensional unstructured Euler code. </title> <type> Technical Report 95-1733, </type> <institution> AIAA. </institution>
Reference-contexts: For a fuller discussion, see [BS90]. For numerical experiments demonstrating the importance of the relative scaling of h in the CFD context, see <ref> [KM93, NWAK95] </ref>. <p> 32 nodes of the Intel Paragon (right) for the defect correction scheme (dashed), and the NKS method (dotted). initially defect correction then switched to NKS when defect correction prohibits fast growth in CFL, may ultimately be much faster than either pure algorithm exclusively, as demonstrated for a related problem in <ref> [NWAK95] </ref>, and as found in preliminary experiments for the present problem.) The asymptotic convergence rate is shown to be linear, since we truncated the Newton iterations well above the tolerances necessary to guarantee superlinear or quadratic convergence. <p> The NK technique has been compared with V-cycle multigrid on Euler and Navier-Stokes problems without parallelizing the preconditioning in <ref> [Key95, NWAK95] </ref>. For a subsonic unstructured grid example, NK trails multigrid in execution time by a factor of only about 1.5. <p> This penalty can be accepted when it is realized that the NK method has the advantage of doing all of its computation without generation of a family of coarse unstructured grids (which is difficult for three-dimensional unstructured grids). This work has been extended to three-dimensional problems in <ref> [NWAK95] </ref>. Large-scale time-dependent problems suffering from multiple scales often require parallel implicit algorithms. The KS technique has been shown effective in the unsteady Navier-Stokes context in [CFS96].
Reference: [SBG95] <author> Smith B. F., Bjorstad P. E., and Gropp W. D. </author> <title> (1995) Domain Decomposition: Parallel Multilevel Algorithms for Elliptic Partial Differential Equations. </title> <publisher> Cambridge Univ. Press, </publisher> <address> Cambridge. </address>
Reference-contexts: In turn, h and H can be inversely related to n and p in simple problems. The theory, which has evolved over a decade to cover nonsmooth, nonsymmetric and indefinite problems, as well as nonnested spaces, is digested among other places in [CM94] and <ref> [SBG95] </ref>. Two such numerically optimal methods for the scalar self-adjoint elliptic problem are the two-level additive Schwarz method [DW87] and BPS-I [BPS86], which is a wire root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) 6 X.-C. CAI, D. E. KEYES & V.
Reference: [SS86] <author> Saad Y. and Schultz M. H. </author> <title> (1986) GMRES: A generalized minimal residual algorithm for solving nonsymmetric linear systems. </title> <journal> SIAM Journal of Scientific and Statistical Computing 7: </journal> <pages> 856-869. </pages>
Reference-contexts: A Newton-Krylov-Schwarz (NKS) method combines a Newton-Krylov (NK) method such as nonlinear GMRES [BS90], with a Krylov-Schwarz (KS) method, such as additive Schwarz [DW87]. The key linkage is provided by the Krylov method, of which the restarted form of GMRES <ref> [SS86] </ref> is perhaps the best-known example for nonselfadjoint problems.
Reference: [Ven94] <author> Venkatakrishnan V. </author> <title> (1994) Parallel implicit unstructured grid Euler solvers. </title> <journal> AIAA Journal 32: </journal> <pages> 1985-1991. </pages>
Reference-contexts: The fixed-size parallel efficiencies remain above 75% throughout the preconditioner parameter and granularity range considered. 1.4.2 Euler Flow The problem of inviscid incompressible flow around a two-dimensional four-element airfoil in landing configuration was studied in terms of convergence rate and parallel performance in <ref> [Ven94] </ref>, and the same code was converted to NKS form for the present study. The details of the discretization are left to the original reference. From [Ven94] we consider the vertex-based discretization with a first-order Roe scheme on the left (out of which we form ~ J 1 low ), and <p> problem of inviscid incompressible flow around a two-dimensional four-element airfoil in landing configuration was studied in terms of convergence rate and parallel performance in <ref> [Ven94] </ref>, and the same code was converted to NKS form for the present study. The details of the discretization are left to the original reference. From [Ven94] we consider the vertex-based discretization with a first-order Roe scheme on the left (out of which we form ~ J 1 low ), and a second-order Roe scheme on the right (which defines f high ). <p> However, the number of Krylov vectors per Newton iteration is bounded (at 2 restart cycles of 25 each), so the data translates directly to parallelization efficiency of the truncated Newton method. In this example, no coarse grid is used, but <ref> [Ven94] </ref> compares the defect correction form of the algorithm with and without a coarse grid. The coarse grid appears multiplicatively rather than additively, as in (1.1).
Reference: [YAM + 93] <author> Young D. P., Ashcraft C. C., Melvin R. G., Bieterman M. B., Huffman W. P., Johnson F. T., Hilmes C. L., and Bussoletti J. E. </author> <title> (1993) Ordering and incomplete factorization issues for matrices arising from the TRANAIR CFD code. </title> <type> Technical Report BCSTECH-93-025, </type> <institution> Boeing Computer Services. </institution>
Reference-contexts: However, there is a law of diminishing returns in convergence rate, and overall execution time actually increases after a minimum, as the cost per iteration begins to rise more rapidly than the number of iterations falls. It has been observed in other contexts for the same full potential equation <ref> [YAM + 93] </ref> that Schwarz methods are forgiving of inexactness in the individual subdomain solves. Furthermore, a factorization with a fixed level of fill is increasingly accurate as the subdomain over which it is defined gets smaller.
Reference: [YMB + 91] <author> Young D. P., Melvin R. G., Bieterman M. B., Johnson F. T., Samant S. S., and Bussoletti J. E. </author> <title> (1991) A locally refined rectangular grid finite element method: Application to computational fluid dynamics and computational physics. </title> <journal> Journal of Computational Physics 92: </journal> <pages> 1-66. </pages> <publisher> root 30/10/1995 21:39|PAGE PROOFS for John Wiley & Sons Ltd (jwbook.sty v3.0, 12-1-1995) </publisher>
Reference-contexts: In addition, artificial continuation parameters, such as upwinding strength, may enhance the convergence of globally divergent or slowly convergent iterations with near-discontinuities in the solution. For transonic potential computations, we have found invaluable the practical advice on "viscosity damping" in Section 8 of <ref> [YMB + 91] </ref>. 1.3 PARALLEL SCALABILITY OF KRYLOV-SCHWARZ Practical scalable parallelism is one of the major motivations for research on and implementation of domain decomposition methods in CFD, the operative buzzwords being "faster, bigger, and cheaper." Though it would be premature to attempt to draw conclusions about the optimal algorithm/architecture combination <p> See <ref> [YMB + 91] </ref>, which motivates our present study, for a more refined treatment of boundary conditions.
References-found: 25

