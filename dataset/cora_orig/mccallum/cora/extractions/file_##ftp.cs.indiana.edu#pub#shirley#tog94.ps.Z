URL: file://ftp.cs.indiana.edu/pub/shirley/tog94.ps.Z
Refering-URL: http://www.cs.indiana.edu/hyplan/kuzimmer.html
Root-URL: http://www.cs.indiana.edu
Title: Monte Carlo Techniques for Direct Lighting Calculations  on Graphics  
Author: Peter Shirley Changyaw Wang Kurt Zimmerman 
Keyword: CR Categories and Subject Descriptors: G.1.4 [Mathematical Computing]: Quadrature and Numerical Differentiation; I.3.0 [Computer Graphics]: General; I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism. Additional Key Words and Phrases: direct lighting, importance sampling, luminaires, Monte Carlo integration, ray tracing, realistic image synthesis.  
Address: Ithaca, NY 14853  110 Richmond Street East Toronto, Canada M5C 1P1  Lindley Hall  Bloomington, IN 47405  
Affiliation: Program of Computer Graphics 580 Engineering and Theory Center Cornell University  Alias Research Inc.  Department of Computer Science  Indiana University  
Note: To Appear in ACM Transactions  
Abstract: In a distribution ray tracer, the crucial part of the direct lighting calculation is the sampling strategy for shadow ray testing. Monte Carlo integration with importance sampling is used to carry out this calculation. Importance sampling involves the design of integrand-specific probability density functions which are used to generate sample points for the numerical quadrature. Probability density functions are presented that aid in the direct lighting calculation from luminaires of various simple shapes. A method for defining a probability density function over a set of luminaires is presented that allows the direct lighting calculation to be carried out with one sample, regardless of the number of luminaires. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> John M. Airey and Ming Ouh-young. </author> <title> Two adaptive techniques let progressive radiosity outperform the traditional radiosity algorithm. </title> <type> Technical Report TR89-20, </type> <institution> University of North Carolina at Chapel Hill, </institution> <month> August </month> <year> 1989. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques <ref> [1, 39, 3, 20, 29] </ref>. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29]. <p> For example, the quantity f () = 2 is more likely to have a value near zero than one, so it must have a nonuniform density function. We can reverse-engineer what f (x) must be to get a sample with desired density function - : <ref> [ 0 ; 1 ] </ref> ! IR. This will be P 1 ( ) where P : [ 0 ; 1 ] ! [0; 1] is given by P ( ) = 0 The function P is often called the cumulative probability distribution function associated with the probability density function because <p> We can reverse-engineer what f (x) must be to get a sample with desired density function - : <ref> [ 0 ; 1 ] </ref> ! IR. This will be P 1 ( ) where P : [ 0 ; 1 ] ! [0; 1] is given by P ( ) = 0 The function P is often called the cumulative probability distribution function associated with the probability density function because P ( ) is the probability that a random variable with density has a value less than <p> We can reverse-engineer what f (x) must be to get a sample with desired density function - : [ 0 ; 1 ] ! IR. This will be P 1 ( ) where P : [ 0 ; 1 ] ! <ref> [0; 1] </ref> is given by P ( ) = 0 The function P is often called the cumulative probability distribution function associated with the probability density function because P ( ) is the probability that a random variable with density has a value less than or equal to . <p> For a two dimensional probability density function - : <ref> [ 0 ; 1 ] </ref> fi [o 0 ; o 1 ] ! IR + , where is defined with respect to measure d ( ; o ) = m ( ; o )d do , we can do a similar transformation by using the marginal density function - : [ <p> <ref> [ 0 ; 1 ] </ref> fi [o 0 ; o 1 ] ! IR + , where is defined with respect to measure d ( ; o ) = m ( ; o )d do , we can do a similar transformation by using the marginal density function - : [ 0 ; 1 ] ! IR + : - ( ) = o 0 The function is a valid density function that represents the density of values without reference to o . <p> In the special case where -m is separable, meaning -( ; o )m ( ; o ) can be expressed as b 1 ( )b 2 (o ), where both b 1 : <ref> [ 0 ; 1 ] </ref> ! IR + and b 2 : [o 0 ; o 1 ] ! IR + are probability density functions, then we can chose i = B 1 1 ( i ) and o i = B 1 2 ( i+1 ), where B 1 is
Reference: [2] <author> James Arvo, Kenneth Torrance, and Brian Smits. </author> <title> A framework for the analysis of error in global illumination algorithms. </title> <journal> Computer Graphics, </journal> <volume> 28(3), </volume> <month> July </month> <year> 1994. </year> <booktitle> ACM Siggraph '94 Conference Proceedings. </booktitle>
Reference-contexts: To solve this problem, authors commonly refer to "incoming" and "outgoing" radiance. Because the outgoing radiance is what we perceive when we look at a surface, the outgoing radiance is sometime called "surface radiance", and the incoming radiance from the "field" is called "field radiance" <ref> [2] </ref>. For transparent surfaces, both the surface and field radiances are defined on all directions in fl.
Reference: [3] <author> Shenchang Eric Chen, Holly Rushmeier, Gavin Miller, and Douglass Turner. </author> <title> A progressive multi-pass method for global illumination. </title> <journal> Computer Graphics, </journal> <volume> 25(4) </volume> <pages> 165-174, </pages> <month> July </month> <year> 1991. </year> <booktitle> ACM Siggraph '91 Conference Proceedings. </booktitle>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques <ref> [1, 39, 3, 20, 29] </ref>. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29].
Reference: [4] <author> K. Chiu, M. Herf, P. Shirley, S. Swamy, C. Wang, and K. Zimmerman. </author> <title> Spatially nonuniform scaling functions for high contrast images. </title> <booktitle> In Graphics Interface '93, </booktitle> <pages> pages 245-244, </pages> <month> May </month> <year> 1993. </year>
Reference-contexts: Such a threshold will ensure that any luminaire that can change 9 L w should be chosen according to a perceptual viewer model, such as the model implemented by Tumblin and Rushmeier [42]. L w may also vary from pixel to pixel if spatially varying mappings are used <ref> [4] </ref>. Such models will become increasingly important as physically based rendering becomes more popular. 20 contribute significantly to the surface radiance of a point in that cell. the pixel color more than a few steps will be included in L bright .
Reference: [5] <author> Kennth Chiu, Peter Shirley, and Changyaw Wang. </author> <title> Multi-jittered sampling. </title> <editor> In Paul Heckbert, editor, </editor> <title> Graphics Gems 4. </title> <publisher> Academic Press, </publisher> <address> New York, NY, </address> <year> 1993. </year>
Reference-contexts: advantage to have 1 stratified in one dimension, as well as having the pair ( 1 ; 2 ) stratified in two dimensions, so that the ` i we choose will be stratified over many ( 1 ; 2 ) pairs, so some multijittered sampling method may be helpful (e.g <ref> [5] </ref>).
Reference: [6] <author> Robert L. Cook. </author> <title> Stochastic sampling in computer graphics. </title> <journal> ACM Transactions on Graphics, </journal> <volume> 5(1) </volume> <pages> 51-72, </pages> <month> January </month> <year> 1986. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> Intuitively, stratification will pay off when f varies slowly relative to the distance between adjacent sample points. Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. <ref> [6, 24, 31] </ref>). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure [50, 48, 24, 34] rather than in terms of variance. <p> If there is some regularity in how these points are generated (e.g. the first point is in a particular corner of canonical space), then the mapping between pairs should be random <ref> [6] </ref>. 17 1 . 4.2 Linear ff i Suppose we had perfect p i defined for all the luminaires. A zero variance solution would then result if we could set ff i / L i , where L i is the contribution from the ith luminaire.
Reference: [7] <author> Robert L. Cook, Thomas Porter, and Loren Carpenter. </author> <title> Distributed ray tracing. </title> <journal> Computer Graphics, </journal> <volume> 18(4) </volume> <pages> 165-174, </pages> <month> July </month> <year> 1984. </year> <booktitle> ACM Siggraph '84 Conference Proceedings. </booktitle>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper <ref> [7] </ref> on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> The direct lighting component of this radiance is a two-dimensional integral (as opposed to an integral equation) over the set of all points in the scene. As shown by Cook et al. <ref> [7] </ref>, this direct lighting integral is a natural target for Monte Carlo integration [13, 17]. A difficult question in any application of Monte Carlo integration is what probability density function should be used to generate sample points on the domain of integration. <p> This can be thought of as a special case of geometric simplification as used by Rushmeier et al. [29]. 4 Direct Lighting from Many Luminaires Traditionally, when N L luminaires are in a scene, the direct lighting integral is broken into N L separate integrals <ref> [7] </ref>. This implies at least N L samples must be taken to approximate the direct lighting, or some 15 16 bias must be introduced (as done by Ward where small value samples are not calculated [45]).
Reference: [8] <author> Julie O'B. Dorsey, Francois X. Sillion, and Donald P. Greenberg. </author> <title> Design and simulation of opera lighting and projection effects. </title> <journal> Computer Graphics, </journal> <volume> 25(4) </volume> <pages> 41-50, </pages> <month> July </month> <year> 1991. </year> <booktitle> ACM Siggraph '91 Conference Proceedings. </booktitle>
Reference-contexts: Such scenes are becoming increasingly important. In outdoor scenes, especially in urban settings, scenes with thousands and even hundreds of thousands of luminaires are commonplace. In opera and theater applications, hundreds or thousands of luminaires are common <ref> [8] </ref>. In infrared scenes, almost all surfaces are luminaires, so something such as the light octree is crucial. These methods also make it easy to use luminaires defined by many polygons or parametric patches.
Reference: [9] <author> Andrew S. Glassner. </author> <title> Space subdivision for fast ray tracing. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 4(10) </volume> <pages> 15-22, </pages> <year> 1984. </year>
Reference-contexts: The stratification of the scene into boxes is arbitrary. An easy way to choose the subdivision cells is to use the leaf cells of the conventional subdivision structure (e.g. the octree leaves of a Glassner style octree used for ray intersection acceleration <ref> [9] </ref>), and maintain a separate L bright list at each leaf. This is a finer than needed subdivision for scenes where the number of objects is much greater than the number of luminaires.
Reference: [10] <author> Andrew S. Glassner. </author> <title> Principles of Digital Image Synthesis. </title> <address> Morgan-Kaufman, San Francisco, </address> <year> 1994. </year>
Reference-contexts: In practice, this is a reasonable approximation to the human-observable behavior of visible light for many scenes <ref> [10] </ref>. 3 The notation (-) = 1 means that the measure of is one, and is equivalent to the notation R S -( )d ( ) = 1. We will occasionally use the symbol d ( ) in isolation. <p> For example, Figure 7 shows a room lit by flourescent fixtures that are approximated by rectangles for the lighting calculations at other surfaces. This idea is used extensively in Ward's Radiance program [46], where the far-field photometry of the entire fixture is known (see <ref> [10] </ref> for details on getting CIE or IES standard far-field photometry for real luminaires) and the luminaire is displayed with a complex geometry.
Reference: [11] <author> Eric Haines. </author> <title> Essential ray tracing algorithms. </title> <editor> In Andrew S. Glassner, editor, </editor> <title> An Introduction to Ray Tracing, </title> <address> pages 33-77. </address> <publisher> Academic Press, </publisher> <address> San Diego, CA, </address> <year> 1989. </year>
Reference-contexts: This test can be accomplished using a ray test in the plane of the polygon <ref> [11] </ref>, which works for all polygons, even those with holes.
Reference: [12] <author> John H. Halton. </author> <title> A retrospective and prospective of the monte carlo method. </title> <journal> SIAM Review, </journal> <volume> 12(1) </volume> <pages> 1-63, </pages> <month> January </month> <year> 1970. </year> <month> 26 </month>
Reference-contexts: Most of the basic Monte Carlo material of this section is also covered in several of the classic texts <ref> [13, 38, 12, 49] </ref>.
Reference: [13] <author> J. M. Hammersley and D. C. Handscomb. </author> <title> Monte Carlo Methods. </title> <publisher> Wiley, </publisher> <address> New York, N.Y., </address> <year> 1964. </year>
Reference-contexts: The direct lighting component of this radiance is a two-dimensional integral (as opposed to an integral equation) over the set of all points in the scene. As shown by Cook et al. [7], this direct lighting integral is a natural target for Monte Carlo integration <ref> [13, 17] </ref>. A difficult question in any application of Monte Carlo integration is what probability density function should be used to generate sample points on the domain of integration. This is especially difficult in the direct lighting calculation where the domain is typically all surfaces in a complex three-dimensional environment. <p> Most of the basic Monte Carlo material of this section is also covered in several of the classic texts <ref> [13, 38, 12, 49] </ref>. <p> This basic method has been in use since at least the 1950s <ref> [13] </ref>, and was first used in image synthesis by Ward et al. to generate reflection rays with a cosine density [47]. Note that P 1 will always exist, but may not be analytical, in which case numerical function inversion must be used.
Reference: [14] <author> David S. Immel, Michael F. Cohen, and Donald P. Greenberg. </author> <title> A radiosity method for non-diffuse environments. </title> <journal> Computer Graphics, </journal> <volume> 20(4) </volume> <pages> 133-142, </pages> <month> August </month> <year> 1986. </year> <booktitle> ACM Siggraph '86 Conference Proceedings. </booktitle>
Reference-contexts: It can be written down in terms of all directions ^! 0 visible to x (as done by Immel <ref> [14] </ref>): L s (x; ^!) = L e (x; ^!) + 0 where L s (x; ^!) is the surface radiance 5 of x in direction ^!, L e (x; ^!) is the emitted surface radiance in direction ^! at x, 0 is the unit hemisphere of incoming directions oriented about
Reference: [15] <institution> American National Standard Institute. Nomenclature and definitions for illumination engineering. </institution> <note> ANSI Report, 1986. ANSI/IES RP-16-1986. </note>
Reference-contexts: As shown by Kajiya [16], the radiance <ref> [15, 27] </ref> at a point in a scene can be written down as an integral equation over the set of all points in the environment 2 . <p> surface radiance in direction ^! at x, 0 is the unit hemisphere of incoming directions oriented about ^n, ae (x; ^!; ^! 0 ) is the BRDF 4 In this paper we use the a slight variant of the radiometric terms and symbols standardized by the Illumination Engineering Society (IES) <ref> [15, 27] </ref>. To simplify notation, we drop the spectral term even though all of the radiometric quantities we use are spectral quantities.
Reference: [16] <author> James T. Kajiya. </author> <title> The rendering equation. </title> <journal> Computer Graphics, </journal> <volume> 20(4) </volume> <pages> 143-150, </pages> <month> August </month> <year> 1986. </year> <booktitle> ACM Siggraph '86 Conference Proceedings. </booktitle>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> As shown by Kajiya <ref> [16] </ref>, the radiance [15, 27] at a point in a scene can be written down as an integral equation over the set of all points in the environment 2 . <p> This leads to other way the rendering equation is often written as integral equation over all surfaces (as done by Kajiya <ref> [16] </ref> 6 ): Z g (x; x 0 )ae (x; ^!; ^! 0 )L s (x 0 ; ^! 0 )(^! 0 ^n) k x x 0 k where X is the set of all points on surfaces and g (x; x 0 ) is the geometry term, which is zero <p> The question remaining is what to use for ff i . 4.1 Constant ff i The simplest way to choose values for ff i was proposed by Lange [21] (and this method is also implied in the figure on page 148 of <ref> [16] </ref>), where all weights are made equal: ff i = 1=N L for all i. This would definitely make a valid estimator because the ff i sum to one and none of them is zero. <p> The basic rationale for the techniques presented in this paper is that direct lighting should not be calculated to a higher accuracy than necessary. This is very similar in concept to Kajiya's argument that we should not expend much work for deep parts of the ray tree <ref> [16] </ref>. It is certainly not always true that one shadow ray per viewing ray is optimal, however. For the 100 luminaire case, one shadow ray is better than 100 shadow rays, but two or three might be better still. This issue requires further investigation.
Reference: [17] <author> Malvin H. Kalos and Paula A. Whitlock. </author> <title> Monte Carlo Methods. </title> <publisher> John Wiley and Sons, </publisher> <address> New York, N.Y., </address> <year> 1986. </year>
Reference-contexts: The direct lighting component of this radiance is a two-dimensional integral (as opposed to an integral equation) over the set of all points in the scene. As shown by Cook et al. [7], this direct lighting integral is a natural target for Monte Carlo integration <ref> [13, 17] </ref>. A difficult question in any application of Monte Carlo integration is what probability density function should be used to generate sample points on the domain of integration. This is especially difficult in the direct lighting calculation where the domain is typically all surfaces in a complex three-dimensional environment.
Reference: [18] <author> David Kirk and James Arvo. </author> <title> Unbiased variance reduction for global illumination. </title> <booktitle> In Proceedings of the Second Eurographics Workshop on Rendering, </booktitle> <year> 1991. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> The issues involved in choosing between Equations 14 and 15 are discussed in more detail in [37]. Several of the examples used in this section have been used by other authors (e.g. <ref> [18, 21, 25] </ref>) who use the same transformation strategies. 3.1 Designing Probability Density Functions In designing a density function p (x 0 ) to use in Equation 15, we can immediately set p (x 0 ) = 0 wherever L e (x 0 ; ^! 0 ) = 0 (all points
Reference: [19] <author> A. Kok and F. Jansen. </author> <title> Source selection for the direct lighting calculation in global illumination. </title> <booktitle> In Proceedings of the Second Eurographics Workshop on Rendering, </booktitle> <year> 1991. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> The difficult part of this method is deciding which luminaires are in L bright for a particular x. As pointed out by Kok and Jansen <ref> [19] </ref>, a luminaire that is responsible for a large fraction of the radiance of x is likely to be responsible for a large fraction of the radiance of the neighboring points of x. <p> An example of an imposter is a luminaire with zero reflectivity that is shaped like a reflecting patch and emits light in roughly the same distribution and intensity as the reflecting patch reflects light. This concept has been used by Kok and Jansen <ref> [19] </ref>, Chen et al.[3], Rushmeier et al. [29] and Ward [46]. Adding an imposter reduces the number of patches whose reflected light needs to be calculated and increases the number of luminaires.
Reference: [20] <author> Arjan J. F. Kok and Frederik W. Jasen. </author> <title> Adaptive sampling of area light sources in ray tracing including diffuse interreflection. </title> <journal> Computer Graphics forum, </journal> <volume> 11(3) </volume> <pages> 289-298, </pages> <year> 1992. </year> <note> Eurographics '92. </note>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques <ref> [1, 39, 3, 20, 29] </ref>. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29].
Reference: [21] <author> Brigitta Lange. </author> <title> The simulation of radiant light transfer with stochastic ray-tracing. </title> <booktitle> In Proceedings of the Second Eurographics Workshop on Rendering, </booktitle> <year> 1991. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29]. <p> The issues involved in choosing between Equations 14 and 15 are discussed in more detail in [37]. Several of the examples used in this section have been used by other authors (e.g. <ref> [18, 21, 25] </ref>) who use the same transformation strategies. 3.1 Designing Probability Density Functions In designing a density function p (x 0 ) to use in Equation 15, we can immediately set p (x 0 ) = 0 wherever L e (x 0 ; ^! 0 ) = 0 (all points <p> When ae (x; ^!; ^! 0 ) is the most important term, we want p / ae (x; ^!; ^! 0 ) as in <ref> [45, 21] </ref> and when L e (x 0 ; ^! 0 ) is the key factor, we want to use p / L e (x 0 ; ^! 0 ). There are many luminaire shapes we have not discussed that might be of interest. <p> The question remaining is what to use for ff i . 4.1 Constant ff i The simplest way to choose values for ff i was proposed by Lange <ref> [21] </ref> (and this method is also implied in the figure on page 148 of [16]), where all weights are made equal: ff i = 1=N L for all i. This would definitely make a valid estimator because the ff i sum to one and none of them is zero.
Reference: [22] <author> Mark E. Lee, Richard A. Redner, and Samuel P. Uselton. </author> <title> Statistically optimized sampling for distributed ray tracing. </title> <journal> Computer Graphics, </journal> <volume> 19(3) </volume> <pages> 61-68, </pages> <month> July </month> <year> 1985. </year> <booktitle> ACM Siggraph '85 Conference Proceedings. </booktitle>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29].
Reference: [23] <author> Thomas J. V. Malley. </author> <title> A shading method for computer generated images. </title> <type> Master's thesis, </type> <institution> University of Utah, </institution> <month> June </month> <year> 1988. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods <ref> [23, 35] </ref>, and hybrid techniques [1, 39, 3, 20, 29]. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29].
Reference: [24] <author> Don P. Mitchell. </author> <title> Spectrally optimal sampling for distribution ray tracing. </title> <journal> Computer Graphics, </journal> <volume> 25(4), </volume> <month> July </month> <year> 1991. </year> <booktitle> Siggraph '91 Conference Proceedings. </booktitle>
Reference-contexts: Intuitively, stratification will pay off when f varies slowly relative to the distance between adjacent sample points. Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. <ref> [6, 24, 31] </ref>). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure [50, 48, 24, 34] rather than in terms of variance. <p> Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. [6, 24, 31]). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure <ref> [50, 48, 24, 34] </ref> rather than in terms of variance. However, in practice it is often convenient to develop a sampling strategy using variance analysis on random samples, and then to turn around and use non-random, but equidistributed samples in an implementation.
Reference: [25] <author> S. N. Pattanaik. </author> <title> Computational Methods for Global Illumination and Visualization of Complex 3D Environments. </title> <type> PhD thesis, </type> <institution> Birla Institute of Technology & Science, </institution> <month> February </month> <year> 1993. </year>
Reference-contexts: The issues involved in choosing between Equations 14 and 15 are discussed in more detail in [37]. Several of the examples used in this section have been used by other authors (e.g. <ref> [18, 21, 25] </ref>) who use the same transformation strategies. 3.1 Designing Probability Density Functions In designing a density function p (x 0 ) to use in Equation 15, we can immediately set p (x 0 ) = 0 wherever L e (x 0 ; ^! 0 ) = 0 (all points
Reference: [26] <author> Werner Purgathofer. </author> <title> A statistical method for adaptive stochastic sampling. </title> <journal> Computers & Graphics, </journal> <volume> 11(2) </volume> <pages> 157-162, </pages> <year> 1987. </year>
Reference: [27] <author> Mark S. </author> <title> Rea, editor. </title> <booktitle> The Illumination Engineering Society Lighting Handbook. Illumination Engineering Society, </booktitle> <address> New York, NY, 8th edition, </address> <year> 1993. </year>
Reference-contexts: As shown by Kajiya [16], the radiance <ref> [15, 27] </ref> at a point in a scene can be written down as an integral equation over the set of all points in the environment 2 . <p> surface radiance in direction ^! at x, 0 is the unit hemisphere of incoming directions oriented about ^n, ae (x; ^!; ^! 0 ) is the BRDF 4 In this paper we use the a slight variant of the radiometric terms and symbols standardized by the Illumination Engineering Society (IES) <ref> [15, 27] </ref>. To simplify notation, we drop the spectral term even though all of the radiometric quantities we use are spectral quantities.
Reference: [28] <author> Jon Rokne. </author> <title> The area of a simple polygon. </title> <editor> In James Arvo, editor, </editor> <booktitle> Graphics Gems II, </booktitle> <pages> pages 5-6. </pages> <publisher> Academic Press, </publisher> <address> San Diego, CA, </address> <year> 1991. </year>
Reference-contexts: This test can be accomplished using a ray test in the plane of the polygon [11], which works for all polygons, even those with holes. This probability density function is just the inverse of the polygon area, which can be found using Stoke's Theorem <ref> [28] </ref>. 11 1 (uniform on visible portion; top right), p 2 (bottom left) and p 3 (bottom right). 12 3.3.2 Sampling Disk Luminaires To choose a random sample from a disk, we suppose its center is at the c, the radius is r, and ^n 0 = ^w in its ^u^v
Reference: [29] <author> Holly Rushmeier, Charles Patterson, and Aravindan Veerasamy. </author> <title> Geometric simplification for indirect illumination calculations. </title> <booktitle> In Graphics Interface '93, </booktitle> <pages> pages 227-236, </pages> <month> May </month> <year> 1993. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques <ref> [1, 39, 3, 20, 29] </ref>. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29]. <p> Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table <ref> [47, 29] </ref>. This paper extends traditional Monte Carlo methods for carrying out the direct lighting calculation so that they can be applied to scenes with hundreds or thousands of luminaires (light emitting objects). <p> This can be thought of as a special case of geometric simplification as used by Rushmeier et al. <ref> [29] </ref>. 4 Direct Lighting from Many Luminaires Traditionally, when N L luminaires are in a scene, the direct lighting integral is broken into N L separate integrals [7]. <p> This concept has been used by Kok and Jansen [19], Chen et al.[3], Rushmeier et al. <ref> [29] </ref> and Ward [46]. Adding an imposter reduces the number of patches whose reflected light needs to be calculated and increases the number of luminaires.
Reference: [30] <author> Holly E. Rushmeier. </author> <title> Realistic Image Synthesis for Scenes with Radiatively Participating Media. </title> <type> PhD thesis, </type> <institution> Cornell University, </institution> <month> May </month> <year> 1988. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods <ref> [22, 6, 16, 18, 21, 19, 30] </ref>, zonal (view-independent) methods [23, 35], and hybrid techniques [1, 39, 3, 20, 29].
Reference: [31] <author> Christophe Schlick. </author> <title> The acne problem. Ray Tracing News, </title> <type> 4(1), </type> <month> March </month> <year> 1991. </year> <note> e-mail Edition, available under anonymous ftp from weedeater.math.yale.edu. </note>
Reference-contexts: Intuitively, stratification will pay off when f varies slowly relative to the distance between adjacent sample points. Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. <ref> [6, 24, 31] </ref>). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure [50, 48, 24, 34] rather than in terms of variance.
Reference: [32] <author> Peter Shirley. </author> <title> Physically Based Lighting Calculations for Computer Graphics. </title> <type> PhD thesis, </type> <institution> University of Illinois at Urbana-Champaign, </institution> <month> November </month> <year> 1990. </year> <month> 27 </month>
Reference-contexts: This function is not defined at boundaries between materials (i.e. at surfaces) because the light abruptly changes direction <ref> [32] </ref>. To solve this problem, authors commonly refer to "incoming" and "outgoing" radiance. Because the outgoing radiance is what we perceive when we look at a surface, the outgoing radiance is sometime called "surface radiance", and the incoming radiance from the "field" is called "field radiance" [2].
Reference: [33] <author> Peter Shirley. </author> <title> A ray tracing algorithm for global illumination. </title> <booktitle> In Graphics Interface '90, </booktitle> <pages> pages 205-212, </pages> <month> May </month> <year> 1990. </year>
Reference-contexts: Figure 9 shows a scene with 100 rectangular luminaires sampled with 49 rays per pixel using the linear method. This method of setting ff i was first used in <ref> [33] </ref>, and was first theoretically justified in [36]. Implementing the linear ff i method has several subtleties. We implemented a method for each type of luminaire that estimated L i for a particular x and ae (x; ^!; ^! 0 ). <p> This will make ff i take the one value that is not allowed: an incorrect zero. Such a bug will become obvious in pictures of spheres illuminated by luminaires that subtend large solid angles, but for many scenes such errors are not noticeable (the figures in <ref> [33] </ref> had this bug, but it was not noticeable). To overcome this problem, we make sure that for a polygonal luminaires all of its vertices are below the horizon before it is given a zero probability of being sampled.
Reference: [34] <author> Peter Shirley. </author> <title> Discrepancy as a quality measure for sampling distributions. </title> <booktitle> In Eurographics '91, </booktitle> <pages> pages 183-193, </pages> <month> September </month> <year> 1991. </year>
Reference-contexts: Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. [6, 24, 31]). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure <ref> [50, 48, 24, 34] </ref> rather than in terms of variance. However, in practice it is often convenient to develop a sampling strategy using variance analysis on random samples, and then to turn around and use non-random, but equidistributed samples in an implementation.
Reference: [35] <author> Peter Shirley, Kelvin Sung, and William Brown. </author> <title> A ray tracing framework for global illumination. </title> <booktitle> In Graphics Interface '91, </booktitle> <pages> pages 117-128, </pages> <month> June </month> <year> 1991. </year>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods <ref> [23, 35] </ref>, and hybrid techniques [1, 39, 3, 20, 29]. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29].
Reference: [36] <author> Peter Shirley and Changyaw Wang. </author> <title> Direct lighting by monte carlo integration. </title> <booktitle> In Proceedings of the Second Eurographics Workshop on Rendering, </booktitle> <year> 1991. </year>
Reference-contexts: Figure 9 shows a scene with 100 rectangular luminaires sampled with 49 rays per pixel using the linear method. This method of setting ff i was first used in [33], and was first theoretically justified in <ref> [36] </ref>. Implementing the linear ff i method has several subtleties. We implemented a method for each type of luminaire that estimated L i for a particular x and ae (x; ^!; ^! 0 ).
Reference: [37] <author> Peter Shirley and Changyaw Wang. </author> <title> Distribution ray tracing: Theory and practice. </title> <booktitle> In Proceedings of the Third Eurographics Workshop on Rendering, </booktitle> <pages> pages 200-209, </pages> <year> 1992. </year>
Reference-contexts: For reflection rays from specular or near-specular surfaces it is usually more natural to use Equation 14, but we will not address reflection rays in this paper. The issues involved in choosing between Equations 14 and 15 are discussed in more detail in <ref> [37] </ref>. <p> Because specular surfaces are usually handled using reflection rays (and thus Equation 12. See <ref> [37] </ref> for details) rather than shadow rays, we can expect ae max to not be extremely large. In Figure 11, a set of luminaires and their regions of importance are shown. The stratification of the scene into boxes is arbitrary. <p> Instead, people often either choose uniform -, or set -( ) = w ( )[6, 26, 21]. This section extends arguments in <ref> [37] </ref> that letting -( ) = w ( ) is in some sense optimal. In graphics we usually repeatedly perform an integral for every member of a set F = ff 1 ; f 2 ; : : :; f n g.
Reference: [38] <author> Y. A. Shreider. </author> <title> The Monte Carlo Method. </title> <publisher> Pergamon Press, </publisher> <address> New York, N.Y., </address> <year> 1966. </year>
Reference-contexts: Most of the basic Monte Carlo material of this section is also covered in several of the classic texts <ref> [13, 38, 12, 49] </ref>.
Reference: [39] <author> Francois X. Sillion and Claude Puech. </author> <title> A general two-pass method integrating specular and diffuse reflection. </title> <journal> Computer Graphics, </journal> <volume> 23(3) </volume> <pages> 335-344, </pages> <month> July </month> <year> 1989. </year> <booktitle> ACM Siggraph '89 Conference Proceedings. </booktitle>
Reference-contexts: 1 Introduction Monte Carlo Methods have been used extensively for image rendering since Cook et al.'s landmark paper [7] on distribution ray tracing. Monte Carlo techniques have been used in classic ray tracing (view-dependent) methods [22, 6, 16, 18, 21, 19, 30], zonal (view-independent) methods [23, 35], and hybrid techniques <ref> [1, 39, 3, 20, 29] </ref>. Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table [47, 29].
Reference: [40] <author> Jerome Spanier and Earl H. Maize. </author> <title> Quasi-random methods for estimating integrals using relatively small samples. </title> <journal> SIAM Review, </journal> <volume> 36(1) </volume> <pages> 18-44, </pages> <month> March </month> <year> 1994. </year>
Reference-contexts: Our method is designed to work with tens to thousands of samples for each numerical quadrature, and technically this is a "low sampling density", meaning that the results of traditional asymptotic analysis are not directly applicable. Instead, we follow the advice of Spanier and Maize <ref> [40] </ref> and focus on the design of probability 1 Lighting is often separated into three components in image synthesis programs: emitted (or self-emitted) lighting that originates at an object (called a luminaire), direct lighting that consists of light emitted from a luminaire and reflected from exactly one surface before reaching the
Reference: [41] <author> D. M. Titterington, A. F. M. Smith, and U. E. Makov. </author> <title> The Statistical Analysis of Finite Mixture Distributions. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, NY, </address> <year> 1985. </year>
Reference-contexts: These functions can be combined into a single mixture density <ref> [41] </ref> over both lights by applying a weighted average: p (x 0 ) = ffp 1 (x 0 ) + (1 ff)p 2 (x 0 ) where ff 2 (0; 1).
Reference: [42] <author> Jack Tumblin and Holly Rushmeier. </author> <title> Tone reproduction for realistic computer generated images. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 13(7), </volume> <year> 1993. </year>
Reference-contexts: Such a threshold will ensure that any luminaire that can change 9 L w should be chosen according to a perceptual viewer model, such as the model implemented by Tumblin and Rushmeier <ref> [42] </ref>. L w may also vary from pixel to pixel if spatially varying mappings are used [4].
Reference: [43] <author> Changyaw Wang. </author> <title> Physically correct direct lighting for distribution ray tracing. </title> <editor> In David Kirk, editor, </editor> <title> Graphics Gems 3. </title> <publisher> Academic Press, </publisher> <address> New York, NY, </address> <year> 1992. </year>
Reference-contexts: (x 0 ): q (^! 0 ) = k x x 0 k So we can solve for p 2 (x 0 ): p 2 (x 0 ) = 2k x x 0 k r i kxck j 2 For further details on sampling the sphere with p 2 see <ref> [43] </ref>. 3.2.3 Cosine-Weighted Solid Angle: To bring the (^! 0 ^n) term into the density function we again use the space of directions: q 3 (^! 0 ) / (^! 0 ^n).
Reference: [44] <author> Changyaw Wang. </author> <title> The Direct Lighting calculation in Global Illumination Methods. </title> <type> PhD thesis, </type> <institution> Indiana University, </institution> <month> November </month> <year> 1993. </year>
Reference-contexts: More details on the derivations of the material in this section can be found in <ref> [44] </ref>. 3.2 Sampling Spherical Luminaires In this section we will discuss three different density functions that could be used to choose samples on a spher ical luminaire with radius r and center c = (c x ; c y ; c z ). <p> luminaire is entirely above the horizon, then it is also possible to choose a random point with density p 6 (x 0 ) / (^! 0 ^n 0 )k ! 2 ! 2 but the evaluation of p 6 and p 7 are costly, and their implementation is difficult (see <ref> [44] </ref> for details). One sample per pixel images using p 5 , p 6 , and p 7 are shown in Figure 5. <p> Details on using p 9 can be found in <ref> [44] </ref>. 7 Three barycentric coordinates are often used with x 0 = [o + ff ( ! p 0 o) + fi ( ! p 1 o) + fl ( ! p 2 o)], where o is the coordinate origin and ff + fi + fl = 1.
Reference: [45] <author> Greg Ward. </author> <title> Adaptive shadow testing for ray tracing. </title> <booktitle> In Proceedings of the Second Eurographics Workshop on Rendering, </booktitle> <year> 1991. </year>
Reference-contexts: This makes ray tracing feasible for scenes with many luminaires. This method is most suitable for images where multiple samples will be taken in each pixel. If the number of samples per pixel is very low (e.g. four samples), then a culling method such as Ward's <ref> [45] </ref> would be preferable to the method described in this paper. In Section 2 we state the direct lighting integral, and describe basic Monte Carlo integration. In Section 3 we design probability density functions for shapes commonly used to approximate luminaires. <p> When ae (x; ^!; ^! 0 ) is the most important term, we want p / ae (x; ^!; ^! 0 ) as in <ref> [45, 21] </ref> and when L e (x 0 ; ^! 0 ) is the key factor, we want to use p / L e (x 0 ; ^! 0 ). There are many luminaire shapes we have not discussed that might be of interest. <p> This implies at least N L samples must be taken to approximate the direct lighting, or some 15 16 bias must be introduced (as done by Ward where small value samples are not calculated <ref> [45] </ref>). Instead we leave the direct lighting integral intact and design a probability density function over all N L luminaires.
Reference: [46] <author> Gregory J. Ward. </author> <title> The radiance lighting simulation and rendering system. </title> <journal> Computer Graphics, </journal> <volume> 28(2), </volume> <month> July </month> <year> 1994. </year> <booktitle> ACM Siggraph '94 Conference Proceedings. </booktitle>
Reference-contexts: For example, Figure 7 shows a room lit by flourescent fixtures that are approximated by rectangles for the lighting calculations at other surfaces. This idea is used extensively in Ward's Radiance program <ref> [46] </ref>, where the far-field photometry of the entire fixture is known (see [10] for details on getting CIE or IES standard far-field photometry for real luminaires) and the luminaire is displayed with a complex geometry. <p> This concept has been used by Kok and Jansen [19], Chen et al.[3], Rushmeier et al. [29] and Ward <ref> [46] </ref>. Adding an imposter reduces the number of patches whose reflected light needs to be calculated and increases the number of luminaires.
Reference: [47] <author> Gregory J. Ward, Francis M. Rubinstein, and Robert D. </author> <title> Clear. A ray tracing solution for diffuse inter-reflection. </title> <journal> Computer Graphics, </journal> <volume> 22(4) </volume> <pages> 85-92, </pages> <month> August </month> <year> 1988. </year> <booktitle> ACM Siggraph '88 Conference Proceedings. </booktitle>
Reference-contexts: Most recent implementations have handled the direct lighting 1 using Monte Carlo integration in a view-dependent manner, and have stored the indirect lighting within some kind of spatial lookup table <ref> [47, 29] </ref>. This paper extends traditional Monte Carlo methods for carrying out the direct lighting calculation so that they can be applied to scenes with hundreds or thousands of luminaires (light emitting objects). <p> This basic method has been in use since at least the 1950s [13], and was first used in image synthesis by Ward et al. to generate reflection rays with a cosine density <ref> [47] </ref>. Note that P 1 will always exist, but may not be analytical, in which case numerical function inversion must be used.
Reference: [48] <author> H. Wozniakowski. </author> <title> Average case complexity of multivariate integration. </title> <journal> Bulliten (New Series) of the American Mathematical Society, </journal> <volume> 24(1) </volume> <pages> 185-193, </pages> <month> January </month> <year> 1991. </year>
Reference-contexts: Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. [6, 24, 31]). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure <ref> [50, 48, 24, 34] </ref> rather than in terms of variance. However, in practice it is often convenient to develop a sampling strategy using variance analysis on random samples, and then to turn around and use non-random, but equidistributed samples in an implementation.
Reference: [49] <author> Sidney J. Yakowitz. </author> <title> Computational Probability and Simulation. </title> <publisher> Addison-Wesley, </publisher> <address> New York, N.Y., </address> <year> 1977. </year>
Reference-contexts: Most of the basic Monte Carlo material of this section is also covered in several of the classic texts <ref> [13, 38, 12, 49] </ref>.
Reference: [50] <author> S. K. Zeremba. </author> <title> The mathematical basis of monte carlo and quasi-monte carlo methods. </title> <journal> SIAM Review, </journal> <volume> 10(3) </volume> <pages> 303-314, </pages> <month> July </month> <year> 1968. </year>
Reference-contexts: Although distribution ray tracing is usually phrased as an application of Equation 2, many researchers replace the i with more evenly distributed (quasi-random) samples (e.g. [6, 24, 31]). This approach can be shown to be sound by analyzing decreasing error in terms of some discrepancy measure <ref> [50, 48, 24, 34] </ref> rather than in terms of variance. However, in practice it is often convenient to develop a sampling strategy using variance analysis on random samples, and then to turn around and use non-random, but equidistributed samples in an implementation.
Reference: [51] <author> Kurt Zimmerman. </author> <title> Direct lighting models for ray tracing with cylindrical lamps. In Graphics Gems V. </title> <publisher> Academic Press, Inc., </publisher> <year> 1995. </year> <month> 28 </month>
Reference-contexts: coordinates is: x 0 = o + 4 u y v y w y 3 2 r c cos (2 1 ) 2 w max 5 A more practical (lower variance) cylinder sampling strategy that approximates a density function propor tional to (^! 0 ^n 0 ) is presented in <ref> [51] </ref>. 3.5 Discussion Since the density functions developed in this section assume that ae (x; ^!; ^! 0 ) and L e (x 0 ; ^! 0 ) are roughly constant in the directions subtended by the luminaire, a variance increase can be introduced by specular reflection or directional luminaires.
References-found: 51

