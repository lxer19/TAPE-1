URL: http://www.graphics.cornell.edu/~westin/thesis/thesis.ps.gz
Refering-URL: http://www.graphics.cornell.edu/~westin/
Root-URL: 
Title: Predicting Reflectance Functions from Complex Surfaces  
Author: Stephen H. Westin 
Degree: A Thesis Presented to the Faculty of the Graduate School  in Partial Fulfillment of the Requirements for the Degree of Master of Science by  
Date: August 1992  
Affiliation: of Cornell University  
Abstract-found: 0
Intro-found: 1
Reference: [Appel 68] <author> Appel, Arthur. </author> <title> Some techniques for shading machine renderings of solids. </title> <booktitle> In Proceedings of 1968 Spring Joint Computer Conference (Atlantic City, </booktitle> <address> New Jersey, April 30-May 2, </address> <booktitle> 1968) AFIPS Conference Proceedings 32, </booktitle> <pages> 37-45. </pages>
Reference: [Arvo 90] <author> Arvo, James, and Kirk, David. </author> <title> Particle transport and image synthesis. </title> <booktitle> In Proceedings of SIGGRAPH '90 (Dallas, </booktitle> <address> Texas, </address> <month> August 6-10, </month> <note> 1990) Computer Graphics 24(4) (August 1990), 63-66. </note>
Reference: [Blinn 77] <author> Blinn, J., </author> <title> Models of light reflection for computer synthesized pictures. </title> <booktitle> In Proceedings of SIGGRAPH '77 (Boulder, </booktitle> <address> Colorado, </address> <month> July 27-31, </month> <note> 1977) Computer Graphics 11(2) (July 1977), 192-198. </note>
Reference-contexts: Lambertian, models [Appel 68,Wylie 67], but Phong soon added an ad-hoc model of directional-diffuse scattering [Phong 75] and Whitted added ideal specular (mirror-like) reflection [Whitted 80]. While simple to compute, these models exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Blinn <ref> [Blinn 77] </ref> and others [Cook 82,He 91] built on earlier work in radiative transfer [Torrance 67] to introduce progressively more sophisticated, physically-based, analytical scattering models.
Reference: [Cabral 87] <author> Cabral, Brian, Nelson. Max, and Springmeyer, Rebecca. </author> <title> Bidirectional reflection functions from surface bump maps. </title> <booktitle> In Proceedings of SIG-GRAPH '87 (Anaheim, </booktitle> <address> California, </address> <month> July 27-31, </month> <note> 1987) Computer Graphics 21(4) (July 1990), 273-281. </note>
Reference-contexts: Previous authors have used spherical harmonics to represent scattering functions [Cabral 87,Kajiya 84, Sillion 91], since they form a complete basis set of smooth functions over the sphere. Kajiya [Kajiya 84] used spherical harmonics to derive an analytical scat tering function; Cabral et al. <ref> [Cabral 87] </ref> and Sillion et al. [Sillion 91] used them 14 15 as a numerical approximation to the BRDF. <p> To account for variation of the BRDF with incident direction, the coefficient vector C in Equation 3.2 can be thought of as a function of the incident direction. If a surface has isotropic roughness, as assumed in <ref> [Cabral 87] </ref> and [Sillion 91], the scattering function bd is independent of rotation about the surface normal, and bd ( i ; i ; r ; r ) = bd ( i ; 0; r ; r i ): (3:4) Each coefficient C k is a function of i alone, which <p> This implementation detail is omitted from the following discussion. As with a Fourier representation of a function, simply truncating all coefficients with index l &gt; l max will cause ringing in the approximation, called the Gibbs phenomenon. To reduce this, we attenuate higher frequencies, as did Cabral et al. <ref> [Cabral 87] </ref>, by progressively reducing the magnitude of coefficients with l filter &lt; l l max , where l filter is an empirically-determined threshold. The 20 magnitude is reduced according to a half-Gaussian with empirically-determined width. <p> A microgeome-try composed of planar ideal-specular surfaces, as in Section 4.3.2, is equivalent to geometric optics models based on microfacets, such as the Torrance-Sparrow model [Torrance 67]. We use ray tracing to model scattering events, as suggested by Cabral et al. <ref> [Cabral 87] </ref>.
Reference: [Cook 82] <author> Cook, R. L, and Torrance, K. E. </author> <title> A reflectance model for computer graphics. </title> <journal> ACM Transactions on Graphics 1(1) 1982, </journal> <pages> 7-24. </pages>
Reference: [Cook 84] <author> Cook, Robert L, Porter, Thomas and Carpenter, Loren. </author> <title> Distributed ray tracing. </title> <booktitle> In Proceedings of SIGGRAPH '84 (Minneapolis, </booktitle> <address> Minnesota, </address> <month> July 23-27, </month> <note> 1984) Computer Graphics 18(3) (July 1984), 137-145. </note>
Reference-contexts: Monte Carlo methods were developed to solve such problems; the early Monte Carlo simulations of the 1940's solved particle transport problems similar to optical energy transport. Since Cook et al. introduced the method to computer graphics <ref> [Cook 84] </ref>, these methods have been applied more and more [Arvo 90,Kajiya 86]. <p> The pattern on the right is called stratified sampling. If the mean variance of each of the subdomains is less than the variance of the entire domain, which is likely, stratification will reduce variance. Jitter sampling in rendering <ref> [Cook 84] </ref> is a familiar example of this.
Reference: [Gouraud 71] <author> Gouraud, H. </author> <title> Continuous shading for curved surfaces. </title> <journal> IEEE Transactions on Computers 20(6) (June 1971), </journal> <pages> 623-628. </pages>
Reference: [Goldstein 71] <author> Goldstein, Robert A., and Nagel, Roger. </author> <title> 3-D visual simulation. </title> <booktitle> Simulation 16(1) (January 1971), </booktitle> <pages> 25-31. 78 79 </pages>
Reference-contexts: The second also makes the ray tracer more "conventional" in that the quantity estimated is an array of pixels, rather than a matrix of coefficients for the BRDF. The third is necessary because this ray 76 tracer calculates energy flux density, rather than radiance, as ray tracers since <ref> [Goldstein 71] </ref> have traditionally done. The conversion is dI = cos b i d! i where b i is the elevation angle at which the eye ray strikes the first surface, and d! i is the solid angle subtended by the pixel.
Reference: [Goel 91] <author> Goel, Narendra S., Rozehnal, Ivan and Thompson, Richard L. </author> <title> A computer graphics based model for scattering from objects of arbitrary shapes in the optical region. </title> <booktitle> Remote Sensing of Environment 36(2) (1991), </booktitle> <pages> 73-104. </pages>
Reference-contexts: Finally, many other complex surfaces may yield to this method. For example, metallic paint contains many flakes of metal suspended in a transparent medium. For remote sensing, the method could give accurate predictions of reflection from vegetation canopies <ref> [Goel 91] </ref>. It is not limited to conventional ray tracing of surfaces; given a volume-density ray tracer, such as described by Ka-jiya [Kajiya 84], the method could give BRDFs for clouds (e.g. for remote sens ing) or texels [Kajiya 89].
Reference: [Hall 83] <author> Hall, Roy A. </author> <title> A Methodology For Realistic Image Synthesis. </title> <type> Master's Thesis, </type> <institution> Cornell University, </institution> <year> 1983. </year>
Reference-contexts: A.5 Russian Roulette Ray tracing can be made much more efficient by terminating the paths of rays whose contribution to the result is insignificant <ref> [Hall 83] </ref>. In a series of interac 73 tions with surfaces, the weight of a ray is typically diminished. Following every ray until it leaves the model entirely could be very expensive with not much contribution to the result.
Reference: [Hecht 87] <author> Hecht, Eugene. </author> <title> Optics. Second Edition, </title> <publisher> Addison-Wesley, </publisher> <year> 1987. </year>
Reference-contexts: Reflection of unpolarized light from a per fectly smooth surface of a dielectric (i.e. non-conductive) material is governed by the Fresnel equation <ref> [Hecht 87] </ref>: E r = F 2 k n i cos i + n t cos t + n t cos i n i cos t ! 2 9 where E r and E i are the reflected and incident energy flux densities (defined in Section 2.3.1), F ? and F <p> Whenever a ray encounters a smooth interface between media of different refractive indices, we must calculate the energy transfer through the interface. Neither energy flux density nor radiance is preserved at the interface <ref> [Hecht 87, p. 102] </ref>, since solid angles are altered.
Reference: [He 91] <author> He, Xiao D., Torrance, Kenneth E., Sillion, Fran~cois X., and Greenberg, Donald P. </author> <title> A comprehensive physical model for light reflection. </title> <booktitle> In Proceedings of SIGGRAPH '91 (Las Vegas, </booktitle> <address> Nevada, </address> <note> July 28-August 2, 1991) Computer Graphics 25(4) (July 1991), 175-186. </note>
Reference-contexts: When the size of geometric features of the scattering surfaces approaches the wavelength of light, the light must be treated as waves that can diffract and interfere with each other. 2.2 Scattering Modes Reflective scattering can be divided into three components, called ideal specular, ideal diffuse, and directional diffuse <ref> [He 91] </ref>. These modes are illustrated in except in the specular direction r = i ; r = i + . This is a mirror-like reflection. Ideal diffuse scattering, also known as Lambertian scattering, is independent of reflection direction. <p> A similar, but much more complex, expression governs reflection from a conductive surface. Any roughness of the surface at a scale comparable to or larger than the wavelength of light will alter this dependence on incident angle. He <ref> [He 91] </ref> has calculated the effects of wave optics and the dependence of effective roughness on incident angle to derive this relation for surfaces whose roughness has a Gaussian autocorrelation function. Specular scattering results from a single reflection from the surface [He 91]; it takes place only at the boundary between <p> He <ref> [He 91] </ref> has calculated the effects of wave optics and the dependence of effective roughness on incident angle to derive this relation for surfaces whose roughness has a Gaussian autocorrelation function. Specular scattering results from a single reflection from the surface [He 91]; it takes place only at the boundary between two materials of differing dielectric constants. 2.2.2 Ideal Diffuse Reflection Ideal diffuse reflection is independent of reflected direction and depends only on incident direction. It is also known as Lambertian reflection. <p> This seems to be caused by bias in the ray termination procedure (see Appendix). 6.1.3 Analytical bd for an Isotropic Surface The method was also compared to that of He et al. <ref> [He 91] </ref> as further confirmation of its accuracy. The He model assumes a flat Gaussian-rough surface for which, at the microscale, the surface is an ideal specular reflector; it models full wave optics effects for such a rough surface. <p> Results are plotted as solid lines in Figure 6.7 for incident angles i = 0 ffi ; 30 ffi ; 45 ffi ; 60 ffi ; 75 ffi . Dashed lines show results from the model of He <ref> [He 91] </ref>, which assumes a Gaussian rough surface and allows for wave optics effects. The He model is shown in the limit of large surface roughness, , where wave optics effects should be negligible. <p> The geometry shown in Figure 6.9 was used with He's analytical BRDF model <ref> [He 91] </ref> to demonstrate this. Each of the parallel cylinders had a microscale BRDF calculated with He's method; this simulated slightly rough anisotropic aluminum surface at the microscale, including wave optics effects. <p> For a perfectly smooth surface, b s is the Fresnel reflectance; for rougher surfaces, b s must be calculated with a more general wave-optics model (e.g. <ref> [He 91] </ref>). If the surface is very rough, with roughness features much larger than the wave length of light, b s = 0. The ray tracer uses path tracing [Kajiya 86] to reduce the number of rays cast. <p> Unfortunately, directional-diffuse scattering works badly with this distribution (Figure A.2); as b i ! 2 , the peak of the scattering lobe approaches b r = 2 and the shape of b bd for most directional-diffuse scatterers tends to grow narrower and more concentrated <ref> [He 91] </ref>. The cosine distribution thus avoids sampling the most important directions: those with maximum contribution to the integral and maximum variation of the func tion b bd cos b r .
Reference: [Goral 84] <author> Goral, Cindy M., Torrance, Kenneth E., Greenberg, Donald P., and Battaile, Bennett. </author> <title> Modeling the interaction of light between diffuse surfaces. </title> <booktitle> In Proceedings of SIGGRAPH '84 (Minneapolis, </booktitle> <address> Minnesota, </address> <month> July 23-27, </month> <note> 1984) Computer Graphics 18(3) (July 1984), 213-222. </note>
Reference-contexts: The advent of global illumination methods (e.g. radiosity <ref> [Goral 84] </ref> and enhanced ray tracing [Ward 88]) has created another concept of scale by modelling the transfer of light between objects in the environment, not just from each object to the eye.
Reference: [Howell 63] <author> Howell, John R., and Perlmutter, Morris. </author> <title> Directional behavior of emitted and reflected radiant energy from a specular, </title> <type> gray, </type> <institution> asymmetric groove. NASA Technical Note D-1874, NASA Lewis Research Center, Cleve-land, Ohio, </institution> <month> August, </month> <year> 1963. </year>
Reference-contexts: This was done for 43 44 three cases: a simple periodic surface geometry, a conical cavity, and an isotropic random surface. q 6.1.1 Analytical dh for a Regular Geometry To verify the Monte Carlo integration, the analytical work of Howell and Perl-mutter <ref> [Howell 63] </ref> was duplicated. They calculated emitted energy from an asymmetric V-shaped groove (Figure 6.1) with ideal-specular reflection at the microscale. The microscale reflectivity b s in their model was constant for all incident angles b i ; it did not obey the Fresnel equation. <p> Because of this, the simulations were confined to the directional hemispherical reflectance dh to verify the Monte Carlo integration. The Howell paper gives emissivity * as a function of angle. To calculate the directional-hemispherical reflectance dh , 45 0.1 0.4 q i Analytical <ref> [Howell 63] </ref> Present Simulation we apply Kirchoff's law to obtain ff = (1 dh )[Siegel 81; p:73]. Two simulations were performed for a groove angle = 30 ffi and a microscale reflectivity b = 0:5. <p> In the second simulation, the contributions of the reflected rays were used to estimate spherical harmonics coefficients to approximate the function dh . 46 0.2 0.5 q i Analytical <ref> [Howell 63] </ref> Interpolated Simulation shot from random incident directions to estimate the coefficients; coefficients up to L = 23 were used, for a total of 273 coefficients. The result shows good agreement with the Howell/Perlmutter results, but shows some ringing.
Reference: [Jones 85] <author> Jones, M. N. </author> <title> Spherical Harmonics and Tensors for Classical Field Theory. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1985. </year>
Reference-contexts: hY k j fi : (3.3) This follows directly from the orthogonality of the basis functions [Wallace 84]. 1 This thesis uses the surface spherical harmonics, which form a complete orthogonal basis set for functions on the unit sphere; the more general solid spherical harmonics are defined over all space <ref> [Jones 85, pp. 1-2] </ref>.
Reference: [Kajiya 89] <author> Kajiya, James T., and Kay, Timothy L. </author> <title> Rendering fur with three dimensional textures. </title> <booktitle> In Proceedings of SIGGRAPH '89 (Boston. </booktitle> <address> Massachusetts, </address> <note> July 31-August 4, 1989) Computer Graphics 23(3) (July 1989), 271-280. </note>
Reference-contexts: It is not limited to conventional ray tracing of surfaces; given a volume-density ray tracer, such as described by Ka-jiya [Kajiya 84], the method could give BRDFs for clouds (e.g. for remote sens ing) or texels <ref> [Kajiya 89] </ref>. Appendix A An Energy-Consistent Ray Tracer To simulate scattering accurately, we must account for all energy in the environment, assuring that energy is neither created nor lost. To do this, the simulation must maintain the energy balance of each scattering event.
Reference: [Kajiya 86] <author> Kajiya, James T. </author> <title> The rendering equation. </title> <booktitle> In Proceedings of SIG-GRAPH '86 (Dallas, </booktitle> <address> Texas, </address> <month> August 18-22, </month> <note> 1986) Computer Graphics 20(4) (August 1986), 143-150. </note>
Reference-contexts: If the surface is very rough, with roughness features much larger than the wave length of light, b s = 0. The ray tracer uses path tracing <ref> [Kajiya 86] </ref> to reduce the number of rays cast.
Reference: [Kajiya 85] <author> Kajiya, James T. </author> <title> Anisotropic reflectance models. </title> <booktitle> In Proceedings of SIGGRAPH '85 (San Francisco, </booktitle> <address> California, </address> <month> July 22-26, </month> <note> 1985) Computer Graphics 19(4) (July 1985), 15-21. </note>
Reference-contexts: Several authors have proposed scattering models for anisotropic surfaces. Poulin and Fournier [Poulin 90] developed a closed-form solution for a surface of parallel cylinders or cylindrical grooves, and Kajiya <ref> [Kajiya 85] </ref> explored a numerical technique using Fourier coefficients and bump maps. Neither of these models guarantees physical consistency (e.g. energy conservation). Each method is restricted to certain characterizations of surface roughness; the accuracy of each model depends on how well this description matches the physical surface to be modeled.
Reference: [Kajiya 84] <author> Kajiya, James T., and Von Herzen, Brian J. </author> <title> Ray tracing volume densities. </title> <booktitle> In Proceedings of SIGGRAPH '84 (Minneapolis, </booktitle> <address> Minnesota, </address> <month> July 23-27, </month> <note> 1984) Computer Graphics 18(3) (July 1984), 165-174. 80 </note>
Reference-contexts: Fortunately, a BRDF is generally smooth, making it a good candidate for representation by smooth orthogonal functions. Previous authors have used spherical harmonics to represent scattering functions [Cabral 87,Kajiya 84, Sillion 91], since they form a complete basis set of smooth functions over the sphere. Kajiya <ref> [Kajiya 84] </ref> used spherical harmonics to derive an analytical scat tering function; Cabral et al. [Cabral 87] and Sillion et al. [Sillion 91] used them 14 15 as a numerical approximation to the BRDF. <p> For remote sensing, the method could give accurate predictions of reflection from vegetation canopies [Goel 91]. It is not limited to conventional ray tracing of surfaces; given a volume-density ray tracer, such as described by Ka-jiya <ref> [Kajiya 84] </ref>, the method could give BRDFs for clouds (e.g. for remote sens ing) or texels [Kajiya 89]. Appendix A An Energy-Consistent Ray Tracer To simulate scattering accurately, we must account for all energy in the environment, assuring that energy is neither created nor lost.
Reference: [Kalos 86] <author> Kalos, Malvin H., and Whitlock, Paula A. </author> <title> Monte Carlo Methods. </title> <publisher> John Wiley & Sons, </publisher> <year> 1986. </year>
Reference-contexts: The essence of the method is the invention of games of chance whose behavior and outcome can be used to study some interesting phenomena. <ref> [Kalos 86] </ref> In many physical simulations, we must evaluate functions that defy classical closed-form solutions. Monte Carlo methods were developed to solve such problems; the early Monte Carlo simulations of the 1940's solved particle transport problems similar to optical energy transport. <p> To show this proba 24 0.0 -0.1 Relative error bilistic convergence, Monte Carlo quadrature was used to estimate the value of R 1 2 x dx as explained in <ref> [Kalos 86, pp. 94-95] </ref>. The results of ten trials of the calculation are shown in Figure 4.1. The trend of reduced error as N increases is apparent; so is the probabilistic nature of convergence. The shaded band has height proportional to 1 p N for reference. <p> It is always possible to choose a number of dimensions for which Monte Carlo quadrature converges faster than a deterministic method. Monte Carlo quadrature generally becomes superior to deterministic methods at levels ranging from six to ten dimensions <ref> [Kalos 86, p. 91] </ref>. 25 4.2 Application to Estimation of the Matrix If we bombard a specimen with incident rays from an arbitrary direction U = ( i ; i ), the BRDF can be expressed as bd (U; V) = cos r where a ray from direction U will scatter <p> Unfortunately, the usual method of terminating rays introduces bias, that is the expected value of the estimator does not equal the value of the integral to be estimated. While bias can sometimes be tolerated to gain some offsetting advantage <ref> [Kalos 86, pp. 35-37] </ref>, it is usually undesirable, and the designer of a Monte Carlo algorithm must be careful to avoid it when possible.
Reference: [Oppenheim 89] <author> Oppenheim, Allan V. and Shafer, Ronald W. </author> <title> Discrete-Time Signal Processing. </title> <publisher> Prentice-Hall, </publisher> <address> Englewood Cliffs, New Jersey, </address> <year> 1989. </year>
Reference-contexts: Scale ultimately depends on the Nyquist limit, the highest frequency which can be reconstructed from discrete samples <ref> [Oppenheim 89] </ref>. In rendering, no feature smaller than about twice pixel size need be represented explicitly. This size obviously varies with point of view.
Reference: [Nicodemus 77] <author> Nicodemus, F. E., Richmond, J. C., Hsia, J.J., Ginsberg, I. W., and Limperis T. </author> <title> Geometrical considerations and nomenclature for reflectance. </title> <institution> National Bureau of Standards Monograph 160, </institution> <month> October </month> <year> 1977. </year>
Reference-contexts: Energy flux density can be calculated from radiance by dE (; ) = dA 2.3.3 BRDF Diffuse reflective scattering is completely characterized by the bidirectional reflectance distribution function (BRDF) bd ( i ; i ; r ; r ) <ref> [Nicodemus 77] </ref>.
Reference: [Phong 75] <author> Phong, Bui-Tuong. </author> <title> Illumination for computer generated pictures. </title> <journal> Communications of the ACM 18(6) (June 1975), </journal> <pages> 311-317. </pages>
Reference-contexts: Models of local scattering in computer graphics started with ideal diffuse, i.e. Lambertian, models [Appel 68,Wylie 67], but Phong soon added an ad-hoc model of directional-diffuse scattering <ref> [Phong 75] </ref> and Whitted added ideal specular (mirror-like) reflection [Whitted 80]. While simple to compute, these models exclude many important physical effects and lack the energy consistency needed for global illumination calculations.
Reference: [Polgar 65] <author> Polgar, Leslie G., and Howell, John R. </author> <title> Directional thermal-radiative properties of conical cavities. </title> <institution> NASA Technical Note D-2904, NASA Lewis Research Center, Cleveland, Ohio, </institution> <month> June, </month> <year> 1965. </year>
Reference-contexts: The regular structure gives a dh with discontinuous slope, which is difficult to closely ap proximate with a finite set of smooth basis functions. 6.1.2 Monte Carlo Simulation for a Conical Cavity The method and implementation were further verified by replicating some work of Polgar and Howell <ref> [Polgar 65] </ref>.
Reference: [Poulin 90] <author> Poulin, Pierre, and Fournier, Alain. </author> <title> A model for anisotropic reflection. </title> <booktitle> In Proceedings of SIGGRAPH '90 (Dallas, </booktitle> <address> Texas, </address> <month> August 6-10, </month> <note> 1990) Computer Graphics 24(4) (August 1990), 273-282. </note>
Reference-contexts: These predict the bidirectional reflection func 1 2 tion (BRDF) with good fidelity to physical measurements, but apply only to sur faces of specific types of random isotropic roughness. Several authors have proposed scattering models for anisotropic surfaces. Poulin and Fournier <ref> [Poulin 90] </ref> developed a closed-form solution for a surface of parallel cylinders or cylindrical grooves, and Kajiya [Kajiya 85] explored a numerical technique using Fourier coefficients and bump maps. Neither of these models guarantees physical consistency (e.g. energy conservation).
Reference: [Shirley92] <author> Shirley, Peter. </author> <title> Nonuniform Random Point Sets via Warping. in Graphic Gems III. </title> <editor> Kirk, David, ed. </editor> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1992, </year> <pages> 80-83. </pages>
Reference-contexts: This assumes that b bd cos b r can be sampled directly; this is straightforward for some BRDF approximations, such as a Gaussian distribution [Ward 92] or the Phong model <ref> [Shirley92] </ref>, but the approximation used for this thesis (Chapter 3) cannot efficiently be sampled di rectly.
Reference: [Sillion 91] <author> Sillion, Fran~cois X., Arvo, James, Westin, Stephen H., and Green-berg, Donald P. </author> <title> A global illumination solution for general reflectance distributions. </title> <booktitle> In Proceedings of SIGGRAPH '91 (Las Vegas, </booktitle> <address> Nevada, </address> <note> July 28-August 2, 1991) Computer Graphics 25(4) (July 1991), 187-196. </note>
Reference-contexts: Since the BRDF can take on highly arbitrary shapes [He 91,Torrance 66], a very general method is needed to represent it. Fortunately, a BRDF is generally smooth, making it a good candidate for representation by smooth orthogonal functions. Previous authors have used spherical harmonics to represent scattering functions <ref> [Cabral 87,Kajiya 84, Sillion 91] </ref>, since they form a complete basis set of smooth functions over the sphere. <p> Kajiya [Kajiya 84] used spherical harmonics to derive an analytical scat tering function; Cabral et al. [Cabral 87] and Sillion et al. <ref> [Sillion 91] </ref> used them 14 15 as a numerical approximation to the BRDF. <p> To account for variation of the BRDF with incident direction, the coefficient vector C in Equation 3.2 can be thought of as a function of the incident direction. If a surface has isotropic roughness, as assumed in [Cabral 87] and <ref> [Sillion 91] </ref>, the scattering function bd is independent of rotation about the surface normal, and bd ( i ; i ; r ; r ) = bd ( i ; 0; r ; r i ): (3:4) Each coefficient C k is a function of i alone, which can be calculated <p> The matrix representation for the BRDF can also be used to extend the global illumination method of Sillion et al. <ref> [Sillion 91] </ref>, which stores reflected intensity distributions at many sample points in the environment. Since these distributions are represented by vectors of spherical harmonics coefficients, it is easy to 18 adapt Sillion's method to use the new representation. <p> Since our BRDF representation, like that of <ref> [Sillion 91] </ref>, is based on spherical harmonics, we can adapt two techniques from that work to reduce the number of coefficients (and corresponding basis functions) needed: the first technique causes half the coefficients to vanish, and the second reduces the high-frequency content of the BRDF, reducing the number of coefficients needed <p> All images shown in this section were generated by Monte Carlo ray tracing; the grainy texture of the images is caused by the Monte Carlo integration used to compute global illumination. Other global illumination and rendering techniques could have been used, such as that of Sillion et al. <ref> [Sillion 91] </ref>. 6.1 Verification The best means of verifying the correctness of a Monte Carlo calculation is to simulate a problem for which the solution is already known. <p> The representation not only enforces exact reciprocity, but it also assures smoothness, to avoid visual artifacts like quantization and Mach bands. It can be easily evaluated, so it is directly useful in ray tracing, including stochastic global illumination methods [Kajiya 86,Ward 88]. The global illumination technique of <ref> [Sillion 91] </ref> can be easily extended to accommodate the new representation. Generating BRDFs in this way can be very expensive; some of the BRDFs computed for over a week on a powerful workstation (Apollo DN10000VS).
Reference: [Siegel 81] <author> Siegel, R., and Howell, J. R. </author> <title> Thermal Radiation Heat Transfer. </title> <publisher> Hemisphere Publishing, </publisher> <address> New York, </address> <year> 1981. </year>
Reference-contexts: flux density dE i incident on the surface. bd ( i ; i ; r ; r ) = dE i ( i ; i ) The function bd is called bidirectional because it is a function of both the incident and reflected directions; it obeys the law of reciprocity <ref> [Siegel 81, p. 65] </ref>, i.e. bd ( i ; i ; r ; r ) = bd ( r ; r ; i ; i ) (2:6) for all angles ( r ; r ; i ; i ). It can vary in magnitude from 0 to 1. <p> r ; r ) j E i ( i ; i )i (2.7) 12 where the symbol ffi denotes integration over the hemisphere. 2.3.4 Directional Hemispherical Reflectance dh The directional hemispherical reflectance dh ( i ; i ) is the integral of bd cos r over the entire reflection hemisphere <ref> [Siegel 81, pp. 66-67] </ref>. dh ( i ; i ) fl It is the total reflected energy flux density per unit incident energy flux density, and can never exceed unity. 2.3.5 Hemispherical Directional Reflectance hd The reciprocal quantity associated with dh is hd ( r ; r ), the reflectance in <p> We must also model the attenuation of the ray as it passes through an imperfectly transparent medium, such as colored glass. This is governed by Bouguer's law <ref> [Siegel 81, pp. 424-427] </ref>: I (S) = I (0)e 0 K (S)dS : (A:6) where S is the path distance through the medium (S = 0 at the entry point) and K is an extinction coefficient determined by the material and wavelength.
Reference: [Torrance 67] <author> Torrance, Kenneth E. and Sparrow, Ephraim M. </author> <title> Theory for off-specular reflection from roughened surfaces. </title> <journal> Journal of the Optical Society of America, </journal> <volume> 57(9), </volume> <month> September </month> <year> 1967, </year> <pages> 1105-1114. </pages>
Reference-contexts: While simple to compute, these models exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Blinn [Blinn 77] and others [Cook 82,He 91] built on earlier work in radiative transfer <ref> [Torrance 67] </ref> to introduce progressively more sophisticated, physically-based, analytical scattering models. These predict the bidirectional reflection func 1 2 tion (BRDF) with good fidelity to physical measurements, but apply only to sur faces of specific types of random isotropic roughness. Several authors have proposed scattering models for anisotropic surfaces. <p> At the microscale level, arbitrary reflection models may be employed, including ideal specular, ideal diffuse, and directional diffuse models. A microgeome-try composed of planar ideal-specular surfaces, as in Section 4.3.2, is equivalent to geometric optics models based on microfacets, such as the Torrance-Sparrow model <ref> [Torrance 67] </ref>. We use ray tracing to model scattering events, as suggested by Cabral et al. [Cabral 87].
Reference: [Torrance 66] <author> Torrance, Kenneth E. and Sparrow, Ephraim M. </author> <title> Off-specular peaks in the directional distribution of reflected thermal radiation. </title> <journal> Journal of Heat Transfer, </journal> <month> May </month> <year> 1966, </year> <pages> 223-230. </pages>
Reference-contexts: The scattering pattern can take on almost arbitrary, irregular shapes <ref> [Torrance 66] </ref>. This scattering results mainly from single scattering from a rough surface.
Reference: [Wallace 84] <author> Wallace, P. R. </author> <title> Mathematical Analysis of Physical Problems. </title> <publisher> Dover Publications, </publisher> <editor> Mineola, N. Y. </editor> <year> 1984. </year> <month> 81 </month>
Reference-contexts: Thus f (; ) k=0 Each coefficient C k is defined by the inner product of f (; ) with the correspond ing spherical harmonic basis function: C k = 0 0 = hY k j fi : (3.3) This follows directly from the orthogonality of the basis functions <ref> [Wallace 84] </ref>. 1 This thesis uses the surface spherical harmonics, which form a complete orthogonal basis set for functions on the unit sphere; the more general solid spherical harmonics are defined over all space [Jones 85, pp. 1-2].
Reference: [Ward 88] <author> Ward, Gregory J., Rubinstein, Francis M., and Clear, Robert D. </author> <title> A ray tracing solution for diffuse interreflection. </title> <booktitle> In Proceedings of SIGGRAPH '88 (Atlanta, </booktitle> <address> Georgia, </address> <month> August 1-5, </month> <note> 1988) Computer Graphics 22(4) (August 1988), 85-92. </note>
Reference-contexts: The advent of global illumination methods (e.g. radiosity [Goral 84] and enhanced ray tracing <ref> [Ward 88] </ref>) has created another concept of scale by modelling the transfer of light between objects in the environment, not just from each object to the eye. To do this, the illumination is sampled in object space, with far fewer samples than are used for rendering.
Reference: [Ward 92] <author> Ward, Gregory J. </author> <title> Measuring and modeling anisotropic reflection. </title> <booktitle> In Proceedings of SIGGRAPH '92 (Chicago, </booktitle> <address> Illinois, </address> <month> July 27-31, </month> <note> 1992) Computer Graphics 26(4) (July 1992), 265-272. </note>
Reference-contexts: Such a distribution would embody the entire scattering function in b p; b R would be constant for all V. This assumes that b bd cos b r can be sampled directly; this is straightforward for some BRDF approximations, such as a Gaussian distribution <ref> [Ward 92] </ref> or the Phong model [Shirley92], but the approximation used for this thesis (Chapter 3) cannot efficiently be sampled di rectly.
Reference: [Whitted 80] <author> Whitted, Turner. </author> <title> An improved illumination model for shaded display. </title> <journal> Communications of the ACM 23(6) June 1980, </journal> <pages> 343-349. </pages>
Reference-contexts: Models of local scattering in computer graphics started with ideal diffuse, i.e. Lambertian, models [Appel 68,Wylie 67], but Phong soon added an ad-hoc model of directional-diffuse scattering [Phong 75] and Whitted added ideal specular (mirror-like) reflection <ref> [Whitted 80] </ref>. While simple to compute, these models exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Blinn [Blinn 77] and others [Cook 82,He 91] built on earlier work in radiative transfer [Torrance 67] to introduce progressively more sophisticated, physically-based, analytical scattering models. <p> a ray hits such a microfacet, we model the transfer by spawning a ray in the 66 67 AAAAAAAAA AAAAAAAAA AAAAAAAAA Specular reflection Surface normal Specular transmission E t Diffuse reflection r bd cos q r AA AAA AAA Figure A.1: Local Scattering Modes specular direction as in classical ray-tracing <ref> [Whitted 80] </ref>.
Reference: [Wylie 67] <author> Wylie, C., Romney, G., Evans, D., Erdahl, A. </author> <title> "Half-tone Perspective Drawings by Computer. </title> <booktitle> In Proceedings of 1967 Fall Joint Computer Conference (Anaheim, </booktitle> <address> California, </address> <month> November 14-16, </month> <booktitle> 1967) AFIPS Conference Proceedings 31, </booktitle> <pages> 49-58. </pages>
References-found: 35

