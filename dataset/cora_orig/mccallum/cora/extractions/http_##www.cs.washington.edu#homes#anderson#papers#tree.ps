URL: http://www.cs.washington.edu/homes/anderson/papers/tree.ps
Refering-URL: http://www.cs.washington.edu/research/computation/papers.html
Root-URL: 
Email: anderson@cs.washington.edu  
Title: Tree Data Structures for N-Body Simulation  
Author: Richard J. Anderson 
Date: March 20, 1996  
Address: Washington  
Affiliation: Department of Computer Science and Engineering University of  
Abstract: In this paper, we study data structures for use in N-body simulation. We concentrate on the spatial decomposition tree used in particle-cluster force evaluation algorithms such as the Barnes-Hut algorithm. We prove that a k-d tree is asymptotically inferior to a spatially balanced tree. We show that the worst case complexity of the force evaluation algorithm using a k-d tree is fi(n log 3 n log L) compared with fi(n log L) for an oct-tree. (L is the separation ratio of the set of points.) This result has already had significant impact on astronomical simulation. We also investigate improving the constant factor of the algorithm, and present several methods which improve over the standard oct-tree decomposition. Finally, we consider whether or not the bounding box of a point set should be "tight", and show that it is only safe to use tight bounding boxes for binary decompositions. The results are all directly applicable to practical implementations of N -body algorithms.
Abstract-found: 1
Intro-found: 1
Reference: [App85] <author> A. W. Appel. </author> <title> An efficient program for many-body simulation. </title> <journal> Siam Journal of Scientific and Statistical Computing, </journal> <volume> 6(1) </volume> <pages> 85-103, </pages> <year> 1985. </year>
Reference-contexts: More attention has been paid to the asymptotic performance of the algorithms, and to the accuracy properties of particular codes. A series of papers introduced particle-cluster algorithms in the early to mid eighties <ref> [App85, JP89, BH86] </ref>, with the version developed by Barnes and Hut [BH86] receiving the most attention with respect to implementation. The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin [Gre88, GR87] which is a cluster-cluster algorithm. <p> K-d trees have been used in a number of N -body implementations, including the early implementation of Appel <ref> [App85] </ref> and in the UW KD-grav code [DS95]. We show that in the worst case, an N -body algorithm using k-d trees is inferior to an algorithm with a spatially balanced decomposition. There is a bad case point set where the points all lie on a line.
Reference: [AS96] <author> R. J. Anderson and S. D. Sandys. </author> <title> An experimental study of tree data structures for N-body simulation. </title> <booktitle> Work in progress, </booktitle> <year> 1996. </year> <month> 11 </month>
Reference-contexts: at a random point involves a particular cell. (The interaction regions can also be used for an average case analysis with respect to a random set of points [BN95, Sal90].) Experimental results show that the size of the interaction region is a very good predictor of the algorithm's run time <ref> [BN95, AS96] </ref>. We give a pair of results which suggest that a binary tree requires fewer force evaluations than a quad-tree or an oct-tree for the same set of points.
Reference: [BH86] <author> J. E. Barnes and P. Hut. </author> <title> A hierarchical O(N log N ) force-calculation algorithm. </title> <booktitle> Nature, </booktitle> <address> 324:446--449, </address> <year> 1986. </year>
Reference-contexts: In this paper we study different tree data structures with the goal of minimizing the number of force evaluations performed during the computation. We concentrate on particle-cluster algorithms, where the data structure is traversed independently for each particle. The Barnes-Hut algorithm <ref> [BH86] </ref> is the standard particle-cluster algorithm now in use. We study issues which relate both to asymptotic performance, and to the constant factors of the run time. Our performance measure is the number of force evaluations performed with respect to a fixed error threshold. <p> More attention has been paid to the asymptotic performance of the algorithms, and to the accuracy properties of particular codes. A series of papers introduced particle-cluster algorithms in the early to mid eighties <ref> [App85, JP89, BH86] </ref>, with the version developed by Barnes and Hut [BH86] receiving the most attention with respect to implementation. The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin [Gre88, GR87] which is a cluster-cluster algorithm. <p> More attention has been paid to the asymptotic performance of the algorithms, and to the accuracy properties of particular codes. A series of papers introduced particle-cluster algorithms in the early to mid eighties [App85, JP89, BH86], with the version developed by Barnes and Hut <ref> [BH86] </ref> receiving the most attention with respect to implementation. The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin [Gre88, GR87] which is a cluster-cluster algorithm. Although the algorithm is O (n) time it is not used in astrophysical research. <p> Some work 2 in main stream computational geometry also ties in directly with this, in particular work on the all-nearest neighbor problem [Vai86]. 2 Particle-cluster algorithm One version of the particle-cluster algorithm was originally described by Barnes and Hut <ref> [BH86] </ref>. The data structure is a tree that has a set of particles associated with each node. Each particle is assigned to a unique leaf of the tree.
Reference: [BHE + 94] <author> J. A. Board, Z. S. Hakura, W. D. Elliot, D. C. Gray, W. J. Blanke, and J. F. Leathrum. </author> <title> Scalable implementations of multipole-accelarated algorithms for molecular dynamics. </title> <type> Technical Report 94-002, </type> <institution> Dept. of Electrical Engineering, Duke University, </institution> <year> 1994. </year>
Reference-contexts: However, many of the ideas in Greengard's algorithm are applicable to the particle-cluster algorithms, and practical N -body codes becoming more "Greengard-like" and there are also algorithms which may be viewed as a synthesis of Greengard's algorithm and a particle cluster algorithm <ref> [BHE + 94, BHER94] </ref>. Many of the issues relating to the force evaluation algorithm are orthogonal to the data structure used, so some of the results of this paper may carry over to a larger context.
Reference: [BHER94] <author> J. A. Board, Z. S. Hakura, W. D. Elliot, and W. T. Rankin. </author> <title> Scalable variants of multipole-accelerated algorithms for molecular dynamics applications. </title> <type> Technical Report 94-006, </type> <institution> Dept. of Electrical Engineering, Duke University, </institution> <year> 1994. </year>
Reference-contexts: However, many of the ideas in Greengard's algorithm are applicable to the particle-cluster algorithms, and practical N -body codes becoming more "Greengard-like" and there are also algorithms which may be viewed as a synthesis of Greengard's algorithm and a particle cluster algorithm <ref> [BHE + 94, BHER94] </ref>. Many of the issues relating to the force evaluation algorithm are orthogonal to the data structure used, so some of the results of this paper may carry over to a larger context.
Reference: [BN95] <author> G. Blelloch and G. Narlikar. </author> <title> A practical comparison of N-body algorithms. </title> <type> Unpublished Manuscript, </type> <year> 1995. </year>
Reference-contexts: Many of the issues relating to the force evaluation algorithm are orthogonal to the data structure used, so some of the results of this paper may carry over to a larger context. Papers which have addressed the accuracy of N -body simulations have generally compared different force evaluation strategies <ref> [BN95] </ref> or studied the trade-off between accuracy and run time [SW94]. <p> We can use the interaction region to determine the probability that the evaluation at a random point involves a particular cell. (The interaction regions can also be used for an average case analysis with respect to a random set of points <ref> [BN95, Sal90] </ref>.) Experimental results show that the size of the interaction region is a very good predictor of the algorithm's run time [BN95, AS96]. <p> at a random point involves a particular cell. (The interaction regions can also be used for an average case analysis with respect to a random set of points [BN95, Sal90].) Experimental results show that the size of the interaction region is a very good predictor of the algorithm's run time <ref> [BN95, AS96] </ref>. We give a pair of results which suggest that a binary tree requires fewer force evaluations than a quad-tree or an oct-tree for the same set of points.
Reference: [CK95] <author> P. B. Callahan and S. R. Kosaraju. </author> <title> A decomposition of multi-dimensional point-sets with applications to k-nearest-neighbors and n-body potential fields. </title> <journal> Journal of the ACM, </journal> <volume> 42(1) </volume> <pages> 67-90, </pages> <year> 1995. </year>
Reference-contexts: A paper by Makino [Mak90] studies the performance of oct-trees versus nearest nieghbor trees (a data structure outside of the scope of this current paper.) In terms of data structures, an important related paper is the Fair-Split tree paper by Callahan and Kosaraju <ref> [CK95] </ref>. Although they developed their data structure to get an improved result for cluster-cluster algorithms, it turns out to be very close to the data structure that we advocate in this paper. <p> We prove that the cells of a tight binary spatial decomposition tree (TBSD) satisfy the following lemma. Using the lemma, the argument of Theorem 5.2 applies. The following lemma is based on a packing lemma for fair-split trees proved by Callahan and Kosaraju <ref> [CK95] </ref>. Lemma 8.16 The maximum number of disjoint cells of diameter at least s of a TBSD tree which can intersect a ball of radius s is bounded by a constant. (We establish the lemma in two dimensions, the generalization to three dimensions is straight forward).
Reference: [DS95] <author> M. Dikaiakos and J. Stadel. </author> <title> A performance study of cosmological simulations on message-passing and shared-memory multiprocessors. </title> <note> This paper is available from http://www-hpcc.astro.washington.edu/, 1995. </note>
Reference-contexts: K-d trees have been used in a number of N -body implementations, including the early implementation of Appel [App85] and in the UW KD-grav code <ref> [DS95] </ref>. We show that in the worst case, an N -body algorithm using k-d trees is inferior to an algorithm with a spatially balanced decomposition. There is a bad case point set where the points all lie on a line.
Reference: [GR87] <author> L. Greengard and V. Rokhlin. </author> <title> A fast algorithm for particle simulations. </title> <journal> Journal of Computational Physics, </journal> <volume> 73 </volume> <pages> 325-348, </pages> <year> 1987. </year>
Reference-contexts: The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin <ref> [Gre88, GR87] </ref> which is a cluster-cluster algorithm. Although the algorithm is O (n) time it is not used in astrophysical research. This is primarily because the constant factors in the algorithm are very large, although memory is also a problem.
Reference: [Gre88] <author> L. Greengard. </author> <title> The Rapid Evaluation of Potential Fields in Particle Systems. </title> <publisher> The MIT Press, </publisher> <year> 1988. </year>
Reference-contexts: The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin <ref> [Gre88, GR87] </ref> which is a cluster-cluster algorithm. Although the algorithm is O (n) time it is not used in astrophysical research. This is primarily because the constant factors in the algorithm are very large, although memory is also a problem.
Reference: [JP89] <author> J. G. Jernigan and D. H. Porter. </author> <title> A tree code with logarithmic reduction of force terms, hierarchical regularization of all variables and explicit accuracy controls. </title> <journal> The Astrophysical Journal Supplement, </journal> <volume> 71 </volume> <pages> 871-893, </pages> <year> 1989. </year>
Reference-contexts: More attention has been paid to the asymptotic performance of the algorithms, and to the accuracy properties of particular codes. A series of papers introduced particle-cluster algorithms in the early to mid eighties <ref> [App85, JP89, BH86] </ref>, with the version developed by Barnes and Hut [BH86] receiving the most attention with respect to implementation. The fastest bounds for the force computation problem are for the Fast Multipole Method of Greengard and Roklin [Gre88, GR87] which is a cluster-cluster algorithm.
Reference: [Mak90] <author> J. Makino. </author> <title> Comparison of two different tree algorithms. </title> <journal> The Journal of Computational Physics, </journal> <volume> 88 </volume> <pages> 393-408, </pages> <year> 1990. </year>
Reference-contexts: Papers which have addressed the accuracy of N -body simulations have generally compared different force evaluation strategies [BN95] or studied the trade-off between accuracy and run time [SW94]. A paper by Makino <ref> [Mak90] </ref> studies the performance of oct-trees versus nearest nieghbor trees (a data structure outside of the scope of this current paper.) In terms of data structures, an important related paper is the Fair-Split tree paper by Callahan and Kosaraju [CK95].
Reference: [Sal90] <author> J. K. Salmon. </author> <title> Parallel Hierarchical N-body Methods. </title> <type> PhD thesis, </type> <institution> California Institute of Technology, </institution> <year> 1990. </year>
Reference-contexts: We can use the interaction region to determine the probability that the evaluation at a random point involves a particular cell. (The interaction regions can also be used for an average case analysis with respect to a random set of points <ref> [BN95, Sal90] </ref>.) Experimental results show that the size of the interaction region is a very good predictor of the algorithm's run time [BN95, AS96].
Reference: [Sam89] <author> H. Samet. </author> <title> The Design and Analysis of Spatial Data Structures. </title> <publisher> Addison-Wesley, </publisher> <year> 1989. </year>
Reference-contexts: Instead of tackling this general problem (which is almost certainly NP-hard), we restrict ourselves to look at several tree data structures based upon orthogonal decomposition. There are many different methods for constructing an orthogonal decomposition tree <ref> [Sam89] </ref>. We consider three different options which can be applied independently, yielding eight separate tree data structures. The first option is the degree of the decomposition. The natural choices are either a binary decomposition, or a decomposition into orthants (quadrants in 2-d, octants in 3-d).
Reference: [SW94] <author> J. K. Salmon and M. S. Warren. </author> <title> Skeletons from the treecode closet. </title> <journal> Journal of Computational Physics, </journal> <volume> 111 </volume> <pages> 136-155, </pages> <year> 1994. </year>
Reference-contexts: Papers which have addressed the accuracy of N -body simulations have generally compared different force evaluation strategies [BN95] or studied the trade-off between accuracy and run time <ref> [SW94] </ref>. A paper by Makino [Mak90] studies the performance of oct-trees versus nearest nieghbor trees (a data structure outside of the scope of this current paper.) In terms of data structures, an important related paper is the Fair-Split tree paper by Callahan and Kosaraju [CK95].
Reference: [Vai86] <author> P. M. Vaidya. </author> <title> An optimal algorithm for the all-nearest-neighbors problem. </title> <booktitle> In 27th Symposium on Foundations of Computer Science, </booktitle> <pages> pages 117-122, </pages> <year> 1986. </year> <month> 12 </month>
Reference-contexts: Some work 2 in main stream computational geometry also ties in directly with this, in particular work on the all-nearest neighbor problem <ref> [Vai86] </ref>. 2 Particle-cluster algorithm One version of the particle-cluster algorithm was originally described by Barnes and Hut [BH86]. The data structure is a tree that has a set of particles associated with each node. Each particle is assigned to a unique leaf of the tree. <p> This is at the heart of the packing arguments we allude to. The proof is similar to the correctness proof for Vaidya's all-nearest neighbor algorithm <ref> [Vai86] </ref>. The necessity of accounting for "below evaluations" has been ignored by papers in the physics literature. Theorem 5.2 Let D ave be the average leaf depth of an oct-tree T . The number of force evaluations performed by the particle-cluster algorithm on T is O (nD ave ).
References-found: 16

