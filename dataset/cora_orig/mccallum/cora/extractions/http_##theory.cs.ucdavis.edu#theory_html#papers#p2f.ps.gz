URL: http://theory.cs.ucdavis.edu/theory_html/papers/p2f.ps.gz
Refering-URL: http://theory.cs.ucdavis.edu/
Root-URL: http://www.cs.ucdavis.edu
Title: Luby-Rackoff Backwards: Increasing Security by Making Block Ciphers Non-Invertible  
Author: Mihir Bellare Ted Krovetz Phillip Rogaway 
Keyword: Birthday attacks, block ciphers, pseudorandom functions, symmetric encryption.  
Address: CA 95616, USA.  
Affiliation: Dept. of Computer Science, Engineering II Bldg., University of California at Davis, Davis,  
Note: An extended abstract appears in Advances in Cryptology Eurocrypt 98 Proceedings, Lecture Notes in Computer Science, Vol. 1304, K. Nyberg ed., Springer-Verlag, 1998. This is the full version.  Web page: http://www.cs.ucdavis.edu/~fkrovetz,rogawayg. Supported in part by NSF CAREER Award CCR-9624560 and a MICRO grant from RSA Data Security, Inc.  
Email: E-mail: fkrovetz,rogawayg@cs.ucdavis.edu.  
Date: August 17, 1998  
Abstract: We argue that the invertibility of a block cipher can reduce the security of schemes that use it, and a better starting point for scheme design is the non-invertible analog of a block cipher, that is, a pseudorandom function (PRF). Since a block cipher may be viewed as a pseudorandom permutation, we are led to investigate the reverse of the problem studied by Luby and Rackoff, and ask: "how can one transform a PRP into a PRF in as security-preserving a way as possible?" The solution we propose is data-dependent re-keying. As an illustrative special case, let E : f0; 1g n fi f0; 1g n ! f0; 1g n be the block cipher. Then we can construct the PRF F from the PRP E by setting F (k; x) = E(E(k; x); x). We generalize this to allow for arbitrary block and key lengths, and to improve efficiency. We prove strong quantitative bounds on the value of data-dependent re-keying in the Shannon model of an ideal cipher, and take some initial steps towards an analysis in the standard model. fl Dept. of Computer Science & Engineering, Mail Code 0114, University of California at San Diego, 9500 Gilman Drive, La Jolla, CA 92093, USA. E-mail: mihir@cs.ucsd.edu. Web page: http://www-cse.ucsd.edu/users/mihir. Supported in part by NSF CAREER Award CCR-9624439 and a 1996 Packard Foundation Fellowship in Science and Engineering. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> W. Aiello and R. Vanketesan, </author> <title> "Foiling birthday attacks in output-doubling transformations." </title> <booktitle> Advances in Cryptology - Eurocrypt 96 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 1070, </volume> <editor> U. Maurer ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1996. </year>
Reference-contexts: This scheme was partially analyzed by [2]. Another natural method is F k 1 k 2 (x) = E k 1 (x)E k 2 (x). This has not been analyzed. Aiello and Venkatesan <ref> [1] </ref> give a general construction for turning a PRF E : f0; 1g fi f0; 1g n ! f0; 1g n into a PRF F : f0; 1g 6 fi f0; 1g 2n ! f0; 1g 2n . But this is a different problem.
Reference: [2] <author> M. Bellare, O. Goldreich and H. Krawczyk, </author> <type> personal communications, </type> <year> 1995. </year> <month> 25 </month>
Reference-contexts: So F k will resemble a random function no more than E k does. There are many natural alternatives to the Fn d transformation. For example, truncate E k (x), defining F k (x) to be some appropriate-length prefix of E k (x). This scheme was partially analyzed by <ref> [2] </ref>. Another natural method is F k 1 k 2 (x) = E k 1 (x)E k 2 (x). This has not been analyzed.
Reference: [3] <author> M. Bellare, R. Canetti and H. Krawczyk, </author> <title> "Pseudorandom functions revisited: The cascade construction and its concrete security." </title> <booktitle> Proceedings of the 37th Symposium on Foundations of Computer Science, IEEE, </booktitle> <year> 1996. </year>
Reference-contexts: This too is a good idea, but the construction we give has merit which goes beyond the birthday attacks which we have been using to motivate this problem. 5 2.4 History and related work Our construction is related to the cascade construction of <ref> [3] </ref>. The notion of a PRF was first defined in the polynomial-time framework by Goldreich, Gold-wasser and Micali [8]. A concrete security treatment of PRFs, together with the idea that concretely defined PRFs/PRPs can be used to model block ciphers, originates with [6]. <p> By Time E we mean the worst-case amount of time required to calculate function E in our underlying (fixed) model of computation. We use the notion of multi-oracles as in <ref> [3] </ref>, to provide a framework in which to reason about intermediate constructions that arise in our analysis. A multi-oracle is simply a sequence of oracles, with some rules as to how queries to the multi-oracle are answered by the individual oracles.
Reference: [4] <author> M. Bellare, A. Desai, E. Jokipii and P. Rogaway, </author> <title> "A concrete security treatment of symmetric encryption." </title> <booktitle> Proceedings of the 38th Symposium on Foundations of Computer Science, IEEE, </booktitle> <year> 1997. </year>
Reference-contexts: meaning providing explicit, non-asymptotic bounds on the success probabiilty of an adversary as a function of its resources. 2 A good encryption scheme is much more than one that prevents key recovery from a ciphertext: it should have the property that even partial information about the plaintext is not revealed <ref> [9, 4] </ref>. 3 The attacks are well known. See [4] for an analysis of their effectiveness relative to formal notions of security 3 for many other common modes of operation, too. <p> See <ref> [4] </ref> for an analysis of their effectiveness relative to formal notions of security 3 for many other common modes of operation, too. Thus direct use of a 64-bit block size block cipher usually enables one to safely encrypt no more than 2 32 blocks, which is quite small. <p> So how can we safely encrypt more than 2 n=2 blocks? One answer is to use a slightly different type of primitive in an appropriate mode of operation: specifically, a "pseudorandom function" (PRF) in CTR (counter) mode, as discussed in <ref> [4, 11] </ref> and explained further below. This way to encrypt is easy and has no extra overhead if a PRF of cost comparable to the block cipher is available. <p> " denotes concatenation, and where you increment ctr by m after doing each encryption. (Notice that to decrypt you need only apply F k , so that you don't need this function to be invertible.) Counter-mode encryption with a good PRF is pretty much "ideal encryption": it is shown in <ref> [4] </ref> that an adversary's chance of obtaining partial information about some plaintext, after q blocks have been encrypted, is at most Sec prf strength of F as a PRF. <p> The adversary's advantage then goes quickly to 1 with q 2 n=2 . 2.3 Luby-Rackoff backwards The above is part of an emerging view or understanding, emanating from works like <ref> [4, 5, 6, 20] </ref>, that when it comes to designing higher-level primitives (like encryption schemes or MACs) a PRF is a better tool than a PRP, from two points of view: it permits easier and more effective analysis of the designed scheme, and the resulting schemes have a greater proven quantitative
Reference: [5] <author> M. Bellare, R. Gu erin and P. Rogaway, </author> <title> "XOR MACs: New methods for message authentication using a finite pseudorandom function." </title> <booktitle> Advances in Cryptology - Crypto 95 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 963, </volume> <editor> D. Coppersmith ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1995. </year>
Reference-contexts: The adversary's advantage then goes quickly to 1 with q 2 n=2 . 2.3 Luby-Rackoff backwards The above is part of an emerging view or understanding, emanating from works like <ref> [4, 5, 6, 20] </ref>, that when it comes to designing higher-level primitives (like encryption schemes or MACs) a PRF is a better tool than a PRP, from two points of view: it permits easier and more effective analysis of the designed scheme, and the resulting schemes have a greater proven quantitative
Reference: [6] <author> M. Bellare, J. Kilian and P. Rogaway, </author> <title> "The security of cipher block chaining." </title> <booktitle> Advances in Cryptology - Crypto 94 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 839, </volume> <editor> Y. Desmedt ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1994. </year>
Reference-contexts: The adversary's advantage then goes quickly to 1 with q 2 n=2 . 2.3 Luby-Rackoff backwards The above is part of an emerging view or understanding, emanating from works like <ref> [4, 5, 6, 20] </ref>, that when it comes to designing higher-level primitives (like encryption schemes or MACs) a PRF is a better tool than a PRP, from two points of view: it permits easier and more effective analysis of the designed scheme, and the resulting schemes have a greater proven quantitative <p> The notion of a PRF was first defined in the polynomial-time framework by Goldreich, Gold-wasser and Micali [8]. A concrete security treatment of PRFs, together with the idea that concretely defined PRFs/PRPs can be used to model block ciphers, originates with <ref> [6] </ref>. Luby and Rackoff use the term PRP to refer to a family of permutations that is a PRF family in the sense of [8]. Our notion is different in that we measure the advantage relative to random permutations, not functions. <p> An oracle responds to its query in unit time. 4.1 Complexity theoretic model We will have two measures of security: the strength of G as a PRF and the strength of G as a PRP. We follow <ref> [6] </ref> in the manner in which the basic notion of [8] is "concretized." First, we need the concept of advantage, which for emphasis we call the "computational advan tage" and write CAdv.
Reference: [7] <author> S. Even and Y. Mansour, </author> <title> "A construction of a cipher from a single pseudorandom permutation." </title> <booktitle> Advances in Cryptology - ASIACRYPT 91 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 739, </volume> <editor> H. Imai, R. Rivest and T. Matsumoto ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1991. </year>
Reference-contexts: The ideal block cipher model we use for some of our results is that of [19], used also in <ref> [7, 10] </ref>. There are many natural ways to try to do the PRP-to-PRF conversion. One of the first to come to mind is to define F k (x) = xE k (x). This construction is of value in some contexts, but not in ours. <p> Let FE be some operator on E which returns a new family of functions, and say the new family has key length fl but the block length is still n. (For us, F = Fn d and fl = j where j = d=ne.) As modeled by <ref> [7] </ref>, the adversary that attacks F is given oracles for E (; ) and E 1 (; ) | as well as an oracle f where either f () = F (k fl ; ) for F = FE and k fl a randomly chosen key in f0; 1g fl ,
Reference: [8] <author> O. Goldreich, S. Goldwasser and S. Micali, </author> <title> "How to construct random functions," </title> <journal> Journal of the ACM, </journal> <volume> Vol. 33, No. 4, </volume> <year> 1986, </year> <pages> pp. 210-217. </pages>
Reference-contexts: The notion of a PRF was first defined in the polynomial-time framework by Goldreich, Gold-wasser and Micali <ref> [8] </ref>. A concrete security treatment of PRFs, together with the idea that concretely defined PRFs/PRPs can be used to model block ciphers, originates with [6]. Luby and Rackoff use the term PRP to refer to a family of permutations that is a PRF family in the sense of [8]. <p> and Micali <ref> [8] </ref>. A concrete security treatment of PRFs, together with the idea that concretely defined PRFs/PRPs can be used to model block ciphers, originates with [6]. Luby and Rackoff use the term PRP to refer to a family of permutations that is a PRF family in the sense of [8]. Our notion is different in that we measure the advantage relative to random permutations, not functions. This makes no difference in the polynomial-time framework, but in the concrete-security framework the difference is crucial; indeed, if concrete security is ignored, the problem we are considering does not exist. <p> An oracle responds to its query in unit time. 4.1 Complexity theoretic model We will have two measures of security: the strength of G as a PRF and the strength of G as a PRP. We follow [6] in the manner in which the basic notion of <ref> [8] </ref> is "concretized." First, we need the concept of advantage, which for emphasis we call the "computational advan tage" and write CAdv.
Reference: [9] <author> S. Goldwasser and S. Micali, </author> <title> "Probabilistic encryption." </title> <journal> J. of Computer and System Sciences, </journal> <volume> Vol. 28, </volume> <month> April </month> <year> 1984, </year> <pages> pp. 270-299. </pages>
Reference-contexts: meaning providing explicit, non-asymptotic bounds on the success probabiilty of an adversary as a function of its resources. 2 A good encryption scheme is much more than one that prevents key recovery from a ciphertext: it should have the property that even partial information about the plaintext is not revealed <ref> [9, 4] </ref>. 3 The attacks are well known. See [4] for an analysis of their effectiveness relative to formal notions of security 3 for many other common modes of operation, too.
Reference: [10] <author> J. Kilian and P. Rogaway, </author> <title> "How to protect DES against exhaustive key search." </title> <booktitle> Advances in Cryptology - Crypto 96 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 1109, </volume> <editor> N. Koblitz ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1996. </year>
Reference-contexts: The ideal block cipher model we use for some of our results is that of [19], used also in <ref> [7, 10] </ref>. There are many natural ways to try to do the PRP-to-PRF conversion. One of the first to come to mind is to define F k (x) = xE k (x). This construction is of value in some contexts, but not in ours.
Reference: [11] <author> M. Luby, </author> <title> Pseudorandomness and Crpyptographic Applications. </title> <publisher> Princeton University Press, </publisher> <year> 1996. </year>
Reference-contexts: So how can we safely encrypt more than 2 n=2 blocks? One answer is to use a slightly different type of primitive in an appropriate mode of operation: specifically, a "pseudorandom function" (PRF) in CTR (counter) mode, as discussed in <ref> [4, 11] </ref> and explained further below. This way to encrypt is easy and has no extra overhead if a PRF of cost comparable to the block cipher is available.
Reference: [12] <author> M. Luby and C. Rackoff, </author> <title> "How to construct pseudorandom permutations from pseudorandom functions." </title> <journal> SIAM J. Comput, </journal> <volume> Vol. 17, No. 2, </volume> <month> April </month> <year> 1988. </year>
Reference-contexts: That is, starting with a good PRP E (realized by a block cipher), convert it into a good PRF F . This is effectively the reverse of the problem considered by Luby and Rackoff <ref> [12] </ref>, who wanted to turn PRFs into PRPs. A crucial issue is to make transformations that are as "security preserving" as possible. We want Sec F (q; t) to remain low even for q 2 n=2 . <p> Our methods allow the simpler and more general (ctr; F k2 (ctr)h k1 (M )), where F is the result of PRP-to-PRF conversion starting from E. As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher <ref> [12] </ref>. Luby and Rackoff spawned much further work, including [14, 15, 16, 17, 22], and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions.
Reference: [13] <author> M. Matsui, </author> <title> "The first experimental cryptanalysis of the Data Encryption Standard." </title> <booktitle> Advances in Cryptology - Crypto 94 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 839, </volume> <editor> Y. Desmedt ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 1-11. </pages>
Reference-contexts: DES) will have such an associated security function, which depends on (and to a large extent comprises) its cryptanalytic strength. Of course we won't know for sure what is this function, but we can work with what we know from cryptanalytic results. For example, if the linear cryptanalysis of <ref> [13] </ref> is the best attack on DES, we might assume Sec prp DES (q; t) stays small (close to 0) until q; t reaches around 2 43 . From now on, "block cipher" and "PRP" are synonymous, from the security point of view. Ciphers without invertibility: PRFs.
Reference: [14] <author> U. Maurer, </author> <title> "A simplified and generalized treatment of Luby-Rackoff pseudorandom permutation generators." </title> <booktitle> Advances in Cryptology - Eurocrypt 92 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 658, </volume> <editor> R. Rueppel ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1992, </year> <pages> pp. 239-255. </pages>
Reference-contexts: As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher [12]. Luby and Rackoff spawned much further work, including <ref> [14, 15, 16, 17, 22] </ref>, and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions. Now we present our solution.
Reference: [15] <author> M. Naor and O. Reingold, </author> <title> "On the construction of pseudo-random permutations: Luby-Rackoff revisited." </title> <booktitle> Proceedings of the 29th Annual Symposium on Theory of Computing, ACM, </booktitle> <year> 1997. </year>
Reference-contexts: As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher [12]. Luby and Rackoff spawned much further work, including <ref> [14, 15, 16, 17, 22] </ref>, and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions. Now we present our solution.
Reference: [16] <author> J. Patarin, </author> <title> "Improved security bounds for pseudorandom permutations." </title> <booktitle> Fourth ACM Conference on Computer and Communications Security, </booktitle> <year> 1997. </year> <month> 26 </month>
Reference-contexts: As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher [12]. Luby and Rackoff spawned much further work, including <ref> [14, 15, 16, 17, 22] </ref>, and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions. Now we present our solution.
Reference: [17] <author> J. Patarin, </author> <title> "About Feistel schemes with six (or more) rounds." To appear in Fast Software Encryption (FSE5), </title> <month> March </month> <year> 1998. </year>
Reference-contexts: As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher [12]. Luby and Rackoff spawned much further work, including <ref> [14, 15, 16, 17, 22] </ref>, and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions. Now we present our solution.
Reference: [18] <author> J. Pieprzyk, </author> <title> "How to construct pseudorandom permutations from single pseudorandom functions." </title> <booktitle> Advances in Cryptology - Eurocrypt 90 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 473, </volume> <editor> I. Damg-ard ed., </editor> <publisher> Springer-Verlag, </publisher> <pages> 1990 pp. 140-150. </pages>
Reference: [19] <author> C. Shannon, </author> <title> "Communication theory of secrecy systems." </title> <journal> Bell Systems Technical Journal, </journal> <volume> 28(4), </volume> <month> 656-715 </month> <year> (1949). </year>
Reference-contexts: This makes no difference in the polynomial-time framework, but in the concrete-security framework the difference is crucial; indeed, if concrete security is ignored, the problem we are considering does not exist. The ideal block cipher model we use for some of our results is that of <ref> [19] </ref>, used also in [7, 10]. There are many natural ways to try to do the PRP-to-PRF conversion. One of the first to come to mind is to define F k (x) = xE k (x). This construction is of value in some contexts, but not in ours. <p> The maximum here is over all distinguishers D that make up to q oracle queries and have running time bounded by t. 4.2 Ideal block cipher model The Shannon model <ref> [19] </ref> treats E as a random block cipher. This means that each E k is taken to be random permutation on n-bit strings.
Reference: [20] <author> V. Shoup, </author> <title> "On fast and provably secure message authentication based on universal hashing." </title> <booktitle> Advances in Cryptology - Crypto 96 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 1109, </volume> <editor> N. Koblitz ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1996. </year>
Reference-contexts: The adversary's advantage then goes quickly to 1 with q 2 n=2 . 2.3 Luby-Rackoff backwards The above is part of an emerging view or understanding, emanating from works like <ref> [4, 5, 6, 20] </ref>, that when it comes to designing higher-level primitives (like encryption schemes or MACs) a PRF is a better tool than a PRP, from two points of view: it permits easier and more effective analysis of the designed scheme, and the resulting schemes have a greater proven quantitative <p> a PRP is in hand for doing the encryption, one could define MAC k1;k2 (M ) = (ctr; E k2 (ctr)h k1 (M )), but the security would degrade by fi (q 2 2 n ) compared to using a PRF. (Here q is the number of MACed messages.) Shoup <ref> [20] </ref> describes an alternative with better exact security. Our methods allow the simpler and more general (ctr; F k2 (ctr)h k1 (M )), where F is the result of PRP-to-PRF conversion starting from E.
Reference: [21] <author> M. Wegman and L. Carter, </author> <title> "New hash functions and their use in authentication and set equality." </title> <journal> J. of Computer and System Sciences 22, </journal> <month> 265-279 </month> <year> (1981). </year>
Reference-contexts: In contrast, we go above the original birthday threshold, to a security close to 2 n . Our construction is also more efficient, and it yields a map of the same key size and block length as the original one. In constructing a Wegman-Carter message authentication code (MAC) <ref> [21] </ref> one needs to symmetrically encrypt the universal-hash of each message M .
Reference: [22] <author> Y. Zheng, T. Matsumoto and H. Imai, </author> <title> "Impossibility and optimality results on constructing pseudorandom permutations." </title> <booktitle> Advances in Cryptology - Crypto 90 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 537, </volume> <editor> A. J. Menezes and S. Vanstone ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1990, </year> <pages> pp. 412-422. </pages>
Reference-contexts: As we explained, Luby and Rackoff consider the complementary problem of turning a PRF into a block cipher [12]. Luby and Rackoff spawned much further work, including <ref> [14, 15, 16, 17, 22] </ref>, and our work shares their emphasis on concrete bounds, efficiency, and tight reductions. 3 The Fn Construction We have described in Section 2.4 some simple suggestions that don't work and some related constructions. Now we present our solution.
References-found: 22

