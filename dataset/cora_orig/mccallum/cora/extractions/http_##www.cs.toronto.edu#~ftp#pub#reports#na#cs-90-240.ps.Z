URL: http://www.cs.toronto.edu/~ftp/pub/reports/na/cs-90-240.ps.Z
Refering-URL: http://www.cs.toronto.edu/NA/reports.html
Root-URL: 
Title: Derivation of Efficient Continuous Explicit Runge-Kutta Methods  
Author: by Brynjulf Owren Marino Zennaro 
Address: Toronto, ONT M5S 1A4 (Canada).  I-67100 L'Aquila (Italy).  
Affiliation: Computer Science department University og Toronto  Dipartimento di Matematica Pura ed Applicada, Universita' dell'Aquila,  
Abstract: Continuous Explicit Runge-Kutta methods with the minimal number of stages are considered. These methods are continuously differentiable if and only if one of the stages is the FSAL evaluation. A characterization of a subclass of these methods is developed for order 3,4 and 5. It is shown how the free parameters of these methods can be used either to minimize the continuous truncation error coefficients or to maximize the stability region. As a representative for these methods the 5th order method with minimized error coefficients is chosen, supplied with an error estimation method, and analysed by using the DETEST software. The results are compared with a similar implementation of the Dormand-Prince 5(4) pair with interpolant, showing a significant advantage to the new method for the chosen problems. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> J.C. Butcher, </author> <title> Coefficients for the study of Runge-Kutta integration processes, </title> <journal> J. Austral. Math. Soc., </journal> <volume> 3 (1963), </volume> <pages> pp. </pages> <month> 185-201. </month> <title> [2] , Implicit Runge-Kutta processes, </title> <journal> Math. Comp., </journal> <volume> 18 (1964), </volume> <pages> pp. </pages> <month> 50-64. </month> <title> [3] , The numerical analysis of ordinary differential equations, </title> <editor> J. </editor> <publisher> Wiley & Sons, </publisher> <year> 1987. </year>
Reference-contexts: These tests are made with a 5th order representative of the CERK methods described in this paper, displaying the properties of the underlying discrete method. 2 Preliminary results Henceforth we shall make extensive use of the theory of rooted trees and order conditions developed by Butcher <ref> [1, 2] </ref>. <p> For 0 1 it attains the maximum value 1 at = 1 and it can be shown that c 2 and c 3 can be chosen such that the three remaining error polynomials satisfy je i ()j &lt; 0:05; 2 <ref> [0; 1] </ref>.
Reference: [4] <author> M. Calvo, J.I. Montijano, and L. R andez, </author> <title> A fifth order interpolant for the Dor-mand and Prince Runge-Kutta method, </title> <journal> J. Comput. Appl. Math., </journal> <year> (1990), </year> <pages> pp. 91-100. </pages>
Reference-contexts: In fact, a CERK method is equivalent to a Runge-Kutta method supplied with an interpolant. On surveying the literature one finds such interpolants for most of the commonly used Runge-Kutta formulas, e.g. Shampine [17, 18], Dormand and Prince [6, 7], Calvo et al. <ref> [4] </ref> and Horn [13]. Enright et al. [8] provides a general technique for constructing interpolants to a Runge-Kutta formula while Zennaro [20] discusses natural continuous extensions of Runge-Kutta methods which are especially suited for functional differential equations when certain restrictions are imposed on the mesh. <p> Following e.g. Calvo et al.<ref> [4] </ref> we shall attempt to make the error polynomials small in some sense. The literature is not consistent with regard to what norm should be used on this n p+1 -vector of polynomials. Calvo et al. [4] minimize the quantity g fl = 0 10 over the free parameters, where g () = u t i=N p +1 [e i ()ff (t i )] 2 i=N p +1 [e i (1)ff (t i )] 2 Enright et al. [8] consider bounds for the principal error term on <p> As reference we have performed the same tests with an identical implementation of the Dormand-Prince RK5 (4)7M method [5], henceforth called DP54, with a continuous extension obtained at the additional cost of 2 stages per step, see e.g. <ref> [4] </ref>. Hence, the effective cost per step is 8 stages for the Dormand-Prince extension and 7 stages for our 5th order CERK-method. In order to compare these two pairs, we have found it natural to use normalised efficiency, a feature of the DETEST software.
Reference: [5] <author> J.R. Dormand and P.J. Prince, </author> <title> A family of embedded Runge-Kutta formulae, </title> <journal> J. Comput. Appl. Math., </journal> <volume> 6 (1980), </volume> <pages> pp. 19-26. </pages> <note> [6] , Runge-Kutta triples, Comput. Math. Appl., </note> <month> 12A </month> <year> (1986), </year> <pages> pp. </pages> <month> 1007-1017. </month> <title> [7] , Practical Runge-Kutta processes, </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 5 (1989), </volume> <pages> pp. 977-989. </pages>
Reference-contexts: Most implementations of the discrete pairs proposed by Fehlberg [11] are of the former type while in the methods of Dormand and Prince <ref> [5] </ref> the intention is to impose p = q + 1 (local extrapolation). We will pay most of our attention to the latter type of pairs, mainly for two reasons. Firstly, we have the following negative result for the typical Fehlberg type implementations. <p> Remark: Dormand and Prince attempt to minimize the denominator of (5.9) in their discrete pair RK5 (4)7M <ref> [5] </ref>. If we use the same error measure for our discrete underlying formulas of the 5th order methods, it turns out that we can only obtain an error at the end point about three times the size of that of RK5 (4)7M. <p> We used absolute error control, attempting to control the 13 local error at the end point of each step. As reference we have performed the same tests with an identical implementation of the Dormand-Prince RK5 (4)7M method <ref> [5] </ref>, henceforth called DP54, with a continuous extension obtained at the additional cost of 2 stages per step, see e.g. [4]. Hence, the effective cost per step is 8 stages for the Dormand-Prince extension and 7 stages for our 5th order CERK-method.
Reference: [8] <author> W.H. Enright, K.R. Jackson, S.P. Ntrsett, and P.G. Thomsen, </author> <title> Interpolants for Runge-Kutta formulas, </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> 12 (1986), </volume> <pages> pp. </pages> <month> 193-218. </month> <title> [9] , Effective Solution of Discontinuous IVPs Using a Runge-Kutta Formula Pair with Interpolants, </title> <journal> Appl. Math. and Comput., </journal> <volume> 27 (1988), </volume> <pages> pp. 313-335. </pages>
Reference-contexts: On surveying the literature one finds such interpolants for most of the commonly used Runge-Kutta formulas, e.g. Shampine [17, 18], Dormand and Prince [6, 7], Calvo et al. [4] and Horn [13]. Enright et al. <ref> [8] </ref> provides a general technique for constructing interpolants to a Runge-Kutta formula while Zennaro [20] discusses natural continuous extensions of Runge-Kutta methods which are especially suited for functional differential equations when certain restrictions are imposed on the mesh. In a recent paper Verner [19] elaborates differentiable interpolants of higher order. <p> Calvo et al. [4] minimize the quantity g fl = 0 10 over the free parameters, where g () = u t i=N p +1 [e i ()ff (t i )] 2 i=N p +1 [e i (1)ff (t i )] 2 Enright et al. <ref> [8] </ref> consider bounds for the principal error term on the intervals 0 1 and 0 2. They use the norm max f max je i ()jg where e = 1 or e = 2.
Reference: [10] <author> W.H. Enright and J.D. Pryce, </author> <title> Two Fortran Packages for Assessing Initial Value Problems, </title> <journal> TOMS, </journal> <volume> 13 (1987), </volume> <pages> pp. 1-27. </pages>
Reference-contexts: We give a complete recipe for the construction of some if not all such methods, and we present pairs of formulas with optimized error constants and show how the regions of absolute stability may be optimized. Finally we present some results based on tests made with the DETEST package <ref> [10] </ref>. These tests are made with a 5th order representative of the CERK methods described in this paper, displaying the properties of the underlying discrete method. 2 Preliminary results Henceforth we shall make extensive use of the theory of rooted trees and order conditions developed by Butcher [1, 2]. <p> may choose c 3 and c 6 such that ff 6 0:7956 and ff 7 0:3305 which, again according to [15], maximizes the region of absolute stability. 7 Numerical results with DETEST We have tested the 5th order pair, henceforth denoted CM54, on some selected problems using the DETEST package <ref> [10] </ref>. We used absolute error control, attempting to control the 13 local error at the end point of each step. <p> Piecewise linear interpolation then yields continuous extensions of the tabulated efficiency statistics. See <ref> [10] </ref> for a more detailed explanation. We believe that the test problems chosen give a good idea of how the two methods perform with DETEST.
Reference: [11] <author> E. Fehlberg, </author> <title> Classical fifth-,sixth-,seventh- and eighth order Runge-Kutta formulas with step size control, </title> <type> Tech. Rep. 287, </type> <institution> NASA, </institution> <year> 1968. </year> <note> Extract published in Computing 4 (1969) 93-106. </note>
Reference-contexts: It is obvious that we must require p 6= q and it is customary to assume that jp qj = 1, but it is not clear whether one should have q &gt; p or p &gt; q. Most implementations of the discrete pairs proposed by Fehlberg <ref> [11] </ref> are of the former type while in the methods of Dormand and Prince [5] the intention is to impose p = q + 1 (local extrapolation). We will pay most of our attention to the latter type of pairs, mainly for two reasons.
Reference: [12] <author> E. Hairer, S.P. Ntrsett, and G. Wanner, </author> <title> Solving Ordinary Differential Equations I, Nonstiff Problems, </title> <publisher> Springer Verlag, </publisher> <year> 1987. </year>
Reference-contexts: We shall be concerned with the strategy based on embedded formulas (see <ref> [12] </ref> for details) and we shall see how this strategy can be adapted to pairs of CERK methods.
Reference: [13] <author> M.K. Horn, Fourth- and fifth-order, </author> <title> scaled Runge-Kutta algorithms for treating dense output, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 20 (1983), </volume> <pages> pp. 558-568. </pages>
Reference-contexts: In fact, a CERK method is equivalent to a Runge-Kutta method supplied with an interpolant. On surveying the literature one finds such interpolants for most of the commonly used Runge-Kutta formulas, e.g. Shampine [17, 18], Dormand and Prince [6, 7], Calvo et al. [4] and Horn <ref> [13] </ref>. Enright et al. [8] provides a general technique for constructing interpolants to a Runge-Kutta formula while Zennaro [20] discusses natural continuous extensions of Runge-Kutta methods which are especially suited for functional differential equations when certain restrictions are imposed on the mesh.
Reference: [14] <author> Z. Jackiewicz and M. Zennaro, </author> <title> Variable step explicit two-step Runge-Kutta methods, </title> <type> Tech. Rep. 125, </type> <institution> Arizona State University, </institution> <month> May </month> <year> 1990. </year> <month> 16 </month>
Reference-contexts: Then, since rank (F p (A)) = s it is impossible to find two distinct sets of weights that satisfy the first N p discrete order conditions. The second reason is based on a recent result by Jackiewicz and Zennaro <ref> [14] </ref>. They find that given a CERK method of order p with s=CEN (p) stages, it is possible to obtain a two-step Runge-Kutta method of order p + 1 at no additional cost. Hence, one may use this two-step approximation of order p + 1 to obtain an error estimate.
Reference: [15] <author> B. Owren and K. Seip, </author> <title> Some stability results for explicit Runge-Kutta methods, </title> <journal> BIT, </journal> <volume> 30 (1990), </volume> <pages> pp. 700-706. </pages>
Reference-contexts: It can be shown that for our fourth order methods we have ff 5 = 5 (1 2c 3 )c 4 . Following <ref> [15] </ref> the largest disk of stability is obtained by choosing ff 5 0:5806; 12 0 6 6 4 16 16 2 4 3 1 4 4 3 1 9 369 343 343 9604 4802 8 133 1113 7945 24064 315 156065 1 83 825 180 36 38610 20475 9 0 40 <p> E.g. the choice c 3 = 2 5 and c 4 = 4 7 leads to a nearly optimal stability region in the sense of <ref> [15] </ref>. The fifth order methods yield ff 6 = 6 (5c 2 with fi = 20c 2 3 15c 3 + 3. Thus, for any (; -) 2 R fi R there exist real c 3 and c 6 such that ff 6 = and ff 7 = -. <p> So the stability polynomial is only restricted by the assumptions made in the construction of the CERK-formulas. In particular one may choose c 3 and c 6 such that ff 6 0:7956 and ff 7 0:3305 which, again according to <ref> [15] </ref>, maximizes the region of absolute stability. 7 Numerical results with DETEST We have tested the 5th order pair, henceforth denoted CM54, on some selected problems using the DETEST package [10]. We used absolute error control, attempting to control the 13 local error at the end point of each step.
Reference: [16] <author> B. Owren and M. Zennaro, </author> <title> Order barriers for continuous explicit Runge-Kutta methods, </title> <journal> Math. Comp., </journal> <volume> 56 (1991), </volume> <pages> pp. 645-661. </pages>
Reference-contexts: We are interested in a continuous approximation to the solution y (x) for x 2 [x 0 ; x e ]. A possible way to obtain such an approximation is to apply a continuous explicit Runge-Kutta method (CERK method) as proposed by the authors in <ref> [16] </ref>. One may expect such a method to be appropriate in the case when (1.1) is non-stiff. <p> In a recent paper Verner [19] elaborates differentiable interpolants of higher order. An important issue in many of these papers has been whether or not the continuous approximation should yield the same order of consistency in the interior of the step as at the endpoints. Following <ref> [16] </ref> we shall define the uniform order, or simply the order of a CERK method as the greatest integer p for which max jy n+1 (x n + h n ) u n+1 (x n + h n )j = O (h p+1 2 where y n+1 (x) is the local <p> Here j j can be any norm on R m . Of course the order q at the endpoints satisfies q p and in this paper we shall not impose the possible additional requirement that q &gt; p for any of our methods. We shall always require (see <ref> [16] </ref>) that the degree d of the polynomials b i (); i = 1; . . . ; s; satisfies d p. Again according to [16] one may for each order p define the order barrier as the smallest number of stages CEN (p) that a CERK method satisfying (1.2) can <p> We shall always require (see <ref> [16] </ref>) that the degree d of the polynomials b i (); i = 1; . . . ; s; satisfies d p. Again according to [16] one may for each order p define the order barrier as the smallest number of stages CEN (p) that a CERK method satisfying (1.2) can have. These order barriers were derived for p 5, it was found that CEN (1)=1, CEN (2)=2, CEN (3)=4, CEN (4)=6 and CEN (5)=8. <p> These tests are made with a 5th order representative of the CERK methods described in this paper, displaying the properties of the underlying discrete method. 2 Preliminary results Henceforth we shall make extensive use of the theory of rooted trees and order conditions developed by Butcher [1, 2]. From <ref> [16] </ref> we find the continuous version of the order conditions s X b j () j (t) = fl (t) for all trees t such that (t) p, (2.3) where j (t) is the jth elementary weight for the tree t, (t) is the order of t, and fl (t) is <p> It was pointed out in <ref> [16] </ref> that a CERK method is of order p if and only if rank (F p (A)) = rank (G p (A)). <p> It was proved in <ref> [16] </ref> that a necessary condition for a CERK method of order p to have CEN (p) stages is that A 2 M p fl . <p> Considering order p = 4 we shall restrict ourselves to the methods derived in <ref> [16] </ref> having CEN (4)=6 stages. <p> rows corresponding to the trees t; [t ]; [t 2 ]; [ 2 t ] 2 ; [t 3 ]; [ 3 t ] 3 ; [t 4 ]; [ 4 t ] 4 : (3.8) For a detailed discussion of such 5th order CERK methods with 8 stages, see <ref> [16] </ref>. <p> The ratio was equal to 1.0 in 87% of the cases, and in the range 1.0-1.32 in 99 % of the tests. In this paper we have used the framework of <ref> [16] </ref> to characterize differentiable continuous explicit Runge-Kutta methods with the minimal number of stages for order 3,4 and 5. Of particular interest are the 5th order methods with only 7 effective stages since no such methods have been presented before.
Reference: [17] <author> L.F. Shampine, </author> <title> Interpolation for Runge-Kutta methods, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 22 (1985), </volume> <pages> pp. </pages> <month> 1014-1027. </month> <title> [18] , Some Practical Runge-Kutta Formulas, </title> <journal> Math. Comp., </journal> <volume> 173 (1986), </volume> <pages> pp. 135-150. </pages>
Reference-contexts: In fact, a CERK method is equivalent to a Runge-Kutta method supplied with an interpolant. On surveying the literature one finds such interpolants for most of the commonly used Runge-Kutta formulas, e.g. Shampine <ref> [17, 18] </ref>, Dormand and Prince [6, 7], Calvo et al. [4] and Horn [13].
Reference: [19] <author> J. Verner, </author> <title> Differentiable Interpolants for High-Order Runge-Kutta Methods, </title> <type> Tech. Rep. 1990-9, </type> <institution> Queens's University, </institution> <year> 1990. </year>
Reference-contexts: Enright et al. [8] provides a general technique for constructing interpolants to a Runge-Kutta formula while Zennaro [20] discusses natural continuous extensions of Runge-Kutta methods which are especially suited for functional differential equations when certain restrictions are imposed on the mesh. In a recent paper Verner <ref> [19] </ref> elaborates differentiable interpolants of higher order. An important issue in many of these papers has been whether or not the continuous approximation should yield the same order of consistency in the interior of the step as at the endpoints.
Reference: [20] <author> M. Zennaro, </author> <title> Natural Continuous Extensions of Runge Kutta Methods, </title> <journal> Math. Comp., </journal> <volume> 46 (1986), </volume> <pages> pp. 119-133. </pages>
Reference-contexts: On surveying the literature one finds such interpolants for most of the commonly used Runge-Kutta formulas, e.g. Shampine [17, 18], Dormand and Prince [6, 7], Calvo et al. [4] and Horn [13]. Enright et al. [8] provides a general technique for constructing interpolants to a Runge-Kutta formula while Zennaro <ref> [20] </ref> discusses natural continuous extensions of Runge-Kutta methods which are especially suited for functional differential equations when certain restrictions are imposed on the mesh. In a recent paper Verner [19] elaborates differentiable interpolants of higher order.
References-found: 14

