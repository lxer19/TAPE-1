URL: http://dimacs.rutgers.edu/Workshops/Security/program2/schubert.ps
Refering-URL: http://dimacs.rutgers.edu/Workshops/Security/program2/program.html
Root-URL: http://www.cs.rutgers.edu
Email: fsarah,schubertg@cs.pdx.edu  
Title: Formal Analysis of IP Layer Security  
Author: Sarah Mocas and Tom Schubert 
Affiliation: Department of Computer Science Portland State University  
Abstract: The use of formal methods during the development of a security protocol permits the designer to identify subtle assumptions that can lead to security flaws. Automated support for using formal methods can greatly assist this process, however, for many applications, correct formal modeling of a protocol and identification of its underlying assumptions is initially of greater importance than automated proofs. With this in mind, we model several different security mechanisms and protocols that are currently being developed for use at the IP network layer. Specifically we model the proposed IPSEC security extensions, AH and ESP, to determine the soundness of these propositions. In the context of Mobile-IP, we investigate the use of formal logics to examine IP layer security mechanisms but especially mobile node registration.
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> M. Abadi and M. Tuttle. </author> <title> A semantics for a logic of authentication. </title> <booktitle> In Proceedings of the Tenth ACM Symposium on Principles of Distributed Computing, </booktitle> <pages> pages 201-216. </pages> <publisher> ACM Press, </publisher> <year> 1991. </year>
Reference-contexts: Initially, mobile registration requires the use of an untrusted route to establish a secure tunnel. We model the registration services that are provided via a routing daemon using a UDP port. Several logics for analyzing cryptographic protocols and authentication schemes have been proposed (see for example <ref> [1, 3, 4, 13, 14] </ref>). Belief logics are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs.
Reference: [2] <author> R. Atkinson. </author> <title> IP Encapsulating Security Payload (ESP). Network Working Group Request for Comments: </title> <type> 1827, </type> <month> August </month> <year> 1996. </year>
Reference-contexts: A natural location is at the IP level of the protocol stack. This particular idea is receiving much attention and several mechanisms for achieving this result have been proposed for possible standardization <ref> [2, 5, 6, 7] </ref>. There is also a natural combination of IP layer security mechanisms and mobile networking to create secure mobile networks (secure Mobile-IP). <p> Further material on cryptography can be found in [11]. 1 A one time pad is provably secure, this is an exception. 3 2.1 Basic IP Security Headers The IP level security headers, AH and ESP, were originally proposed by the Network Working Group focused on IP security mechanisms, IPSEC <ref> [5, 6, 2, 7] </ref>. The term IPSEC will be used loosely to refer to packets, keys and routes that are associated with these headers. The IP Authentication Header (AH) is used to provide authentication. The IP Encapsulating Security Header (ESP) is used to provide confidentiality to IP datagrams. <p> The first version of the ESP header did not include an authentication mechanism <ref> [2] </ref>. In the earliest version of the ESP header, it was claimed that in addition to confidentiality, the ESP header also supplied authentication even though no authentication transform was used (see the discussion on authentication) [2]. This claim is misleading. <p> The first version of the ESP header did not include an authentication mechanism <ref> [2] </ref>. In the earliest version of the ESP header, it was claimed that in addition to confidentiality, the ESP header also supplied authentication even though no authentication transform was used (see the discussion on authentication) [2]. This claim is misleading. The current proposed ESP header does not provide either authentication or confidentiality unless the optional authentication feature of the header is used.
Reference: [3] <author> Michael Burrows, Martin Abadi, and Roger Needham. </author> <title> A logic of authentication. </title> <journal> ACM Transactions on Computer Systems, </journal> <volume> 8(1), </volume> <month> Feb. </month> <year> 1990. </year>
Reference-contexts: Initially, mobile registration requires the use of an untrusted route to establish a secure tunnel. We model the registration services that are provided via a routing daemon using a UDP port. Several logics for analyzing cryptographic protocols and authentication schemes have been proposed (see for example <ref> [1, 3, 4, 13, 14] </ref>). Belief logics are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs. <p> For example, algorithms and keys for use with the AH and ESP headers can be negotiated. 2.3 Mechanized Belief Logics Belief logics <ref> [3] </ref> are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs. Logics devised to reason about cryptographic protocols generally consider only idealized protocols; there are no bit streams, but rather typed messages.
Reference: [4] <author> L. Gong and R. Needhamand R. Yahalom. </author> <title> Reasoning about belief in cryptographic protocols. </title> <booktitle> In Proceedings of the 1990 IEEE Computer Society Symposium on Research in Security and Privacy. </booktitle> <publisher> IEEE Computer Society Press, </publisher> <year> 1990. </year>
Reference-contexts: Initially, mobile registration requires the use of an untrusted route to establish a secure tunnel. We model the registration services that are provided via a routing daemon using a UDP port. Several logics for analyzing cryptographic protocols and authentication schemes have been proposed (see for example <ref> [1, 3, 4, 13, 14] </ref>). Belief logics are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs.
Reference: [5] <author> S. Kent and R. Atkinson. </author> <title> IP Authentication Header. Network Working Group, Internet Draft: </title> <address> draft-ietf-ipsec-auth-05.txt, </address> <month> July </month> <year> 1997. </year>
Reference-contexts: A natural location is at the IP level of the protocol stack. This particular idea is receiving much attention and several mechanisms for achieving this result have been proposed for possible standardization <ref> [2, 5, 6, 7] </ref>. There is also a natural combination of IP layer security mechanisms and mobile networking to create secure mobile networks (secure Mobile-IP). <p> Further material on cryptography can be found in [11]. 1 A one time pad is provably secure, this is an exception. 3 2.1 Basic IP Security Headers The IP level security headers, AH and ESP, were originally proposed by the Network Working Group focused on IP security mechanisms, IPSEC <ref> [5, 6, 2, 7] </ref>. The term IPSEC will be used loosely to refer to packets, keys and routes that are associated with these headers. The IP Authentication Header (AH) is used to provide authentication. The IP Encapsulating Security Header (ESP) is used to provide confidentiality to IP datagrams. <p> Therefore, the plaintext is also authenticated. 8 4 The AH Header The AH header consists of the following fields: N extHeaderjP ayloadLenjReservedjSP IjSeqN ojAuthenticationData and is preceded by an IP header and followed by the data <ref> [5] </ref>. The AuthenticationData field is the hash-value. In transport mode an AH packet is: IP HeaderjN extHeaderjP ayloadLenjReservedjSP IjSeqN o jAuthenticationDatajData In our abstract packet format this is: (AH; datalist; (IP Header; N extHeader; P ayloadLen; Reserved; SP I; SeqN o; AuthenticationData; Data); ()) where data-list is the entire packet. <p> Since all fields in a packet using the AH header are included in the hash-data, it is easy to prove that integrity and authentication are provided over the entire packet. AH may also be used in tunnel mode (see <ref> [5] </ref>) but again since all fields are covered by an authenticator, such as a hash, it is easy to show that both integrity and authentication are provided for the packet. 5 The ESP Header The newest version of the ESP header consists of the following fields: SP IjSeqN ojP ayloadjP adjP
Reference: [6] <author> S. Kent and R. Atkinson. </author> <title> IP Encapsulating Security Payload (ESP). Network Working Group, Internet Draft: </title> <address> draft-ietf-ipsec-esp-04.txt, </address> <month> July </month> <year> 1997. </year>
Reference-contexts: A natural location is at the IP level of the protocol stack. This particular idea is receiving much attention and several mechanisms for achieving this result have been proposed for possible standardization <ref> [2, 5, 6, 7] </ref>. There is also a natural combination of IP layer security mechanisms and mobile networking to create secure mobile networks (secure Mobile-IP). <p> Further material on cryptography can be found in [11]. 1 A one time pad is provably secure, this is an exception. 3 2.1 Basic IP Security Headers The IP level security headers, AH and ESP, were originally proposed by the Network Working Group focused on IP security mechanisms, IPSEC <ref> [5, 6, 2, 7] </ref>. The term IPSEC will be used loosely to refer to packets, keys and routes that are associated with these headers. The IP Authentication Header (AH) is used to provide authentication. The IP Encapsulating Security Header (ESP) is used to provide confidentiality to IP datagrams. <p> such as a hash, it is easy to show that both integrity and authentication are provided for the packet. 5 The ESP Header The newest version of the ESP header consists of the following fields: SP IjSeqN ojP ayloadjP adjP adLenjN extHeader jAuthenticationData and is preceded by an IP header <ref> [6] </ref>. In transport mode an ESP packet is: IP HearderjSP IjSeqN ojP ayloadjP adjP adLenjN extHeader jAuthenticationData where Payload is a TCP header followed by data. <p> The use of the self-correcting Cipher Block Chaining Mode increases this possibility. In an attempt to make the latest version of the ESP header backward compatible, the use of a cryptographic hash over parts of an ESP packet is an optional default. As is mentioned in <ref> [6] </ref>, if this option is not used, confidentiality is not guaranteed. Processing the ESP header by first encrypting and then authenticating allows for fast detection of improperly constructed or replayed packages since only the authentication function needs to be computed. <p> This is done to reduce the success of denial of service attacks and also allows processing of the hash and decryption transformations to be done in parallel <ref> [6] </ref>. 5.1 Hash then Encrypt The newest version of the ESP header first encrypts the encrypted-data and then applies an authentication transform to the hash-data, next we examine the reverse process.
Reference: [7] <author> S. Kent and R. Atkinson. </author> <title> Security Architecture for the Internet Protocol. Network Working Group, Internet Draft: </title> <address> draft-ietf-ipsec-.txt, </address> <year> 1997. </year>
Reference-contexts: A natural location is at the IP level of the protocol stack. This particular idea is receiving much attention and several mechanisms for achieving this result have been proposed for possible standardization <ref> [2, 5, 6, 7] </ref>. There is also a natural combination of IP layer security mechanisms and mobile networking to create secure mobile networks (secure Mobile-IP). <p> Using our mechanization of SVO, we formally demonstrate the danger of preserving backward compatibility of the ESP header. 2 Background The following standard definitions are primarily taken from <ref> [7] </ref>, which outlines a security architecture for the Internet. 2 Authentication is the property of knowing that the data received is the same as the data that was sent and that the claimed sender is in fact the actual sender. <p> Further material on cryptography can be found in [11]. 1 A one time pad is provably secure, this is an exception. 3 2.1 Basic IP Security Headers The IP level security headers, AH and ESP, were originally proposed by the Network Working Group focused on IP security mechanisms, IPSEC <ref> [5, 6, 2, 7] </ref>. The term IPSEC will be used loosely to refer to packets, keys and routes that are associated with these headers. The IP Authentication Header (AH) is used to provide authentication. The IP Encapsulating Security Header (ESP) is used to provide confidentiality to IP datagrams.
Reference: [8] <author> D. Maughan, M. Schertler, M. Schneider, and J. Turner. </author> <title> Internet Security Associations and Key Management Protocol (ISAKMP). IPSEC Working Group, </title> <type> Internet Draft, </type> <month> February </month> <year> 1997. </year> <month> 18 </month>
Reference-contexts: A detailed discussion of Internet Security Association and Key Management Protocols, ISAKMP, can be found in <ref> [8] </ref>. In the simplest case, security association information and secret keys can be transfered in a secure manner to all parties statically. The harder case is the dynamic exchange of this information. ISAKMP assumes that entities that are negotiating a security association exchange digitally signed messages. <p> IPSEC keys may be exchanged between a home agent and a mobile node in advance of mobility or may be negotiated after registration. Such negotiations are outlined in <ref> [8] </ref>. Typically, an initially agreed on key should be used only to encrypt additional keys that are used with the IPSEC headers. It is standard practice to change data encryption keys regularly.
Reference: [9] <author> Tom Melham. </author> <title> Automating recursive type definitions in higher order logic. </title> <editor> In G. Birtwhistle and P.A Subrahmanyam, editors, </editor> <booktitle> Current Trends in Hardware Verification and Automated Theorem Proving, </booktitle> <pages> pages 341-386. </pages> <publisher> Springer-Verlag, </publisher> <year> 1989. </year>
Reference-contexts: For example, these 4 logics all assume that the cryptoalgorithm is secure. Using the HOL system's type definition mechanisms, we define a number of application specific data types. HOL's recursive type definition facility <ref> [9] </ref> automates the process of defining new data types in terms of already existing types. Both new type constants and type constructors (operators) can be defined. Additional (recursive) functions can be defined to operate on the concrete data representation of the type.
Reference: [10] <author> C. Perkins. </author> <title> IP Mobility Support. Network Working Group Request for Comments: </title> <year> 2002, </year> <month> October </month> <year> 1996. </year>
Reference-contexts: An initial protocol is used to register the mobile node's location with its home agent. It is necessary, even if further communications require no security, that control messages between a mobile node and a home agent that are used for mobile registration be authenticated <ref> [10] </ref>. Therefore, as a minimum requirement, a mobile node and home agent must share the basic information needed for a security association to support authentication during registration. <p> Functionality is defined in terms of services that can be provided or are used. The following definition are similar to those found in <ref> [10] </ref>. A mobile node, MN, is a host or router that can change its point of attachment from one network or subnetwork to another. A change of location does not necessitate a change of IP address. <p> In this context, a node that is connected via a wireless connection directly to its home network is considered to be local and not mobile. For details on proposed mobile standards see <ref> [10] </ref>. 6.2 Mobile Registration There are several levels of security needed for a reasonable implementation of a secure mobile network and therefore, several different classes of cryptographic keys. The key material used for mobile registration will be referred to as the Mobil-IP authentication key. <p> The last might be viewed as "routing" keys. Mobile-IP registration requires that control messages between the home agent and mobile node are authenticated <ref> [10] </ref>. A general assumption is that the home agent and mobile node have agreed on the information needed for a Mobility Security Association in advance of registration. In this case, a SA, based on the Mobile-IP authentication key, exists between the home agent and mobile node prior to mobile registration. <p> The security association between the mobile node and the home agent is based on a predetermined shared key or certificate. The mobile registration request packet consists of the following fields: T ypejF lagsjLif etimejHomeAddressjHomeAgentjCareOf AddressjIdjExt and is preceded by an UDP header <ref> [10] </ref>. In this case, Type will indicate either a registration request of reply message. Home Address is the mobile node's address in its home subnet. Home Agent is the IP address of the home agent. <p> The mobile registration reply packet consists of the following fields: T ypejCodejLif etimejHomeAddressjHomeAgentjCareOf AddressjIdjExt 13 and is preceded by an UDP header <ref> [10] </ref>. Code indicates the status of the registration request with the same Id. The Mobile-Home Authentication Extension format is the same as that for registration request messages.
Reference: [11] <author> Bruce Schneier. </author> <title> Applied Cryptography. </title> <publisher> John Wiley & Sons, Inc, </publisher> <year> 1994. </year>
Reference-contexts: In all examples and arguments, we will assume that the cryptographic algorithms are computationally secure. Further material on cryptography can be found in <ref> [11] </ref>. 1 A one time pad is provably secure, this is an exception. 3 2.1 Basic IP Security Headers The IP level security headers, AH and ESP, were originally proposed by the Network Working Group focused on IP security mechanisms, IPSEC [5, 6, 2, 7]. <p> A shared secret key can also be used instead of a hash--value, while this is true it is not recommended for use with IP headers. Typically, encryption algorithms are used in combination with encryption block modes which allow an association between different encrypted blocks of the same message (see <ref> [11] </ref> for details). A commonly used mode, Cipher Block Chaining (CBC), has a self correcting property which would allow an attacker to cut and paste early encrypted blocks without effecting the decryption of later encrypted blocks.
Reference: [12] <author> Tom Schubert and Sarah Mocas. </author> <title> A mechanized logic for secure key escrow protocol verification. In International Workshop on the HOL Theorem Proving System and its Applications. </title> <publisher> Springer-Verlag, </publisher> <month> August </month> <year> 1995. </year>
Reference-contexts: Performing proofs however, remains a human-intensive process. To better support the use of our mechanized logic, we have developed a general infrastructure base, based on earlier work <ref> [12] </ref>, for creating automated and interactive procedures to prove goals about inductively defined relations. The infrastructure provides tools to build interactive functions and goal-directed support functions, procedures to eliminate existentially quantified variables from terms, and tactics to generalize existentially quantified rules.
Reference: [13] <author> Paul F. Syverson and Paul C. van Oorschot. </author> <title> On unifying some cryptographic protocol logics. </title> <booktitle> In Proceedings of the 1993 IEEE Symposium on Research in Security and Privacy, </booktitle> <month> May </month> <year> 1994. </year>
Reference-contexts: Initially, mobile registration requires the use of an untrusted route to establish a secure tunnel. We model the registration services that are provided via a routing daemon using a UDP port. Several logics for analyzing cryptographic protocols and authentication schemes have been proposed (see for example <ref> [1, 3, 4, 13, 14] </ref>). Belief logics are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs. <p> For example, these logics all assume that the cryptoalgorithm is secure. Our logic for IP layer security mechanisms closely follows the logic used for analyzing protocols that was developed by Syverson and vanOorschot <ref> [13] </ref>. Syverson and vanOorschot's logic was chosen as it encompasses many of the desirable features from earlier developed logics in an integrated approach. <p> Additional (recursive) functions can be defined to operate on the concrete data representation of the type. The properties of new types must be derived by formal proof. This guarantees that the type does not introduce inconsistency into the logic. The SVO logic <ref> [13] </ref> defines a number of property predicates to describe the set of beliefs present in a system. This set may also include "facts" that may not be believed by all principals. Informally, a message can be received, but it may be encrypted.
Reference: [14] <author> P. vanOorschot. </author> <title> Extending cryptographic logics of cryptographic logics of belief to key agreement protocols. </title> <booktitle> In Proceedings of the First ACM Conference on Computers and Communications Security, </booktitle> <pages> pages 232-243, </pages> <year> 1993. </year> <month> 19 </month>
Reference-contexts: Initially, mobile registration requires the use of an untrusted route to establish a secure tunnel. We model the registration services that are provided via a routing daemon using a UDP port. Several logics for analyzing cryptographic protocols and authentication schemes have been proposed (see for example <ref> [1, 3, 4, 13, 14] </ref>). Belief logics are designed to consider what conclusions individual parties (principals) in a communication dialogue can deduce based on messages received and a set of initial assumptions or beliefs.
References-found: 14

