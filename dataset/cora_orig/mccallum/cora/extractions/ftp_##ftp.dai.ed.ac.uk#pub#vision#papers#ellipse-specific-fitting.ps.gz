URL: ftp://ftp.dai.ed.ac.uk/pub/vision/papers/ellipse-specific-fitting.ps.gz
Refering-URL: http://vision.dai.ed.ac.uk/maurizp/ElliFitDemo/
Root-URL: http://www.aic.nrl.navy.mil/~aha/people.html
Email: email: fandrewfg,maurizp,rbfg@aifh.ed.ac.uk  
Title: Direct Least Squares Fitting of Ellipses  
Author: Andrew W. Fitzgibbon Maurizio Pilu Robert B. Fisher 
Date: January 4, 1996  
Address: 5 Forrest Hill, Edinburgh EH1 2QL SCOTLAND  
Affiliation: Department of Artificial Intelligence The University of Edinburgh  
Abstract: This work presents a new efficient method for fitting ellipses to scattered data. Previous algorithms either fitted general conics or were computationally expensive. By minimizing the algebraic distance subject to the constraint 4ac b 2 = 1 the new method incorporates the ellipticity constraint into the normalization factor. The new method combines several advantages: (i) It is ellipse-specific so that even bad data will always return an ellipse; (ii) It can be solved naturally by a generalized eigensys-tem and (iii) it is extremely robust, efficient and easy to implement. We compare the proposed method to other approaches and show its robustness on several examples in which other non-ellipse-specific approaches would fail or require computationally expensive iterative refinements. Source code for the algorithm is supplied and a demon stration is available on http://www.dai.ed.ac.uk/groups/mvu/ellipse-demo.html
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> F.L. Bookstein. </author> <title> Fitting conic sections to scattered data. </title> <journal> Computer Graphics and Image Processing, </journal> (9):56-71, 1979. 
Reference-contexts: Many of the published algorithms differ only in the form of constraint applied to the parameters: * Many authors suggest kak 2 = 1. * Rosin [13] and Gander [4] impose a + c = 1. * Rosin [13] also investigates f = 1. * Bookstein <ref> [1] </ref> proposes a 2 + 1 2 b 2 + c 2 = 1. * Taubin's approximate square distance [16] may also be viewed as the quadratic con straint kN ak 2 = 1 where N is the Jacobian [rF (a; x 1 ) : : : rF (a; x N <p> Note that these constraints are all either linear, of the form c a = 1 or quadratic, con straining a T Ca = 1 where C is a 6 fi 6 constraint matrix. 2.2 General conic fitting The seminal work by Bookstein <ref> [1] </ref> introduces the invariant constraint a 2 + 1 2 b 2 + c 2 = 1. He showed that this leads to the solution of a rank-deficient generalised eigenvalue problem for which he gives an efficient solution by block decomposition. <p> quadratic constraint which may be expressed in the matrix form a T Ca = 1 as a T 6 6 0 0 2 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 3 7 5 3.1 Solution of the quadratically constrained minimization Following Bookstein <ref> [1] </ref>, the constrained fitting problem is: Minimize E = kDak 2 , subject to the constraint a T Ca = 1 (6) 6 where the design matrix D is the n fi 6 matrix [x 1 x 2 x n ] T . <p> As D T D is positive semidefinite, the constrained problem has a minimum, which must satisfy (7), and we conclude that ^ a solves the constrained problem. The constraint (5) is a conic invariant to Euclidean transformation and so is the solution (see <ref> [1] </ref>) 2 3.3 Remark Before leaping to the experimental section, there is an important intuitive remark to be made. An eigenvector of the eigensystem (8) is a local minimizer of the Rayleigh quotient a T Sa a T Ca .
Reference: [2] <author> T. Ellis, A. Abbood, and B. Brillault. </author> <title> Ellipse detection and matching with uncertainty. </title> <journal> Image and Vision Computing, </journal> <volume> 10(2) </volume> <pages> 271-276, </pages> <year> 1992. </year>
Reference-contexts: Bookstein's method does not restrict the fitting to be an ellipse, in the sense that given arbitrary data the algorithm can return an hyperbola or a parabola, even from elliptical input, but it has been widely used in the past decade. Porrill [10] and Ellis et al. <ref> [2] </ref> use Bookstein's method to initialize a Kalman filter. The Kalman filter iteratively minimizes the gradient distance (3) in order to gather new image evidence and to reject non-ellipse fits by testing the discriminant b 2 4ac &lt; 0 at each iteration.
Reference: [3] <author> A.W. Fitzgibbon and R.B. Fisher. </author> <title> A buyer's guide to conic fitting. </title> <booktitle> In Proceedings of British Machine Vision Conference, </booktitle> <address> Birmingam, </address> <year> 1995. </year>
Reference-contexts: We include both quantitative and qualitative results in order to allow other researchers to evaluate the utility of the ellipse-specific algorithm with respect to the others cited. Fitzgibbon <ref> [3] </ref> provides further theoretical and quantitative results for a wide range of conic-fitting algorithms. 4.1 Ellipse-specificity Despite the theoretical proof of the algorithm's ellipse-specificity, it is instructive to observe its performance on some example data, of which Figure 1 provides an example.
Reference: [4] <author> W. Gander, G.H. Golub, and R. Strebel. </author> <title> Least-square fitting of circles and ellipses. </title> <journal> BIT, </journal> (43):558-578, 1994. 
Reference-contexts: One of the most commonly used models is the ellipse which, being the perspective projection of the circle, is of great importance for many industrial applications. Despite its importance, however, there has been until now no computationally efficient ellipse-specific fitting algorithm <ref> [13, 4] </ref>. 1 In this paper we introduce a new method of fitting ellipses, rather than general conics, to segmented data. <p> Many of the published algorithms differ only in the form of constraint applied to the parameters: * Many authors suggest kak 2 = 1. * Rosin [13] and Gander <ref> [4] </ref> impose a + c = 1. * Rosin [13] also investigates f = 1. * Bookstein [1] proposes a 2 + 1 2 b 2 + c 2 = 1. * Taubin's approximate square distance [16] may also be viewed as the quadratic con straint kN ak 2 = 1 <p> Recently Gander et al. <ref> [4] </ref> published a paper entitled "Least-square fitting of ellipses and circles" in which the normalization a + c = 1 leads to an over-constrained system of N linear equations.
Reference: [5] <author> R. Gnanadesikan. </author> <title> Methods for statistical data analysis of multivariate observations. </title> <publisher> John Wiley & sons, </publisher> <address> New York, </address> <year> 1977. </year>
Reference: [6] <author> R. M. Haralick and L. G. Shapiro. </author> <title> Computer and Robot Vision, volume 1. </title> <publisher> Addison-Wesley, </publisher> <year> 1993. </year>
Reference-contexts: F (a; x i ) is called the "algebraic distance" of a point (x; y) to the conic F (a; x) = 0. The fitting of a general conic may be approached <ref> [6] </ref> by minimizing the sum of squared algebraic distances D A (a) = i=1 of the curve to the N data points x i . <p> It must be said, however, that in the paper they make no explicit claim that the algorithm is ellipse specific. 5 Haralick <ref> [6, x11.10.7] </ref> takes a different approach. Effectively, he guarantees that the conic is an ellipse by replacing the coefficients fa; b; cg with new expressions fp 2 ; 2pq; q 2 +r 2 g so that the discriminant b 2 4ac becomes 4p 2 r 2 which is guaranteed negative.
Reference: [7] <author> K. Kanatani. </author> <title> Statistical bias of conic fitting and renormalization. </title> <journal> IEEE T-PAMI, </journal> <volume> 16(3) </volume> <pages> 320-326, </pages> <year> 1994. </year>
Reference-contexts: In a situation where ellipses are specifically desired, such fits must be rejected as useless. A number of iterative refinement procedures <ref> [15, 7, 10] </ref> alleviate this problem, but do not eliminate it. In addition, these techniques often increase the computational burden unacceptably. <p> In cases where more accureate results are required, this algorithm provides an excellent initial estimate. The algorithm is however biased towards ellipses of low eccentricity, and future work includes the incorporation of the algorithm into a bias-correction algorithm based on that of Kanatani <ref> [7] </ref>. We note also that the algorithm can be trivially converted to a hyperbola-specific fitter, and a variation may be used to fit parabolae. 13 6 Acknowledgements The second author is partially sponsored by SGS-THOMSON Microelectronics UK. This work was partially funded by UK EPSRC Grant GR/H/86905.
Reference: [8] <author> D. Keren, D. Cooper, and J. Subrahmonia. </author> <title> Describing complicated objects by implicit polynomials. </title> <journal> IEEE T-PAMI, </journal> <volume> 16(1) </volume> <pages> 38-53, </pages> <year> 1994. </year>
Reference-contexts: Minimization over the space fp; q; r; d; e; f g then yields an ellipse. His algorithm is again iterative, and an initial estimate is provided by a method of moments. Keren et al. <ref> [8] </ref> apply a similar technique to Haralick's and extend the method to the fitting of bounded quartic curves. Again, their algorithm is iterative.
Reference: [9] <author> V.F. Leavers. </author> <title> Shape Detection in Computer Vision Using the Hough Transform. </title> <publisher> Springer-Verlag, </publisher> <year> 1992. </year>
Reference-contexts: We conclude by presenting some possible extensions. 2 Previous Methods and their Limitations The literature on ellipse fitting divides into two general techniques: clustering and least-squares fitting. Clustering methods are based on mapping sets of points to the parameter space, such as the Hough transform <ref> [9, 18] </ref> and accumulation methods [12]. These Hough-like techniques have some great advantages, notably high robustness to occlusion and no requirement 2 In the case of the Bookstein algorithm, the solid line corresponds to the global minimum, while the dotted lines are the other two local minima.
Reference: [10] <author> J. Porrill. </author> <title> Fitting ellipses and predicting comfidence envelopes using a bias corrected Kalman filter. </title> <journal> Image and Vision Computing, </journal> <volume> 8(1), </volume> <month> February </month> <year> 1990. </year>
Reference-contexts: In a situation where ellipses are specifically desired, such fits must be rejected as useless. A number of iterative refinement procedures <ref> [15, 7, 10] </ref> alleviate this problem, but do not eliminate it. In addition, these techniques often increase the computational burden unacceptably. <p> Bookstein's method does not restrict the fitting to be an ellipse, in the sense that given arbitrary data the algorithm can return an hyperbola or a parabola, even from elliptical input, but it has been widely used in the past decade. Porrill <ref> [10] </ref> and Ellis et al. [2] use Bookstein's method to initialize a Kalman filter. The Kalman filter iteratively minimizes the gradient distance (3) in order to gather new image evidence and to reject non-ellipse fits by testing the discriminant b 2 4ac &lt; 0 at each iteration. <p> Recently Gander et al. [4] published a paper entitled "Least-square fitting of ellipses and circles" in which the normalization a + c = 1 leads to an over-constrained system of N linear equations. The proposed normalization is the same as that in <ref> [10, 14] </ref> and it does not force the fitting to be an ellipse (the hyperbola 3x 2 2y 2 = 0 satisfies the constraint).
Reference: [11] <author> S. S. Rao. </author> <title> Optimization: Theory and Applications. </title> <publisher> Wiley Eastern, </publisher> <address> 2 edition, </address> <year> 1984. </year>
Reference-contexts: The appropriate constraint is well known, namely that the discriminant b 2 4ac be negative. However, this constrained problem is difficult to solve in general as the Kuhn-Tucker conditions <ref> [11] </ref> do not guarantee a solution. In fact, we have not been able to locate any reference regarding the minimization of a quadratic form subject to such a nonconvex inequality.
Reference: [12] <author> P. L. Rosin. </author> <title> Ellipse fitting by accumulating five-point fits. </title> <journal> Pattern Recognition Letters, </journal> (14):661-699, August 1993. 
Reference-contexts: Clustering methods are based on mapping sets of points to the parameter space, such as the Hough transform [9, 18] and accumulation methods <ref> [12] </ref>. These Hough-like techniques have some great advantages, notably high robustness to occlusion and no requirement 2 In the case of the Bookstein algorithm, the solid line corresponds to the global minimum, while the dotted lines are the other two local minima.
Reference: [13] <author> P.L. Rosin. </author> <title> A note on the least square fitting of ellipses. </title> <journal> Pattern Recognition Letters, </journal> (14):799-808, October 1993. 
Reference-contexts: One of the most commonly used models is the ellipse which, being the perspective projection of the circle, is of great importance for many industrial applications. Despite its importance, however, there has been until now no computationally efficient ellipse-specific fitting algorithm <ref> [13, 4] </ref>. 1 In this paper we introduce a new method of fitting ellipses, rather than general conics, to segmented data. <p> Many of the published algorithms differ only in the form of constraint applied to the parameters: * Many authors suggest kak 2 = 1. * Rosin <ref> [13] </ref> and Gander [4] impose a + c = 1. * Rosin [13] also investigates f = 1. * Bookstein [1] proposes a 2 + 1 2 b 2 + c 2 = 1. * Taubin's approximate square distance [16] may also be viewed as the quadratic con straint kN ak <p> Many of the published algorithms differ only in the form of constraint applied to the parameters: * Many authors suggest kak 2 = 1. * Rosin <ref> [13] </ref> and Gander [4] impose a + c = 1. * Rosin [13] also investigates f = 1. * Bookstein [1] proposes a 2 + 1 2 b 2 + c 2 = 1. * Taubin's approximate square distance [16] may also be viewed as the quadratic con straint kN ak 2 = 1 where N is the Jacobian [rF (a; x 1 <p> The Kalman filter iteratively minimizes the gradient distance (3) in order to gather new image evidence and to reject non-ellipse fits by testing the discriminant b 2 4ac &lt; 0 at each iteration. Porrill also gives nice examples of the confidence envelopes of the fittings. Rosin <ref> [13] </ref> also uses a Kalman Filter, and in [14] he restates that ellipse-specific fitting is a non-linear problem and that iterative methods must be employed. He also [13] analyses the pro and cons of two commonly used normalizations, f = 1 and a + c = 1 and shows that the <p> Porrill also gives nice examples of the confidence envelopes of the fittings. Rosin <ref> [13] </ref> also uses a Kalman Filter, and in [14] he restates that ellipse-specific fitting is a non-linear problem and that iterative methods must be employed. He also [13] analyses the pro and cons of two commonly used normalizations, f = 1 and a + c = 1 and shows that the former biases the fitting to have smaller eccentricity, therefore increasing the probability of returning an ellipse, at the cost of losing transformational invariance. <p> An eigenvector of the eigensystem (8) is a local minimizer of the Rayleigh quotient a T Sa a T Ca . In this case the implicit normalization by b 2 4ac turns singular for b 2 4ac = 0. Rosin <ref> [13] </ref> writes that, not surprisingly, the minimization tends to "pull" the solution away from singularities; in our case the singularity is a parabola and so the unique elliptical solution tends to be biased towards low eccentricity, which explains many of the following results, such as those in Figure 6. 4 Experimental
Reference: [14] <author> P.L. Rosin and G.A. West. </author> <title> Segmenting curves into lines and arcs. </title> <booktitle> In Proceedings of the Third International Conference on Computer Vision, </booktitle> <pages> pages 74-78, </pages> <address> Osaka, Japan, </address> <month> December </month> <year> 1990. </year>
Reference-contexts: Porrill also gives nice examples of the confidence envelopes of the fittings. Rosin [13] also uses a Kalman Filter, and in <ref> [14] </ref> he restates that ellipse-specific fitting is a non-linear problem and that iterative methods must be employed. <p> Recently Gander et al. [4] published a paper entitled "Least-square fitting of ellipses and circles" in which the normalization a + c = 1 leads to an over-constrained system of N linear equations. The proposed normalization is the same as that in <ref> [10, 14] </ref> and it does not force the fitting to be an ellipse (the hyperbola 3x 2 2y 2 = 0 satisfies the constraint).
Reference: [15] <author> P.D. Sampson. </author> <title> Fitting conic sections to very scattered data: An iterative refinement of the Bookstein algorithm. </title> <journal> Computer Graphics and Image Processing, </journal> (18):97-108, 1982. 
Reference-contexts: In a situation where ellipses are specifically desired, such fits must be rejected as useless. A number of iterative refinement procedures <ref> [15, 7, 10] </ref> alleviate this problem, but do not eliminate it. In addition, these techniques often increase the computational burden unacceptably. <p> He showed that this leads to the solution of a rank-deficient generalised eigenvalue problem for which he gives an efficient solution by block decomposition. Sampson <ref> [15] </ref> presents an iterative improvement to the Bookstein method which replaces the algebraic distance F (a; x) with a better approximation to the geometric distance: D S (a) = i=1 kr x F (a; x i )k 2 (3) The use of this new distance measure increases the stability of the
Reference: [16] <author> G. Taubin. </author> <title> Estimation of planar curves, surfaces and non-planar space curves defined by implicit equations , with applications to edge and range image segmentation. </title> <journal> IEEE PAMI, </journal> <volume> 13(11) </volume> <pages> 1115-1138, </pages> <month> November </month> <year> 1991. </year>
Reference-contexts: parameters: * Many authors suggest kak 2 = 1. * Rosin [13] and Gander [4] impose a + c = 1. * Rosin [13] also investigates f = 1. * Bookstein [1] proposes a 2 + 1 2 b 2 + c 2 = 1. * Taubin's approximate square distance <ref> [16] </ref> may also be viewed as the quadratic con straint kN ak 2 = 1 where N is the Jacobian [rF (a; x 1 ) : : : rF (a; x N )] T . <p> F (a; x) with a better approximation to the geometric distance: D S (a) = i=1 kr x F (a; x i )k 2 (3) The use of this new distance measure increases the stability of the fitting, but necessitates an iterative algorithm, increasing the computational requirements substantially. 4 Taubin <ref> [16] </ref> proposed an approximation of (3) as D T (a) i=1 F (a; x i ) 2 i=1 kr x F (a; x i )k 2 ; (4) which, while strictly valid only for a circle, again allows the problem to be expressed as a generalized eigensystem, reducing the computational requirements
Reference: [17] <author> J. H. Wilkinson. </author> <title> The algebraic eigenvalue problem. </title> <publisher> Claredon Press, Oxford, </publisher> <address> England, </address> <year> 1965. </year>
Reference: [18] <author> H. K. Yuen, J. Illingworth, and J. Kittler. </author> <title> Detecting partially occluded ellipses using the Hough transform. </title> <journal> Image and Vision Computing, </journal> <volume> 7(1) </volume> <pages> 31-37, </pages> <year> 1989. </year>
Reference-contexts: We conclude by presenting some possible extensions. 2 Previous Methods and their Limitations The literature on ellipse fitting divides into two general techniques: clustering and least-squares fitting. Clustering methods are based on mapping sets of points to the parameter space, such as the Hough transform <ref> [9, 18] </ref> and accumulation methods [12]. These Hough-like techniques have some great advantages, notably high robustness to occlusion and no requirement 2 In the case of the Bookstein algorithm, the solid line corresponds to the global minimum, while the dotted lines are the other two local minima.
References-found: 18

