URL: http://www.cs.unc.edu/~styner/docs/tmi98.ps.gz
Refering-URL: http://www.cs.unc.edu/~gerig/
Root-URL: http://www.cs.unc.edu
Email: email: fstyner,brech,szekely,gerigg@vision.ee.ethz.ch  
Title: Compensation of intensity inhomogeneities in MRI based on a parametric bias estimate  
Author: Martin Styner, Christian Brechbuhler, Gabor Szekely and Guido Gerig 
Address: CH-8092 Zurich, Switzerland  
Affiliation: Communication Technology Laboratory, Image Science ETH-Zentrum,  
Abstract: This paper presents a new approach to the correction of intensity inhomogeneities in Magnetic Resonance Imaging (MRI). The distortion of the image brightness values by a low-frequency bias field often occurs in MRI and impedes visual inspection and intensity-based segmentation. The inhomogeneity problem is particularly significant in surface coil MRI. The new correction method is based on a simplified model of the imaging process and the inhomogeneity field. We assume that a scene contains components that form homogeneous regions, which are corrupted by noise and inhomogeneities. We model the bias field as a polynomial and test its appropriateness by analyzing the MRI images of a phantom with known ground truth. The estimation of the parametric bias field is formulated as a nonlinear energy minimization problem. Energy is calculated from the distance of pixel values and class means. An Evolution Strategy (ES) is used to minimize energy. The resulting bias field is independent of the configuration of image regions, thus overcoming limitations of methods based on homomorphic filtering. Our method is not limited to removing subtle intensity variations only. It can correct bias distortions much larger than the image contrast. Parameters of our method are the statistics of the classes and the form of the polynomial. The polynomial method offers the advantage of combining bias correction with histogram adjustment, making this method well suited for normalizing large sets of image data in serial studies. We present applications to 2D and 3D phantom images, and to 2D and 3D MRI from breast coils, surface coils and head coils, demonstrating the versatility and robustness of this 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D.A. Ortendahl and J.W. Carlson. </author> <title> Segmentation of magnetic resonance images using fuzzy clustering. In M.A. </title> <editor> Viergever and A. Todd-Pokropek, editors, </editor> <booktitle> Proc. of Information Processing in Medical Imaging, IPMI'87, volume 39 of NATO ASI Series F, </booktitle> <pages> pages 91-106, </pages> <address> Berlin Heidelberg, 1988. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: 1 Introduction A major obstacle to segmentation by multiple thresholding or by multivariate statistical classification <ref> [1, 2, 3, 4, 5] </ref> is insufficient data quality. Besides corruption by noise, the brightness of MR image data is often inhomogeneous due to Radio Frequency (RF) field deficiencies. <p> Given detailed information in regard to the bias inhomogeneities of a specific imaging system, the Legendre polynomials could be replaced by an alternative parametric model. The image coordinates x j are scaled to the range <ref> [1; 1] </ref>.
Reference: [2] <editor> M.W. Vannier, Speidel Ch.M., D.L. Rickman, L.D. Schertz, et al. </editor> <title> Validation of Magnetic Resonance Imaging (MRI) Multispectral Tissue Classification. </title> <booktitle> In Proc. of 9th Int. Conf. on Pattern Recognition, ICPR'88, </booktitle> <pages> pages 1182-1186, </pages> <month> November </month> <year> 1988. </year>
Reference-contexts: 1 Introduction A major obstacle to segmentation by multiple thresholding or by multivariate statistical classification <ref> [1, 2, 3, 4, 5] </ref> is insufficient data quality. Besides corruption by noise, the brightness of MR image data is often inhomogeneous due to Radio Frequency (RF) field deficiencies. <p> The segmentation experiments presented by Jungke et al. [7] clearly illustrate that the major problem was not noise but inhomogeneity. Vannier et al. [8] described a correction method based on line by line histogram evaluation and a subsequent correction. Another attempt <ref> [2] </ref> modeled the inhomogeneity as a linear variation in the transverse anatomic plane and computed an approximation to the inhomogeneity as a linear ramp from the neck to the crown.
Reference: [3] <editor> M.B. Merickel et al. </editor> <title> Multispectral pattern recognition of MR imagery for the noninvasive analysis of atherosclerosis. </title> <booktitle> In Proc. of 9th Int. Conf. on Pattern Recognition, ICPR'88, </booktitle> <pages> pages 1192-1197, </pages> <month> November </month> <year> 1988. </year>
Reference-contexts: 1 Introduction A major obstacle to segmentation by multiple thresholding or by multivariate statistical classification <ref> [1, 2, 3, 4, 5] </ref> is insufficient data quality. Besides corruption by noise, the brightness of MR image data is often inhomogeneous due to Radio Frequency (RF) field deficiencies. <p> Only vertical (or horizontal) distortions are taken into account, while the actual distortions due to RF field inhomogeneities are often more accurately described by polynomial functions of second degree. Merickel <ref> [3] </ref> encountered the problem of the sensitivity profile of the surface coil, which falls off with distance from the center of the coil towards the slice borders and along the direction of increasing depth.
Reference: [4] <author> K.O. Lim and A.J. Pfefferbaum. </author> <title> Segmentation of MR brain images into cerebrospinal fluid spaces, white and gray matter. </title> <journal> Journal of Computer Assisted Tomography, </journal> <volume> 13 </volume> <pages> 588-593, </pages> <year> 1989. </year>
Reference-contexts: 1 Introduction A major obstacle to segmentation by multiple thresholding or by multivariate statistical classification <ref> [1, 2, 3, 4, 5] </ref> is insufficient data quality. Besides corruption by noise, the brightness of MR image data is often inhomogeneous due to Radio Frequency (RF) field deficiencies. <p> The intensity gradients were corrected by employing an unsharp masking technique, reducing low frequency surface coil gradients while enhancing the contrast of edges [9]. Lim et al. <ref> [4] </ref> proposed a smoothing technique to correct for the inhomogeneity problem: after extraction of the head contour they extended the intensity values radially towards the image boundaries and smoothed the image with a Gaussian filter of a large kernel size.
Reference: [5] <author> H.E. Cline, W.E. Lorensen, St.P. Souza, F.A. Jolesz, R. Kikinis, G. Gerig, and Th.E. Kennedy. </author> <title> 3D surface rendered MR images of the brain and its vasculature. </title> <journal> Journal of 30 REFERENCES Computer Assisted Tomography, </journal> <volume> 15(2) </volume> <pages> 344-351, </pages> <month> March </month> <year> 1991. </year>
Reference-contexts: 1 Introduction A major obstacle to segmentation by multiple thresholding or by multivariate statistical classification <ref> [1, 2, 3, 4, 5] </ref> is insufficient data quality. Besides corruption by noise, the brightness of MR image data is often inhomogeneous due to Radio Frequency (RF) field deficiencies.
Reference: [6] <author> M.I. Kohn, </author> <title> N.K. </title> <editor> Tanna, G.T. Herman, S.M. Resnick, P.D. Mozley, R.E. Gur, A. Alavi, R.A. Zimmerman, and R.C. Gur. </editor> <title> Analysis of brain and cerebrospinal fluid volumes with MR imaging. Part I. Methods, reliability, and validation. </title> <journal> Radiology, </journal> <volume> 178 </volume> <pages> 115-122, </pages> <month> January </month> <year> 1991. </year>
Reference-contexts: This variability of tissue intensity values with respect to image location severely affects visual evaluation and also segmentation based on absolute pixel intensities. The effects of such inhomogeneities on the subsequent segmentation have been carefully discussed by Kohn et al. <ref> [6] </ref>. The segmentation experiments presented by Jungke et al. [7] clearly illustrate that the major problem was not noise but inhomogeneity. Vannier et al. [8] described a correction method based on line by line histogram evaluation and a subsequent correction. <p> They assumed that the resulting blurred image represents one homogeneous region, which is only distorted by the scanner inhomogeneities. The images were corrected according to an estimation of the 3 inhomogeneity characteristics. Kohn et al. <ref> [6] </ref> carefully discuss and illustrate the inhomogeneity problem. They observed that inhomogeneity elongates clusters in feature space in the direction of the origin, but that, due to the relative positions of the clusters representing brain and cerebro-spinal fluid, the two classes were still separated.
Reference: [7] <author> M. Jungke, W. von Seelen, G. Bielke, S. Meindl, et al. </author> <title> A system for the diagnostic use of tissue characterizing parameters in NMR-tomography. In M.A. </title> <editor> Viergever and A. Todd-Pokropek, editors, </editor> <booktitle> Proc. of Information Processing in Medical Imaging, IPMI'87, volume 39 of NATO ASI Series F, </booktitle> <pages> pages 471-481, </pages> <address> Berlin Heidelberg, 1987. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: This variability of tissue intensity values with respect to image location severely affects visual evaluation and also segmentation based on absolute pixel intensities. The effects of such inhomogeneities on the subsequent segmentation have been carefully discussed by Kohn et al. [6]. The segmentation experiments presented by Jungke et al. <ref> [7] </ref> clearly illustrate that the major problem was not noise but inhomogeneity. Vannier et al. [8] described a correction method based on line by line histogram evaluation and a subsequent correction.
Reference: [8] <author> M.W. Vannier, Ch.M. Speidel, and D.L. Rickman. </author> <title> Magnetic resonance imaging multispec-tral tissue classification. </title> <journal> NIPS, </journal> <volume> 3 </volume> <pages> 148-154, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: The effects of such inhomogeneities on the subsequent segmentation have been carefully discussed by Kohn et al. [6]. The segmentation experiments presented by Jungke et al. [7] clearly illustrate that the major problem was not noise but inhomogeneity. Vannier et al. <ref> [8] </ref> described a correction method based on line by line histogram evaluation and a subsequent correction. Another attempt [2] modeled the inhomogeneity as a linear variation in the transverse anatomic plane and computed an approximation to the inhomogeneity as a linear ramp from the neck to the crown.
Reference: [9] <author> J. Haselgrove and M. Prammer. </author> <title> An algorithm for compensation of surface-coil images for sensitivity of the surface coil. </title> <journal> Magnetic Resonance Imaging, </journal> <volume> 4 </volume> <pages> 469-472, </pages> <year> 1986. </year>
Reference-contexts: The intensity gradients were corrected by employing an unsharp masking technique, reducing low frequency surface coil gradients while enhancing the contrast of edges <ref> [9] </ref>. Lim et al. [4] proposed a smoothing technique to correct for the inhomogeneity problem: after extraction of the head contour they extended the intensity values radially towards the image boundaries and smoothed the image with a Gaussian filter of a large kernel size.
Reference: [10] <editor> B.M. Dawant, A.P. Zjidenbos, and R.A. Margolin. </editor> <title> Correction of intensity variations in MR images for compuer-aided tissue classification. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 12(4) </volume> <pages> 770-781, </pages> <year> 1993. </year>
Reference-contexts: The assumption is often valid in microscope images of small particles, but most often fails for the structures imaged by MR. A scene, such as a head structure, contains a considerable amount of low-frequency components. Dawant et al. <ref> [10] </ref> propose a bias correction method relying on user interaction. A user selects typical points of a tissue class as input to the estimation of a parametric bias field. Tincher et al. [11] and Meyer et al. [12] present an automatic technique that fits polynomial functions to initially segmented regions.
Reference: [11] <author> M. Tincher, C.R. Meyer, R. Gupta, and D.M. Williams. </author> <title> Polynomial modeling and reduction of RF body coil spatial inhomogeneity in MRI. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 12(2) </volume> <pages> 361-365, </pages> <year> 1993. </year>
Reference-contexts: A scene, such as a head structure, contains a considerable amount of low-frequency components. Dawant et al. [10] propose a bias correction method relying on user interaction. A user selects typical points of a tissue class as input to the estimation of a parametric bias field. Tincher et al. <ref> [11] </ref> and Meyer et al. [12] present an automatic technique that fits polynomial functions to initially segmented regions. The individual fits are combined to find an estimate for a global inhomogeneity field. The procedure relies on a preliminary segmentation into region patches.
Reference: [12] <author> Charles R. Meyer, Peyton H. B land, and James Pipe. </author> <title> Retrospective correction of Intensity Inhomogeneities in MRI. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 14(1) </volume> <pages> 36-41, </pages> <month> March </month> <year> 1995. </year>
Reference-contexts: Dawant et al. [10] propose a bias correction method relying on user interaction. A user selects typical points of a tissue class as input to the estimation of a parametric bias field. Tincher et al. [11] and Meyer et al. <ref> [12] </ref> present an automatic technique that fits polynomial functions to initially segmented regions. The individual fits are combined to find an estimate for a global inhomogeneity field. The procedure relies on a preliminary segmentation into region patches.
Reference: [13] <author> W.M. Wells, W.E.L. Grimson, R. Kikinis, and F.A. Jolesz. </author> <title> Statistical gain correction and segmentation of MRI data. </title> <note> Draft of August 5, 1993, internal report BWH Boston. REFERENCES 31 </note>
Reference-contexts: Tincher et al. [11] and Meyer et al. [12] present an automatic technique that fits polynomial functions to initially segmented regions. The individual fits are combined to find an estimate for a global inhomogeneity field. The procedure relies on a preliminary segmentation into region patches. Wells et al. <ref> [13, 14, 15] </ref> propose an expectation-maximization (EM) algorithm to achieve an interleaved bias correction/statistical segmentation.
Reference: [14] <author> William Wells, Ron Kikinis, and Ferenc A. Jolesz. </author> <title> Statistical intensity correction and segmentation of magnetic resonance image data. </title> <editor> In Richard A. Robb, editor, </editor> <booktitle> Proceedings of the Third Conference on Visualization in Biomedical Computing VBC'94, </booktitle> <volume> volume 2359, </volume> <pages> pages 13-24. SPIE, </pages> <month> October </month> <year> 1994. </year>
Reference-contexts: Tincher et al. [11] and Meyer et al. [12] present an automatic technique that fits polynomial functions to initially segmented regions. The individual fits are combined to find an estimate for a global inhomogeneity field. The procedure relies on a preliminary segmentation into region patches. Wells et al. <ref> [13, 14, 15] </ref> propose an expectation-maximization (EM) algorithm to achieve an interleaved bias correction/statistical segmentation.
Reference: [15] <author> W.M. Wells, W.E.L. Grimson, R. Kikinis, and F.A. Jolesz. </author> <title> Adaptive Segmentation of MRI Data. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 15(4) </volume> <pages> 429-443, </pages> <month> August </month> <year> 1996. </year>
Reference-contexts: Tincher et al. [11] and Meyer et al. [12] present an automatic technique that fits polynomial functions to initially segmented regions. The individual fits are combined to find an estimate for a global inhomogeneity field. The procedure relies on a preliminary segmentation into region patches. Wells et al. <ref> [13, 14, 15] </ref> propose an expectation-maximization (EM) algorithm to achieve an interleaved bias correction/statistical segmentation.
Reference: [16] <author> Regis Guillemaud and Michael Brady. </author> <title> Estimating the Bias Field of MR Images. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 16(3) </volume> <pages> 238-251, </pages> <month> June </month> <year> 1997. </year>
Reference-contexts: With no prior assumptions about the bias field the EM algorithm can not recover the correct classification. Regis Guillemaud and Michael Brady <ref> [16] </ref> introduced a modified EM algorithm that replaces the distribution of the class other, which includes all tissue not explicitly modeled, by a uniform probability density function. The correction was claimed to be more robust and to overcome some limitations of Wells' original method.
Reference: [17] <author> John G. Sled, P. Zijdenbos, and Alan C. Evans. </author> <title> A Comparison of Retrospective Intensity Non-uniformity Correction Methods for MRI. </title> <editor> In James Duncan and Gene Gindi, editors, </editor> <booktitle> Information Processing in Medical Imaging, volume 1230 of Lecture Notes in Computer Science, </booktitle> <pages> pages 459-464, </pages> <address> Berlin Heidelberg, </address> <year> 1997. </year> <title> Springer. </title> <booktitle> Proceedings 15th Int. Conf. </booktitle> <address> IMPI'97. </address>
Reference-contexts: However, the resulting set of initial parameters remains critical, as with the original algorithm, and the method is still sensitive to the spatial configuration of image structures. A correction algorithm fully based on the histogram was proposed by Sled <ref> [17, 18] </ref>. It requires a parametric model for the bias field but not a decomposition of the intensities into tissue classes. The algorithm assumes that the histogram of an image represents the probability distribution of the given signal.
Reference: [18] <author> John G. Sled. </author> <title> A Non-parametric Method for Automatic Correction of Intensity Nonuniformity in MRI Data. </title> <type> Master's thesis, </type> <institution> Department of Biomedical Engineering, McGill University, Montreal, </institution> <month> May </month> <year> 1997. </year>
Reference-contexts: However, the resulting set of initial parameters remains critical, as with the original algorithm, and the method is still sensitive to the spatial configuration of image structures. A correction algorithm fully based on the histogram was proposed by Sled <ref> [17, 18] </ref>. It requires a parametric model for the bias field but not a decomposition of the intensities into tissue classes. The algorithm assumes that the histogram of an image represents the probability distribution of the given signal.
Reference: [19] <author> G. Gerig, O. Kubler, R. Kikinis and F.A. Jolesz. </author> <title> Nonlinear Anisotropic Filtering of MRI Data. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 11(2) </volume> <pages> 221-232, </pages> <month> June </month> <year> 1992. </year>
Reference-contexts: The term ~s (x) n (x) (4) describes a noise corrected signal, which is corrupted by the bias field. An approximation to the noise corrected signal can be obtained by preprocessing the image with a structure-preserving smoothing method <ref> [19] </ref>. 2.2 Bias field estimation by a smooth parametric bias field We propose to estimate the bias field b (x) by a parametric model.
Reference: [20] <author> Colin R. Reeves. </author> <title> Modern Heuristic Techniques for Combinatorial Problems. </title> <publisher> Blackwell Scientific Publications, </publisher> <year> 1993. </year>
Reference: [21] <author> Christian Brechbuhler, Guido Gerig, and Gabor Szekely. </author> <title> Compensation of spatial inho-mogenity in mri based on a multi-valued image model and a parametric bias estimate. </title> <type> Technical Report BIWI-TR-170, </type> <institution> Image Science Lab, ETH Zurich, </institution> <year> 1996. </year> <note> 32 REFERENCES </note>
Reference: [22] <editor> Hans-Paul Schwefel. </editor> <title> Evolution and optimum seeking. </title> <publisher> Wiley, </publisher> <address> cop., </address> <year> 1995. </year>
Reference-contexts: Furthermore, the method is fast enough to cope with our large data sets and overcomes the problem of parameters with different scaling. The developed algorithm uses a so called (1 + 1)-Evolution Strategy (ES), which belongs to the family of Evolutionary Algorithms (for an introduction see <ref> [22] </ref> and [23]). In an Evolution Strategy a parameter vector p represents an individual. The fitness of an individual is determined by its energy value e (p). In our case a small energy value yields a high fitness and a high energy value leads to a low fitness. <p> Generally, the lower the choice of c grow the more probable the optimization finds the optimal solution, and the higher c grow , the higher the convergence rate. A good choice for c shrink is c 1=4 grow (see <ref> [22] </ref>) and for c grow a value between 1.01 and 1.1. * Initial step size: A low choice of the initial step size speeds up convergence but the opti mization is more likely to end in a non-optimal minimum. * Maximum number of iterations: The maximum number of iterations should not
Reference: [23] <author> Willfried Wienholt. Entwurf neuronaler Netze: </author> <title> ein datenbasiertes Verfahren zur Model-lierung nichtlinearer Systeme mit Hilfe evolutionarer Algorithmen und unscharfer Logik. </title> <publisher> Harri Deutsch, </publisher> <year> 1996. </year>
Reference-contexts: Furthermore, the method is fast enough to cope with our large data sets and overcomes the problem of parameters with different scaling. The developed algorithm uses a so called (1 + 1)-Evolution Strategy (ES), which belongs to the family of Evolutionary Algorithms (for an introduction see [22] and <ref> [23] </ref>). In an Evolution Strategy a parameter vector p represents an individual. The fitness of an individual is determined by its energy value e (p). In our case a small energy value yields a high fitness and a high energy value leads to a low fitness. <p> Z 1 P t (x) P t 0 (x) dx = 2t + 1 The orthogonality is passed on to all products P l (x). 5.2 Optimization with (1 + 1)-ES algorithm An Evolution Strategy (ES) for non-linear optimization has been implemented. The (1 + 1)-ES optimization (described in <ref> [23] </ref>) iterates by randomly selecting a new position in parameter space, which is controlled by a probability function centered at the current location. The 24 5 APPENDIX y-degree from top to bottom. original (1 + 1)-ES algorithm uses a common variance for the mutation of all parameters. <p> The isotropic probability function is subject to grow or shrink by an update rule which considers local information. The algorithm can be summarized as follows (terminology from <ref> [23] </ref>): r t N (0; I) a t+1 = &gt; &gt; &gt; &lt; a t c grow if f (x t+1 ) &lt; f (x opt ) a t c shrink otherwise x opt = &gt; &gt; &gt; &lt; x t+1 if f (x t+1 ) &lt; f (x opt )
Reference: [24] <author> Martin Styner and Guido Gerig. </author> <title> Evaluation of 2d/3d bias correction with 1+1es-optimization. </title> <type> Technical Report 179, </type> <institution> Image Science Lab, ETH Zurich, </institution> <year> 1997. </year>
Reference-contexts: There are the parameters of the bias field estimation and those of the optimization method. This paper gives a short description of the settings of the parameters, for a detailed evaluation please refer to <ref> [24] </ref>.
Reference: [25] <author> D. Vandermeulen F. Maes, A. Collignon, G. Marchal, and P.Suetens. </author> <title> Multimodality image registration by maximization of mutual information. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 16(2) </volume> <pages> 187-198, </pages> <month> April </month> <year> 1997. </year>
Reference-contexts: Two time series, proton density and T2-weighted, were acquired at 12 different time points. To study intensity changes over time with computer based methods the volumes need to be bias corrected, and the intensities of tissue classes in different volumes need to be normalized. After registration using the MIRIT-software <ref> [25] </ref> the volumes are transformed into a normalized 4-D image data set. The intensity normalization can be achieved with our bias correction method by setting the mean values and variances of the classes to the same values for all volumes in the time series.
References-found: 25

