URL: http://www.cs.purdue.edu/homes/tto/ps/varna97.ps
Refering-URL: http://www.cs.purdue.edu/homes/tto/mypaps.html
Root-URL: http://www.cs.purdue.edu
Title: Sparse matrix techniques in a large air pollution model 1 Application of sparse matrix techniques
Author: Tz. Ostromsky Z. Zlatev Frederiksborgvej P. O. 
Keyword: air pollution models, systems of PDE's, systems of ODE's, stiffness, partitioning, accuracy, sparsity  
Address: G.Bonchev str., bl. 25-A, 1113 Sofia, Bulgaria;  Box 358, DK-4000 Roskilde, Denmark;  
Affiliation: Central Laboratory for Parallel Information Processing, Bulgarian Academy of Sciences, Acad.  National Environmental Research Institute, Department of  
Note: AMS Subject Classifications:  
Email: e-mail: ceco@iscbg.acad.bg  e-mail: luzz@sun2.dmu.dk,  
Web: 65L05  Web site: http://www.dmu.dk/atmosphericenvironment/staff/zlatev.htm  
Abstract: Large-scale air pollution models are represented by large systems of partial differential equations. After some discretization and splitting procedures these are transformed into several huge systems of ODE's, which are to be handled numerically during many time-steps. The use of both fast numerical methods and high speed computers is crucial for such models. The chemical part of the model is normally the most time-consuming module. It consists of a huge number of stiff ODE systems, which can be treated as parallel tasks by using different partitioning procedures. One can also try to exploit the sparsity of the Jacobian matrix in order to improve further the efficiency of the computations. A special sparsity algorithm for the chemical part of a large air pollution model is described and tested in this paper. fl This research was partially supported by grants from NATO (ENVIR.CGR.930449 and OUTR. CGR.960312), the Bulgarian Ministry of Education, Science and Technology (I-505/95 and MU-MM-02/96), and the European Union (WEPTEL Esprit 22727 and EUROAIR Esprit 24618). A grant from the Danish Natural Sciences Research Council gave us access to all Danish supercomputers. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> V. Alexandrov, A. Sameh, Y. Siddique and Z. Zlatev, </author> <title> Numerical integration of chemical ODE problems arising in air pollution models, Environmental Modelling and Assessment, </title> <note> to appear. </note>
Reference-contexts: Therefore, one should be very careful when numerical algorithms for this sub-model are selected. The algorithms chosen must be fast. Furthermore, these must be efficient when high speed computers are used. The difficulties that have to be overcome when the chemical sub-model is treated are discussed in <ref> [1] </ref> and [7], and we shall not repeat this discussion here. It is important, however, to emphasize the fact that the chemical sub-model consists of N x fi N y fi N z independent ODE systems. <p> The Backward Euler Formula (together with some modification of the well-known Newton iterative procedure) is often used to solve numerically (8); see <ref> [1] </ref>. <p> A partitioning procedure can be applied in an attempt to reduce the computational work needed to solve (9). The same partitioning as in <ref> [1] </ref> and [7] will be used in this paper. The application of this procedure is equivalent to the replacement of (9) with S n+1 4z n+1 = z n+1 + z n + 4tf (t n+1 ; z n+1 ); (10) where S [0] n+1 is a block-diagonal matrix. <p> The total computing time will also be reduced only if the convergence rate of the Newton iterative process applied to the partitioned version of the Backward Euler Formula is sufficiently fast. The numerical results presented in <ref> [1] </ref> and [7] show that this is true for the particular class of problems arising in the chemical sub-models of large air pollution modes. Several theorems proved in [10] explain why this is so. Many people use partitioning to get parallel computations (see [2]). <p> Six scenarios have been used to create such typical situations. These six scenarios have also been used in <ref> [1] </ref>. Different starting concentrations have been used with and without emissions in the six scenarios. A qualitative characterization of the scenarios, which have been selected by us, is given in Table 1.
Reference: [2] <author> K. Burrage, </author> <title> Parallel and sequential methods for ordinary differential equations, </title> <publisher> Oxford University Press, </publisher> <address> Oxford-New York, </address> <year> 1995. </year>
Reference-contexts: The numerical results presented in [1] and [7] show that this is true for the particular class of problems arising in the chemical sub-models of large air pollution modes. Several theorems proved in [10] explain why this is so. Many people use partitioning to get parallel computations (see <ref> [2] </ref>). This will be efficient only if the blocks are well-balanced, which is not true for the chemical problems arising in air pollution modelling; see the paragraph after formula (10).
Reference: [3] <author> I. S. Duff, A. M. Erisman and J. K. Reid, </author> <title> Direct methods for sparse matrices, </title> <publisher> Oxford University Press, </publisher> <address> Oxford-London, </address> <year> 1986. </year>
Reference-contexts: In the application discussed in the previous section, the largest block of S [0] n contains 13 equations. Therefore, it is difficult to apply general sparse matrix techniques, as those discussed in <ref> [3] </ref> and [8]. However, special sparse matrix techniques may sometimes lead to an improvement of the performance. <p> (i) why special sparse matrix techniques are to be developed and (ii) the main principles used in the development of a special sparse matrix technique. 2.1 Difficulties when general sparse techniques are used The traditional sparse matrix tools, which are used in the treatment of large and sparse matrices (see <ref> [3] </ref> and [8]), are based on two important principles: * computations are carried out only with the non-zero elements and * only the non-zero elements are stored. Both the number of floating arithmetic operations and the storage needed are reduced in this way. <p> The situation changes dramatically when the matrix is small and the general sparse matrix techniques, as those described in <ref> [3] </ref> and [8], become inefficient.
Reference: [4] <author> M. W. Gery, G. Z. Whitten, J. P. Killus and M. C. Dodge, </author> <title> A photochemical kinetics mechanism for urban and regional modeling, </title> <journal> J. Geophys. Res., </journal> <volume> 94, </volume> <year> 1989, </year> <pages> 12925-12956. </pages>
Reference-contexts: 1; : : : q), * the chemical reactions between species are described by the non-linear functions Q s (c 1 ; c 2 ; : : : c q ), where s = 1; 2; : : : ; q (the condensed CBM IV scheme that was proposed by <ref> [4] </ref>, see also [9], is the particular chemical scheme which will be used in this paper). It is very difficult to treat directly the system (1). Therefore, some kind of splitting is to be used.
Reference: [5] <author> G. I. </author> <title> Marchuk, Mathematical modeling for the problem of the environment, </title> <journal> Studies in Mathematics and Applications, </journal> <volume> No. 16, </volume> <publisher> North-Holland, </publisher> <address> Amsterdam, </address> <year> 1985. </year>
Reference-contexts: It is very difficult to treat directly the system (1). Therefore, some kind of splitting is to be used. Splitting according to the major physical processes is very popular; see, for example, <ref> [5] </ref>, [6] and [9]. Such splitting procedures lead often to five sub models which are to be treated cyclicly at every time-step ([9]).
Reference: [6] <author> G. J. McRae, W. R. Goodin and J. H. Seinfeld, </author> <title> Numerical solution of the atmospheric diffusion equations for chemically reacting flows, </title> <journal> J. Comp. Phys., </journal> <volume> 45, </volume> <year> 1984, </year> <pages> 1-42. </pages>
Reference-contexts: It is very difficult to treat directly the system (1). Therefore, some kind of splitting is to be used. Splitting according to the major physical processes is very popular; see, for example, [5], <ref> [6] </ref> and [9]. Such splitting procedures lead often to five sub models which are to be treated cyclicly at every time-step ([9]).
Reference: [7] <author> S. Skelboe and Z. Zlatev, </author> <title> Exploiting the natural partitioning in the numerical solution of ODE systems arising in atmospheric chemistry, In: "Numerical Analysis and Its Applications" (L. </title> <editor> Vulkov, J. Wasniewski and P. Yalamov, </editor> <booktitle> eds.), </booktitle> <pages> pp. 458-465, </pages> <publisher> Springer, </publisher> <address> Berlin, </address> <year> 1997. </year>
Reference-contexts: Therefore, one should be very careful when numerical algorithms for this sub-model are selected. The algorithms chosen must be fast. Furthermore, these must be efficient when high speed computers are used. The difficulties that have to be overcome when the chemical sub-model is treated are discussed in [1] and <ref> [7] </ref>, and we shall not repeat this discussion here. It is important, however, to emphasize the fact that the chemical sub-model consists of N x fi N y fi N z independent ODE systems. <p> A partitioning procedure can be applied in an attempt to reduce the computational work needed to solve (9). The same partitioning as in [1] and <ref> [7] </ref> will be used in this paper. The application of this procedure is equivalent to the replacement of (9) with S n+1 4z n+1 = z n+1 + z n + 4tf (t n+1 ; z n+1 ); (10) where S [0] n+1 is a block-diagonal matrix. <p> The total computing time will also be reduced only if the convergence rate of the Newton iterative process applied to the partitioned version of the Backward Euler Formula is sufficiently fast. The numerical results presented in [1] and <ref> [7] </ref> show that this is true for the particular class of problems arising in the chemical sub-models of large air pollution modes. Several theorems proved in [10] explain why this is so. Many people use partitioning to get parallel computations (see [2]).
Reference: [8] <author> Z. Zlatev, </author> <title> Computational methods for general sparse matrices, </title> <publisher> Kluwer Academic Publishers, </publisher> <address> Dordrecht-Toronto-London, </address> <year> 1991. </year>
Reference-contexts: In the application discussed in the previous section, the largest block of S [0] n contains 13 equations. Therefore, it is difficult to apply general sparse matrix techniques, as those discussed in [3] and <ref> [8] </ref>. However, special sparse matrix techniques may sometimes lead to an improvement of the performance. <p> special sparse matrix techniques are to be developed and (ii) the main principles used in the development of a special sparse matrix technique. 2.1 Difficulties when general sparse techniques are used The traditional sparse matrix tools, which are used in the treatment of large and sparse matrices (see [3] and <ref> [8] </ref>), are based on two important principles: * computations are carried out only with the non-zero elements and * only the non-zero elements are stored. Both the number of floating arithmetic operations and the storage needed are reduced in this way. However, one has to pay something for this reduction. <p> The situation changes dramatically when the matrix is small and the general sparse matrix techniques, as those described in [3] and <ref> [8] </ref>, become inefficient. <p> The pivotal strategies used in sparse matrix factorizations for general matrices, Markowitz pivotal interchanges and their modifications (see <ref> [8] </ref>), are very efficient for large matrices, but they become rather expensive when the factorized matrix is small. Therefore, the pivotal strategy must be improved. This has been achieved by removing the requirement to carry out pivoting for achieving numerical stability. The matrices that appear in our problems are general.
Reference: [9] <author> Z. Zlatev, </author> <title> Computer treatment of large air pollution models, </title> <publisher> Kluwer Academic Publishers, </publisher> <address> Dordrecht-Boston-London, </address> <year> 1995. </year>
Reference-contexts: This number varies from 10 to 168 in the experiments described in <ref> [9] </ref>. The other quantities involved in the model can be described as follows (see again [9] for more details): * the unknowns c s are concentrations of the chemical species, * u; v and w are the components of the wind along the coordinate axes, * K x ; K y <p> This number varies from 10 to 168 in the experiments described in <ref> [9] </ref>. The other quantities involved in the model can be described as follows (see again [9] for more details): * the unknowns c s are concentrations of the chemical species, * u; v and w are the components of the wind along the coordinate axes, * K x ; K y and K z are diffusion coefficients, * the emissions in the space domain are represented <p> : q), * the chemical reactions between species are described by the non-linear functions Q s (c 1 ; c 2 ; : : : c q ), where s = 1; 2; : : : ; q (the condensed CBM IV scheme that was proposed by [4], see also <ref> [9] </ref>, is the particular chemical scheme which will be used in this paper). It is very difficult to treat directly the system (1). Therefore, some kind of splitting is to be used. Splitting according to the major physical processes is very popular; see, for example, [5], [6] and [9]. <p> see also <ref> [9] </ref>, is the particular chemical scheme which will be used in this paper). It is very difficult to treat directly the system (1). Therefore, some kind of splitting is to be used. Splitting according to the major physical processes is very popular; see, for example, [5], [6] and [9]. Such splitting procedures lead often to five sub models which are to be treated cyclicly at every time-step ([9]). <p> The functions g (i) , i = 1; 2; 3; 4; 5, are vector-functions whose components are approximations to the concentrations at the grid-points, while the right-hand-side vectors f (i) depend on the particular discretization methods applied to the corresponding sub-models (2)-(6) (see <ref> [9] </ref>). The number of equations in any of the five ODE systems in (7) is equal to the product of the number of grid-points and the number of chemical species studied by the model. <p> The situation is slightly more complicated when vector processors are used. However, also here can high efficiency be achieved by rearranging the computations across the grid-points in order to obtain long loops (see <ref> [9] </ref>). Tests on parallel and vector machines will be carried out in the near future.
Reference: [10] <author> Z. Zlatev, </author> <title> Partitioning ODE systems with an application to air pollution models, </title> <type> Internal report. </type> <institution> National Environmental Research Institute, Department of Atmospheric Environment, </institution> <address> Frederiksborgvej 399, P. O. Box 399, DK-4000 Roskilde, Denmark, </address> <year> 1997. </year>
Reference-contexts: The numerical results presented in [1] and [7] show that this is true for the particular class of problems arising in the chemical sub-models of large air pollution modes. Several theorems proved in <ref> [10] </ref> explain why this is so. Many people use partitioning to get parallel computations (see [2]). This will be efficient only if the blocks are well-balanced, which is not true for the chemical problems arising in air pollution modelling; see the paragraph after formula (10).
References-found: 10

