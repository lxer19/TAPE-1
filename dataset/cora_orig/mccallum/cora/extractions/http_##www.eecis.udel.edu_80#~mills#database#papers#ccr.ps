URL: http://www.eecis.udel.edu:80/~mills/database/papers/ccr.ps
Refering-URL: http://www.eecis.udel.edu:80/~mills/papers.htm
Root-URL: http://www.cis.udel.edu
Title: On the Accuracy and Stability of Clocks Synchronized by the Network Time Protocol in the
Author: David L. Mills 
Keyword: network clock synchronization, standard-time distribution, performance evaluation, internet protocol.  
Affiliation: Electrical Engineering Department University of Delaware  
Abstract: This paper describes a series of experiments involving over 100,000 hosts of the Internet system and located in the U.S., Europe and the Pacific. The experiments are designed to evaluate the availability, accuracy and reliability of international standard time distribution using the Internet and the Network Time Protocol (NTP), which has been designated an Internet Standard protocol. NTP is designed specifically for use in a large, diverse internet system operating at speeds from mundane to lightwave. In NTP a distributed subnet of time servers operating in a self-organizing, hierarchical, masterslave configuration exchange precision timestamps in order to synchronize host clocks to each other and national time standards via wire or radio. The experiments are designed to locate Internet hosts and gateways that provide time by one of three time distribution protocols and evaluate the accuracy of their indications. For those hosts that support NTP, the experiments determine the distribution of errors and other statistics over paths spanning major portions of the globe. Finally, the experiments evaluate the accuracy and reliability of precision timekeeping using NTP and typical Internet paths involving ARPANET, NSFNET and regional networks. The experiments demonstrate that timekeeping throughout most portions of the Internet can be maintained to an accuracy of a few tens of milliseconds and a stability of a few milliseconds per day, even in cases of failure or disruption of clocks, time servers or networks.
Abstract-found: 1
Intro-found: 1
Reference: 1. <author> Allan, D.W., J.H. Shoaf and D. Halford. </author> <title> Statistics of time and frequency data analysis. In: Blair, B.E. (Ed.). Time and Frequency Theory and Fundamentals . National Bureau of Standards Monograph 140, </title> <type> U.S. </type> <institution> Department of Commerce, </institution> <year> 1974, </year> <pages> 151-204. </pages> <note> Time (NTP days) Frequency Error (ppm) 2 4 6 8 10 12 14 -0.6 -0.2 0.2 Time (NTP days) Offset Error (ms) 7.0 7.2 7.4 7.6 7.8 8.0 -5 5 10 </note>
Reference-contexts: In order to test this conjecture an experiment was designed to determine the stability of the apparent times-cale constructed from the first-order offset differences produced in an experiment similar to that which produced Table 2. This is similar to the approach described in <ref> [1] </ref> to analyze the intrinsic characteristics of a precision oscillator. In the month-long experiment, measured offsets were filtered by the algorithm described in the next section. The resulting samples were averaged at given intervals from about a minute to about ten days.
Reference: 2. <author> Allan, D.W., J.E. Gray and H.E. Machlan. </author> <title> The Na--tional Bureau of Standards atomic time scale: generation, stability, accuracy and accessibility. In: Blair, B.E. (Ed.). Time and Frequency Theory and Fundamentals . National Bureau of Standards Monograph 140, </title> <type> U.S. </type> <institution> Department of Commerce, </institution> <year> 1974, </year> <pages> 205-231. </pages>
Reference-contexts: In principle, such methods can reduce the effect of systematic offsets shown in Table 2 <ref> [2] </ref>. However, these methods can also significantly increase the sample variance presented to the PLL and thus reduce the local-clock stability below acceptable levels. Thus, the experiment represents a worst-case scenario. by the simulator using offset samples collected from all six primary servers over a four-week period.
Reference: 3. <author> Bertsekas, D., and R. </author> <title> Gallager. </title> <booktitle> Data Networks . Prentice-Hall, </booktitle> <address> Englewood Cliffs, NJ, </address> <year> 1987. </year>
Reference-contexts: Subnet servers calculate local clock offsets and delays between them using timestamps with 200 picosecond resolution exchanged at intervals up to about 17 minutes. As explained in [16], the protocol uses a distributed Bellman-Ford algorithm <ref> [3] </ref> to construct minimum-weight spanning trees within the subnet based on hierarchical level (stratum) and total synchronization path delay to the primary servers.
Reference: 4. <author> Beser, J., and B.W. Parkinson. </author> <title> The application of NAVSTAR differential GPS in the civilian commu nity. </title> <type> Navigation 29, </type> <month> 2 (Summer </month> <year> 1982). </year>
Reference-contexts: Using GOES the accuracy depends on an accurate ephemeris and correction factors, but is generally of the same order as WWVB. Other systems intended primarily for navigation, including LORAN-C [8], Global Positioning System (GPS) <ref> [4] </ref>, OMEGA [25], and various very-low-frequency communication stations in principle can be used for very precise time and frequency transfer on a global scale; however, these systems do not provide timecodes including time-of-day or day-of-year information. 1.2.
Reference: 5. <author> Blair, </author> <title> B.E. Time and frequency dissemination: an overview of principles and techniques. In: Blair, B.E. (Ed.). Time and Frequency Theory and Fundamentals . National Bureau of Standards Monograph 140, </title> <type> U.S. </type> <institution> Department of Commerce, </institution> <year> 1974, </year> <pages> 233-313. </pages>
Reference-contexts: Using high-frequency transmissions, reliable frequency comparisons can be made to the order of 10 -7 , but time accuracies are limited to the order of a millisecond <ref> [5] </ref>. Using long-wave transmissions and appropriate receiving and averaging techniques and corrections for diurnal and seasonal propagation effects, frequency comparisons to within 10 -11 are possible and time accuracies of from a few to 50 microseconds can be obtained. <p> It is possible to estimate the timekeeping accuracy by means of a detailed analysis of the radio propagation path itself. In the case of the WWVB and MSF services on 60 kHz, the variations in path delay are relatively well understood and limited to the order of 50 microseconds <ref> [5] </ref>. In the case of the GOES service the accuracy is limited by the ability to accurately estimate the distance along the line-of-sight path to the satellite and the ability to maintain accurate stationkeeping in geosynchronous orbit.
Reference: 6. <author> Cole, R., and C. Foxcroft. </author> <title> An experiment in clock synchronisation. </title> <booktitle> The Computer Journal 31 , 6 (1988), </booktitle> <pages> 496-502. </pages>
Reference-contexts: Obviously, the accuracies achievable depend upon the statistical properties of the outbound and inbound data paths. Further analysis and experimental results bearing on this issue can be found in <ref> [6] </ref>, [12] and [13]. As shown in Figure 2, the computed offsets are first filtered to reduce incidental noise and then evaluated to select the most accurate and reliable subset among all available servers.
Reference: 7. <institution> Defense Advanced Research Projects Agency. Internet Control Message Protocol. DARPA Network Working Group Report RFC-792, USC Information Sciences Institute, </institution> <month> September </month> <year> 1981. </year>
Reference-contexts: Besides NTP, there are several protocols designed to distribute time in local-area networks, including the DAYTIME protocol [22], TIME Protocol [23], ICMP Timestamp message <ref> [7] </ref> and IP Timestamp option [24]. The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP [11]. <p> The program accumulates error messages and sample data for up to eight samples in each of the three time protocols. It abandons a host upon receipt of an ICMP error message <ref> [7] </ref> and abandons further hosts on the same network upon receipt of an ICMP net-unreachable message. Using this procedure, attempts were Protocol Valid Timeout Error Unknown ICMP 11533 61343 265 532 TIME 8441 1400 2293 na NTP 784 713 6956 na Totals 20758 63456 9514 532 Table 1.
Reference: 8. <author> Frank, </author> <title> R.L. </title> <booktitle> History of LORAN-C. Navigation 29, </booktitle> <month> 1 (Spring </month> <year> 1982). </year>
Reference-contexts: Using GOES the accuracy depends on an accurate ephemeris and correction factors, but is generally of the same order as WWVB. Other systems intended primarily for navigation, including LORAN-C <ref> [8] </ref>, Global Positioning System (GPS) [4], OMEGA [25], and various very-low-frequency communication stations in principle can be used for very precise time and frequency transfer on a global scale; however, these systems do not provide timecodes including time-of-day or day-of-year information. 1.2.
Reference: 9. <author> Gusella, R., and S. Zatti. </author> <title> The Berkeley UNIX 4.3BSD time synchronization protocol: protocol specification. </title> <type> Technical Report UCB/CSD 85/250, </type> <institution> University of California, Berkeley, </institution> <month> June </month> <year> 1985. </year>
Reference-contexts: The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP [11]. The Unix 4.3bsd time daemon timed uses a single master-time daemon to measure offsets of a number of slave hosts and send periodic corrections to them <ref> [9] </ref>. However, these protocols do not include engineered algorithms to compensate for the effects of statistical delay variations encountered in wide-area networks and are unsuitable for precision time distribution throughout the Internet. 1.3.
Reference: 10. <author> Kopetz, H., and W. Ochsenreiter. </author> <title> Clock synchronization in distributed real-time systems. </title> <journal> IEEE Trans. Computers C-36, </journal> <month> 8 (August </month> <year> 1987), </year> <pages> 933-939. </pages>
Reference-contexts: As in previous surveys of this type, statistics based on the sample median yield more reliable results than those based on the sample mean. However, statistics based on the trimmed mean (also called Fault-Tolerant Average <ref> [10] </ref>) with 25 percent of the samples removed are within a millisecond of the values shown in Table 2. The residual offset errors apparent in Table 2 can be traced to subtle asymmetries in path routing and network/gateway configurations.
Reference: 11. <author> Mills, </author> <title> D.L. DCN local-network protocols. DARPA Network Working Group Report RFC-891, </title> <address> M/A COM Linkabit, </address> <month> December </month> <year> 1983. </year>
Reference-contexts: Besides NTP, there are several protocols designed to distribute time in local-area networks, including the DAYTIME protocol [22], TIME Protocol [23], ICMP Timestamp message [7] and IP Timestamp option [24]. The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP <ref> [11] </ref>. The Unix 4.3bsd time daemon timed uses a single master-time daemon to measure offsets of a number of slave hosts and send periodic corrections to them [9].
Reference: 12. <author> Mills, </author> <title> D.L. Algorithms for synchronizing network clocks. DARPA Network Working Group Report RFC-956, </title> <address> M/A-COM Linkabit, </address> <month> September </month> <year> 1985. </year>
Reference-contexts: Obviously, the accuracies achievable depend upon the statistical properties of the outbound and inbound data paths. Further analysis and experimental results bearing on this issue can be found in [6], <ref> [12] </ref> and [13]. As shown in Figure 2, the computed offsets are first filtered to reduce incidental noise and then evaluated to select the most accurate and reliable subset among all available servers. <p> This path was purposely selected as among the statistically noisiest in order to determine how well clocks can be synchronized under adverse conditions. A number of algorithms for deglitching and filtering time-offset data are summarized in <ref> [12] </ref> and [18]. Experi ments during the development of NTP Version 2 have produced an algorithm which provides high accuracy together with a low computational burden. The key to the new algorithm becomes evident through an examination of scatter diagrams plotting clock offset versus roundtrip delay.
Reference: 13. <author> Mills, </author> <title> D.L. Experiments in network clock synchronization. DARPA Network Working Group Report RFC-957, </title> <address> M/A-COM Linkabit, </address> <month> September </month> <year> 1985. </year>
Reference-contexts: Obviously, the accuracies achievable depend upon the statistical properties of the outbound and inbound data paths. Further analysis and experimental results bearing on this issue can be found in [6], [12] and <ref> [13] </ref>. As shown in Figure 2, the computed offsets are first filtered to reduce incidental noise and then evaluated to select the most accurate and reliable subset among all available servers. <p> Discovering Internet Timetellers An experiment designed to discover Internet time server hosts and evaluate the quality of their indications was conducted over a nine-day interval in August 1989. This experiment is an update of previous experiments conducted in 1985 <ref> [13] </ref> and early 1988 [14]. It involved sending timerequest messages in each of three time distribution protocols: ICMP Timestamp, TIME and NTP, to every Internet address that could reasonably be associated with a working host.
Reference: 14. <author> Mills, </author> <title> D.L. Network Time Protocol (version 1) specification and implementation. </title> <institution> DARPA Network Working Group Report RFC-1059, University of Delaware, </institution> <month> July </month> <year> 1988. </year>
Reference-contexts: 1. Introduction How do hosts and gateways in a large, dispersed networking community know what time it is? How accurate are their clocks? In a 1988 survey involving 5,722 hosts and gateways of the Internet system <ref> [14] </ref>, 1158 provided their local time via the network. Sixty percent of the replies had errors greater than one minute, while ten percent had errors greater than 13 minutes. A few had errors as much as two years. <p> Discovering Internet Timetellers An experiment designed to discover Internet time server hosts and evaluate the quality of their indications was conducted over a nine-day interval in August 1989. This experiment is an update of previous experiments conducted in 1985 [13] and early 1988 <ref> [14] </ref>. It involved sending timerequest messages in each of three time distribution protocols: ICMP Timestamp, TIME and NTP, to every Internet address that could reasonably be associated with a working host.
Reference: 15. <author> Mills, </author> <title> D.L. </title> <booktitle> The fuzzball. Proc. ACM SIGCOMM 88 Symposium (Palo Alto, </booktitle> <address> CA, </address> <month> August </month> <year> 1988), </year> <pages> 115-122. </pages>
Reference-contexts: NTP and its forebears were developed and tested on PDP11 computers and the Fuzzball operating system, which was designed specifically for timekeeping precisions of a millisecond or better <ref> [15] </ref>. An implementation 1 Sponsored by: Defense Advanced Research Projects Agency contract number N00140-87-C-8901 and by National Science Foundation grant number NCR-89-13623. 2 Authors address: Electrical Engineering Department, University of Delaware, Newark, DE 19716; Internet mail: mills@udel.edu. 3 Reprinted from: Mills, D.L. <p> The experiment itself was conducted with the aid of the control file and a specially constructed experiment program written for the Fuzzball operating system <ref> [15] </ref>. The data were collected using experiment hosts located at the University of Delaware and connected to the University of Delaware campus network and SURA regional network. The experiment program reads each entry from the control file in turn and sends timerequest messages to the first Internet address found.
Reference: 16. <author> Mills, </author> <title> D.L. Network Time Protocol (version 2) specification and implementation. </title> <institution> DARPA Network Working Group Report RFC-1119, University of Delaware, </institution> <month> September </month> <year> 1989. </year>
Reference-contexts: Further information on the background, model and algorithms can be found in [18], while details of the latest NTP protocol specification can be found in <ref> [16] </ref>. This paper itself is an edited and expanded version of [17]. 1.1. <p> In addition to the above, and in common with other promiscuously distributed services, the system must include generic protection against accidental or willful intrusion and provide a comprehensive interface for network management. In NTP address filtering is used for access control, while encrypted checksums are used for authentication <ref> [16] </ref>. Network management presently uses a proprietary protocol with provisions to migrate to standard protocols where available. In NTP one or more primary time servers synchronize directly to external reference sources such as radio clocks. <p> Secondary time servers synchronize to the primary servers and others in a configured subnet of NTP servers. Subnet servers calculate local clock offsets and delays between them using timestamps with 200 picosecond resolution exchanged at intervals up to about 17 minutes. As explained in <ref> [16] </ref>, the protocol uses a distributed Bellman-Ford algorithm [3] to construct minimum-weight spanning trees within the subnet based on hierarchical level (stratum) and total synchronization path delay to the primary servers. <p> The offset and delay columns show the sample medians for these quantities in milliseconds. Note that the number of samples collected depends on whether the server is selected for clock synchronization, as determined by the NTP clockselec-tion algorithm described in <ref> [16] </ref>. As in previous surveys of this type, statistics based on the sample median yield more reliable results than those based on the sample mean. <p> Therefore, an appropriate technique is simply to select from the n most recent samples the sample with lowest delay and use its associated offset as the estimate. This is the basis of the clock filter shown in detail in <ref> [16] </ref>. under study over a six-day interval, in which occasional errors up to several seconds are apparent. Figure 7 shows the time-offset series produced by the filtering algorithm, in which the large errors have been dramatically reduced. <p> The offsets measured between each of the six primary servers and the experiment host were collected and processed by a simulator that duplicates the NTP processing algorithms. However, in addition to the algorithms described in <ref> [16] </ref>, which select a subset of quality clocks and from them a single clock as the synchronization source, an experimental clock-combining method involving a weighted average of offsets from all selected clocks was used. In principle, such methods can reduce the effect of systematic offsets shown in Table 2 [2].
Reference: 17. <author> Mills, </author> <title> D.L. Measured performance of the Network Time Protocol in the Internet system. </title> <institution> DARPA Network Working Group Report RFC-1128, University of Delaware, </institution> <month> October </month> <year> 1989. </year>
Reference-contexts: Further information on the background, model and algorithms can be found in [18], while details of the latest NTP protocol specification can be found in [16]. This paper itself is an edited and expanded version of <ref> [17] </ref>. 1.1. Standard Time and Frequency Dissemina tion In order that precision time and frequency can be coordinated throughout the world, national administrations operate primary time and frequency standards and maintain Coordinated Universal Time (UTC) by observing various radio broadcasts and through occasional use of portable atomic clocks.
Reference: 18. <author> Mills, </author> <title> D.L. Internet time synchronization: the Network Time Protocol. </title> <institution> DARPA Network Working Group Report RFC-1129, University of Delaware, </institution> <month> October </month> <year> 1989. </year>
Reference-contexts: This paper does not describe in detail the architecture or protocols of NTP, nor does it present the rationale for the particular choice of synchronization method and statistical processing algorithms. Further information on the background, model and algorithms can be found in <ref> [18] </ref>, while details of the latest NTP protocol specification can be found in [16]. This paper itself is an edited and expanded version of [17]. 1.1. <p> This path was purposely selected as among the statistically noisiest in order to determine how well clocks can be synchronized under adverse conditions. A number of algorithms for deglitching and filtering time-offset data are summarized in [12] and <ref> [18] </ref>. Experi ments during the development of NTP Version 2 have produced an algorithm which provides high accuracy together with a low computational burden. The key to the new algorithm becomes evident through an examination of scatter diagrams plotting clock offset versus roundtrip delay.
Reference: 19. <author> Mitra, D. </author> <title> Network synchronization: analysis of a hybrid of masterslave and mutual synchronization. </title> <journal> IEEE Trans. Communications COM-28, </journal> <month> 8 (August </month> <year> 1980), </year> <pages> 1245-1259. </pages>
Reference-contexts: This method amounts to a continuously sampled, returnable-time system, which is used in some digital telephone networks <ref> [19] </ref>. Among the advantages are that the transmitted time and received order of the messages are unimportant and that reliable delivery is not required. Obviously, the accuracies achievable depend upon the statistical properties of the outbound and inbound data paths.
Reference: 20. <author> Mockapetris, P. </author> <title> Domain names - concepts and facilities. </title> <institution> DARPA Network Working Group Report RFC-1034, USC Information Sciences Institute, </institution> <month> November </month> <year> 1987. </year>
Reference-contexts: Previously, lists of such addresses were derived from the Internet host table maintained by the Network Information Center (NIC), which contained 6382 distinct host and gateway addresses as of August 1989. With the proliferation of the Internet domain-name system used to resolve host addresses from host names <ref> [20] </ref>, the NIC host table has become increasingly inadequate as a discovery vehicle for working host addresses. In a comprehensive survey of the domain-name system, Mark Lotter of SRI International recently compiled a revised host table of 137,484 entries.
Reference: 21. <institution> Time and Frequency Dissemination Services. </institution> <note> NBS Special Publication 432, </note> <institution> U.S. Department of Com merce, </institution> <year> 1979. </year>
Reference-contexts: The U.S. National Institute of Standards and Technology (NIST - formerly National Bureau of Standards) operates radio broadcast services for the dissemination of standard time <ref> [21] </ref>. These include shortwave transmissions from stations WWV at Fort Collins, CO, and WWVH at Kauai, HI, long-wave transmissions from WWVB, also at Fort Collins, and satellite transmissions from the Geo-synchronous Orbiting Environmental Satellite (GOES).
Reference: 22. <author> Postel, J. </author> <title> Daytime protocol. </title> <institution> DARPA Network Working Group Report RFC-867, USC Information Sciences Institute, </institution> <month> May </month> <year> 1983. </year>
Reference-contexts: The subnet has recon-figured itself automatically to use backup paths, with the result that one of the servers has dropped from stratum 2 to stratum 3. Besides NTP, there are several protocols designed to distribute time in local-area networks, including the DAYTIME protocol <ref> [22] </ref>, TIME Protocol [23], ICMP Timestamp message [7] and IP Timestamp option [24]. The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP [11].
Reference: 23. <author> Postel, J. </author> <title> Time protocol. </title> <institution> DARPA Network Working Group Report RFC-868, USC Information Sciences Institute, </institution> <month> May </month> <year> 1983. </year>
Reference-contexts: The subnet has recon-figured itself automatically to use backup paths, with the result that one of the servers has dropped from stratum 2 to stratum 3. Besides NTP, there are several protocols designed to distribute time in local-area networks, including the DAYTIME protocol [22], TIME Protocol <ref> [23] </ref>, ICMP Timestamp message [7] and IP Timestamp option [24]. The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP [11].
Reference: 24. <author> Su, Z. </author> <title> A specification of the Internet protocol (IP) timestamp option. DARPA Network Working Group Report RFC-781. </title> <booktitle> SRI International, </booktitle> <month> May </month> <year> 1981. </year>
Reference-contexts: Besides NTP, there are several protocols designed to distribute time in local-area networks, including the DAYTIME protocol [22], TIME Protocol [23], ICMP Timestamp message [7] and IP Timestamp option <ref> [24] </ref>. The DCN routing protocol incorporates time synchronization directly into the routing protocol using algorithms similar to NTP [11]. The Unix 4.3bsd time daemon timed uses a single master-time daemon to measure offsets of a number of slave hosts and send periodic corrections to them [9].
Reference: 25. <author> Vass, </author> <title> E.R. OMEGA navigation system: present status and plans 1977-1980. </title> <booktitle> Navigation 25, 1 (Spring 1978). </booktitle> <pages> 11 </pages>
Reference-contexts: Using GOES the accuracy depends on an accurate ephemeris and correction factors, but is generally of the same order as WWVB. Other systems intended primarily for navigation, including LORAN-C [8], Global Positioning System (GPS) [4], OMEGA <ref> [25] </ref>, and various very-low-frequency communication stations in principle can be used for very precise time and frequency transfer on a global scale; however, these systems do not provide timecodes including time-of-day or day-of-year information. 1.2. The Network Time Protocol An accurate, reliable time distribution protocol must provide the following: 1.
References-found: 25

