URL: ftp://dimacs.rutgers.edu/pub/dimacs/TechnicalReports/TechReports/1997/97-18.ps.gz
Refering-URL: http://dimacs.rutgers.edu/TechnicalReports/1997.html
Root-URL: http://www.cs.rutgers.edu
Title: On the Linear-Cost Subtree-Transfer Distance between Phylogenetic Trees 1  
Author: by Bhaskar DasGupta ;; Xin He Tao Jiang Ming Li John Tromp 
Date: 1997  
Note: May  DIMACS is a partnership of Rutgers University, Princeton University, AT&T Labs, Bellcore, and Bell Labs. DIMACS is an NSF Science and Technology Center, funded under contract STC-91-19999; and also receives support from the New Jersey Commission on Science and Technology.  
Abstract: DIMACS Technical Report 97-18 1 The results reported here have also appeared in Proc. 8th Annual ACM-SIAM Symposium on Discrete Algorithms, 1997, pp. 427-436, New Orleans. 2 Visitor, DIMACS Center. 3 Address for correspondence: Department of Computer Science, Rutgers University, Camden, NJ 08102. E-mail: bhaskar@crab.rutgers.edu. Supported by an CGAT (Canadian Genome Analysis and Technology) grant. Work done while the author was at University of Waterloo and McMaster University 4 Department of Computer Science, SUNY at Buffalo, Buffalo, NY 14260. E-mail: xinhe@cs.buffalo.edu. Supported in part by CGAT and NSF grant 9205982. Work done while the author was visiting at University of Waterloo 5 Department of Computer Science, McMaster University, Hamilton, Ontario L8S 4K1, Canada. Email: jiang@maccs.mcmaster.ca. Supported in part by NSERC Operating Grant OGP0046613 and CGAT. Work done while the author was visiting at University of Washington. 6 Department of Computer Science, City University of Hong Kong, Kowloon, Hong Kong. Email: mli@cs.cityu.edu.hk. Supported by NSERC Operating Grant OGP0046506 and CGAT. On sabbatical leave from Department of Computer Science, University of Waterloo, Waterloo, Ont. N2L 3G1, Canada. 7 CWI, P.O. Box 94079, 1090 GB Amsterdam, Netherlands. E-mail: tromp@cwi.nl. Supported by an NSERC International Fellowship and CGAT. Work done while the author was with University of Waterloo. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D. Barry and J.A. Hartigan, </author> <title> Statistical analysis of hominoid molecular evolution, </title> <journal> Stat. Sci., </journal> <volume> 2(1987), </volume> <pages> 191-210. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility [15], distance [8, 19], and maximum likelihood <ref> [4, 5, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [2] <author> B. DasGupta, X. He, T. Jiang, M. Li, J. Tromp and L. Zhang, </author> <title> On Distances between Phylogenetic Trees, </title> <booktitle> Proc. 8th Annual ACM-SIAM Symposium on Discrete Algorithms, </booktitle> <address> Jan. 1997, New Orleans. </address>
Reference-contexts: The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in <ref> [2] </ref> that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in [2, 16]. The problem of computing distance between phylogenies also arises in a different context. <p> The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in [2] that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in <ref> [2, 16] </ref>. The problem of computing distance between phylogenies also arises in a different context. <p> The rest of the paper is organized as follows. In section 2, we show that the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, the complexity and approximation results for the nni distance reported in <ref> [2, 3] </ref> directly apply to the linear-cost subtree-transfer distance on unweighted phylogenies too. <p> Hence the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, all the results on computing the nni distance reported in <ref> [2, 3] </ref> directly applies to the linear-cost subtree-transfer problem on unweighted phylogenies also.
Reference: [3] <author> B. DasGupta, X. He, T. Jiang, M. Li, J. Tromp and L. Zhang, </author> <title> On Computing the Nearest Neighbor Interchange Distance, </title> <type> Preprint, </type> <year> 1997. </year>
Reference-contexts: The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies [6]. Just like the nni model <ref> [3] </ref>, the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in [14]. <p> The rest of the paper is organized as follows. In section 2, we show that the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, the complexity and approximation results for the nni distance reported in <ref> [2, 3] </ref> directly apply to the linear-cost subtree-transfer distance on unweighted phylogenies too. <p> Hence the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, all the results on computing the nni distance reported in <ref> [2, 3] </ref> directly applies to the linear-cost subtree-transfer problem on unweighted phylogenies also.
Reference: [4] <author> A.W.F. Edwards and L.L. Cavalli-Sforza, </author> <title> The reconstruction of evolution, </title> <journal> Ann. Hum. Genet., </journal> <volume> 27(1964), </volume> <pages> 105. </pages> <note> (Also in Heredity 18, 553.) </note>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [4, 7, 20] </ref>, compatibility [15], distance [8, 19], and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14]. <p> Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility [15], distance [8, 19], and maximum likelihood <ref> [4, 5, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [5] <author> J. Felsenstein, </author> <title> Evolutionary trees for DNA sequences: a maximum likelihood approach. </title> <journal> J. Mol. Evol., </journal> <volume> 17(1981), </volume> <pages> 368-376. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility [15], distance [8, 19], and maximum likelihood <ref> [4, 5, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [6] <author> J. Felsenstein, </author> <type> personal communication, </type> <year> 1996. </year>
Reference-contexts: Comparison of weighted phylogenies has recently been studied in [14]. The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies <ref> [6] </ref>. Just like the nni model [3], the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in [14].
Reference: [7] <author> W.M. Fitch, </author> <title> Toward defining the course of evolution: minimum change for a specified tree topology, </title> <journal> Syst. Zool., </journal> <volume> 20(1971), </volume> <pages> 406-416. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [4, 7, 20] </ref>, compatibility [15], distance [8, 19], and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [8] <author> W.M. Fitch and E. Margoliash, </author> <title> Construction of phylogenetic trees, </title> <journal> Science, </journal> <volume> 155(1967), </volume> <pages> 279-284. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility [15], distance <ref> [8, 19] </ref>, and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [9] <author> M. R. Garey and D. S. Johnson, </author> <title> Computers and Intractability: A Guide to the Theory of NP-Completeness, </title> <editor> W. H. </editor> <publisher> Freeman, </publisher> <year> 1979. </year>
Reference-contexts: QUESTION: Are there q disjoint sets C i 1 ; : : : ; C i q such that [ q X3C is known to be NP-complete <ref> [9] </ref>. We will construct two trees T 1 and T 2 with leaf labels (not necessarily unique), such that transforming from T 1 into T 2 requires subtree-transfers of total cost exactly 1 iff an exact cover of S exists.
Reference: [10] <author> J. Hein, </author> <title> Reconstructing evolution of sequences subject to recombination using parsimony, </title> <journal> Math. Biosci., </journal> <volume> 98(1990), </volume> <pages> 185-200. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model [23] and a model using a list of phylogenetic trees <ref> [10, 11] </ref>. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another. Figure 1 shows a subtree-transfer operation and its corresponding recombination event. <p> Figure 1 shows a subtree-transfer operation and its corresponding recombination event. The parsimony model in <ref> [10, 11] </ref> requires the computation of the - 2 - subtree s 2 in (b). The genetic material (thick lines), that is in one sequence after recombination, was in two sequences just before the recombination.
Reference: [11] <author> J. Hein, </author> <title> A heuristic method to reconstruct the history of sequences subject to recombination, </title> <journal> J. Mol. Evol., </journal> <volume> 36(1993), </volume> <pages> 396-405. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model [23] and a model using a list of phylogenetic trees <ref> [10, 11] </ref>. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another. Figure 1 shows a subtree-transfer operation and its corresponding recombination event. <p> Figure 1 shows a subtree-transfer operation and its corresponding recombination event. The parsimony model in <ref> [10, 11] </ref> requires the computation of the - 2 - subtree s 2 in (b). The genetic material (thick lines), that is in one sequence after recombination, was in two sequences just before the recombination. <p> It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies. For example, it is reasonable to assume that sequences that have only diverged recently give rise to more recombinations than sequences that diverged many generations ago <ref> [11, 12] </ref>. In this case, we can charge each subtree-transfer operation a cost equal to the distance (number of nodes passed) that the subtree has moved in the current tree.
Reference: [12] <author> J. </author> <title> Hein, </title> <type> personal email communication, </type> <year> 1996. </year>
Reference-contexts: It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies. For example, it is reasonable to assume that sequences that have only diverged recently give rise to more recombinations than sequences that diverged many generations ago <ref> [11, 12] </ref>. In this case, we can charge each subtree-transfer operation a cost equal to the distance (number of nodes passed) that the subtree has moved in the current tree.
Reference: [13] <author> J. Hein, T. Jiang, L. Wang, and K. Zhang, </author> <title> On the complexity of comparing evolutionary trees, </title> <booktitle> Discrete Applied Mathematics 71, </booktitle> <pages> 153-169, </pages> <year> 1996. </year>
Reference-contexts: of s 2 ; s 3 ; s 4 is found going back in time; hence the second number of the thick line in second row is 3. subtree-transfer distance between two trees, i.e. the minimum number of subtrees we need to move to transform one tree into the other. <ref> [13] </ref> shows that computing the subtree-transfer distance is NP-complete and gives a simple approximation algorithm with ratio 3. It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies.
Reference: [14] <author> M. Kuhner and J. Felsenstein, </author> <title> A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates. Mol. </title> <journal> Biol. Evol. </journal> <volume> 11(3), </volume> <year> 1994, </year> <pages> 459-468. </pages>
Reference-contexts: The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species <ref> [14] </ref>. It is thus of interest to compare phylogenies produced by different methods, or by the same method on different data, for similarity and discrepancy. The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. <p> Many phylogeny reconstruction methods, including the distance and maximum likelihood methods, actually produce weighted phylogenies. Comparison of weighted phylogenies has recently been studied in <ref> [14] </ref>. The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies [6]. <p> Just like the nni model [3], the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in <ref> [14] </ref>. In this paper, we study the computational complexity and approximation algorithms for linear-cost subtree-transfer distance on both unweighted and weighted phylogenies. The rest of the paper is organized as follows.
Reference: [15] <author> W.J. Le Quesne, </author> <title> The uniquely evolved character concept and its cladistic application, </title> <journal> Syst. Zool., </journal> <volume> 23(1974), </volume> <pages> 513-517. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility <ref> [15] </ref>, distance [8, 19], and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [16] <author> M. Li, J. Tromp and L. Zhang, </author> <title> Some notes on the nearest neighbor interchange distance, </title> <booktitle> Proc. 2nd Intern. Computing and Combinatorics Conf., </booktitle> <address> Hong Kong, </address> <year> 1996. </year> <month> - 19 </month> - 
Reference-contexts: The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in [2] that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in <ref> [2, 16] </ref>. The problem of computing distance between phylogenies also arises in a different context. <p> An n O (d) algorithm for this problem is trivial. With careful inspection, one can derive an algorithm that runs in O (n O (1) d O (d 2 ) ) time. It turns out that by using the results in <ref> [22, 16] </ref>, we could improve this asymptotically to O (n 2 log n + n 2 23d=2 ) time. Definition 1 Let T 1 and T 2 be the two trees being compared. <p> We know that T 1 contains at least 1 (and at most d) bad edges. Moreover, assume that these bad edges form t connected components B 1 ; : : : ; B t (1 t d). As observed in <ref> [16] </ref>, for an optimal nni transformation, sometimes one or more nni operations are needed across a good internal edge of T 1 . Consider the set of at most d 1 good edges in T 1 across which at least one nni operation is performed in an optimal nni sequence. <p> For each tree A i , the number of sequences of k i nni operations to consider is at most 3 k i 1 2 4k i &lt; 2 6k i by Lemma 1 of <ref> [16] </ref>. Combining everything, the number of trees we have to examine is at most 2 5d=2 2 3d 2 6d &lt; 2 23d=2 .
Reference: [17] <author> G. W. Moore, M. Goodman and J. Barnabas, </author> <title> An iterative approach from the standpoint of the additive hypothesis to the dendrogram problem posed by molecular data sets, </title> <journal> Journal of Theoretical Biology 38(1973), </journal> <pages> 423-457. </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [17, 18, 24] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to B $ C or B $ D. operate or perform on this internal edge.
Reference: [18] <author> D. F. Robinson, </author> <title> Comparison of labeled trees with valency three, </title> <journal> Journal of Combinatorial Theory, Series B, </journal> <volume> 11(1971), </volume> <pages> 105-119. </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [17, 18, 24] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to B $ C or B $ D. operate or perform on this internal edge.
Reference: [19] <author> N. Saitou and M. Nei, </author> <title> The neighbor-joining method: a new method for reconstructing phylogenetic trees, Mol. </title> <journal> Biol. Evol., </journal> <volume> 4(1987), </volume> <pages> 406-425. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [4, 7, 20], compatibility [15], distance <ref> [8, 19] </ref>, and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [20] <author> D. Sankoff, </author> <title> Minimal mutation trees of sequences, </title> <journal> SIAM J. Appl. Math., </journal> <pages> 28(1975) 35-42. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [4, 7, 20] </ref>, compatibility [15], distance [8, 19], and maximum likelihood [4, 5, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [14].
Reference: [21] <author> D. Sleator, R. Tarjan, W. Thurston, </author> <title> Rotation distance, triangulations, and hyperbolic geometry, </title> <journal> J. Amer. Math. Soc., </journal> <volume> 1(1988), </volume> <pages> 647-681. </pages>
Reference: [22] <author> D. Sleator, R. Tarjan, W. Thurston, </author> <title> Short encodings of evolving structures, </title> <journal> SIAM J. Discr. Math., </journal> <volume> 5(1992), </volume> <pages> 428-450. </pages>
Reference-contexts: An n O (d) algorithm for this problem is trivial. With careful inspection, one can derive an algorithm that runs in O (n O (1) d O (d 2 ) ) time. It turns out that by using the results in <ref> [22, 16] </ref>, we could improve this asymptotically to O (n 2 log n + n 2 23d=2 ) time. Definition 1 Let T 1 and T 2 be the two trees being compared.
Reference: [23] <author> Arndt von Haseler and Gary A. Churchill, </author> <title> Network models for sequence evolution, </title> <journal> J. Mol. Evol., </journal> <volume> 37(1993), </volume> <pages> 77-85. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model <ref> [23] </ref> and a model using a list of phylogenetic trees [10, 11]. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another.
Reference: [24] <author> M. S. Waterman and T. F. Smith, </author> <title> On the similarity of dendrograms, </title> <journal> Journal of Theoretical Biology, </journal> <volume> 73(1978), </volume> <pages> 789-800. </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [17, 18, 24] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to B $ C or B $ D. operate or perform on this internal edge.
References-found: 24

