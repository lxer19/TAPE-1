URL: http://www.cs.caltech.edu/~arvo/papers/SphTri.ps
Refering-URL: http://www.cs.caltech.edu/~arvo/papers.html
Root-URL: http://www.cs.caltech.edu
Title: Stratified Sampling of Spherical Triangles  
Author: James Arvo 
Keyword: CR Categories and Subject Descriptors: I.3.5 [Computational Geometry and Object Modeling]: Geometric Algorithms. Additional Key Words and Phrases: Monte Carlo, solid angle, spherical triangle, stratified sampling.  
Affiliation: Program of Computer Graphics Cornell University  
Abstract: We present an algorithm for generating uniformly distributed random samples from arbitrary spherical triangles. The algorithm is based on a transformation of the unit square and easily accommodates stratified sampling, an effective means of reducing variance. With the new algorithm it is straightforward to perform stratified sampling of the solid angle subtended by an arbitrary polygon; this is a fundamental operation in image synthesis which has not been addressed in the Monte Carlo literature. We derive the required transformation using elementary spherical trigonometry and provide the complete sampling algorithm. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Berger, M. </author> <title> Geometry, Volume II. </title> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1987. </year> <title> Translated by M. </title> <editor> Cole and S. </editor> <publisher> Levy. </publisher>
Reference-contexts: Let a, b, and c denote the edge lengths of T, and let ff, fi, and fl denote the three internal angles, which are the dihedral angles between the planes containing the edges. See Figure 1a. To generate uniformly distributed samples over T we seek a bi-jection f : <ref> [0; 1] </ref> 2 ! T with the following property: given any two subsets S 1 and S 2 of the unit square with equal areas, f (S 1 ) and f (S 2 ) will also have equal areas. <p> to sampling spherical triangles we require the following three identities: A = ff + fi + fl (1) cos fl = cos fi cos ff + sin fi sin ff cos c (3) The first is known as Girard's formula and the other two are spherical cosine laws for angles <ref> [1] </ref>. 2 The Sampling Algorithm The algorithm proceeds in two stages. In the first stage we randomly select a sub-triangle b T T whose area b A is uniformly distributed between 0 and the original area A. <p> Given two random variables ~ 1 and ~ 2 uniformly distributed in <ref> [0; 1] </ref>, we first find b b such that F 1 ( b b ) = ~ 1 , and then find such that F 2 ( j b b ) = ~ 2 . <p> P z fl B + 1 z 2 fl [ b C j B ]; return P; end If ~ 1 and ~ 2 are independent random variables uniformly distributed in <ref> [0; 1] </ref>, as produced by most pseudo-random number generators, then P will be uniformly distributed in triangle T.
Reference: [2] <author> Cook, R. L. </author> <title> Stochastic sampling in computer graphics. </title> <journal> ACM Transactions on Graphics 5, </journal> <volume> 1 (1986), </volume> <pages> 51-72. </pages>
Reference-contexts: The pattern on the right was generated by partitioning the unit square into a regular grid and choosing one pair (~ 1 ; ~ 2 ) uniformly from each grid cell, which corresponds to stratified or jittered sampling <ref> [2] </ref>. The advantage of stratified sampling is evident in the resulting pattern; the samples are more evenly distributed, which generally reduces the variance of Monte Carlo estimates based on these samples. right were generated from stratified points in the unit square.
Reference: [3] <author> Hanrahan, P., Salzman, D., and Aupperle, L. </author> <title> A rapid hierarchical radiosity algorithm. </title> <booktitle> Computer Graphics 25, </booktitle> <month> 4 (July </month> <year> 1991), </year> <pages> 197-206. </pages>
Reference-contexts: 1 Introduction Monte Carlo integration is used throughout computer graphics; examples include estimating form factors, visibility, and irradiance from complex or partially occluded luminaires <ref> [3, 5] </ref>. While many specialized sampling algorithms exist for various geometries, relatively few methods exist for sampling solid angles; that is, for regions on the unit sphere. The most common example that arises in computer graphics is the solid angle subtended by a polygon.
Reference: [4] <author> Rubinstein, R. Y. </author> <title> Simulation and the Monte Carlo Method. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1981. </year>
Reference-contexts: The function f can be derived using standard Monte Carlo methods for sampling bivariate functions; for example, see Spanier and fl 580 Engineering and Theory Center Building, Ithaca, New York 14853, http://www.graphics.cornell.edu Gelbard [6] or Rubinstein <ref> [4] </ref>.
Reference: [5] <author> Shirley, P., Wang, C., and Zimmerman, K. </author> <title> Monte carlo methods for direct lighting calculations. </title> <journal> ACM Transactions on Graphics (1995). </journal> <note> To appear. </note>
Reference-contexts: 1 Introduction Monte Carlo integration is used throughout computer graphics; examples include estimating form factors, visibility, and irradiance from complex or partially occluded luminaires <ref> [3, 5] </ref>. While many specialized sampling algorithms exist for various geometries, relatively few methods exist for sampling solid angles; that is, for regions on the unit sphere. The most common example that arises in computer graphics is the solid angle subtended by a polygon.
Reference: [6] <author> Spanier, J., and Gelbard, E. M. </author> <title> Monte Carlo Principles and Neutron Transport Problems. </title> <publisher> Addison-Wesley, </publisher> <address> Reading, Mas-sachusetts, </address> <year> 1969. </year>
Reference-contexts: The function f can be derived using standard Monte Carlo methods for sampling bivariate functions; for example, see Spanier and fl 580 Engineering and Theory Center Building, Ithaca, New York 14853, http://www.graphics.cornell.edu Gelbard <ref> [6] </ref> or Rubinstein [4].
Reference: [7] <author> Turk, G. </author> <title> Generating random points in triangles. In Graphics Gems, </title> <editor> A. S. Glassner, Ed. </editor> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1990, </year> <pages> pp. 24-28. </pages>
Reference-contexts: The sampling algorithm can be applied to spherical poly gons by decomposing them into triangles and performing stratified sampling on each component independently, which is analogous to the method for planar polygons <ref> [7] </ref>. This provides an effective means of sampling the solid angle sub-tended by a polygon. Acknowledgments Many thanks to Pete Shirley for his valuable suggestions and for urging the author to write this paper.
References-found: 7

