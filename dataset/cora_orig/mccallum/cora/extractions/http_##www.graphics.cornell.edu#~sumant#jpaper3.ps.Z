URL: http://www.graphics.cornell.edu/~sumant/jpaper3.ps.Z
Refering-URL: http://www.graphics.cornell.edu/~sumant/cv.html
Root-URL: 
Title: Adjoint Equations and Random Walks for Illumination Computation  
Author: S.N.Pattanaik and S.P.Mudur 
Address: Juhu, Bombay 400 049, INDIA  
Affiliation: Graphics CAD Division, National Centre for Software Technology,  
Abstract: In this paper we introduce the potential equation which along with the rendering equation forms an adjoint system of equations and provides the mathematical framework for all known approaches to illumination computation. The potential equation is more natural for illumination computations which simulate light propagation starting from the light sources, such as, progressive radiosity and particle tracing. Using the mathematical handles provided by the adjoint system of equations and the random walk model, we present a number of biasing schemes for improving the computation of flux estimation. Of particular significance is the scheme to use an approximate potential value as the biasing function for directing a majority of the random walks through regions of importance in the environment thus reducing the variance in the estimates of flux in these regions. Finally results from a simple implementation of this scheme is presented.
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Turner Whitted. </author> <title> An improved illumination model for shaded display. </title> <journal> Communications of the ACM, </journal> <volume> 23(6) </volume> <pages> 343-349, </pages> <year> 1980. </year>
Reference-contexts: 1 Introduction There are basically two approaches used for the computation of global illumination. In one the luminous flux reaching a surface or eye point is estimated by sampling its surroundings. Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods <ref> [1, 2, 3, 4] </ref> based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing [5, 6, 7] are representative methods.
Reference: [2] <author> R. L. Cook, Thomas Porter, and Loren Carpenter. </author> <title> Distributed ray tracing. </title> <booktitle> Computer Graphics (SIGGRAPH '84 Proceedings), </booktitle> <volume> 18(3) </volume> <pages> 137-145, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: 1 Introduction There are basically two approaches used for the computation of global illumination. In one the luminous flux reaching a surface or eye point is estimated by sampling its surroundings. Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods <ref> [1, 2, 3, 4] </ref> based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing [5, 6, 7] are representative methods.
Reference: [3] <author> James T. Kajiya. </author> <title> The rendering equation. </title> <booktitle> Computer Graphics (SIGGRAPH '86 Proceedings), </booktitle> <volume> 20(4) </volume> <pages> 143-150, </pages> <month> Aug. </month> <year> 1986. </year>
Reference-contexts: 1 Introduction There are basically two approaches used for the computation of global illumination. In one the luminous flux reaching a surface or eye point is estimated by sampling its surroundings. Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods <ref> [1, 2, 3, 4] </ref> based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing [5, 6, 7] are representative methods. <p> The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing [5, 6, 7] are representative methods. So far Kajiya's rendering equation <ref> [3] </ref> has provided the mathematical basis for these computations. The essence of the rendering equation is the balancing of point to point light transport through the use of a Transport Intensity function which is closely related to the Luminance function. <p> While illumination computation methods for computing the flux reaching the surface or the eye are primarily based on the rendering equation, we believe that the potential equation is more natural for describing methods which simulate light propagation starting from the light sources. Just as Kajiya has shown <ref> [3] </ref> full radiosity to be an approximate analytical solution of the rendering equation, analogously we have 1 also shown progressive radiosity [5] to be an approximate analytical solution of the potential equation. <p> understanding, Kajiya introduced the concept of two point transport intensity, I (x; x 0 ), which is the luminous flux density coming from a differential area dx 0 around x 0 and received by the differential area dx around x and reformulated equation 1 as the rendering equation shown below: <ref> [3] </ref> I (x; x 0 ) = v (x; x 0 ) *(x; x 0 ) + A where the integration range is defined as all the surfaces (A) in the environment. In this equation all the illumination terms are from one point to another point of the environment. <p> The next event estimation in the path tracing would mean computing the local model at the points of ray-hit. Though not explicitly mentioned we believe that Kajiya used this estimator in path tracing as he writes in <ref> [3, page 146] </ref> "Calculating emitted . . . factors is simply a matter of consulting the . . . light models".
Reference: [4] <author> Cindy M. Goral, Kenneth E. Torrance, Donald P. Greenberg, and Bennett Battaile. </author> <title> Modelling the interaction of light between diffuse surfaces. </title> <booktitle> Computer Graphics (SIG-GRAPH '84 Proceedings), </booktitle> <volume> 18(3) </volume> <pages> 212-222, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: 1 Introduction There are basically two approaches used for the computation of global illumination. In one the luminous flux reaching a surface or eye point is estimated by sampling its surroundings. Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods <ref> [1, 2, 3, 4] </ref> based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing [5, 6, 7] are representative methods. <p> It may be recalled that F ij is similar to the formfactor used in the radiosity computation <ref> [4] </ref> with the only difference that the summation of this factor over all the patches, i.e. P N j=1 F ij , is equal to . <p> x N X Z Z L (x; fi x )g k (x; fi x )cos x d! x dx N X L i g k;i A i x N X L i g k;i A i = L k A k 1 These assumptions are typical of radiosity based solutions <ref> [4] </ref>. 7 = A k @ * k + k j=1 1 N X L j F kj N X j F kj (6) where E k is the total emission flux leaving the k-th patch. We can see that this equation forms the basis of well established radiosity method [4]. <p> <ref> [4] </ref>. 7 = A k @ * k + k j=1 1 N X L j F kj N X j F kj (6) where E k is the total emission flux leaving the k-th patch. We can see that this equation forms the basis of well established radiosity method [4]. To derive the analytical approximation of x using the potential function we introduce a hemispherical potential function over any point of patch i, W k , as the average potential of the surface points in any hemispherical direction.
Reference: [5] <author> Michael Cohen, Shenchang Eric Chen, John R. Wallace, and Donald P. Greenberg. </author> <title> A progressive refinement approach to fast radiosity image generation. </title> <booktitle> Computer Graphics (SIGGRAPH '88 Proceedings), </booktitle> <volume> 22(4) </volume> <pages> 75-84, </pages> <month> Aug. </month> <year> 1988. </year>
Reference-contexts: Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods [1, 2, 3, 4] based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing <ref> [5, 6, 7] </ref> are representative methods. So far Kajiya's rendering equation [3] has provided the mathematical basis for these computations. <p> Just as Kajiya has shown [3] full radiosity to be an approximate analytical solution of the rendering equation, analogously we have 1 also shown progressive radiosity <ref> [5] </ref> to be an approximate analytical solution of the potential equation. The particle tracing [7] (or light ray tracing method [6]) mathematically speaking is in fact a random walk based solution of the potential equation. <p> And this is how the computation proceeds in the progressive refinement approach for the radiosity computation <ref> [5] </ref>.
Reference: [6] <author> Peter Shirley. </author> <title> Physically Based Lighting Calculations for Computer Graphics. </title> <type> PhD thesis, </type> <year> 1990. </year>
Reference-contexts: Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods [1, 2, 3, 4] based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing <ref> [5, 6, 7] </ref> are representative methods. So far Kajiya's rendering equation [3] has provided the mathematical basis for these computations. <p> Just as Kajiya has shown [3] full radiosity to be an approximate analytical solution of the rendering equation, analogously we have 1 also shown progressive radiosity [5] to be an approximate analytical solution of the potential equation. The particle tracing [7] (or light ray tracing method <ref> [6] </ref>) mathematically speaking is in fact a random walk based solution of the potential equation. Similarly the biasing scheme of absorption suppression [8, 7] found useful in particle tracing automatically falls within the mathematical framework of the random walk.
Reference: [7] <author> S. N. Pattanaik and S. P. Mudur. </author> <title> Computation of global illumination by monte carlo simulation of the particle model of light. </title> <booktitle> In Proceedings of the Third Eurographics Workshop on Rendering, </booktitle> <pages> pages 71-83, </pages> <address> Bristol, UK, </address> <month> May </month> <year> 1992. </year>
Reference-contexts: Ray tracing, path tracing and full matrix radiosity solution are extensively researched methods [1, 2, 3, 4] based on this approach. The other approach is based on simulating the propagation of light starting from the light sources of which progressive radiosity and particle tracing <ref> [5, 6, 7] </ref> are representative methods. So far Kajiya's rendering equation [3] has provided the mathematical basis for these computations. <p> Just as Kajiya has shown [3] full radiosity to be an approximate analytical solution of the rendering equation, analogously we have 1 also shown progressive radiosity [5] to be an approximate analytical solution of the potential equation. The particle tracing <ref> [7] </ref> (or light ray tracing method [6]) mathematically speaking is in fact a random walk based solution of the potential equation. Similarly the biasing scheme of absorption suppression [8, 7] found useful in particle tracing automatically falls within the mathematical framework of the random walk. <p> The particle tracing [7] (or light ray tracing method [6]) mathematically speaking is in fact a random walk based solution of the potential equation. Similarly the biasing scheme of absorption suppression <ref> [8, 7] </ref> found useful in particle tracing automatically falls within the mathematical framework of the random walk. In this paper we introduce the notion of the potential function intuitively with the help of a simple hypothetical experiment placing light detectors in an environment and then proceed with its mathematical formulation. <p> ) + k=1 # = E fi n i=1 k=0 This method of evaluating k by first sampling the source function is the essence of the particle tracing or light ray tracing. 10 Of the two solution methods, particle tracing is highly intuitive as it resembles the physical illumination process <ref> [7] </ref>. <p> There have been a number of efforts to combine these approaches and thus derive benefits of both. These have typically come to be known as two pass methods or more generally multi pass methods <ref> [12, 13, 14, 7] </ref>. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. <p> In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing <ref> [7] </ref> is used in the first pass to estimate the flux over diffuse surfaces. Chen et al [14] have an additional pass in which rays are traced from the light sources through non-diffuse surfaces to estimate caustics. <p> In practice the walk is terminated when the product term in the above equations falls below some minimum threshold. However this termination process introduces a bias into the estimation. Unbiased termination technique like Russian Roulette may be used to overcome this <ref> [8, 7] </ref>. 5.2.2 Source Biasing In the particle tracing process, emission function, S (x; fi x ), plays an important role as every random walk originates at the light source.
Reference: [8] <author> James Arvo and David Kirk. </author> <title> Particle transport and image synthesis. </title> <booktitle> Computer Graphics (SIGGRAPH '90 Proceedings), </booktitle> <volume> 24(4) </volume> <pages> 63-66, </pages> <month> Aug. </month> <year> 1990. </year>
Reference-contexts: The particle tracing [7] (or light ray tracing method [6]) mathematically speaking is in fact a random walk based solution of the potential equation. Similarly the biasing scheme of absorption suppression <ref> [8, 7] </ref> found useful in particle tracing automatically falls within the mathematical framework of the random walk. In this paper we introduce the notion of the potential function intuitively with the help of a simple hypothetical experiment placing light detectors in an environment and then proceed with its mathematical formulation. <p> In practice the walk is terminated when the product term in the above equations falls below some minimum threshold. However this termination process introduces a bias into the estimation. Unbiased termination technique like Russian Roulette may be used to overcome this <ref> [8, 7] </ref>. 5.2.2 Source Biasing In the particle tracing process, emission function, S (x; fi x ), plays an important role as every random walk originates at the light source.
Reference: [9] <author> Robert Siegel and John R. Howell. </author> <title> Thermal Radiation Heat Transfer. </title> <publisher> Hemisphere Publishing Corporation, </publisher> <year> 1981. </year>
Reference-contexts: We have preferred to use its original form with integration over a hemisphere mainly to retain its similarity with the potential equation which we are introducing immediately after this. From the definition of surface bidirectional reflectance function <ref> [9, page 64] </ref>, the outgoing luminance (L) at any point x of a surface in the environment in any direction fi out , due to the luminance incident at x from direction fi in can be given by L out (x; fi out ) = x (fi out ; fi in
Reference: [10] <author> Malvin H. Kalos and Paula A. Whitlock. </author> <title> Monte Carlo Methods. Volume I. </title> <publisher> John Wiley & Sons, </publisher> <year> 1986. </year>
Reference-contexts: It is by now well known that solution of multidimensional integrations are best carried out by Monte Carlo quadrature techniques. The main principle behind a Monte Carlo quadrature technique for computing the integral R F (x)dx is as follows <ref> [10] </ref>: 1. Write F (x) as a product f 1 (x)f 2 (x) such that R 2. Sample f 1 for a x i . 3. For each such sample x i evaluate f 2 (x i ). 4. Carry out the steps (2) and (3) for some n times.
Reference: [11] <author> Reuven Y. Rubinstein. </author> <title> Simulation and the Monte Carlo Method. </title> <publisher> John Wiley & Sons, </publisher> <year> 1981. </year>
Reference-contexts: For each such sample the next task will be to evaluate W k and L. As said earlier the L and W k are integral equations of the second kind. Random walk, a versatile mathematical method, is known to be useful in solving such integral equations <ref> [11] </ref>. We shall discuss below in detail its use for the evaluation of luminance (L) and potential (W k ) values. A random walk or a Markov chain is basically a sequence of states.
Reference: [12] <author> John R. Wallace, Michael F. Cohen, and Donald P. Greenberg. </author> <title> A two-pass solution to the rendering equation: A synthesis of ray tracing and radiosity methods. </title> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> 21(4) </volume> <pages> 311-320, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: There have been a number of efforts to combine these approaches and thus derive benefits of both. These have typically come to be known as two pass methods or more generally multi pass methods <ref> [12, 13, 14, 7] </ref>. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces.
Reference: [13] <author> Francois Sillion and Claude Puech. </author> <title> A general two-pass method integrating specular and diffuse reflection. </title> <booktitle> Computer Graphics (SIGGRAPH '89 Proceedings), </booktitle> <volume> 23(3) </volume> <pages> 335-344, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: There have been a number of efforts to combine these approaches and thus derive benefits of both. These have typically come to be known as two pass methods or more generally multi pass methods <ref> [12, 13, 14, 7] </ref>. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. <p> These have typically come to be known as two pass methods or more generally multi pass methods [12, 13, 14, 7]. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity <ref> [13, 14] </ref> or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. Chen et al [14] have an additional pass in which rays are traced from the light sources through non-diffuse surfaces to estimate caustics.
Reference: [14] <author> Shenchang Eric Chen, Holly E. Rushmeier, Gavin Miller, and Douglass Turner. </author> <title> A progressive multi-pass method for global illumination. </title> <booktitle> Computer Graphics (SIGGRAPH '91 Proceedings), </booktitle> <volume> 25(4) </volume> <pages> 164-174, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: There have been a number of efforts to combine these approaches and thus derive benefits of both. These have typically come to be known as two pass methods or more generally multi pass methods <ref> [12, 13, 14, 7] </ref>. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. <p> These have typically come to be known as two pass methods or more generally multi pass methods [12, 13, 14, 7]. In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity <ref> [13, 14] </ref> or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. Chen et al [14] have an additional pass in which rays are traced from the light sources through non-diffuse surfaces to estimate caustics. <p> In the initial passes simulation proceeds starting from the light sources and estimates are obtained for the flux in different subregions. For example, radiosity [13, 14] or particle tracing [7] is used in the first pass to estimate the flux over diffuse surfaces. Chen et al <ref> [14] </ref> have an additional pass in which rays are traced from the light sources through non-diffuse surfaces to estimate caustics. In the case of multiple initial passes, care is taken to ensure that the flux computations are non-intrusive. <p> We also would like to point out that Chen et al <ref> [14, page 167] </ref> used a variant of the next event estimation principle in computing the final luminance I (x; fi x ) by computing I l;s (x; fi x ), a part of I (x; fi x ), by Monte Carlo sampling only the source contribution at x. 5.2 Biasing All
Reference: [15] <author> R. R. Coveyou, V. R. Cain, and K. J. Yost. </author> <title> Adjoint and importance in monte carlo application. </title> <journal> Nuclear Science and Engineering, </journal> <volume> 27 </volume> <pages> 219-234, </pages> <year> 1967. </year> <month> 20 </month>
Reference-contexts: So an ideal strategy would be either to transform the basic underlying random walk process or to change the estimator or to do both such that each random walk almost always contributes towards any subregion of our interest. 5.1 Next Event Estimation This technique <ref> [15] </ref> leaves the stochastic process under study unaltered but modifies the form of the estimator. <p> Our observation is that often it is possible to derive an approximate potential function W imp (x; fi x ) with respect to such region of interest. This approximate function or one which can be easily derived from this will be termed importance function <ref> [15] </ref>, Imp (x; fi x ).
References-found: 15

