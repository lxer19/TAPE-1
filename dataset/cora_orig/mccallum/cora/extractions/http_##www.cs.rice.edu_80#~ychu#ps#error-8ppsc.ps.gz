URL: http://www.cs.rice.edu:80/~ychu/ps/error-8ppsc.ps.gz
Refering-URL: http://www.cs.rice.edu:80/~ychu/papers.html
Root-URL: 
Title: On the Accuracy of Anderson's Fast N-body Algorithm  
Author: Yu Charlie Hu S. Lennart Johnsson 
Date: March 1997.  
Address: Minneapolis, MN,  
Affiliation: Computing,  
Note: 8th SIAM Conference on Parallel Processing for Scientific  
Abstract: We present an empirical study of the accuracy-cost tradeoffs of Anderson's method. The various parameters that control the degree of approximation of the computational elements and the separateness of interacting computational elements govern both the arithmetic complexity and the accuracy of the method. Our experiment shows that for a given error requirement, using a near-field containing only nearest neighbor boxes and a hierarchy depth that minimizes the number of arithmetic operations minimizes the total number of arithmetic operations.
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> C. R. Anderson. </author> <title> An implementation of the fast multipole method without multipoles. </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 13(4) </volume> <pages> 923-947, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: 1 Introduction Although O (N ) N -body methods <ref> [1, 4, 5, 13, 14] </ref> are superior to the direct O (N 2 ) methods in terms of arithmetic complexity for large scale simulations, their complex computational structures relative to the direct method and consequent difficulty in achieving efficient computer implementations have so far hindered them from gaining wide acceptance in <p> Degree of approximation The degree of approximation of the aggregated effects of clusters of particles represented by computational elements determines the error decay rate. Greengard and Rokhlin [5, 4], and Zhao [14] give error bounds on truncated multipole expansions used to represent computational elements. Similarly, Anderson <ref> [1] </ref> provides some insights into the error characteristics of his method, but no rigorous tight bounds. Clearly, the degree of approximation directly affects the arithmetic complexity of translating the computational elements, and therefore that of the complete methods. <p> The issue of how to choose the parameters in order to minimize the running time for a prescribed accuracy remains unresolved. 2 Anderson's method In Anderson's method <ref> [1] </ref>, Poisson's formula is used for representing solutions of the underlying Laplace equation. Given a numerical integration formula, the discretized integration becomes a summation of expansions with Legendre functions as the base functions and relies only on the potential values at the integration points. <p> The error decay rate of Anderson's method is determined by the integration order of the sphere approximations, which in turn determines the choices of other parameters associated with the integration. Table 3 <ref> [1] </ref> lists the relationship among the parameters and the expected error decay rate of Anderson's method. The fact that translations in Anderson's method are evaluations of sphere approximations leads to a different way of using supernodes. <p> of Expected error Measured average error integration D integration points K decay rate decay rate 5 12 4 3.95 9 32 6 8.85 14 72 9 8.90 the radius of the sphere containing the particles and r is the distance of the evaluation point from the center of the sphere <ref> [1] </ref>. Therefore, it is desirable to perform the conversion from a small sphere to a large sphere.
Reference: [2] <author> A. Brandt. </author> <title> Multilevel computations: Review and recent developments. </title> <editor> In S. McCormick, editor, </editor> <booktitle> Proc. 3rd Copper Mountain Conference on Multigrid Method, </booktitle> <month> April </month> <year> 1987. </year>
Reference-contexts: One other important reason for the slow acceptance of the O (N ) methods by the application community is the limited understanding of the error behavior of these methods on large-scale simulations, especially of the accuracy-cost tradeoffs. Like the Multi-grid methods <ref> [2] </ref>, the multipole-based N -body methods and their variations are approximation methods. For these methods, higher accuracy can be achieved at increased computational effort. Though the computational time is directly proportional to the number of particles, the constant of proportionality depends upon the desired accuracy.
Reference: [3] <author> K. Esselink. </author> <title> A comparison of algorithms for long range interactions. </title> <type> Technical Report 500.90.200GRA204-IN73916 AMER.94.006, </type> <address> Koninklijke/Shell-Lab, Amsterdam, </address> <month> August </month> <year> 1994. </year>
Reference-contexts: depth Greengard-Rokhlin [5] GR 2 No blog N 8 c Zhao [14] Zhao 2 Yes blog N 8 c Schmidt-Lee [11] GR 1 No 3,4,5 Shimada et al. [12] GR 1,2 No log N 8 Leathrum [10] GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink <ref> [3] </ref> GR 2 Yes 2,3,4 The scheme is developed and verified for uniform distributions of particles. The impact on the error of non-uniform particle distributions is studied through some model distributions.
Reference: [4] <author> L. Greengard and W. D. Gropp. </author> <title> A parallel version of the fast multipole method. </title> <booktitle> In Parallel Processing for Scientific Computing, </booktitle> <pages> pages 213-222. </pages> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1989. </year>
Reference-contexts: 1 Introduction Although O (N ) N -body methods <ref> [1, 4, 5, 13, 14] </ref> are superior to the direct O (N 2 ) methods in terms of arithmetic complexity for large scale simulations, their complex computational structures relative to the direct method and consequent difficulty in achieving efficient computer implementations have so far hindered them from gaining wide acceptance in <p> The choice of these parameters affect the arithmetic complexity of the methods directly or indirectly. Degree of approximation The degree of approximation of the aggregated effects of clusters of particles represented by computational elements determines the error decay rate. Greengard and Rokhlin <ref> [5, 4] </ref>, and Zhao [14] give error bounds on truncated multipole expansions used to represent computational elements. Similarly, Anderson [1] provides some insights into the error characteristics of his method, but no rigorous tight bounds. <p> For a fixed degree of separation of the near-field, varying the hierarchy depth changes the proportion of particles in the near-field and in the far-field, and therefore may affect the error of the complete method. The error bounds given in <ref> [5, 4, 14] </ref> for multipole-based methods apply to individual computational elements. The error for the complete methods remain to be verified.
Reference: [5] <author> L. F. Greengard. </author> <title> The rapid evaluation of potential fields in particle systems. </title> <publisher> MIT Press, </publisher> <year> 1988. </year>
Reference-contexts: 1 Introduction Although O (N ) N -body methods <ref> [1, 4, 5, 13, 14] </ref> are superior to the direct O (N 2 ) methods in terms of arithmetic complexity for large scale simulations, their complex computational structures relative to the direct method and consequent difficulty in achieving efficient computer implementations have so far hindered them from gaining wide acceptance in <p> The choice of these parameters affect the arithmetic complexity of the methods directly or indirectly. Degree of approximation The degree of approximation of the aggregated effects of clusters of particles represented by computational elements determines the error decay rate. Greengard and Rokhlin <ref> [5, 4] </ref>, and Zhao [14] give error bounds on truncated multipole expansions used to represent computational elements. Similarly, Anderson [1] provides some insights into the error characteristics of his method, but no rigorous tight bounds. <p> For a fixed degree of separation of the near-field, varying the hierarchy depth changes the proportion of particles in the near-field and in the far-field, and therefore may affect the error of the complete method. The error bounds given in <ref> [5, 4, 14] </ref> for multipole-based methods apply to individual computational elements. The error for the complete methods remain to be verified. <p> Author Method Degree of separation Use of supernodes Hierarchy depth Greengard-Rokhlin <ref> [5] </ref> GR 2 No blog N 8 c Zhao [14] Zhao 2 Yes blog N 8 c Schmidt-Lee [11] GR 1 No 3,4,5 Shimada et al. [12] GR 1,2 No log N 8 Leathrum [10] GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink [3] GR 2
Reference: [6] <author> L. F. Greengard and V. Rokhlin. </author> <title> On the efficient implementation of the fast multipole algorithm. </title> <type> Technical Report YALEU/DCS/RR-602, </type> <institution> Yale Univ., </institution> <month> February </month> <year> 1988. </year>
Reference-contexts: (p) 8 h ) Downward pass O ((N int f (p) + f (p)) 8 h ) Far-field O (g (p) N) Near-field O (N near N 2 =8 h ) Minimized total O ((g (p) + p N near N int f (p)) N ) The use of supernodes <ref> [14, 6] </ref> reduces the effective value of the number of computational elements, "boxes", in the interactive-field. This field is defined as the part of the far-field that is in the parent box's near-field.
Reference: [7] <author> Y. Hu and S. L. Johnsson. </author> <title> A data parallel implementation of hierarchical N -body methods. </title> <journal> Intl. J. of Supercomput. Appl. and High Perf. Comput., </journal> <volume> 10(1):3 - 40, </volume> <year> 1996. </year> <title> [8] ||-. On the accuracy of Anderson's fast N -body algorithm. </title> <type> Technical Report TR-06-96, </type> <institution> Harvard University, Division of Applied Sciences, </institution> <month> January </month> <year> 1996. </year>
Reference-contexts: Fig. 4. Running time vs. accuracy, 1M particles with optimal hierarchy depths on a 256 node CM-5E. 3 Experiments The empirical evaluations in this paper are performed on the CM-5E using our data-parallel implementation of the nonadaptive Anderson's method <ref> [7] </ref>. The accuracy is measured against an implementation of the direct O (N 2 ) method on the CM-5E. Both codes perform floating-point operations in 64-bit precision. All the simulation results presented are collected on a 32-node CM-5E, unless otherwise specified. <p> For our implementation of Anderson's method on the CM-5/5E, the FLOP count gives quite accurate predictions of the relative running times. First, the optimal hierarchy depth balances the two computation-dominant stages the downward pass and the direct evaluation in the near-field (see Table 1.) As reported in <ref> [7] </ref>, for problems with reasonably large sizes relative to the machine size, the two time-dominant stages achieve similar efficiency, and therefore the FLOP count predicts the optimal hierarchy depth well for each method.
Reference: [9] <author> J. Katzenelson. </author> <title> Computational structure of the N-body problem. </title> <journal> SIAM J. Sci. Statist. Comput., </journal> <volume> 10(4) </volume> <pages> 787-815, </pages> <year> 1989. </year>
Reference-contexts: For N uniformly distributed particles and a hierarchy of depth h having 8 h leaf-level boxes, the number of floating-point operations (FLOPs) required for the five stages of the generic hierarchical method as described by Katzenelson <ref> [9] </ref> is listed in Table 1. The optimal hierarchy depth minimizes the total number of FLOPs. Round-off error Finite machine precision leads to round-off error.
Reference: [10] <author> J. F. Leathrum. </author> <title> The parallel fast multipole method in three dimensions. </title> <type> PhD thesis, </type> <institution> Duke University, </institution> <year> 1992. </year>
Reference-contexts: Author Method Degree of separation Use of supernodes Hierarchy depth Greengard-Rokhlin [5] GR 2 No blog N 8 c Zhao [14] Zhao 2 Yes blog N 8 c Schmidt-Lee [11] GR 1 No 3,4,5 Shimada et al. [12] GR 1,2 No log N 8 Leathrum <ref> [10] </ref> GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink [3] GR 2 Yes 2,3,4 The scheme is developed and verified for uniform distributions of particles. The impact on the error of non-uniform particle distributions is studied through some model distributions.
Reference: [11] <author> K. E. Schmidt and M. A. Lee. </author> <title> Implementing the fast multipole method in three dimensions. </title> <journal> J. Stat. Phy., </journal> <volume> 63(5/6), </volume> <year> 1991. </year>
Reference-contexts: Author Method Degree of separation Use of supernodes Hierarchy depth Greengard-Rokhlin [5] GR 2 No blog N 8 c Zhao [14] Zhao 2 Yes blog N 8 c Schmidt-Lee <ref> [11] </ref> GR 1 No 3,4,5 Shimada et al. [12] GR 1,2 No log N 8 Leathrum [10] GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink [3] GR 2 Yes 2,3,4 The scheme is developed and verified for uniform distributions of particles.
Reference: [12] <author> J. Shimada, H. Kaneko, and T. Takada. </author> <title> Performance of fast multipole methods for calculating electrostatic interactions in biomacromolecular simulations. </title> <journal> J. Comp. Chem., </journal> <volume> 15(1), </volume> <year> 1994. </year>
Reference-contexts: Author Method Degree of separation Use of supernodes Hierarchy depth Greengard-Rokhlin [5] GR 2 No blog N 8 c Zhao [14] Zhao 2 Yes blog N 8 c Schmidt-Lee [11] GR 1 No 3,4,5 Shimada et al. <ref> [12] </ref> GR 1,2 No log N 8 Leathrum [10] GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink [3] GR 2 Yes 2,3,4 The scheme is developed and verified for uniform distributions of particles.
Reference: [13] <author> M. S. Warren and J. K. Salmon. </author> <title> A portable parallel particle program. </title> <journal> Computer Physics Communications, </journal> <volume> 87, </volume> <year> 1995. </year>
Reference-contexts: 1 Introduction Although O (N ) N -body methods <ref> [1, 4, 5, 13, 14] </ref> are superior to the direct O (N 2 ) methods in terms of arithmetic complexity for large scale simulations, their complex computational structures relative to the direct method and consequent difficulty in achieving efficient computer implementations have so far hindered them from gaining wide acceptance in
Reference: [14] <author> F. Zhao. </author> <title> An O(N ) algorithm for 3-dimensional N-body simulations. </title> <type> Technical Report AI-TR-995, </type> <institution> AI Lab, MIT, </institution> <year> 1987. </year>
Reference-contexts: 1 Introduction Although O (N ) N -body methods <ref> [1, 4, 5, 13, 14] </ref> are superior to the direct O (N 2 ) methods in terms of arithmetic complexity for large scale simulations, their complex computational structures relative to the direct method and consequent difficulty in achieving efficient computer implementations have so far hindered them from gaining wide acceptance in <p> The choice of these parameters affect the arithmetic complexity of the methods directly or indirectly. Degree of approximation The degree of approximation of the aggregated effects of clusters of particles represented by computational elements determines the error decay rate. Greengard and Rokhlin [5, 4], and Zhao <ref> [14] </ref> give error bounds on truncated multipole expansions used to represent computational elements. Similarly, Anderson [1] provides some insights into the error characteristics of his method, but no rigorous tight bounds. <p> (p) 8 h ) Downward pass O ((N int f (p) + f (p)) 8 h ) Far-field O (g (p) N) Near-field O (N near N 2 =8 h ) Minimized total O ((g (p) + p N near N int f (p)) N ) The use of supernodes <ref> [14, 6] </ref> reduces the effective value of the number of computational elements, "boxes", in the interactive-field. This field is defined as the part of the far-field that is in the parent box's near-field. <p> This field is defined as the part of the far-field that is in the parent box's near-field. In <ref> [14] </ref>, Zhao observes that for a near-field extending two boxes away in each direction from a box, two-separation, in three dimensions there are many groups of eight sibling nodes of common parents among the 567 interactive-field boxes of a destination box for the far-field to local-field conversion. <p> For a fixed degree of separation of the near-field, varying the hierarchy depth changes the proportion of particles in the near-field and in the far-field, and therefore may affect the error of the complete method. The error bounds given in <ref> [5, 4, 14] </ref> for multipole-based methods apply to individual computational elements. The error for the complete methods remain to be verified. <p> Author Method Degree of separation Use of supernodes Hierarchy depth Greengard-Rokhlin [5] GR 2 No blog N 8 c Zhao <ref> [14] </ref> Zhao 2 Yes blog N 8 c Schmidt-Lee [11] GR 1 No 3,4,5 Shimada et al. [12] GR 1,2 No log N 8 Leathrum [10] GR 1,2,mixed 1 and 2 Yes and No blog N 8 c Esselink [3] GR 2 Yes 2,3,4 The scheme is developed and verified for
References-found: 13

