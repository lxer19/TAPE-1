URL: http://www.cs.ucsb.edu/~vigna/pub/fwtest.ps.gz
Refering-URL: http://www.cs.ucsb.edu/~vigna/listpub.html
Root-URL: http://www.cs.ucsb.edu
Email: vigna@elet.polimi.it  
Phone: +39 2 2399 3638  
Title: A Formal Model for Firewall Testing  
Author: Giovanni Vigna 
Keyword: Network security, testing methodologies, firewalls, formal methods  
Address: P.za Leonardo da Vinci, 32 20133 Milano, Italia  
Affiliation: Dipartimento di Elettronica Politecnico di Milano  
Abstract: Firewalls are hardware and software systems that protect a corporate network from attacks coming from the outside Internet. Despite their critical role, firewall systems are tested without well-defined and effective methodologies. In particular, field testing is performed using simple checklists of vulnerabilities without taking into account the particular topology and configuration of the firewall's target operational environment. We propose a firewall testing methodology based on a formal model of networks that allows the test engineer to model the network environment of the firewall system, to prove formally that the topology of the network verifies the sufficient conditions for protection against attacks, and to build test cases to verify that protections are actually in place. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> S. Bellovin. </author> <title> Security Problems in the TCP/IP Protocol Suite. </title> <journal> Computer Communications Review, </journal> <volume> 19(2), </volume> <year> 1990. </year>
Reference-contexts: Little attention has been paid to security issues. Therefore, TCP/IP protocols are not able to provide the authentication, integrity, and privacy mechanisms to protect communication in the present potentially hostile environment <ref> [1] </ref>. To provide secure communication services, several secure higher-level protocols (e.g., the Secure Socket Layer [9]) have been designed and implemented on top of the TCP/IP stack. These protocols address the problem of securing point-to-point communication but do not protect a corporate network as a whole. <p> )) s 3 =(a c ; a s ; (p c ; p s ; seq 0 s + 1; fACKg; p 00 empty )); where p 00 empty represents a null payload. 4 MODELING VULNERABILITIES The network model presented so far can be used to model network security vulnerabilities <ref> [14, 1] </ref>. Here, as an example, we will describe IP spoofing [7]. Other attacks have been modeled in [23]. When a host tries to masquerade as another host in a communication, we are in presence of spoofing.
Reference: [2] <author> C. Berge. </author> <title> Hypergraphs. </title> <publisher> North-Holland, </publisher> <year> 1989. </year>
Reference-contexts: In Section 3.2 we describe the Internet network model and the associated protocol. In Sections 3.3 and 3.4 we present the two transport level protocols of the TCP/IP stack. 2 3.1 Link level model A network is modeled as a connected hypergraph <ref> [2] </ref> N on the set of interfaces I = fi 1 ; i 2 ; : : : ; i n g, i.e., is a family N = fE 1 ; E 2 ; : : : ; E m g where each E i is a subset of I called
Reference: [3] <author> B. Chapman and E. </author> <title> Zwicky. Building Internet Firewalls. </title> <publisher> O'Reilly & Associates, </publisher> <year> 1995. </year>
Reference-contexts: To provide secure communication services, several secure higher-level protocols (e.g., the Secure Socket Layer [9]) have been designed and implemented on top of the TCP/IP stack. These protocols address the problem of securing point-to-point communication but do not protect a corporate network as a whole. For this reason firewalls <ref> [4, 3] </ref> have been developed. Firewalls are systems that protect a network from the outside Internet. They act as a filter for all the incoming and outgoing network traffic, blocking access to services that may be exploited to attack the internal hosts of the protected network.
Reference: [4] <author> W. Cheswick and S. Bellovin. </author> <title> Firewalls and Internet Security: Repelling the Wily Hacker. </title> <publisher> Addison-Wesley, </publisher> <year> 1994. </year>
Reference-contexts: To provide secure communication services, several secure higher-level protocols (e.g., the Secure Socket Layer [9]) have been designed and implemented on top of the TCP/IP stack. These protocols address the problem of securing point-to-point communication but do not protect a corporate network as a whole. For this reason firewalls <ref> [4, 3] </ref> have been developed. Firewalls are systems that protect a network from the outside Internet. They act as a filter for all the incoming and outgoing network traffic, blocking access to services that may be exploited to attack the internal hosts of the protected network.
Reference: [5] <author> D. Comer. </author> <title> Internetworking with TCP/IP, volume 1. </title> <publisher> Prentice-Hall, </publisher> <year> 1991. </year>
Reference-contexts: Organizations connect to the Internet to use services, like the World Wide Web, e-mail and file transfer, based on the TCP/IP protocol suite <ref> [5] </ref>. TCP/IP protocols were designed years ago to provide a simple, efficient, open communication infrastructure in a collaborative and friendly environment. Little attention has been paid to security issues.
Reference: [6] <institution> Computer Emergency Response Team. CERT Advisories. </institution> <note> Available via anonymous ftp at ftp.cert.org. </note>
Reference-contexts: Rather, single known vulnerabilities are addressed using ad hoc mechanisms and techniques. For this reason, firewalls are subject to continuous maintenance to address security problems as soon as they become publicly known <ref> [6] </ref>. A particular challenging activity is firewall testing. While firewall software modules and the system as a whole can be tested following well-known techniques [15], field testing requires a different approach.
Reference: [7] <institution> Computer Emergency Response Team. IP Spoofing Attacks and Hijacked Terminal Connections. CA-95:01, </institution> <month> January </month> <year> 1995. </year>
Reference-contexts: Here, as an example, we will describe IP spoofing <ref> [7] </ref>. Other attacks have been modeled in [23]. When a host tries to masquerade as another host in a communication, we are in presence of spoofing. The impersonated host may have a privileged access to the attacked host or may be regarded as a source of sensitive information.
Reference: [8] <author> D. Farmer and W. Venema. SATAN Documentation, </author> <month> Apr. </month> <year> 1995. </year>
Reference-contexts: Section 7 draws some conclusions and outlines future work. 2 CURRENT APPROACHES The current approach to firewall testing can be described as "test once deploy many". Firewall vendors develop firewall systems and then perform system testing using tools like the Internet Security Scanner [11], or SATAN <ref> [8] </ref> that try to exploit a number of well-known security vulnerabilities. If a firewall survives these attacks, it is considered "secure" and eventually marketed. This approach is supported by the National Computer Security Association (NCSA) that provides a certification process to firewall products developers [16].
Reference: [9] <author> A. Freier, P. Karlton, and P. Kocher. </author> <title> The SSL Protocol | Version 3.0. </title> <type> Internet Draft, </type> <month> March </month> <year> 1996. </year>
Reference-contexts: Little attention has been paid to security issues. Therefore, TCP/IP protocols are not able to provide the authentication, integrity, and privacy mechanisms to protect communication in the present potentially hostile environment [1]. To provide secure communication services, several secure higher-level protocols (e.g., the Secure Socket Layer <ref> [9] </ref>) have been designed and implemented on top of the TCP/IP stack. These protocols address the problem of securing point-to-point communication but do not protect a corporate network as a whole. For this reason firewalls [4, 3] have been developed.
Reference: [10] <author> L. Joncheray. </author> <title> A Simple Active Attack Against TCP. </title> <type> Technical report, </type> <institution> Merit Network Inc., </institution> <month> April </month> <year> 1995. </year>
Reference-contexts: This can be done by describing constraint on messages appearing on the links of the protected network. These constraints are derived directly from the modeling of the different types of attacks. For example, the session hijacking attack, 7 described in <ref> [10] </ref>, generates particular sequences of mes-sages, that, in particular topologies, allow for detection of an occurring attack. As another example, the requisite to avoid traffic from a particular source to reach some parts of the internal network can be specified as patterns of message that cannot appear on particular links.
Reference: [11] <author> C. Klaus. </author> <title> Internet Security Scanner. </title> <note> http://- www.iss.net/. </note>
Reference-contexts: Section 6 describes an example. Section 7 draws some conclusions and outlines future work. 2 CURRENT APPROACHES The current approach to firewall testing can be described as "test once deploy many". Firewall vendors develop firewall systems and then perform system testing using tools like the Internet Security Scanner <ref> [11] </ref>, or SATAN [8] that try to exploit a number of well-known security vulnerabilities. If a firewall survives these attacks, it is considered "secure" and eventually marketed. This approach is supported by the National Computer Security Association (NCSA) that provides a certification process to firewall products developers [16].
Reference: [12] <author> S. Microsystems. NFS: </author> <title> Network File System Protocol specification. </title> <type> RFC 1094, </type> <year> 1989. </year>
Reference-contexts: There is no concept of a UDP session, but since several application protocols based on UDP (like the Domain Name Service (DNS) [13] or the Network File System (NFS) <ref> [12] </ref>) follow a query/reply schema, we define a UDP interaction as an IP session composed of two UDP datagrams representing a request/reply exchange.
Reference: [13] <author> P. Mockapetris. </author> <title> Domain Name System. </title> <type> RFC 1034, </type> <month> November </month> <year> 1987. </year>
Reference-contexts: There is no concept of a UDP session, but since several application protocols based on UDP (like the Domain Name Service (DNS) <ref> [13] </ref> or the Network File System (NFS) [12]) follow a query/reply schema, we define a UDP interaction as an IP session composed of two UDP datagrams representing a request/reply exchange.
Reference: [14] <author> R. T. Morris. </author> <title> A Weakness in the 4.2BSD UNIX TCP/IP Software. </title> <type> Technical report, </type> <institution> AT&T Bell Laboratories, </institution> <month> February </month> <year> 1985. </year>
Reference-contexts: )) s 3 =(a c ; a s ; (p c ; p s ; seq 0 s + 1; fACKg; p 00 empty )); where p 00 empty represents a null payload. 4 MODELING VULNERABILITIES The network model presented so far can be used to model network security vulnerabilities <ref> [14, 1] </ref>. Here, as an example, we will describe IP spoofing [7]. Other attacks have been modeled in [23]. When a host tries to masquerade as another host in a communication, we are in presence of spoofing.
Reference: [15] <author> G. Myers. </author> <title> The Art of Software Testing. </title> <publisher> Wiley, </publisher> <year> 1979. </year>
Reference-contexts: For this reason, firewalls are subject to continuous maintenance to address security problems as soon as they become publicly known [6]. A particular challenging activity is firewall testing. While firewall software modules and the system as a whole can be tested following well-known techniques <ref> [15] </ref>, field testing requires a different approach. Field testing verifies if a software system behaves correctly when it is put at work in its target operational environment. Usually the operational environment is viewed as something the system "must survive to".
Reference: [16] <institution> NCSA Firewall Product Developers Consortium. NCSA FWPD Criteria|Version 2.0. </institution> <note> http://www.ncsa.com/fpfs/fwct20.html, 1996. </note>
Reference-contexts: If a firewall survives these attacks, it is considered "secure" and eventually marketed. This approach is supported by the National Computer Security Association (NCSA) that provides a certification process to firewall products developers <ref> [16] </ref>. Even though certification is an important step in the delivery of quality products, this approach is often misunderstood by firewall customers. The "NCSA approved" seal conveys a false sense of security and organizations buy and deploy certified firewall systems without further testing of their functionalities.
Reference: [17] <author> J. Postel. </author> <title> User Datagram Protocol. </title> <type> RFC 768, </type> <month> August </month> <year> 1980. </year>
Reference-contexts: s with i 6= n, the following holds: 8m 2 d i ; 8m 0 2 d i+1 fdsa (m); dda (m)g = fdsa (m 0 ); dda (m 0 )g: Note that datagrams belonging to the same session may follow different routes. 3.3 User Datagram Protocol The UDP protocol <ref> [17] </ref> provides a datagram delivery service over IP. The UDP protocol introduces the port abstraction to distinguish among different message sources and destinations for the same IP address.
Reference: [18] <author> J. Postel. </author> <title> Internet Protocol. </title> <type> RFC 792, </type> <year> 1981. </year>
Reference-contexts: set of listeners of the message as the set of hosts connected to the link the message appears on, and owning neither of the interfaces of the message: ML (m) = fH i 2 H j H i 2 C (al (m)) ^ 3.2 IP networks The Internet Protocol (IP) <ref> [18] </ref> defines a global addressing mechanism and relies on low level network protocols in order to deliver messages (called datagrams) to distant hosts. An IP datagram is composed of a header, containing the source and destination IP addresses, and a payload.
Reference: [19] <author> J. Postel. </author> <title> Transmission Control Protocol. </title> <type> RFC 793, </type> <month> September </month> <year> 1981. </year>
Reference-contexts: and (a j ; p j ) is composed of two datagrams d 1 = hm 1 2 ; : : : ; m 1 1 ; m 2 q i such that: pl (m 1 i )); pl (m 2 j )): 3.4 Transmission Control Protocol The TCP protocol <ref> [19] </ref> provides a reliable stream delivery service, using the IP datagram delivery service. The TCP protocol uses the port abstraction in order to distinguish among different virtual circuits between the same IP addresses.
Reference: [20] <author> M. Ranum. </author> <title> On the Topic of Firewall Testing. </title> <note> http://www.clark.net/pub/mjr/pubs/fw-test/index.htm, 1995. </note>
Reference-contexts: A different approach is described by Ranum in <ref> [20] </ref>. Following this approach, once a firewall system has been deployed in its target operational environment, a top-down design-oriented review is carried out.
Reference: [21] <author> SRI Consulting. </author> <title> Standard Firewall/Penetration Testing Work Agreement. </title> <address> http://rome.isl.- sri.com/itp/security/firewall.html, </address> <year> 1997. </year>
Reference-contexts: The "NCSA approved" seal conveys a false sense of security and organizations buy and deploy certified firewall systems without further testing of their functionalities. In some cases, black-box field testing (also called penetration testing) is performed after firewall deployment by consulting companies <ref> [22, 21] </ref> using tools like the aforementioned ones on the basis of some information about the particular installation (e.g., IP addresses and firewall system configuration).
Reference: [22] <author> Trusted Information Systems. </author> <title> Firewall Vulnerabilities Analysis and Testing. </title> <address> http://www.tis.com/- docs/products/consulting/fwvuln.html, </address> <year> 1997. </year>
Reference-contexts: The "NCSA approved" seal conveys a false sense of security and organizations buy and deploy certified firewall systems without further testing of their functionalities. In some cases, black-box field testing (also called penetration testing) is performed after firewall deployment by consulting companies <ref> [22, 21] </ref> using tools like the aforementioned ones on the basis of some information about the particular installation (e.g., IP addresses and firewall system configuration).
Reference: [23] <author> G. Vigna. </author> <title> A Topological Characterization of TCP/IP Security. </title> <type> Technical Report TR-96.156, </type> <institution> Politecnico di Milano, </institution> <month> November </month> <year> 1996. </year> <month> 10 </month>
Reference-contexts: Firewall testing should not rely only on the arts and crafts of security experts or be limited to generic checklists. There is a need for a well-defined testing methodology supported by a sound underlying model. Our approach is based on a formal model of TCP/IP networks and related vulnerabilities <ref> [23] </ref>. The model allows the test engineer to describe the network environment the firewall is placed into, and the services to be protected. <p> The complete definition is given in <ref> [23] </ref>. <p> Here, as an example, we will describe IP spoofing [7]. Other attacks have been modeled in <ref> [23] </ref>. When a host tries to masquerade as another host in a communication, we are in presence of spoofing. The impersonated host may have a privileged access to the attacked host or may be regarded as a source of sensitive information. <p> Eventually, test cases can be deduced by the requirements as well as correct positioning of monitors and probes. 9 Future work will consider the analysis of other vulner-abilities. Until now, several types of spoofing, sniffing, and hijacking have been analyzed <ref> [23] </ref>. Current efforts are focused on the development of an integrated set of software tools based on the model, that support the test engineer in his/her work and automate part of it.
References-found: 23

