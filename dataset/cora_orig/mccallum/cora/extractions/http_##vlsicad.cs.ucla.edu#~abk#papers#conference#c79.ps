URL: http://vlsicad.cs.ucla.edu/~abk/papers/conference/c79.ps
Refering-URL: http://vlsicad.cs.ucla.edu/~abk/publications.html
Root-URL: http://www.cs.ucla.edu
Title: Watermarking Techniques for Intellectual Property Protection  
Author: A. B. Kahng, J. Lach W. H. Mangione-Smith S. Mantik, I. L. Markov, M. Potkonjak, P. Tucker H. Wang and G. Wolfe 
Address: Los Angeles, CA 90095-1596  Los Angeles, CA 90095-1594  La Jolla, CA 92093-0114  
Affiliation: UCLA Computer Science Dept.,  UCLA Electrical Engineering Dept.,  UCSD Computer Science Engineering Dept.,  
Abstract: Digital system designs are the product of valuable effort and knowhow. Their embodiments, from software and HDL program down to device-level netlist and mask data, represent carefully guarded intellectual property (IP). Hence, design methodologies based on IP reuse require new mechanisms to protect the rights of IP producers and owners. This paper establishes principles of watermarking-based IP protection, where a watermark is a mechanism for identification that is (i) nearly invisible to human and machine inspection, (ii) difficult to remove, and (iii) permanently embedded as an integral part of the design. We survey related work in cryptography and design methodology, then develop desiderata, metrics and example approaches centering on constraint-based techniques for watermarking at various stages of the VLSI design process. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> W. Bender, D Gruhl, N. Morimoto and A. Lu, </author> <title> Techniques for Data Hiding, </title> <journal> IBM Systems Journal, </journal> <pages> 35(3-4), </pages> <year> 1996, </year> <pages> pp. 313-336. </pages>
Reference-contexts: Only with the proliferation of digital media has it attracted wide research and economic interest, e.g., for protection of audio <ref> [1, 15] </ref>, text [21, 2], image [5], and video. connects into a transistor-level layout.
Reference: [2] <author> J.T. Brassil, S. Low, N.F. Maxemchuk and L. O'Gorman, </author> <title> Electronic Marking and Identification Techniques to Discourage Document Copying, </title> <journal> IEEE Journal on Selected Areas in Communications, </journal> <volume> 13(4) (1995), </volume> <pages> pp. 1495-1504. </pages>
Reference-contexts: Only with the proliferation of digital media has it attracted wide research and economic interest, e.g., for protection of audio [1, 15], text <ref> [21, 2] </ref>, image [5], and video. connects into a transistor-level layout.
Reference: [3] <author> R.E. Bryant, </author> <title> Binary Decision Diagrams and Beyond: Enabling Technologies for Formal Verification, </title> <booktitle> Proc. of the International Conference on Computer-Aided Design, </booktitle> <year> 1995, </year> <pages> pp. 236-243. </pages>
Reference-contexts: 14 gg (we pad the end of the message with an extra space to maintain three literals per clause). 4 This observation holds for the three major classes of SAT heuristics: (i) random search [25, 7], (ii) nonlinear programming relaxation and rounding [12], and (iii) a variety of BDD-based techniques <ref> [3] </ref>. 5 Artifact watermarking has been used for thousands of years. Only with the proliferation of digital media has it attracted wide research and economic interest, e.g., for protection of audio [1, 15], text [21, 2], image [5], and video. connects into a transistor-level layout.
Reference: [4] <author> S.T. Chakradhar, V.D. Agrawal and S.G. Rothweiler, </author> <title> A Transitive Closure Algorithm for Test Generation, </title> <journal> IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems, </journal> <note> 12(7) (1993), pp.1015-28. </note>
Reference-contexts: SAT is well-known as the first problem shown to be NP-complete, and the starting point for establishing the known body of NP-completeness results [10]. Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing <ref> [4, 8, 11, 20] </ref>, logic synthesis and physical design [8]. We now illustrate the constraint-based watermarking of a SAT solution. For convenience, we assume the 3SAT restriction of the problem where each clause has exactly three variables.

Reference: [6] <author> I.J.Cox, J. Kilian, F.T. Leighton and T. Shamoon, </author> <title> Secure Spread Spectrum Watermarking for Multimedia, </title> <journal> Transactions on Image Processing, </journal> <note> 6(12) (1997), pp.1673-87. </note>
Reference: [7] <author> M. Davis and H. Putnam, </author> <title> A Computing Procedure for Quantification Theory, </title> <journal> Journal of the ACM, </journal> <volume> 7(3) (1960), </volume> <pages> pp. 201-215. </pages>
Reference-contexts: 8 g; fu 4 ; u 14 ; flu 3 g;fu 8 ; flu 12 ;u 14 gg (we pad the end of the message with an extra space to maintain three literals per clause). 4 This observation holds for the three major classes of SAT heuristics: (i) random search <ref> [25, 7] </ref>, (ii) nonlinear programming relaxation and rounding [12], and (iii) a variety of BDD-based techniques [3]. 5 Artifact watermarking has been used for thousands of years.
Reference: [8] <author> S. Devadas, </author> <title> Optimal Layout Via Boolean Satisfiability, </title> <booktitle> IEEE International Conference on Computer-Aided Design, </booktitle> <year> 1989, </year> <pages> pp. 294-7. </pages>
Reference-contexts: SAT is well-known as the first problem shown to be NP-complete, and the starting point for establishing the known body of NP-completeness results [10]. Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing <ref> [4, 8, 11, 20] </ref>, logic synthesis and physical design [8]. We now illustrate the constraint-based watermarking of a SAT solution. For convenience, we assume the 3SAT restriction of the problem where each clause has exactly three variables. <p> Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing [4, 8, 11, 20], logic synthesis and physical design <ref> [8] </ref>. We now illustrate the constraint-based watermarking of a SAT solution. For convenience, we assume the 3SAT restriction of the problem where each clause has exactly three variables.
Reference: [9] <author> W.Diffie and M. Hellman, </author> <title> New Directions in Cryptography, </title> <journal> IEEE Transactions on Information Theory, </journal> <volume> IT-22(6), </volume> <year> 1976, </year> <pages> pp. 644-654. </pages>
Reference-contexts: Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms [15], behavior [14], logic synthesis and physical design [16], as well as in FPGA designs [18, 19]. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman <ref> [9] </ref>, who introduced public-key cryptography based on the computational intractability of certain mathematical tasks.
Reference: [10] <author> M. E. Garey and D. S. Johnson, </author> <title> Computers and Intractability: a Guide to the Theory of NP-Completeness, </title> <publisher> Freeman, </publisher> <year> 1979. </year>
Reference-contexts: Furthermore, our principles apply to the protection of both hardware and software (e.g., Verilog or C++ code) IP. A Motivating Example: 3SAT We illustrate key ideas behind watermarking-based IPP using the satisfiability (SAT) problem <ref> [10] </ref>: SAT (U;C) Instance: A finite set of variables U and a collection C = fc 1 ; c 2 ; : : : ; c m g of clauses over U . <p> SAT is well-known as the first problem shown to be NP-complete, and the starting point for establishing the known body of NP-completeness results <ref> [10] </ref>. Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing [4, 8, 11, 20], logic synthesis and physical design [8]. We now illustrate the constraint-based watermarking of a SAT solution.
Reference: [11] <author> J. </author> <title> Giraldi and M.L. Bushnell, Search State Equivalence for Redundancy Identification and Test Generation, </title> <booktitle> Proc. Intl. Test Conf., </booktitle> <year> 1991, </year> <pages> pp. 184-193. </pages>
Reference-contexts: SAT is well-known as the first problem shown to be NP-complete, and the starting point for establishing the known body of NP-completeness results [10]. Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing <ref> [4, 8, 11, 20] </ref>, logic synthesis and physical design [8]. We now illustrate the constraint-based watermarking of a SAT solution. For convenience, we assume the 3SAT restriction of the problem where each clause has exactly three variables.
Reference: [12] <author> M. X. Goemans and D. P. Williamson, </author> <title> Improved Approximation Algorithms for Maximum Cut and Satisfiability Problems Using Semidefinite Programming, </title> <journal> Journal of the ACM, </journal> <note> 42(6) (1995), pp.1115-45. </note>
Reference-contexts: flu 3 g;fu 8 ; flu 12 ;u 14 gg (we pad the end of the message with an extra space to maintain three literals per clause). 4 This observation holds for the three major classes of SAT heuristics: (i) random search [25, 7], (ii) nonlinear programming relaxation and rounding <ref> [12] </ref>, and (iii) a variety of BDD-based techniques [3]. 5 Artifact watermarking has been used for thousands of years.
Reference: [13] <author> A.H. Hashemi, D.R. Kaeli and B. Calder, </author> <title> Efficient Procedure Mapping Using Cache Line Coloring, </title> <journal> SIGPLAN Notices, </journal> <note> 32(5) (1997), pp.171-182. </note>
Reference-contexts: Much effort has been devoted to allocating minimal cache structures and optimizing code for effective cache utilization [30]. A particularly successful technique is cache line coloring <ref> [13] </ref>. Given a code segment and input data benchmarks, cache line coloring code optimization seeks a permutation of basic block code segments such that the mapping of code to cache entries minimizes the cache miss ratio over the given benchmarks. The problem can be modeled as follows.
Reference: [14] <author> I. Hong and M. Potkonjak, </author> <title> Behavioral Synthesis Techniques for Intellectual Property Protection, </title> <type> unpublished manuscript, </type> <year> 1997. </year>
Reference-contexts: Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms [15], behavior <ref> [14] </ref>, logic synthesis and physical design [16], as well as in FPGA designs [18, 19]. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman [9], who introduced public-key cryptography based on the computational intractability of certain mathematical tasks. <p> For example, following the technique for watermarking of graph coloring solutions proposed by Hong and Potkonjak <ref> [14] </ref>, one may add additional edges to the graph according to some encrypted signature of the author.
Reference: [15] <author> L. Honey, A.H. Tewfik and K.N. Hamdy, </author> <title> Digital Watermarks for Audio Signals, </title> <booktitle> Proc. of the International Conference on Multimedia Computing and Systems, </booktitle> <year> 1998, </year> <pages> pp. 473-480. </pages>
Reference-contexts: Only with the proliferation of digital media has it attracted wide research and economic interest, e.g., for protection of audio <ref> [1, 15] </ref>, text [21, 2], image [5], and video. connects into a transistor-level layout. <p> Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms <ref> [15] </ref>, behavior [14], logic synthesis and physical design [16], as well as in FPGA designs [18, 19]. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman [9], who introduced public-key cryptography based on the computational intractability of certain mathematical tasks.
Reference: [16] <author> A. B. Kahng, S. Mantik, I. L. Markov, M. Potkonjak, P. Tucker, H. Wang and G. Wolfe, </author> <title> Robust IP Watermarking Methodologies for Physical Design, </title> <booktitle> Proc. ACM/IEEE Design Automation Conf., </booktitle> <year> 1998. </year>
Reference-contexts: Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms [15], behavior [14], logic synthesis and physical design <ref> [16] </ref>, as well as in FPGA designs [18, 19]. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman [9], who introduced public-key cryptography based on the computational intractability of certain mathematical tasks. <p> hierarchy. 11 Note that since the attacker does not know which constraints correspond to the author's signature, tampering attacks might not be able to ruin the proof of authorship before they significantly degrade the quality of the final solution (at which point the tampered solution ceases to be useful); see <ref> [16] </ref> for experience in the physical design realm.
Reference: [17] <author> D. Kirovski and M. Potkonjak, </author> <title> System-Level Synthesis of Low-Power Hard Real-Time Systems, </title> <booktitle> Proc. ACM/IEEE Design Automation Conference, </booktitle> <year> 1997, </year> <pages> pp. 697-702. </pages>
Reference-contexts: Our intent is to illustrate the wide-ranging applicability of the principles developed above. 5.1 Preprocessing in System-Level Design At the system level, instruction and data caches consume a significant portion of the overall area, and often have crucial impact on system timing and power consumption <ref> [17] </ref>. Much effort has been devoted to allocating minimal cache structures and optimizing code for effective cache utilization [30]. A particularly successful technique is cache line coloring [13]. <p> However, it seems possible for an attacker to use tampering methods to remove a signature that is known to him, or to add an entirely new signature. 12 Kirovski et al. <ref> [17] </ref> have experimentally shown that this optimization results in significant performance increase.
Reference: [18] <author> J. Lach, W. H. Mangione-Smith and M. Potkonjak, </author> <title> Fingerprinting Digital Circuits on Programmable Hardware, </title> <booktitle> Proc. Workshop on Information Hiding, </booktitle> <year> 1998. </year>
Reference-contexts: Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms [15], behavior [14], logic synthesis and physical design [16], as well as in FPGA designs <ref> [18, 19] </ref>. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman [9], who introduced public-key cryptography based on the computational intractability of certain mathematical tasks. <p> The disadvantage of this approach is that the watermark is not embedded in the functional part of the design; given enough information, the watermark can be removed without affecting design functionality. An example of an iterative approach can be found in the work by Lach et al. <ref> [18, 19] </ref>. An example of a purely post-processing approach involves inserting the watermark into the control bits for unused outputs from configurable logic blocks (CLBs).
Reference: [19] <author> J. Lach, W. H. Mangione-Smith and M. Potkonjak, </author> <title> FPGA Fingerprinting Techniques for Protecting Intellectual Property, </title> <booktitle> Proc. </booktitle> <address> CICC, </address> <year> 1998. </year>
Reference-contexts: Since 1996, the effectiveness of this generic scheme for watermarking-based IPP has been demonstrated at the level of algorithms [15], behavior [14], logic synthesis and physical design [16], as well as in FPGA designs <ref> [18, 19] </ref>. 2.2 Cryptography Modern age cryptography grew from the seminal work of Diffie and Hellman [9], who introduced public-key cryptography based on the computational intractability of certain mathematical tasks. <p> The disadvantage of this approach is that the watermark is not embedded in the functional part of the design; given enough information, the watermark can be removed without affecting design functionality. An example of an iterative approach can be found in the work by Lach et al. <ref> [18, 19] </ref>. An example of a purely post-processing approach involves inserting the watermark into the control bits for unused outputs from configurable logic blocks (CLBs).
Reference: [20] <author> T. Larrabee, </author> <title> Test Pattern Generation Using Boolean Satisfiability, </title> <booktitle> Proc. International Test Conf., </booktitle> <month> 11(1) </month> <year> (1992), </year> <month> pp.4-15. </month>
Reference-contexts: SAT is well-known as the first problem shown to be NP-complete, and the starting point for establishing the known body of NP-completeness results [10]. Problems from many application domains have been modeled as SAT instances. In VLSI CAD, SAT formulations have been used in testing <ref> [4, 8, 11, 20] </ref>, logic synthesis and physical design [8]. We now illustrate the constraint-based watermarking of a SAT solution. For convenience, we assume the 3SAT restriction of the problem where each clause has exactly three variables.
Reference: [21] <author> S.H. Low, N.F. Maxemchuk, J.T. Brassil and L. O'Gorman, </author> <title> Document Marking and Identification Using both Line and Word Shifting, </title> <booktitle> Proc. INFOCOM, </booktitle> <year> 1995, </year> <month> pp.853-60. </month>
Reference-contexts: Only with the proliferation of digital media has it attracted wide research and economic interest, e.g., for protection of audio [1, 15], text <ref> [21, 2] </ref>, image [5], and video. connects into a transistor-level layout.
Reference: [22] <editor> A.J. Menezes, P.C. van Oorschot and S.A. Vanstone, </editor> <booktitle> Handbook of Applied Cryptography, </booktitle> <address> Boca Raton, </address> <publisher> CRC Press, </publisher> <year> 1997. </year>
Reference-contexts: Since 1976, cryptographic algorithms and techniques have evolved through vigorous innovation and public scrutiny, resulting in a variety of digital signature mechanisms, as well as protocols for secret splitting, timestamping, proxy signatures, group signatures, key escrow, oblivious transfer, oblivious signatures, digital cash, etc. <ref> [27, 22] </ref>.
Reference: [23] <author> Pretty Good (tm) Privacy, Phil Zimmerman, </author> <title> Users Guide: </title> <journal> Vol. </journal> <volume> 1, Vol. </volume> <month> 2, </month> <title> and Internal Data Structures from Phil's Pretty Good Software, copy: </title> <address> http://www-atp.llnl.gov/atp/papers/HRM/references/pgp-refs.html </address>
Reference-contexts: If a signature corresponds simply to a text message (as it has so far in this discussion) then Bob's task is easy: he simply chooses a text message resembling one that Alice would use. However, such attacks can be easily prevented by using a public key encryption system <ref> [23] </ref>. Any message actually signed by Alice would be encrypted with her private key, yet verifiable with her public key.
Reference: [24] <author> R.L.Rivest, </author> <title> RFC 1321: the MD5 Message-Digest Algorithm, </title> <institution> Internet Activities Board, </institution> <month> April </month> <year> 1992. </year>
Reference-contexts: This is also easy. Suppose that the author's signature is a particular text message. We can convert this message into a cryptographically sound pseudorandom bit stream by simply hashing the message (using a one-way hash function such as MD5 <ref> [24] </ref>) and using the hash as a seed for a stream cipher such as RC4 [35]. 10 We believe continuous watermarking is possible as well, e.g., by mapping into discrete watermarking by Fourier transform.
Reference: [25] <author> B. Selman, </author> <title> Stochastic Search and Phase Transitions: AI Meets Physics, </title> <booktitle> IJCAI, </booktitle> <month> 1 </month> <year> (1995), </year> <month> pp.998-1002. </month>
Reference-contexts: 8 g; fu 4 ; u 14 ; flu 3 g;fu 8 ; flu 12 ;u 14 gg (we pad the end of the message with an extra space to maintain three literals per clause). 4 This observation holds for the three major classes of SAT heuristics: (i) random search <ref> [25, 7] </ref>, (ii) nonlinear programming relaxation and rounding [12], and (iii) a variety of BDD-based techniques [3]. 5 Artifact watermarking has been used for thousands of years.
Reference: [26] <institution> Semiconductor Industry Association, National Technology Roadmap for Semiconductors, </institution> <month> revised November </month> <year> 1997. </year>
Reference-contexts: At the same time, market forces have led to more design starts, shorter design cycle times and greater time-to-market pressures. Industry organizations have documented a compounding design productivity shortfall <ref> [26] </ref>, which demands ever-larger design teams with each successive process generation just to maintain a given level of design compet itiveness. 1 Finally, system design costs are increasingly impacted by software, which accounts for up to 70% of total development cost in recent design projects. <p> Work by A. B. Kahng, S. Mantik, I. L. Markov, P. Tucker and H. Wang supported by a grant from Cadence Design Systems, Inc. 1 According to <ref> [26] </ref>, the available transistor density has increased by 58%/year over the last 20 years; designer efficiency (measured in transistors designed per staff-month) has increased by only 21%/year over the same period. ganizations such as the VSI Alliance [33] have created high expectations for the value and reusability of design IP.
Reference: [27] <author> D.R. Stinson, </author> <title> Cryptography: Theory and Practice, </title> <address> Boca Raton, </address> <publisher> CRC Press, </publisher> <year> 1995. </year>
Reference-contexts: Since 1976, cryptographic algorithms and techniques have evolved through vigorous innovation and public scrutiny, resulting in a variety of digital signature mechanisms, as well as protocols for secret splitting, timestamping, proxy signatures, group signatures, key escrow, oblivious transfer, oblivious signatures, digital cash, etc. <ref> [27, 22] </ref>.
Reference: [28] <author> S. Trimberger, </author> <type> personal communication, </type> <year> 1997. </year>
Reference-contexts: Xilinx does not take any specific actions to make their configurations difficult to reverse engineer. However, they do believe that it is difficult to do in general, and they promise their customers that they will keep the bitstream specification confidential in order to raise the bar for reverse engineering <ref> [28] </ref>. 5.3 Preprocessing in Physical Design Finally, in the context of physical design, we present a new preprocessing based approach for design watermarking. Our approach exploits the flexibility with which path-based timing constraints can be satisfied.
Reference: [29] <editor> VSI Alliance, </editor> <booktitle> Fall Worldwide Member Meeting: a Year of Achievement, </booktitle> <address> Santa Clara, CA, </address> <month> October </month> <year> 1997. </year>
Reference-contexts: In addition to system verification, mixed-signal design integration, on-chip bus, manufacturing-related test, and system-level design, intellectual property protection is considered to be a crucial enabling technology <ref> [29] </ref>. Enumeration of the solution space indicates that the given 3SAT instance has 556 different satisfying assignments.
Reference: [30] <author> H. Wang, T. Sun, Q. Yang, </author> <title> Minimizing Area Cost of on-Chip Cache Memories by Caching Address Tags, </title> <journal> IEEE Transactions on Computers, </journal> <volume> 46(11) (1997), </volume> <pages> pp. 1187-1201. </pages>
Reference-contexts: Much effort has been devoted to allocating minimal cache structures and optimizing code for effective cache utilization <ref> [30] </ref>. A particularly successful technique is cache line coloring [13]. Given a code segment and input data benchmarks, cache line coloring code optimization seeks a permutation of basic block code segments such that the mapping of code to cache entries minimizes the cache miss ratio over the given benchmarks.
Reference: [31] <author> Xilinx, </author> <title> The Programmable Logic Data Book, </title> <publisher> Xilinx Corporation, </publisher> <address> San Jose, </address> <year> 1996. </year> <note> [32] http://www.rapid.org [33] http://www.vsi.org [34] http://www.si2.org [35] http://dcs.ex.ac.uk/~aba/rsa/rc4.html </note>
Reference-contexts: Certain bits in the configuration bitstream that control multiplexers for the CLB outputs can be replaced by watermark bits if the CLB outputs are not used. For example, the Xilinx 4000 family of FPGAs contain CLBs with four outputs <ref> [31] </ref>. Two outputs (X and Y) are combinational, while the others (XQ and YQ) can be used in sequential designs. The two combinatorial outputs are each controlled by a 2-to-1 multiplexer, and the two sequential outputs are each controlled by three 2-to-1 multiplexers and one 4-to-1 multiplexer.
References-found: 30

