URL: http://www.graphics.cornell.edu/~sumant/jpaper1.ps.Z
Refering-URL: http://www.graphics.cornell.edu/~sumant/cv.html
Root-URL: 
Title: Computation of Global Illumination by Monte Carlo Simulation of the Particle Model of Light  
Author: S.N.Pattanaik and S.P.Mudur 
Address: Juhu, Bombay 400 049, INDIA  
Affiliation: Graphics CAD Division, National Centre for Software Technology,  
Abstract: In the particle model, light is assumed to be composed of photons originating at the light sources and moving within the environment, possibly getting scattered by the medium and refracted or reflected by the objects in the environment until they are eventually absorbed. Using Monte Carlo methods for simulating the behaviour and keeping track of a sufficiently large sample of photons in the environment, illumination effects can be estimated. In this paper we first describe the algorithm used for Monte Carlo simulation and show how the results are used for computing global illumination effects and for synthesising realistic images. A distinctive feature of the algorithm is that as the simulation progresses, with increasing number of samples, the computed illumination is progressively refined. A detailed comparative performance analysis with a straightforward implementation of the radiosity method shows that the results are equally good and the computation times comparable. The major advantages over the other well established methods of ray tracing and radiosity stem from the fact that complex environmental behaviour can be more easily accommodated. In particular we discuss techniques for dealing with complex extended light sources and large unevenly lighted surfaces without any need for apriori discretisation, and the issues related to the rendering of non diffuse environments. Finally we describe a variation in the simulation algorithm for variance reduction and compare the results with the earlier algorithm. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> James Arvo and David Kirk. </author> <title> Particle transport and image synthesis. </title> <booktitle> Computer Graphics (SIGGRAPH '90 Proceedings), </booktitle> <volume> 24(4) </volume> <pages> 63-66, </pages> <month> Aug. </month> <year> 1990. </year>
Reference-contexts: As has been shown in other disciplines such as the Neutron transport [12] or Heat Transfer [9], such simulations are best carried out using Monte Carlo methods. Although in Computer Graphics, Monte Carlo methods have been applied to stochastic ray tracing and to find solutions to the rendering equation <ref> [10, 4, 1] </ref> it is only in [15] that there is some reference to its use for computing illumination but the primary emphasis is on time complexity analysis.
Reference: [2] <author> Michael Cohen and Donald P. Greenberg. </author> <title> The hemi-cube: A radiosity solution for complex environments. </title> <booktitle> Computer Graphics (SIGGRAPH '85 Proceedings), </booktitle> <volume> 19(3) </volume> <pages> 31-40, </pages> <month> Aug. </month> <year> 1985. </year>
Reference-contexts: If the main purpose of the simulation is image synthesis then the process can be terminated when visually satisfactory results have been arrived at. 2.3 Comparison with Radiosity Method For comparison purposes, we have carried out a simple implementation of Full Radiosity solution using the hemicube method <ref> [2] </ref> for form-factor computation and the iterative matrix solution method for carrying out final radiosity computation to produce radiosity values over the surface patches in the environment.
Reference: [3] <author> Michael Cohen, Donald P. Greenberg, Dave S. Immel, and Philip J. Brock. </author> <title> An efficient radiosity approach for realistic image synthesis. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 6(3) </volume> <pages> 26-35, </pages> <month> March </month> <year> 1986. </year> <month> 21 </month>
Reference-contexts: Greenberg 13 et al <ref> [3] </ref> do suggest a technique of repeatedly determining the illumination and using the results for adaptive discretisation. However the technique does not always guarantee success in capturing the gradient accurately.
Reference: [4] <author> R. L. Cook. </author> <title> Stochastic sampling in computer graphics. </title> <journal> ACM Transac--tions on Graphics, </journal> <volume> 5(1) </volume> <pages> 51-72, </pages> <month> Jan. </month> <year> 1986. </year>
Reference-contexts: As has been shown in other disciplines such as the Neutron transport [12] or Heat Transfer [9], such simulations are best carried out using Monte Carlo methods. Although in Computer Graphics, Monte Carlo methods have been applied to stochastic ray tracing and to find solutions to the rendering equation <ref> [10, 4, 1] </ref> it is only in [15] that there is some reference to its use for computing illumination but the primary emphasis is on time complexity analysis.
Reference: [5] <author> James D. Foley, Andries van Dam, Steven K. Feiner, and John F. Hughes. </author> <title> Computer Graphics, Principles and Practice, Second Edition. </title> <publisher> Addison-Wesley, </publisher> <year> 1990. </year>
Reference-contexts: Any of the established techniques of scan conversion, subdivision (dicing) or ray tracing could be used for determining visible parts <ref> [5] </ref>.
Reference: [6] <author> Andrew Glassner. </author> <title> An Introduction to Ray Tracing. </title> <publisher> Academic Press, </publisher> <year> 1989. </year>
Reference-contexts: Since the path of a photon is assumed straight, finding the nearest surface hit by the photon (step III.6.a) is done by carrying out ray-surface intersections which has been researched extensively in computer graphics <ref> [6] </ref>. Section 4 discusses the method of updating the outgoing flux (step III.4, III.6.c.i) on large and complex surfaces. <p> As the photon travels in a straight line during its flight, finding the nearest receiver, as stated earlier, amounts to computing ray-surface intersection. The ray tracing literature abounds with methods for ray-surface intersection for a large variety of surface shapes <ref> [6] </ref>. All such surfaces in principle can be therefore used as receivers in the simulation process. In our implementation, we have considered polygons, spheres, cylinders, cones and discs.
Reference: [7] <author> Cindy M. Goral, Kenneth E. Torrance, Donald P. Greenberg, and Ben-nett Battaile. </author> <title> Modelling the interaction of light between diffuse surfaces. </title> <booktitle> Computer Graphics (SIGGRAPH '84 Proceedings), </booktitle> <volume> 18(3) </volume> <pages> 212-222, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: The light source is assumed to be a point or a line and if more realistic appearance is called for then area sources are simulated by a large collection of points or lines. The very first treatment of real area geometry has been in the radiosity method <ref> [7] </ref>. The 8 radiosity method is based on computing geometric form factors between any two surfaces, which is the fraction of the light energy reaching one surface from the other.
Reference: [8] <author> Roy A. Hall. </author> <title> Illumination and Color in Computer Generated Imagery. </title> <publisher> Springer-Verlag, </publisher> <year> 1989. </year>
Reference-contexts: This illumination is aptly termed global illumination. That the accurate computation of global illumination leads to synthesis of more realistic images is by now well recognised in the field of computer graphics <ref> [8] </ref>. Throughout this paper we shall be concerned only with the particle model of light and its use for determining the global illumination in a complex three dimensional environment. <p> So far only spectral distribution is handled satisfactorily by the existing rendering methods. Though it is common practice to carry out the illumination computation only with red, green and blue wavelength strengths of the emitter, in principle, one can carry out the computation for more number of wavelengths <ref> [8] </ref>. The effects of extended light source geometry and anisotropic luminous intensity distribution cannot in general be determined by most of the existing methods. On the other hand Monte Carlo simulation is inherently capable of including the above effects.
Reference: [9] <author> J. R. Howell. </author> <title> Application of monte carlo to heat transfer problems. </title> <booktitle> Advances in Heat Transfer, </booktitle> <volume> 5 </volume> <pages> 1-54, </pages> <year> 1968. </year>
Reference-contexts: As has been shown in other disciplines such as the Neutron transport [12] or Heat Transfer <ref> [9] </ref>, such simulations are best carried out using Monte Carlo methods. <p> We also discuss some issues related to rendering in the synthesis of images from the simulation results and end with a detailed analysis of a variation in the basic simulation algorithm for variance reduction used by many Monte Carlo programs <ref> [12, 9] </ref>. 2 The Monte Carlo Simulation Method 2.1 The Algorithm Throughout this paper we consider three dimensional environments consisting of light sources and other objects with the following assumptions: * The medium in the environment does not interact with the photons. * The objects are all opaque and are described <p> As evident from Table.3 the variation from this ideal value reduces with increasing number of samples and only by about a million samples is the ideal value almost reached. A variance reduction technique that is used by many Monte Carlo programs in other disciplines <ref> [12, 9] </ref> is based on the following idea: On every interaction instead of choosing to absorb the photon the photon's brightness contributing capacity (weight) is reduced and the photon is always allowed to continue. The photon starts with a weight of 1 from the source.
Reference: [10] <author> James T. Kajiya. </author> <title> The rendering equation. </title> <booktitle> Computer Graphics (SIG-GRAPH '86 Proceedings), </booktitle> <volume> 20(4) </volume> <pages> 143-150, </pages> <month> Aug. </month> <year> 1986. </year>
Reference-contexts: As has been shown in other disciplines such as the Neutron transport [12] or Heat Transfer [9], such simulations are best carried out using Monte Carlo methods. Although in Computer Graphics, Monte Carlo methods have been applied to stochastic ray tracing and to find solutions to the rendering equation <ref> [10, 4, 1] </ref> it is only in [15] that there is some reference to its use for computing illumination but the primary emphasis is on time complexity analysis. <p> Ray tracing has also been extended to handle diffuse reflectance property but at the expense of heavy increases in computation time <ref> [10, 19] </ref>. The Radiosity method on the other hand can basically handle diffuse reflectance property accurately. It has also been extended to handle pure specular reflectance behaviour. However, there are two very basic assumptions in the Radiosity method. 1. The surface patches have uniform illumination. <p> This computation is based on the observation that the illumination of a surface which is not an emitter can be determined if the illumination of all the surrounding surfaces is known <ref> [10] </ref>. Any of the established techniques of scan conversion, subdivision (dicing) or ray tracing could be used for determining visible parts [5].
Reference: [11] <author> Malvin H. Kalos and Paula A. Whitlock. </author> <title> Monte Carlo Methods. Volume I. </title> <publisher> John Wiley & Sons, </publisher> <year> 1986. </year>
Reference-contexts: All assignments are done making random choices which over a sufficiently large sample would match the actual behaviour. Such assignments in Monte Carlo simulation are carried out by random sampling of the probability distribution functions (pdf) representing the behaviours <ref> [11] </ref>. Thus for example, the probability of a photon being associated with a more powerful light source is higher than its being associated with a light source of lesser power. Similarly the other assignments above, would all depend on the shape and emission properties of the emitter surface.
Reference: [12] <author> E. E. Lewis and W.F. Miller Jr. </author> <title> Computational Methods of Neutron Transport. </title> <publisher> John Wiley & Sons, </publisher> <year> 1984. </year>
Reference-contexts: As has been shown in other disciplines such as the Neutron transport <ref> [12] </ref> or Heat Transfer [9], such simulations are best carried out using Monte Carlo methods. <p> We also discuss some issues related to rendering in the synthesis of images from the simulation results and end with a detailed analysis of a variation in the basic simulation algorithm for variance reduction used by many Monte Carlo programs <ref> [12, 9] </ref>. 2 The Monte Carlo Simulation Method 2.1 The Algorithm Throughout this paper we consider three dimensional environments consisting of light sources and other objects with the following assumptions: * The medium in the environment does not interact with the photons. * The objects are all opaque and are described <p> As evident from Table.3 the variation from this ideal value reduces with increasing number of samples and only by about a million samples is the ideal value almost reached. A variance reduction technique that is used by many Monte Carlo programs in other disciplines <ref> [12, 9] </ref> is based on the following idea: On every interaction instead of choosing to absorb the photon the photon's brightness contributing capacity (weight) is reduced and the photon is always allowed to continue. The photon starts with a weight of 1 from the source. <p> If the photon survives the termination then the photon is allowed to continue with increased weight. The computational equivalent of the Russian Roulette <ref> [12] </ref> is to choose a predefined number N between 2 to 10. Once the weight of the photon reduces below a sufficiently small threshold a uniform random number ~ is generated. The photon is removed from the system only if ~ &gt; 1=N .
Reference: [13] <author> S.P. Mudur and S.N. Pattanaik. </author> <title> Multidimensional illumination functions for visualisation of complex 3d environments. </title> <journal> The Journal of Visualisation and Computer Animation, </journal> <volume> 1(2) </volume> <pages> 49-58, </pages> <year> 1990. </year>
Reference-contexts: differential patch at the center of the surface.) Therefore in the radiosity method all complex surfaces must be first subdivided and unless proper apriori subdivision of a nonuniformly lit surface is carried out, the illumination gradient over the surface will not be accurately captured (shadow boundaries could be completely missed) <ref> [13] </ref>. Greenberg 13 et al [3] do suggest a technique of repeatedly determining the illumination and using the results for adaptive discretisation. However the technique does not always guarantee success in capturing the gradient accurately.
Reference: [14] <author> S. N. Pattanaik and S. P. Mudur. </author> <title> Computation of global illumination in a participating medium by monte carlo simulation. </title> <journal> The Journal of Visualisation and Computer Animation, </journal> <note> To appear, 4, </note> <year> 1993. </year>
Reference-contexts: In this paper we discuss in detail the simulation for environments containing complex extended light sources and also large and complex reflecting surfaces. In a companion paper we are presenting our extensions of this method for dealing with environments with a participating medium <ref> [14] </ref>. 3 Complex Light Sources Light sources, i.e., emitters play a crucial role in the illumination of the environment. There are mainly three important characteristics of the emitter that influence the illumination [17]. <p> Thus environments with complex light sources or unevenly illuminated large and curved surfaces or with participating media <ref> [14] </ref> can be treated with greater flexibility, simplicity and speed. 8 Acknowledgements We are grateful to Dr S Ramani, Director, NCST for his support and encouragement. We thank Dr S Gopalsamy of NCST for clarifying some of the mathematical details in the derivation of position sampling equations.
Reference: [15] <author> Peter Shirley. </author> <title> Physically Based Lighting Calculations for Computer Graphics. </title> <type> PhD thesis, </type> <year> 1990. </year>
Reference-contexts: Although in Computer Graphics, Monte Carlo methods have been applied to stochastic ray tracing and to find solutions to the rendering equation [10, 4, 1] it is only in <ref> [15] </ref> that there is some reference to its use for computing illumination but the primary emphasis is on time complexity analysis. To the best of our knowledge ours is the first in depth study of the use of the Monte Carlo simulation for computing global illumination.
Reference: [16] <author> Jerome Spanier and Ely M. Gelbard. </author> <title> Monte Carlo Principles and Neutron Transport Problems. </title> <publisher> Addison-Wesley Publishing Company, </publisher> <year> 1969. </year> <month> 22 </month>
Reference: [17] <author> Channing P. Verbeck and Donald Greenberg. </author> <title> A comprehensive light--source description for computer graphics. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 4(3) </volume> <pages> 213-222, </pages> <year> 1984. </year>
Reference-contexts: There are mainly three important characteristics of the emitter that influence the illumination <ref> [17] </ref>. They are geometry (emitter surface shape), spectral distribution (emitter strength at different wavelengths) and luminous intensity distribution (emitter strength in different directions). Light source geometries are varied and determine the distribution of light in the environment and also control the nature of the shadows generated. <p> In most cases we make the assumption that the emission does not depend on the circumferential angle and hence intensity 11 distribution is specified only along the cone angle by goniometric diagrams <ref> [17] </ref>. In such a case can be sampled as = 2~ where ~ is a uniform random number chosen from the range 0 and 1 and is sampled by Rejection Sampling (cf Appendix) of the Goniometer Curve.
Reference: [18] <author> John R. Wallace, Michael F. Cohen, and Donald P. Greenberg. </author> <title> A two-pass solution to the rendering equation: A synthesis of ray tracing and radiosity methods. </title> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> 21(4) </volume> <pages> 311-320, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: However, once it is established that through a particular pixel a non diffuse surface is visible then from that surface, intensity in the view direction must be estimated. * If we assume that non-diffuse surfaces are ideal specular surfaces i.e. mirrors, then the technique used in <ref> [18] </ref> could be adopted. A ray in the direction mirroring the view direction is shot. If the nearest surface in that direction is a diffuse surface then the illumination is known.
Reference: [19] <author> Gregory J. Ward, Francis M. Rubinstein, and Robert D. </author> <title> Clear. A ray tracing solution for diffuse interreflection. </title> <booktitle> Computer Graphics (SIG-GRAPH '88 Proceedings), </booktitle> <volume> 22(4) </volume> <pages> 85-92, </pages> <month> Aug. </month> <year> 1988. </year>
Reference-contexts: Ray tracing has also been extended to handle diffuse reflectance property but at the expense of heavy increases in computation time <ref> [10, 19] </ref>. The Radiosity method on the other hand can basically handle diffuse reflectance property accurately. It has also been extended to handle pure specular reflectance behaviour. However, there are two very basic assumptions in the Radiosity method. 1. The surface patches have uniform illumination.
Reference: [20] <author> David R. Warn. </author> <title> Light control for synthetic images. </title> <booktitle> Computer Graphics (SIGGRAPH '83 Proceedings), </booktitle> <volume> 17(3) </volume> <pages> 13-22, </pages> <year> 1983. </year> <month> 23 </month>
Reference-contexts: Assuming point light sources, extensions have been proposed in the published literature to support emission in a small range of directions or to support emission following a cosine law for attenuation <ref> [20] </ref>. However, we are not aware of any such extensions to the radiosity method which deals with area light sources. Just as in the case of complex light source geometry, directional intensity distribution can also be supported quite easily in Monte Carlo simulation.
References-found: 20

