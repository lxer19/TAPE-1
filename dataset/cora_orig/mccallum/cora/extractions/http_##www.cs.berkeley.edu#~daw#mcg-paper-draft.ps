URL: http://www.cs.berkeley.edu/~daw/mcg-paper-draft.ps
Refering-URL: http://www.cs.berkeley.edu/~daw/me.html
Root-URL: 
Title: The Security of MacGuffin  
Author: David A. Wagner 
Abstract: This paper examines MacGuffin, a recently proposed block cipher based on a new DES-like architecture. The strength of MacGuffin against differential cryptanalysis is investigated: DES is more resistant to these attacks. A differential attack requiring 2 51:5 chosen plaintexts is described. In addition, the internal components of MacGuffin are shown to be sub-optimal with respect to differential cryptanalysis. Finally, a weakness in the key schedule is discussed.
Abstract-found: 1
Intro-found: 1
Reference: 1. <author> Matt Blaze and Bruce Schneier. </author> <title> The MacGuffin block cipher algorithm. </title> <editor> In Bart Preneel, editor, </editor> <title> Fast Software Encryption: </title> <booktitle> Proceedings of K. U. Leuven Workshop on Algorithms. </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995. </year> <note> (to appear). </note>
Reference-contexts: Blaze and Schneier have proposed a variation on the basic DES design. Their generalized unbalanced Feistel network (GUFN) splits the block unevenly. To illustrate the power of this model and incite debate on its merits, Blaze and Schneier have offered an example design called MacGuffin <ref> [1] </ref>. The most conspicuous disadvantage of a GUFN is that each round modifies less than half of the block. One MacGuffin round affects just 16 bits, yet DES alters 32 bits of the block. <p> One MacGuffin round affects just 16 bits, yet DES alters 32 bits of the block. For these reasons, Blaze and Schneier hypothesize that two rounds of MacGuffin should yield at least the strength of one DES round <ref> [1] </ref>. Their hypothesis is central to the security of MacGuffin. This paper presents an overview of several attacks on MacGuffin, rather than specifying the methods in great detail. <p> It is interesting to examine whether other MacGuffin-like designs might improve its resistance to differential cryptanalysis. One possibility is to investigate different choices of the input permutation. Blaze and Schneier list five design criteria used to direct f inputs to the S- box inputs <ref> [1] </ref>; most are straightforward adoptions of the DES design rules or logical new principles specific to GUFNs. Examination of the MacGuffin input permutation suggests that Blaze and Schneier probably followed another design rule (though [1] never mentions it): P6 No S-box in any round sends both its output bits to any <p> and Schneier list five design criteria used to direct f inputs to the S- box inputs <ref> [1] </ref>; most are straightforward adoptions of the DES design rules or logical new principles specific to GUFNs. Examination of the MacGuffin input permutation suggests that Blaze and Schneier probably followed another design rule (though [1] never mentions it): P6 No S-box in any round sends both its output bits to any one S-box in any other round. One omission is noteworthy: Blaze and Schneier avoided an explicit expansion box.
Reference: 2. <author> David Wagner. </author> <title> The security of MacGuffin. </title> <type> Senior thesis, </type> <institution> Princeton University, </institution> <year> 1995. </year> <note> Available for anonymous ftp on the Internet from ftp.princeton.edu as /pub/dawagner/crypto/me/senior-thesis.ps. </note>
Reference-contexts: Their hypothesis is central to the security of MacGuffin. This paper presents an overview of several attacks on MacGuffin, rather than specifying the methods in great detail. See <ref> [2] </ref> for a more comprehensive discussion of these topics. 2 Preliminary analysis To compare the strength of DES and MacGuffin, one can first examine reduced- round variants of the two block ciphers with a variety of standard statistical tests. Table 1 summarizes the results of this investigation.
Reference: 3. <author> Alan G. Konheim. </author> <title> Cryptography: A Primer. </title> <publisher> John Wiley and Sons, </publisher> <address> New York, </address> <year> 1981. </year>
Reference-contexts: MacGuffin Test Rounds to pass Comments DES MacGuffin avalanche 6 14 strict avalanche 6 13 consistent with above test up to limits of statistical significance key-dependence 6 5 MacGuffin passes so quickly because avalanche of its non-linear key schedule sequence complexity 5 10 binary derivatives 5 10 bit dependencies 5 <ref> [3] </ref> 9 cycle lengths y y complexity of exhaustive testing too large to be practical small subgroup z z complexity of testing MacGuffin too large to be practical Notes: y DES passes limited cycling tests [3]; MacGuffin passed a limited cycling test too. z DES does not generate a small subgroup <p> its non-linear key schedule sequence complexity 5 10 binary derivatives 5 10 bit dependencies 5 <ref> [3] </ref> 9 cycle lengths y y complexity of exhaustive testing too large to be practical small subgroup z z complexity of testing MacGuffin too large to be practical Notes: y DES passes limited cycling tests [3]; MacGuffin passed a limited cycling test too. z DES does not generate a small subgroup [4]; MacGuffin's status is unknown. statistical regularities detected by the strict avalanche test to break MacGuffin- 16.
Reference: 4. <author> Keith W. Campbell and Michael J. Wiener. </author> <title> DES is not a group. </title> <booktitle> In Advances in Cryptology: CRYPTO '92, </booktitle> <pages> pages 512-520. </pages> <publisher> Springer-Verlag, </publisher> <year> 1992. </year>
Reference-contexts: 9 cycle lengths y y complexity of exhaustive testing too large to be practical small subgroup z z complexity of testing MacGuffin too large to be practical Notes: y DES passes limited cycling tests [3]; MacGuffin passed a limited cycling test too. z DES does not generate a small subgroup <ref> [4] </ref>; MacGuffin's status is unknown. statistical regularities detected by the strict avalanche test to break MacGuffin- 16.
Reference: 5. <author> David Chaum and Jan-Hendrik Evertse. </author> <title> Cryptanalysis of DES with a reduced number of rounds. </title> <booktitle> In Advances in Cryptology: CRYPTO '85, </booktitle> <pages> pages 192-211. </pages> <publisher> Springer-Verlag, </publisher> <year> 1986. </year>
Reference-contexts: The cryptographic literature documents a great variety of elementary attacks on DES, so there is no lack of ideas to try. Notably, MacGuffin has no obvious complementation properties to speed up exhaustive search, and is immune from Chaum and Evertse's meet-in-the-middle attack <ref> [5] </ref> after more than 6 rounds. MacGuffin is about as resistant as DES against most other elementary attacks. Still, two slightly more sophisticated statistical attacks penetrated reduced- round variants of MacGuffin successfully enough to be worrisome. The first uses Table 1.
Reference: 6. <author> D. Davies and S. Murphy. </author> <title> Pairs and triplets of DES S-boxes. </title> <journal> Journal of Cryptology, </journal> <volume> 8(1) </volume> <pages> 1-25, </pages> <month> Winter </month> <year> 1995. </year>
Reference-contexts: The second attack takes advantage of correlations caused when S-boxes in nearby rounds share input bits. (This approach appears to be similar to a recently published attack on DES which exploits duplicated input bits at neighboring S-boxes in one round <ref> [6] </ref>.) In both cases, the statistical regularities seem more pronounced in MacGuffin than DES, so some reduced-round variants of MacGuffin are more vulnerable than those of DES.
Reference: 7. <author> Eli Biham and Adi Shamir. </author> <title> Differential Cryptanalysis of the Data Encryption Standard. </title> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1993. </year>
Reference-contexts: These experiments found that MacGuffin admits a 4 round iterative characteristic with probability 1=148:9. This characteristic is shown in full detail in Figure 1. In comparison, the best DES iterative characteristic has 2 rounds and probability 1=234 <ref> [7] </ref>. <p> In comparison, the best differential attack on DES with independent subkeys requires approximately 2 60 chosen plaintexts and very little memory <ref> [7, p. 68] </ref>. (There is an improved attack on vanilla DES with dependent round subkeys [8], but it succeeds only by taking advantage of the linear DES key schedule, so MacGuffin is best compared to DES with independent round subkeys.) In short, MacGuffin is no stronger than DES against a differential <p> In this case the total complexity of the attack will be reduced to approximately 2 59 operations, with negligible storage requirements. 3.4 Other issues If partial information about the first round subkey is available, we can often improve the probability of the first round of a characteristic <ref> [7, pp. 46-47] </ref>. For MacGuffin, the probability and S=N ratio of the iterative characteristic can be improved by a factor of about 1:4 if one bit of the first round subkey is known. <p> On the other hand, there is no way to take advantage of this enhancement if we bypass more than two rounds. The probability of a characteristic is often dependent on subkey values in later rounds as well <ref> [7, pp. 54-55] </ref>. Here, though, the MacGuffin characteristic has only a very weak key dependence. In the most extreme possible situation, the 4 round iterative characteristic could be improved by a factor of 1:02 1:05 1:05. <p> One omission is noteworthy: Blaze and Schneier avoided an explicit expansion box. This has dubious cryptographic merits|for example, Biham and Shamir found that removing the E box weakens DES by about 9 orders of magnitude <ref> [7] </ref>. On the other hand, the GUFN structure may fulfill the same cryptographic function as the E box. One can also study other choices of S-boxes.
Reference: 8. <author> Eli Biham and Adi Shamir. </author> <title> Differential cryptanalysis of the full 16-round DES. </title> <booktitle> In Advances in Cryptology: CRYPTO '92. </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1993. </year>
Reference-contexts: The observed graceful degradation is reassuring (to the attacker!). 3.2 Attacking all 32 rounds To attack all 32 rounds of MacGuffin, bypass the first three rounds with the techniques of Biham and Shamir <ref> [8] </ref>, use a 3R attack, and cover the middle 26 rounds with repetitions of the 4 round iterative characteristic from Figure 1. The characteristic has probability 20 148:9 6 64 Count on 54 round subkey bits. <p> In comparison, the best differential attack on DES with independent subkeys requires approximately 2 60 chosen plaintexts and very little memory [7, p. 68]. (There is an improved attack on vanilla DES with dependent round subkeys <ref> [8] </ref>, but it succeeds only by taking advantage of the linear DES key schedule, so MacGuffin is best compared to DES with independent round subkeys.) In short, MacGuffin is no stronger than DES against a differential attack. 3.3 An attack based on a key schedule weakness If memory is at a
Reference: 9. <author> Xiejia Lai, James L. Massey, and Sean Murphy. </author> <title> Markov ciphers and differen-tial cryptanalysis. </title> <booktitle> In Advances in Cryptology: EUROCRYPT '91, </booktitle> <pages> pages 17-38. </pages> <publisher> Springer-Verlag, </publisher> <year> 1991. </year>
Reference-contexts: This leads to a total improvement in the probability and the S=N ratio by at most a factor of 2:0 even if all round subkeys are favorable. Since this event occurs with probability 2 18 , the key dependence is essentially negligible. Lai, Massey, and Murphy <ref> [9] </ref> have studied the propagation of differential characteristics, modeling them as Markov chains.
Reference: 10. <author> Vincent Rijmen and Bart Preneel. </author> <title> Cryptanalysis of McGuffin. </title> <editor> In Bart Preneel, editor, </editor> <title> Fast Software Encryption: </title> <booktitle> Proceedings of K. U. Leuven Workshop on Algorithms. </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995. </year> <note> (to appear). </note>
Reference: 11. <author> Vincent Rijmen and Bart Preneel. </author> <title> Cryptanalysis of McGuffin, </title> <note> 1995. (a corrected version of [10]). </note>
Reference-contexts: Lai, Massey, and Murphy also propose a design principle for block ciphers: The transition probability matrix of a Markov cipher should not be sym <p>- metric. MacGuffin passes this design criterion after 11 rounds. 3.5 Related research Rijmen and Preneel <ref> [11] </ref> independently found the iterative characteristic depicted in Figure 1 and showed that MacGuffin is no stronger than DES. They also demonstrated that MacGuffin is susceptible to linear cryptanalysis, though not quite so vulnerable as DES. <p> Rijmen and Preneel have examined other subsets of output bits from the DES S-boxes, and found that the MacGuffin choices are sub-optimal <ref> [11] </ref>. Table 2.
Reference: 12. <author> D. Coppersmith. </author> <title> The Data Encryption Standard (DES) and its strength against attacks. </title> <journal> IBM J. Res. Develop., </journal> <volume> 38(3) </volume> <pages> 243-250, </pages> <month> May </month> <year> 1994. </year>
Reference-contexts: In contrast, DES was apparently designed with immunity to differential cryptanalysis in mind at every stage of the design <ref> [12] </ref>. It is interesting to examine whether other MacGuffin-like designs might improve its resistance to differential cryptanalysis. One possibility is to investigate different choices of the input permutation. <p> The MacGuffin S-boxes are just truncated DES S-boxes; much literature is available on design rules for creating DES-like S-boxes, so it is convenient to generate new DES-like S-boxes and truncate them. These experiments followed S-1, S-2, S-3, S-4, and S-7 from Coppersmith's account of the DES design process <ref> [12] </ref>; his other criteria were relevant only to the carefully balanced machinery in DES and appear to be of limited value to MacGuffin. <p> Because of these problematic weaknesses, long-term use of MacGuffin is not recommended. On the other hand, MacGuffin is just one particular incarnation of the more general GUFN structure. DES was carefully crafted so all components would mesh together to provide the maximum security possible <ref> [12] </ref>; perhaps the GUFN architecture could reap substantial benefits from this kind of meticulous attention to detail. 7 Acknowledgements I would like to extend my gratitude to Steve Bellovin for proposing this research topic and offering many helpful suggestions; his kindness is appreciated.
Reference: 13. <author> Robert Winternitz and Martin Hellman. </author> <title> Chosen-key attacks on a block cipher. </title> <journal> Cryptologia, </journal> <volume> XI(1):16-20, </volume> <month> January </month> <year> 1987. </year>
Reference-contexts: Table 3. Average-case complexity of deducing K given a round subkey Round Encryptions 1 2 80 3 2 97 5-32 2 127 5.4 Inverting the key schedule with related keys Several authors have introduced the idea of related key cryptanalysis <ref> [13, 14] </ref>. Suppose we are allowed 2 t (t &lt; 64) related key chosen plaintext queries, and we wish to speed up inversion of the key schedule.
Reference: 14. <author> Eli Biham. </author> <title> New types of cryptanalytic attacks using related keys. </title> <booktitle> In Advances in Cryptology: EUROCRYPT '93, </booktitle> <pages> pages 398-409. </pages> <publisher> Springer-Verlag, </publisher> <year> 1994. </year> <title> This article was processed using the L a T E X macro package with LLNCS style </title>
Reference-contexts: Table 3. Average-case complexity of deducing K given a round subkey Round Encryptions 1 2 80 3 2 97 5-32 2 127 5.4 Inverting the key schedule with related keys Several authors have introduced the idea of related key cryptanalysis <ref> [13, 14] </ref>. Suppose we are allowed 2 t (t &lt; 64) related key chosen plaintext queries, and we wish to speed up inversion of the key schedule.
References-found: 14

