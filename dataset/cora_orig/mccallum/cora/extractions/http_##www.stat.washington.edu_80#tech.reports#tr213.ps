URL: http://www.stat.washington.edu:80/tech.reports/tr213.ps
Refering-URL: http://www.stat.washington.edu:80/tech.reports/
Root-URL: 
Title: Model Selection and Accounting for Model Uncertainty in Graphical Models using Occam's Window  
Author: David Madigan and Adrian E. Raftery 
Date: July 14, 1992 Revised: June 22, 1993; October 10, 1993  
Affiliation: University of Washington  
Abstract: We consider the problem of model selection and accounting for model uncertainty in high-dimensional contingency tables, motivated by expert system applications. The approach most used currently is a stepwise strategy guided by tests based on approximate asymptotic P -values leading to the selection of a single model; inference is then conditional on the selected model. The sampling properties of such a strategy are complex, and the failure to take account of model uncertainty leads to underestimation of uncertainty about quantities of interest. In principle, a panacea is provided by the standard Bayesian formalism which averages the posterior distributions of the quantity of interest under each of the models, weighted by their posterior model probabilities. Furthermore, this approach is optimal in the sense of maximising predictive ability. However, this has not been used in practice because computing the posterior model probabilities is hard and the number of models is very large (often greater than 10 11 ). We argue that the standard Bayesian formalism is unsatisfactory and we propose an alternative Bayesian approach that, we contend, takes full account of the true model uncertainty by averaging over a much smaller set of models. An efficient search algorithm is developed for finding these models. We consider two classes of graphical models that arise in expert systems: the recursive causal models and the decomposable fl David Madigan is Assistant Professor of Statistics and Adrian E. Raftery is Professor of Statistics and Sociology, Department of Statistics, GN-22, University of Washington, Seattle, WA 98195. Madigan's research was partially supported by the Graduate School Research Fund, University of Washington and by the NSF. Raftery's research was supported by ONR Contract no. N-00014-91-J-1074. The authors are grateful to Gregory Cooper, Leo Goodman, Shelby Haberman, David Hinkley, Graham Upton, Jon Wellner, Nanny Wermuth, Jeremy York, Walter Zucchini and two anonymous referees for helpful comments and discussions, and to Michael R. Butler for providing the data for the scrotal swellings example. 
Abstract-found: 1
Intro-found: 1
Reference: <author> Anderson, L.R., Krebs, J.H. and Anderson J.D. </author> <title> (1991) STENO : An expert system for medical diagnosis based on graphical models and model search. </title> <journal> Journal of Applied Statistics, </journal> <volume> 18, </volume> <pages> 139-153. </pages>
Reference: <author> Berger, J.O. and Delampady, M. </author> <title> (1987) Testing precise hypotheses (with Discussion). </title> <journal> Statistical Science, </journal> <volume> 2, </volume> <pages> 317-352. </pages>
Reference: <author> Berger, J.O. and Sellke, T. </author> <title> (1987) Testing a point null hypothesis: The irreconcilability of P values and evidence (with Discussion). </title> <journal> Journal of the American Statistical Association 82, </journal> <pages> 112-139. </pages>
Reference: <author> Bishop, Y.M.M., Fienberg, S.E. and Holland, P.W. </author> <title> (1975) Discrete Multivariate Analysis. </title> <address> Cam--bridge, Mass.: </address> <publisher> MIT Press. </publisher>
Reference: <author> Chaloner, K.M. and Duncan G.T. </author> <title> (1987) Some properties of the Dirichlet-Multinomial distribution and its use in prior elicitation. Communications in Statistics-Theory and Methods, </title> <publisher> 16,511-523. </publisher>
Reference: <author> Cooper, G.F. and Herskovits, E. </author> <title> (1992) A Bayesian method for the induction of probabilistic networks from data. Machine Learning, </title> <publisher> 9,309-347. </publisher>
Reference: <author> Critchlow, D.E. </author> <title> (1985) Metric Methods for Analyzing Partially Ranked Data, </title> <publisher> Springer-Verlag. </publisher>
Reference: <author> Dawid, </author> <title> A.P. </title> <journal> (1984) Statistical theory-The prequential approach Journal of the Royal Statistical Society (Series A), 147,278-292. </journal>
Reference: <author> Dawid, </author> <title> A.P. (1986) Probability Forecasting. </title> <journal> In Encyclopedia of Statistical Sciences, </journal> <volume> Volume 7, </volume> <editor> (ed. Kotz, S. and Johnson, N.L.). </editor> <publisher> Wiley: </publisher> <address> New York. </address> <pages> 210-218. </pages>
Reference: <author> Dawid, A.P. and Lauritzen, </author> <title> S.L. (1993) Hyper-Markov laws in the statistical analysis of decomposable graphical models. </title> <journal> Annals of Statistics, </journal> <note> to appear. </note>
Reference: <author> Edwards, D. </author> <title> (1990) Hierarchical mixed interaction models. </title> <journal> Journal of the Royal Statistical Society (Series B), 52,3-20. </journal>
Reference: <author> Edwards, D. and Havranek, T. </author> <title> (1985) A fast procedure for model search in multidimensional contingency tables. </title> <journal> Biometrika, </journal> <volume> 72 ,339-351. </volume>
Reference: <author> Evett, I.W. </author> <title> (1991) Implementing Bayesian methods in forensic science. </title> <booktitle> Paper presented to the Fourth Valencia International Meeting on Bayesian Statistics. </booktitle>
Reference: <author> Fenech, A. and Westfall, P. </author> <title> (1988) The power function of conditional log-linear model tests. </title> <journal> Journal of the American Statistical Association, 83,198-203. </journal>
Reference-contexts: Inference about the quantities of interest is then made conditionally on the selected model. There are several difficulties with this approach. The sampling properties of the overall strategy are complex because it involves multiple tests and, at least implicitly, the comparison of non-nested models <ref> (Fenech and Westfall, 1988) </ref>. The use of P -values themselves is controversial, even when there are only two models to be compared, because of the so-called "conflict between P -values and evidence" discussed by Berger and Sellke (1987) and Berger and Delampady (1987).
Reference: <author> Fowlkes, E.B., Freeny, A.E. and Landwehr, J.M. </author> <title> (1988) Evaluating logistic models for large contingency tables. </title> <journal> Journal of the American Statistical Association, 83,611-622. </journal>
Reference: <author> Frydenberg, M. and Lauritzen, </author> <title> S.L. (1989) Decomposition of maximum likelihood in mixed graphical interaction models. </title> <journal> Biometrika, 76,539-555. </journal>
Reference: <author> Gabriel, K.R. </author> <title> (1969) Simultaneous test procedures|Some theory of multiple comparisons. </title> <journal> Annals of Mathematical Statistics, 40,224-250. </journal>
Reference: <author> Glymour, C., Scheines, R., Spirtes, P. and Kelly, K. </author> <title> (1987) Discovering Causal Structure. </title> <address> New York: </address> <publisher> Academic Press. </publisher>
Reference: <author> Gokhale, D.V. and Kullback, S. </author> <title> (1978) The Information in Contingency Tables. </title> <address> New York: </address> <publisher> Marcel Dekker. </publisher>
Reference: <author> Good, I.J. </author> <title> (1952) Rational Decisions. </title> <journal> Journal of the Royal Statistical Society (Series B), 14,107-114. </journal>
Reference: <author> Goodman, L.A. </author> <title> (1970) The multivariate analysis of qualitative data: Interaction among multiple classifications. </title> <journal> Journal of the American Statistical Association, 65,226-256. </journal>
Reference: <author> Goodman, L.A. </author> <title> (1971) The analysis of multidimensional contingency tables: Stepwise procedures and direct estimation methods for building models for multiple classifications. </title> <booktitle> Tech-nometrics 13, </booktitle> <pages> 33-61. </pages>
Reference: <author> Goodman, L.A. </author> <title> (1973) Guided and unguided methods for the selection of models for a set of T multidimensional contingency tables. </title> <journal> Journal of the American Statistical Association, 68,165-175. </journal>
Reference: <author> Haberman, S.J. </author> <title> (1974) The Analysis of Frequency Data. IMS Monographs, </title> <publisher> University of Chicago Press. </publisher>
Reference: <author> Havranek, T. </author> <title> (1984) A procedure for model search in multidimensional contingency tables. Biometrics, </title> <publisher> 40,95-100. </publisher>
Reference: <author> Hodges, J.S. </author> <title> (1987) Uncertainty, policy analysis and statistics (with Discussion). </title> <booktitle> Statistical Science 2, </booktitle> <pages> 259-291. </pages>
Reference-contexts: This underestimation can be large, as was shown by Regal and Hook (1991) in the contingency table context and by Miller (1984) in the regression context. One bad consequence is that it can lead to decisions that are too risky <ref> (Hodges, 1987) </ref>. In principle, the standard Bayesian formalism provides a panacea for all these difficulties.
Reference: <author> Jeffreys, H. </author> <title> (1961) Theory of Probability. </title> <publisher> (3rd ed.), Oxford University Press. </publisher>
Reference-contexts: involving a larger number of nodes or where the elicitation of link probabilities is not possible, we could assume that the "evidence" in favour of each link included by the expert (s)/data analyst (s) in the elicited qualitative structure (s) is "substantial" or "strong" but not "very strong" or "decisive" <ref> (Jeffreys, 1961) </ref>.
Reference: <author> Kass, R.E. and Raftery, A.E. </author> <year> (1993). </year> <title> Bayes factors and model uncertainty. </title> <type> Technical Report no. 254, </type> <institution> Department of Statistics, University of Washington. </institution> <note> Submitted for publication to Journal of the American Statistical Association. </note>
Reference: <author> Kotz, S. and Johnson, </author> <title> N.L. </title> <editor> (eds.) </editor> <year> (1985). </year> <journal> Encyclopedia of Statistical Sciences, </journal> <volume> Volume 6, </volume> <pages> 578-579. </pages>
Reference-contexts: Occam's razor states that if: pr (H 1 jE) = pr (H 2 jE) = ::: = pr (H k jE) for hypotheses H 1 ; :::; H k , then the simplest among H 1 ; :::; H k is to be preferred <ref> (Kotz and Johnson, 1985) </ref>.
Reference: <author> Kiiveri, H., </author> <title> Speed, T.P. and Carlin, J.B. (1984) Recursive causal models. </title> <journal> Journal of the Aus-tralian Mathematical Society (Series A), 36,30-52. </journal>
Reference: <author> Kreiner, S. </author> <title> (1987) Analysis of multidimensional contingency tables by exact conditional tests: techniques and strategies. </title> <journal> Scandinavian Journal of Statistics, 14,97-112. </journal>
Reference: <author> Lauritzen, S.L. and Spiegelhalter, </author> <title> D.J. (1988) Local computations with probabilities on graphical structures and their application to expert systems (with discussion). </title> <journal> Journal of the Royal Statistical Society (Series B), 50,157-224. </journal>
Reference-contexts: Here we consider two classes of graphical models: the recursive causal models of Kiiveri et al. (1984) and the decomposable log-linear models introduced by Goodman (1970) and Haberman (1974). This work is motivated by applications in expert systems which use a belief network to represent knowledge and perform inference <ref> (Lauritzen and Spiegelhalter, 1988) </ref>. These are the two model classes that arise in such applications. Potentially the most important advantage of constructing expert systems in this fashion is the system's ability to modify itself as data becomes available.
Reference: <author> Linhart, H. and Zucchini, W. </author> <title> (1986) Model Selection. </title> <address> New York: </address> <publisher> Wiley. </publisher>
Reference: <author> Madigan, D. and Raftery, A.E. </author> <title> (1991) Model selection and accounting for model uncertainty in graphical models using Occam's window. </title> <type> Technical Report no. 213, </type> <institution> Department of Statistics, University of Washington. </institution>
Reference: <author> Miller, A.J. </author> <title> (1984) Selection of subsets of regression variables (with Discussion). </title> <journal> Journal of the Royal Statistical Society (Series A), </journal> <volume> 147, </volume> <pages> 389-425. </pages>
Reference: <author> Moulton, B.R. </author> <title> (1991) A Bayesian approach to regression selection and estimation with applica 31 tion to a price index for radio services. </title> <journal> Journal of Econometrics, </journal> <volume> 49, </volume> <pages> 169-193. </pages>
Reference: <author> Pearl, J. and Verma,T.S. </author> <title> (1991) A theory of inferred causation. In Knowledge Representation and Reasoning: </title> <booktitle> Proceedings of the Second International Conference, </booktitle> <editor> (eds. J.A. Allen, Fikes, R. and Sandewall, E.). </editor> <publisher> Morgan Kaufmann: </publisher> <address> San Mateo. </address> <pages> 441-452. </pages>
Reference-contexts: If v i precedes v j in the ordering, then a directed link from v j to v i is prohibited. In certain applications it may be possible to search over all possible orderings but this will typically not be the case. Pearl's IC-algorithm <ref> (Pearl and Verma, 1991) </ref> induces directed "causal" structures from data.
Reference: <author> Raftery, A.E. </author> <title> (1986a) A note on Bayes factors for log-linear contingency table models with vague prior information. </title> <journal> Journal of the Royal Statistical Society (Series B), 48,249-250. </journal>
Reference-contexts: Subject Preference; maths/science or liberal arts; F. Future Plans; college or job; Upton (1991) reports that a model selection procedure based on the AIC criterion (Akaike, 1973) selects [ABCE][CDF ][BCD][DEF ] while a procedure based on the BIC criterion <ref> (Raftery, 1986a) </ref> selects the much simpler [A][BE][CE][CF ][BD][DE][DF ]. Clearly an important difference between these two models is the treatment of A. The Bayesian graphical model selection procedure started from the empty model and used the "Up" algorithm.
Reference: <author> Raftery, A.E. </author> <year> (1986b). </year> <title> Choosing models for cross-classifications. </title> <journal> American Sociological Review 51, </journal> <pages> 145-146. </pages>
Reference: <author> Raftery, A.E. </author> <year> (1988). </year> <title> Approximate Bayes factors for generalized linear models. </title> <type> Technical Report 121, </type> <institution> Department of Statistics, University of Washington. </institution>
Reference: <author> Raftery, A.E. </author> <year> (1993). </year> <title> Approximate Bayes factors and accounting for model uncertainty in generalized linear models. </title> <type> Technical Report no. </type> <month> 255, </month> <title> Department of Statistics, University of Washington. Submitted for publication to Applied Statistics. Regal and Hook (1991) The effects of model selection on confidence intervals for the size of a closed population. Statistics in Medicine 10, 717-721. Sakamoto (1984) Efficient use of Akaike's information criterion on high dimensional contingency table analysis. </title> <booktitle> Metron 40, </booktitle> <pages> 257-275. </pages>
Reference: <editor> Spiegelhalter, D.J. and Cowell, R.G. </editor> <booktitle> (1991) Learning in probabilistic expert systems. Paper presented to the Fourth Valencia International Meeting on Bayesian Statistics. </booktitle>
Reference: <author> Spiegelhalter, D.J. and Lauritzen, </author> <title> S.L. (1990a) Sequential updating of conditional probabilities on directed graphical structures. Networks, </title> <publisher> 20,579-605. </publisher>
Reference: <author> Spiegelhalter, D.J. and Lauritzen, </author> <title> S.L. (1990b) Techniques for Bayesian analysis in expert systems. </title> <journal> Annals of Mathematics and Artificial Intelligence, 2,353-366. </journal>
Reference: <author> Spiegelhalter, D.J. and Smith, A.F.M. </author> <title> (1982) Bayes factors for linear and log-linear models with vague prior information. </title> <journal> Journal of the Royal Statistical Society (Series B), 44,377-387. </journal>
Reference: <author> Upton, G.J.G. </author> <title> (1991) The exploratory analysis of survey data using log-linear models. The Statistician, </title> <publisher> 40,169-182. </publisher>
Reference-contexts: Initially it was also assumed that C (School Type) was exogenous. An exhaustive search over all consequent orderings produced the single model shown in The selected model is similar to the model selected by Upton's BIC procedure. The model selected by AIC clearly over-fits the data <ref> (Upton, 1991) </ref>. It is of interest to note the direction of the link from D to F . Both Upton (1991) and Fowlkes et al. (1988) treat D as a response variable and Upton's path diagram shows a directed link from F to D.
Reference: <author> Wermuth, N. </author> <title> (1976) Model search among multiplicative models. Biometrics, </title> <publisher> 32,253-263. </publisher>
Reference: <author> Wermuth, N. and Lauritzen, </author> <title> S.L. (1990) On substantive research hypotheses, conditional independence graphs and graphical chain models. </title> <journal> Journal of the Royal Statistical Society (Series B), 52,21-50. </journal>
Reference: <author> Whittaker, J. </author> <title> (1984) Fitting all possible decomposable and graphical models to multiway contingency tables. In Compstat 84, </title> <editor> (ed. T.Havranek et al.). </editor> <publisher> Physica-Verlag: Vienna. </publisher> <pages> 401-406. </pages>
Reference: <author> Whittaker, J. </author> <title> (1990) Graphical Models in Applied Multivariate Statistics. </title> <address> Chichester: </address> <publisher> Wiley. </publisher> <pages> 32 </pages>
References-found: 50

