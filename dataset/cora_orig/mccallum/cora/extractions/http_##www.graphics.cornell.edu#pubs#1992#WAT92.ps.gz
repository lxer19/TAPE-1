URL: http://www.graphics.cornell.edu/pubs/1992/WAT92.ps.gz
Refering-URL: http://www.graphics.cornell.edu/pubs/1992/WAT92.html
Root-URL: 
Title: Predicting Reflectance Functions from Complex Surfaces  
Author: Stephen H. Westin James R. Arvo Kenneth E. Torrance 
Keyword: CR Categories and Subject Descriptors: I3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism. Additional Key Words: spherical harmonics, Monte Carlo, anisotropic reflection, BRDF  
Address: Ithaca, New York 14853  
Affiliation: Program of Computer Graphics Cornell University  
Abstract: We describe a physically-based Monte Carlo technique for approximating bi-directional reflectance distribution functions (BRDFs) for a large class of geometries by directly simulating optical scattering. The technique is more general than previous analytical models: it removes most restrictions on surface microgeometry. Three main points are described: a new representation of the BRDF, a Monte Carlo technique to estimate the coefficients of the representation, and the means of creating a milliscale BRDF from microscale scattering events. These allow the prediction of scattering from essentially arbitrary roughness geometries. The BRDF is concisely represented by a matrix of spherical harmonic coefficients; the matrix is directly estimated from a geometric optics simulation, enforcing exact reciprocity. The method applies to roughness scales that are large with respect to the wavelength of light and small with respect to the spatial density at which the BRDF is sampled across the surface; examples include brushed metal and textiles. The method is validated by comparing with an existing scattering model and sample images are generated with a physically-based global illumination algorithm. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Cabral, B., Max, N., and Springmeyer, R., </author> <title> Bidirectional reflection functions from surface bump maps. </title> <booktitle> In Proceedings of SIGGRAPH '87 (July 27-31, 1987, Anaheim, Califor-nia), Computer Graphics 21, </booktitle> <month> 4 (July </month> <year> 1990), </year> <pages> 273-281. </pages>
Reference-contexts: Previous authors have used spherical harmonics to represent scattering functions [1,9,13], since they form a complete basis set of smooth functions over the sphere. Kajiya [9] used spherical harmonics to derive an analytical scattering function; Cabral et al. <ref> [1] </ref> and Sillion et al. [13] used them as a numerical approximation to the BRDF. <p> To account for variation of the BRDF with incident direction, the coefficient vector C in Equation 2 can be thought of as a function of the incident direction. If a sur face has isotropic roughness, as assumed in <ref> [1] </ref> and [13], the scattering function bd is independent of rotation about the surface normal. <p> We omit this implementation detail from the following discussion. As with a Fourier representation of a function, simply truncating all coefficients with index l &gt; l max will cause ringing in the approximation, called the Gibbs phenomenon. To reduce this, we attenuate higher frequencies, as did Cabral et al. <ref> [1] </ref>, by progressively reducing the magnitude of coefficients with l filter &lt; l &lt;= l max ; where l filter is an empirically-determined threshold. <p> One illustrative case is where the mi-crogeometry is composed of planar ideal specular surfaces; this is equivalent to geometric optics models based on micro-facets, such as the Torrance-Sparrow model [15]. We use ray tracing to model scattering events, as suggested by Cabral et al. <ref> [1] </ref>. The ray tracer must be carefully designed to assure physically accurate results. Each ray has a certain amount of energy associated with it; microscale reflection will attenuate this energy and perhaps divide it among multiple rays at each bounce.
Reference: [2] <author> Cook, R. L, and Torrance, K. E. </author> <title> A reflectance model for computer graphics, </title> <journal> ACM Transactions on Graphics 1, </journal> <volume> 1 (Jan-uary 1982), </volume> <pages> 7-24. </pages>
Reference-contexts: Non-physically-based local lighting models, such as that of Phong [12], although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Physically-based models <ref> [2, 5, 15] </ref> reproduce many effects better, but cannot Permission to copy without fee all or part of this material is granted provided that the copies are not made or distributed for direct commercial advantage, the ACM copyright notice and the title of the publication and its date appear, and notice
Reference: [3] <author> Gouraud, H. </author> <title> Continuous shading for curved surfaces. </title> <journal> IEEE Transactions on Computers 20, </journal> <month> 6 (June </month> <year> 1971), </year> <pages> 623-628. </pages>
Reference-contexts: 1 Introduction Since the earliest days of computer graphics, experimenters have recognized that the realism of an image is limited by the sophistication of the model of local light scattering <ref> [3, 12] </ref>. Non-physically-based local lighting models, such as that of Phong [12], although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations.
Reference: [4] <author> Hecht, E., and Zajac, A. </author> <title> Optics. </title> <publisher> Addison-Wesley, </publisher> <year> 1974. </year>
Reference-contexts: Whenever a ray encounters a smooth interface between media of different refractive indices, we must calculate the energy transfer through the interface. Neither energy flux density nor radiance is preserved at the interface <ref> [4] </ref>, since solid angles are altered, but the distribution of transmitted rays accounts for this.
Reference: [5] <author> He, X. D., Torrance, K. E., Sillion, F. X., and Greenberg, D. P. </author> <title> A comprehensive physical model for light reflection. </title> <booktitle> In Proceedings of SIGGRAPH '91 (July 28-August 2, 1991, </booktitle> <address> Las Vegas, Nevada), </address> <institution> Computer Graphics 25, </institution> <month> 4 (July </month> <year> 1991), </year> <pages> 175-186. </pages>
Reference-contexts: Non-physically-based local lighting models, such as that of Phong [12], although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Physically-based models <ref> [2, 5, 15] </ref> reproduce many effects better, but cannot Permission to copy without fee all or part of this material is granted provided that the copies are not made or distributed for direct commercial advantage, the ACM copyright notice and the title of the publication and its date appear, and notice <p> For a BRDF, bd is zero whenever i or r &gt; 2 : The BRDF can take on highly arbitrary shapes <ref> [5, 16] </ref>, so a very general method is needed to represent it. Fortunately, a BRDF is generally smooth, making it a good candidate for representation by smooth orthogonal functions. <p> We first consider a flat Gaussian-rough surface for which, at the microscale, the surface is an ideal specular reflector. We can compare the results of the new method with the results of an existing analytical model for such a surface <ref> [5] </ref>, thus giving some verification of the new technique. 5.1 Initial Verification: An Isotropic Surface Wave optics effects were not included, except for the Fresnel coefficient for each microfacet. <p> Results are plotted as solid lines in Figure 6 for incident angles i = 0 ffi ; 30 ffi ; 45 ffi ; 60 ffi ; 75 ffi : Dashed lines show results from the model of He <ref> [5] </ref>, which assumes a Gaussian rough surface and allows for wave optics effects. The He model is shown in the limit of large surface roughness ; where wave optics effects should be negligible.
Reference: [6] <author> Goral, C. M., Torrance, K. E., Greenberg, D. P., and Battaile, B. </author> <title> Modeling the interaction of light between diffuse surfaces. </title> <note> In Proceedings of SIGGRAPH '84 (July 23-27, 1984, </note> <institution> Minneapolis, Minnesota), Computer Graphics 18, </institution> <month> 3 (July </month> <year> 1984), </year> <pages> 213-222. </pages>
Reference-contexts: The advent of global illumination methods (e.g. <ref> [6, 18] </ref>) has created another concept of scale: these methods generally use a coarser characterization of scattering for indirect illumination, but demand careful attention to energy consistency and physical accuracy. The method of this paper is applicable wherever the BRDF is an adequate model of surface geometry.
Reference: [7] <author> Kajiya, J. </author> <title> The rendering equation. </title> <note> In Proceedings of SIGGRAPH '86 (August 18-22, 1986, </note> <institution> Dallas, Texas), Computer Graphics 20, </institution> <month> 4 (August </month> <year> 1986), </year> <pages> 143-150. </pages>
Reference-contexts: The new representation is concise and well-suited for use in rendering and global illumination calculations. The technique of [13] can be easily extended to accommodate the new representation. Its ease of evaluation suits it for other global illumination methods such as stochastic ray tracing <ref> [7] </ref>, [18] as well.
Reference: [8] <author> Kajiya, J. </author> <title> Anisotropic reflectance models. </title> <booktitle> In Proceedings of SIGGRAPH '85 (July 22-26, 1985, </booktitle> <address> San Francisco, Cali-fornia), </address> <institution> Computer Graphics 19, </institution> <month> 4 (July </month> <year> 1985), </year> <pages> 15-21. </pages>
Reference-contexts: To copy otherwise, or to republish, requires a fee and/or specific permission. model many surfaces, such as those with anisotropic roughness. Models that deal with anisotropic surfaces <ref> [8, 11] </ref> fail to assure physical consistency. This paper presents a new method of creating local scattering models. <p> The representation used makes it easy to enforce the basic physical property of scattering reciprocity, and its approximation does not require discretizing scattering directions as in the work of Kajiya <ref> [8] </ref> and Cabral et al.[1]. The method can predict scattering from any geometry that can be ray-traced: polygons, spheres, parametric patches, and even volume densities. Previous numerical techniques were limited to height fields, and analytical methods have been developed only for specific classes of surface geometry.
Reference: [9] <author> Kajiya, J., and Von Herzen, B. </author> <title> Ray tracing volume densities. </title> <note> In Proceedings of SIGGRAPH '84 (July 23-27, 1984, </note> <institution> Minneapolis, Minnesota), Computer Graphics 18, </institution> <month> 3 (July </month> <year> 1984), </year> <pages> 165-174. </pages>
Reference-contexts: Fortunately, a BRDF is generally smooth, making it a good candidate for representation by smooth orthogonal functions. Previous authors have used spherical harmonics to represent scattering functions [1,9,13], since they form a complete basis set of smooth functions over the sphere. Kajiya <ref> [9] </ref> used spherical harmonics to derive an analytical scattering function; Cabral et al. [1] and Sillion et al. [13] used them as a numerical approximation to the BRDF.
Reference: [10] <author> Kalos, M, H., and Whitlock, P. A. </author> <title> Monte Carlo Methods. </title> <publisher> John Wiley Sons, </publisher> <year> 1986. </year>
Reference-contexts: probability density function p (U; V ): If we define G k (U ) = N n=1 where V n are random samples distributed according to p; then the expected value of G k is C k (U ); G k is said to be an estimator of the integral <ref> [10] </ref>. The rays departing from the specimen in direction V will have mean attenuation hR (U; V )i ; this attenuation must be multiplied by Y k (V )=cos r to give the expected value g for the estimator.
Reference: [11] <author> Poulin, P., and Fournier, A. </author> <title> A model for anisotropic reflection. </title> <note> In Proceedings of SIGGRAPH '90 (August 6-10, 1990, </note> <institution> Dallas, Texas), Computer Graphics 24, </institution> <month> 4 (August </month> <year> 1990), </year> <pages> 273-282. </pages>
Reference-contexts: To copy otherwise, or to republish, requires a fee and/or specific permission. model many surfaces, such as those with anisotropic roughness. Models that deal with anisotropic surfaces <ref> [8, 11] </ref> fail to assure physical consistency. This paper presents a new method of creating local scattering models.
Reference: [12] <author> Phong, B-T. </author> <title> Illumination for computer generated pictures., </title> <journal> Communications of the ACM 18, </journal> <month> 6 (June </month> <year> 1975), </year> <pages> 311-317. </pages>
Reference-contexts: 1 Introduction Since the earliest days of computer graphics, experimenters have recognized that the realism of an image is limited by the sophistication of the model of local light scattering <ref> [3, 12] </ref>. Non-physically-based local lighting models, such as that of Phong [12], although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations. <p> 1 Introduction Since the earliest days of computer graphics, experimenters have recognized that the realism of an image is limited by the sophistication of the model of local light scattering [3, 12]. Non-physically-based local lighting models, such as that of Phong <ref> [12] </ref>, although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations.
Reference: [13] <author> Sillion, F. X., Arvo, J., Westin, S. H., and Greenberg, D. P. </author> <title> A global illumination solution for general reflectance distributions. </title> <booktitle> In Proceedings of SIGGRAPH '91 (July 28-August 2, 1991, </booktitle> <address> Las Vegas, Nevada), </address> <institution> Computer Graphics 25, </institution> <month> 4 (July </month> <year> 1991), </year> <pages> 187-196. </pages>
Reference-contexts: Previous authors have used spherical harmonics to represent scattering functions [1,9,13], since they form a complete basis set of smooth functions over the sphere. Kajiya [9] used spherical harmonics to derive an analytical scattering function; Cabral et al. [1] and Sillion et al. <ref> [13] </ref> used them as a numerical approximation to the BRDF. <p> To account for variation of the BRDF with incident direction, the coefficient vector C in Equation 2 can be thought of as a function of the incident direction. If a sur face has isotropic roughness, as assumed in [1] and <ref> [13] </ref>, the scattering function bd is independent of rotation about the surface normal. <p> By assuring that we compute a symmetric matrix M, we can enforce exact reciprocity; previous approaches [1,8,11,13] af forded, at best, approximate reciprocity. 2.5 Storage Reduction and Filtering The matrix M can be quite large; tens of thousands of elements are typical. Since our BRDF representation, like that of <ref> [13] </ref>, is based on spherical harmonics, we can adapt two techniques from that work to reduce the number of coefficients (and corresponding basis functions) needed: the first technique causes half the coefficients to vanish, and the second reduces the high-frequency content of the BRDF, reducing the number of coefficients needed to <p> All images shown in this section were generated by Monte Carlo ray tracing; the grainy texture of the images is caused by the Monte Carlo integration used to compute global illumination. Other global illumination and rendering techniques might have been used, such as that of Sillion et al. <ref> [13] </ref>. We first consider a flat Gaussian-rough surface for which, at the microscale, the surface is an ideal specular reflector. <p> BRDFs for complex surfaces can be simulated hierarchically by using the result of one simulation in generating the BRDF for the next larger scale. The new representation is concise and well-suited for use in rendering and global illumination calculations. The technique of <ref> [13] </ref> can be easily extended to accommodate the new representation. Its ease of evaluation suits it for other global illumination methods such as stochastic ray tracing [7], [18] as well.
Reference: [14] <author> Siegel, R., and Howell, J. R. </author> <title> Thermal Radiation Heat Transfer. </title> <publisher> Hemisphere Publishing, </publisher> <address> New York, </address> <year> 1981. </year>
Reference-contexts: basis functions evalu ated at (; ): 2.4 Reciprocity An important physical constraint on the BRDF is reciprocity, which states that bd ( i ; i ; r ; r ) = bd ( r ; r ; i ; i ) (9) for all angles of incidence and reflection <ref> [14] </ref>. If the matrix M is symmetric, then Y T ( i ; i )MY ( r ; r ) = Y T ( r ; r )MY ( i ; i ) (10) and the approximation in Equation 8 satisfies Equation 9.
Reference: [15] <author> Torrance, K. E. and Sparrow, E. M. </author> <title> Theory for off-specular reflection from roughened surfaces. </title> <journal> In Journal of the Optical Society of America 57, </journal> <month> 9 (September </month> <year> 1967) </year> <month> 1105-1114. </month>
Reference-contexts: Non-physically-based local lighting models, such as that of Phong [12], although computationally simple, exclude many important physical effects and lack the energy consistency needed for global illumination calculations. Physically-based models <ref> [2, 5, 15] </ref> reproduce many effects better, but cannot Permission to copy without fee all or part of this material is granted provided that the copies are not made or distributed for direct commercial advantage, the ACM copyright notice and the title of the publication and its date appear, and notice <p> At the microscale, arbitrary reflection models may be employed, including ideal specular, ideal diffuse, and directional diffuse models. One illustrative case is where the mi-crogeometry is composed of planar ideal specular surfaces; this is equivalent to geometric optics models based on micro-facets, such as the Torrance-Sparrow model <ref> [15] </ref>. We use ray tracing to model scattering events, as suggested by Cabral et al. [1]. The ray tracer must be carefully designed to assure physically accurate results.
Reference: [16] <author> Torrance, K. E. and Sparrow, E. M. </author> <title> Off-specular peaks in the directional distribution of reflected thermal radiation. </title> <note> In Journal of Heat Transfer (May 1966) 223-230. </note>
Reference-contexts: For a BRDF, bd is zero whenever i or r &gt; 2 : The BRDF can take on highly arbitrary shapes <ref> [5, 16] </ref>, so a very general method is needed to represent it. Fortunately, a BRDF is generally smooth, making it a good candidate for representation by smooth orthogonal functions.
Reference: [17] <author> Wallace, P. R. </author> <title> Mathematical Analysis of Physical Problems. </title> <publisher> Dover Publications, </publisher> <editor> Mineola, N. Y. </editor> <year> 1984. </year>
Reference-contexts: Thus f (; ) k=0 Each coefficient C k is defined by the inner product of f (; ) with the corresponding spherical harmonic basis function: C k = 0 0 = hY k jf i : (3) This follows directly from the orthogonality of the basis functions <ref> [17] </ref>. 2.2 Representing the BRDF If we fix the incident direction ( i ; i ), the BRDF is a function of two variables, ( r ; r ), and the representation in Equation 2 suffices.
Reference: [18] <author> Ward, G. J., Rubinstein, F. M. and Clear, R. D. </author> <title> A ray tracing solution for diffuse interreflection. </title> <note> In Proceedings of SIGGRAPH '88 (August 1-5, 1988, </note> <institution> Atlanta, Georgia), Computer Graphics 24, </institution> <month> 4 (August </month> <year> 1988), </year> <pages> 85-92. </pages>
Reference-contexts: The advent of global illumination methods (e.g. <ref> [6, 18] </ref>) has created another concept of scale: these methods generally use a coarser characterization of scattering for indirect illumination, but demand careful attention to energy consistency and physical accuracy. The method of this paper is applicable wherever the BRDF is an adequate model of surface geometry. <p> The new representation is concise and well-suited for use in rendering and global illumination calculations. The technique of [13] can be easily extended to accommodate the new representation. Its ease of evaluation suits it for other global illumination methods such as stochastic ray tracing [7], <ref> [18] </ref> as well.
Reference: [19] <author> Whitted, T. </author> <title> An improved illumination model for shaded display. </title> <booktitle> In Communications of the ACM 23, </booktitle> <month> 6 (June </month> <year> 1980) </year> <month> 343-349. </month>
Reference-contexts: The next three sections describe how these modes are modeled. 4.2 Specular Reflection The BRDF at the microscale may contain an ideal specular component ^ s : Whenever a ray hits such a microfacet, we model the transfer by spawning a ray in the specular direction as in classical ray-tracing <ref> [19] </ref>.
References-found: 19

