URL: http://www.cs.washington.edu/research/graphics/projects/glob-illum/dissert.ps
Refering-URL: http://www.cs.washington.edu/research/graphics/projects/glob-illum/
Root-URL: http://www.cs.washington.edu
Author: Per Henrik Christensen 
Date: 1995  
Note: c Copyright  
Abstract-found: 0
Intro-found: 1
Reference: [1] <author> Edwin A. Abbott. Flatland: </author> <title> A Romance of Many Dimensions. </title> <publisher> Dover, </publisher> <address> New York, </address> <month> 1884. </month>
Reference-contexts: When no confusion can arise, we suppress the arguments and simply write L = BL : Examples Let's look at a very simple, finite-dimensional space: the space of linear functions on the interval <ref> [0, 1] </ref>. A basis for this space consists of the linear B-splines b 1 (x) = 1 x and b 2 (x) = x , see figure 3.1. <p> Therefore, orthonormal bases are self-dual, meaning that the dual basis is identical to the basis itself, B = B. Example A basis for piecewise-constant functions on the interval <ref> [0, 1] </ref> is the n functions evenly dividing that interval: b i (x) = &lt; p n x &lt; i 0, elsewhere An example of such a basis (with n equal to 4) is shown in figure 3.3. These functions are known as the normalized box functions. <p> The basis functions for the spaces V j are called scaling functions and are usually denoted by the symbol OE. Example The simplest multiresolution basis is the Haar basis in one dimension. Let us consider the Haar basis on the interval <ref> [0, 1] </ref>. The space V j consists of piecewise-constant functions on [0, 1] with discontinuities at f0, 1=2 j , 2=2 j , :::, 1g. The space V j is spanned by scaling functions OE j i (u). <p> Example The simplest multiresolution basis is the Haar basis in one dimension. Let us consider the Haar basis on the interval <ref> [0, 1] </ref>. The space V j consists of piecewise-constant functions on [0, 1] with discontinuities at f0, 1=2 j , 2=2 j , :::, 1g. The space V j is spanned by scaling functions OE j i (u). <p> However, they also have some serious drawbacks, as will be described in section 5.3.2. Example Another example of a hierarchical basis is the basis consisting of piecewise-linear functions, the linear B-splines. We call the corresponding wavelets splinelets. A few of these scaling functions and wavelets (defined on the interval <ref> [0, 1] </ref> for this example) are shown in figure 5.3. The basis shown is continuous, but not smooth. Smooth bases can be constructed from higher-order B-splines [29, 31, 93]. The corresponding wavelets have vanishing moments equal to the order of the spline. <p> As is common, we split the surfaces into patches such that the spatial variables on each patch can be parameterized on the unit square <ref> [0, 1] </ref> 2 ; see figure 5.7. Then three possibilities for parameterization of the remaining two dimensions are described: spatial parameterization, wavelets defined on the hemisphere, and transformation of the hemisphere to a square. <p> These choices are called standard and nonstandard constructions, respectively. 5.3.1 A Convenient Domain for Radiance A spatial parameterization of radiance, like Schr oder and Hanrahan [79] and Pattanaik and Bouatouch [70] used, gives the domain <ref> [0, 1] </ref> 2 on both the sending and receiving patch, so the domain of the radiance distribution is the four-dimensional hypercube [0, 1] 4 . As we shall see in section 5.3.3, it is simple to construct bases for [0, 1] 4 from tensor products of one-dimensional wavelets. 76 However, we <p> nonstandard constructions, respectively. 5.3.1 A Convenient Domain for Radiance A spatial parameterization of radiance, like Schr oder and Hanrahan [79] and Pattanaik and Bouatouch [70] used, gives the domain <ref> [0, 1] </ref> 2 on both the sending and receiving patch, so the domain of the radiance distribution is the four-dimensional hypercube [0, 1] 4 . As we shall see in section 5.3.3, it is simple to construct bases for [0, 1] 4 from tensor products of one-dimensional wavelets. 76 However, we want a directional parameterization of radiance since it leads to a small number of initial light transports between basis functions (see <p> Hanrahan [79] and Pattanaik and Bouatouch [70] used, gives the domain <ref> [0, 1] </ref> 2 on both the sending and receiving patch, so the domain of the radiance distribution is the four-dimensional hypercube [0, 1] 4 . As we shall see in section 5.3.3, it is simple to construct bases for [0, 1] 4 from tensor products of one-dimensional wavelets. 76 However, we want a directional parameterization of radiance since it leads to a small number of initial light transports between basis functions (see section 2.7). The domain of the radiance distribution on each patch is then [0, 1] 2 fi W+, <p> to construct bases for <ref> [0, 1] </ref> 4 from tensor products of one-dimensional wavelets. 76 However, we want a directional parameterization of radiance since it leads to a small number of initial light transports between basis functions (see section 2.7). The domain of the radiance distribution on each patch is then [0, 1] 2 fi W+, where W+ is the unit hemisphere. Schr oder and Sweldens [80] describe wavelets defined on a spherical domain. Using their wavelets, a basis for radiance can be constructed from a tensor product of bases for the unit square and the unit hemisphere. <p> Using their wavelets, a basis for radiance can be constructed from a tensor product of bases for the unit square and the unit hemisphere. We use a simpler method, mapping the hemisphere to a unit square. By mapping W+ onto <ref> [0, 1] </ref> 2 , we get a domain [0, 1] 4 for directional radiance. This process is described below. We can then use straightforward tensor products of one-dimensional basis functions for both angular and spatial variations. Mapping the hemisphere to a unit square is done in two steps. <p> Using their wavelets, a basis for radiance can be constructed from a tensor product of bases for the unit square and the unit hemisphere. We use a simpler method, mapping the hemisphere to a unit square. By mapping W+ onto <ref> [0, 1] </ref> 2 , we get a domain [0, 1] 4 for directional radiance. This process is described below. We can then use straightforward tensor products of one-dimensional basis functions for both angular and spatial variations. Mapping the hemisphere to a unit square is done in two steps. <p> The gnomonic projection is followed by a radial stretch of the disc to exactly cover the unit square, also shown in figure 5.8. The composition of these mappings is an invertible mapping between the unit hemisphere W+ and the unit square <ref> [0, 1] </ref> 2 . One might worry that this mapping distorts radiance distributions to an unacceptable degree. However, figure 5.9 shows a typical radiance distribution (resulting from glossy reflection of light from a single point) before and after the angular mapping. <p> V 2 0 1 u 0 (u) 1 OE 2 0 1 u 2 (u) 1 u 0 (u) 1 -1 1 W 1 1 u 0 (u) 1 u 1 (u) W 2 A continuous linear wavelet basis with just one scaling function: Linear B-splines and wavelets on domain <ref> [0, 1] </ref> extended down to a con stant function. The coiflets defined by Daubechies are a family of wavelets where both scaling functions and wavelets have many vanishing moments. <p> The many vanishing moments and smoothness are very desirable properties in a wavelet basis. However, coiflets are defined on the real line and are therefore not directly useful for our purposes. Meyer [63] modified these to be defined on the interval <ref> [0, 1] </ref>. If these wavelet bases were extended to have a one-dimensional space V 0 , they could be used for glossy global illumination. They have many vanishing moments, so if the kernel of the transport operator were everywhere-smooth, these wavelets would be ideal. <p> However, the basis functions overlap each other. With a nonsmooth kernel, as the transport operator has, many basis functions will have support on a discontinuity or singularity. This overlap reduces the potential sparsity. Flatlets are defined on the interval <ref> [0, 1] </ref> and can easily be extended to have a one-dimensional space V 0 . They have more vanishing moments than the Haar basis, increasing the sparsity of the transport matrix. On the other hand, flatlets have wider support and more costly integration formulas. Multiwavelets also require costly integration formulas. <p> They showed that linear bases are best for reasonable accuracies. Higher-order bases converge at a faster rate, but the gain only shows for very high accuracies. 81 5.3.3 A Wavelet Basis for Radiance Now we want to construct basis functions on the four-dimensional hypercube <ref> [0, 1] </ref> 4 using tensor products of univariate basis functions. Here, the constructions are done for the Haar basis, but the tensor-product constructions can be used for any wavelet basis. <p> In the remainder of this section, we will describe some of the details of the nonstandard construction. Let u = (u 1 , u 2 , u 3 , u 4 ) denote a point in <ref> [0, 1] </ref> 4 , and let i = (i 1 , i 2 , i 3 , i 4 ) denote a four-component multi-index of integers. <p> To illustrate the advantages of a wavelet decomposition, let us first consider an example of a matrix in a nonhierarchical basis. To ease illustration of the concepts, it is necessary to reduce the dimensionality of the global illumination problem. We consider glossy reflection in Flatland <ref> [1, 41, 50, 78] </ref>, a two-dimensional environment. In Flatland, radiosity only falls off linearly with the distance, and not with the square of the distance (as in three-dimensional environments). <p> wavelet OE OE j i (u s ) on another wave let OEOEOE j 0 T r s = h OEOEOE j 0 j The domain of radiance is position and direction, for example x and ~ !, while the domain of our tensor-product basis functions is the four-dimensional hypercube <ref> [0, 1] </ref> 4 . The transformations were described in section 5.3.1.
Reference: [2] <author> Bradley Alpert, Gregory Beylkin, Ronald Coifman, and Vladimir Rokhlin. </author> <title> Wavelet-like bases for the fast solution of second-kind integral equations. </title> <journal> SIAM Journal on Scientific Computing, </journal> <volume> 14(1) </volume> <pages> 159-184, </pages> <month> January </month> <year> 1993. </year>
Reference-contexts: We are free to choose one that makes computations efficient; for example, a hierarchical basis. Results by Alpert <ref> [2, 3, 4] </ref>, Beylkin et al. [13, 14], Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis.
Reference: [3] <author> Bradley K. Alpert. </author> <title> Sparse Representations of Smooth Linear Operators. </title> <type> PhD thesis, </type> <institution> Yale University, </institution> <address> New Haven, Connecticut, </address> <year> 1990. </year>
Reference-contexts: Multiresolution analysis provides firm theoretical ground for describing hierarchical bases. Wavelets are a set of orthogonal basis functions; in a wavelet basis, a function is represented as a coarse overall shape with detail at increasing resolutions. Alpert <ref> [3] </ref> discovered that in a wa 12 velet representation, a smooth integral operator can be represented as a sparse matrix without introducing significant error. This approximation can be utilized for global illumination, since light transport can be represented as an operator. <p> We are free to choose one that makes computations efficient; for example, a hierarchical basis. Results by Alpert <ref> [2, 3, 4] </ref>, Beylkin et al. [13, 14], Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis. <p> Results by Alpert [2, 3, 4], Beylkin et al. [13, 14], Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis. Alpert <ref> [3] </ref> and Beylkin et al. [13] discovered that a large class of operators can be approximated with sparse matrices in a wavelet basis. <p> The sparseness of the transport matrix is related to the number of vanishing moments of the wavelets <ref> [3, 4, 41] </ref>. The more vanishing moments, the sparser the matrix will be. However, wavelets with more vanishing moments are either of higher polynomial order or have larger support. In both cases, numerical integration required for computing the matrix entries becomes more expensive.
Reference: [4] <author> Bradley K. Alpert. </author> <title> A class of bases in L 2 for the sparse representation of integral operators. </title> <journal> SIAM Journal on Mathematical Analysis, </journal> <volume> 24(1) </volume> <pages> 246-262, </pages> <month> January </month> <year> 1993. </year>
Reference-contexts: We are free to choose one that makes computations efficient; for example, a hierarchical basis. Results by Alpert <ref> [2, 3, 4] </ref>, Beylkin et al. [13, 14], Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis. <p> Example Gortler et al. [41, 78] used wavelet bases to represent radiosity. They used two families of non-overlapping wavelets: multiwavelets (defined by Al-pert <ref> [4] </ref>) and flatlets, shown in figures 5.5 and 5.6. Multiwavelets of order n are constructed from pieces of monomials of order up to n, and flatlets of order n are 74 constructed from 2n piecewise-constant pieces. <p> The sparseness of the transport matrix is related to the number of vanishing moments of the wavelets <ref> [3, 4, 41] </ref>. The more vanishing moments, the sparser the matrix will be. However, wavelets with more vanishing moments are either of higher polynomial order or have larger support. In both cases, numerical integration required for computing the matrix entries becomes more expensive.
Reference: [5] <author> Andrew W. Appel. </author> <title> An efficient program for many-body simulation. </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 6(1) </volume> <pages> 85-103, </pages> <month> January </month> <year> 1985. </year>
Reference-contexts: Initially, light is transported between large clusters. Later, the transports are refined where higher accuracy is needed, so that transports are between smaller clusters or patches. Clustering techniques were first developed for applications in astrophysics. Appel <ref> [5] </ref>, Barnes and Hut [11], and Greengaard [43] considered efficient solutions to the n-body problem; that is, how n bodies influence each other through, for example, gravitational or electrostatic forces. <p> Finally, a glossy global illumination algorithm using clustering is described, along with the initial construction of the cluster hierarchy and the refinement of clusters. 98 6.1 Background Related work on clustering was done in physics by Appel <ref> [5] </ref>, Barnes and Hut [11], and Greengard [43], among others. They considered the so-called n-body problem, where the forces between a set of bodies have to be computed for example, gravitational forces between stars in a galaxy or electrostatic forces between elementary particles.
Reference: [6] <author> James Arvo. </author> <title> Linear operators and integral equations in global illumination. </title> <booktitle> ACM SIGGRAPH '93 course notes (course 42), </booktitle> <month> August </month> <year> 1993. </year>
Reference-contexts: The term finite elements is a common name for all these methods. More on the theory behind the Galerkin method and other finite-element methods can be found in Delves and Mohamed [28] and the excellent course notes by Arvo <ref> [6] </ref>. 3.5 Simple Algorithm Here we will describe a simple, iterative, nonhierarchical solution method for the truncated radiance equation. Later, when we improve the solution method 48 with hierarchical bases and adaptive refinement, this simple algorithm will be the core of the improved algorithms.
Reference: [7] <author> James Arvo and David Kirk. </author> <title> Fast ray tracing by ray classification. </title> <booktitle> In Proceedings of ACM SIGGRAPH '87, </booktitle> <pages> pages 55-64, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: There are some more sophisticated methods for visibility computations that have near-constant expected time per visibility ray. Among them are the ray classification scheme proposed by Arvo and Kirk <ref> [7] </ref> and the ray coherence scheme of Ohta and Maekawa [65].
Reference: [8] <author> James Arvo, Kenneth Torrance, and Brian Smits. </author> <title> A framework for the analysis of error in global illumination algorithms. </title> <booktitle> In Proceedings of ACM SIGGRAPH '94, </booktitle> <pages> pages 75-84, </pages> <month> July </month> <year> 1994. </year>
Reference-contexts: Recent advances such as hierarchical representation [9, 41, 46, 79, 88], importance-driven refinement [17, 89], error control <ref> [8, 59] </ref>, discontinuity meshing [49, 60], etc. have made finite-element methods a promising approach to global illumination. Most of these advances have been for diffuse global illumination, but, as we shall see, they can also be generalized to glossy global illumination. <p> Definition Incident radiance 1 : Incident radiance L in (y, ~ !) is the power incident on y per unit solid angle in direction ~ ! per unit projected area perpendicular to that direction. 1 This quantity is also called field radiance by some authors <ref> [8] </ref>. 23 Radiance along a ray is invariant, so if points x and y are mutually visible, we have L in (y, ~ ! xy ) = L (x, ~ ! xy ) , (2.1) as illustrated in figure 2.2. x L (x, ~! xy ) ~! xy Radiance along a <p> Such sampling methods generally give noisy artifacts and have slow convergence, unless only specular reflections are considered. Recent advances in finite-element techniques (such as hierarchical representation [9, 19, 41, 46, 79, 88, 89], importance-driven refinement [17, 89], error control <ref> [8, 59] </ref>, discontinuity meshing [49, 60], etc.) have made it a promising approach. We therefore use a finite-element solution method: we approximate the unknown radiance in a finite basis and compute an approximate solution using the Galerkin method.
Reference: [9] <author> Larry Aupperle and Pat Hanrahan. </author> <title> A hierarchical illumination algorithm for surfaces with glossy reflection. </title> <booktitle> In Proceedings of ACM SIGGRAPH '93, </booktitle> <pages> pages 155-162, </pages> <month> August </month> <year> 1993. </year>
Reference-contexts: Recent advances such as hierarchical representation <ref> [9, 41, 46, 79, 88] </ref>, importance-driven refinement [17, 89], error control [8, 59], discontinuity meshing [49, 60], etc. have made finite-element methods a promising approach to global illumination. <p> Wavelets have also been used in as diverse fields as signal analysis, approximation theory, image compression, mathematics, and numerical analysis. Hierarchical bases were first used for diffuse global illumination by Hanra-han et al. [45, 46] and for glossy global illumination by Aupperle and Hanra-han <ref> [9] </ref>. Wavelets were first used for diffuse global illumination by Gortler et al. [41, 78] and for glossy global illumination by Christensen et al. [19], Schr oder and Hanrahan [79], and Pattanaik and Bouatouch [70]. <p> Smits et al. defined importance as an adjoint function of radiosity, and developed a transport equation for this type of diffuse importance. The use of importance has been extended to glossy global illumination. Aup-perle and Hanrahan <ref> [9] </ref> and Pattanaik [68, 69] defined directional importance to be an adjoint of radiance. This type of importance directly gives the contribution of a given radiance distribution. In Christensen et al. [17] we found it advantageous to define directional importance in a different way. <p> Writing the operators in equation (2.13) out in full yields L (y, ~ !) = L e (y, ~ !) + x These terms are illustrated in figure 2.9. The radiance equation was used by Im mel et al. [51], Sillion et al. [85], Aupperle and Hanrahan <ref> [9] </ref> and others. x x L (x, ~! xy ) The radiance equation: radiance from point y in direction ! depends on radiance from all points x towards y. <p> The choice is based on efficiency and the minimum number of transports. Kajiya [54] introduced the use of rigorous equilibrium equations in global illumination. He expressed his equilibrium equation (the rendering equation) using two-point transport intensity. Since then, radiance has been preferred by 35 most researchers <ref> [9, 19, 51, 70, 79, 85] </ref> because it is a standard term in the radiometry field. Two fundamentally different parameterizations of radiance have been used for glossy global illumination. <p> The radiance distribution in a scene can be divided into radiance distributions on patches; each such radiance distribution is a function of only local variables. By contrast, Aupperle and Hanrahan <ref> [9] </ref>, Pattanaik and Bouatouch [70], and Schr oder and Hanrahan [79] represent the radiance from one point towards another. This gives a parameterization with four spatial variables. <p> Such sampling methods generally give noisy artifacts and have slow convergence, unless only specular reflections are considered. Recent advances in finite-element techniques (such as hierarchical representation <ref> [9, 19, 41, 46, 79, 88, 89] </ref>, importance-driven refinement [17, 89], error control [8, 59], discontinuity meshing [49, 60], etc.) have made it a promising approach. <p> The Galerkin solution method for the radiance equation is described, both for exact and approximate solution. Lastly, a simple iterative solution method with fixed resolution is described. The basis can be either nonhierarchical [39, 51, 85, 95, 105] or hierarchical <ref> [9, 19, 22, 41, 46, 70, 79, 88, 89] </ref>. Hierarchical bases enable faster, adaptive solution. In this chapter, we only consider nonhierarchical bases to keep the initial presentation simple. <p> Gortler et al. [41, 78] generalized the hierarchical ra-diosity method to use a wavelet representation. In the more general context of radiance, Aupperle and Hanrahan <ref> [9] </ref> used hierarchical piecewise-constant basis functions for a spatial parameterization of radiance; Schr oder and Hanrahan [79] and Pattanaik and Bouatouch [70] used wavelets for spatial parameterization of radiance; while Christensen et al. [19] used wavelets for a directional parameterization of radiance. <p> For the accurate transport, light is transported directly from all patches in cluster S to all patches in cluster R . For the approximate transport, a single transport suffices. between patches. It works well for scenes with few large patches <ref> [9, 19, 79] </ref>. We want a similar hierarchical approach for scenes with many small patches. In this chapter we extend the hierarchy upward, to allow light to be transported between many patches with a single transport. We first describe how our method differs from previous work.
Reference: [10] <author> Larry Aupperle and Pat Hanrahan. </author> <title> Importance and discrete three point transport. </title> <booktitle> In Proceedings of the Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 85-94, </pages> <month> June </month> <year> 1993. </year> <month> 159 </month>
Reference-contexts: This con tribution can be rewritten as follows: h fl fl e j Li = h fl j Li : 60 Importance defined as the adjoint of radiance was used by Pattanaik [68, 69] for Monte Carlo radiance computations, and by Aupperle and Hanrahan <ref> [10] </ref> for a finite-element method. 4.5 Directional Importance It might seem natural to use two-point importance fl (x, y) since the inner product h fl j Li is exactly the contribution we need to know for refinement.
Reference: [11] <author> Josh Barnes and Piet Hut. </author> <title> A hierarchical O(N log N) force-calculation algorithm. </title> <journal> Nature, </journal> <volume> 324(4) </volume> <pages> 446-449, </pages> <month> December </month> <year> 1986. </year>
Reference-contexts: Initially, light is transported between large clusters. Later, the transports are refined where higher accuracy is needed, so that transports are between smaller clusters or patches. Clustering techniques were first developed for applications in astrophysics. Appel [5], Barnes and Hut <ref> [11] </ref>, and Greengaard [43] considered efficient solutions to the n-body problem; that is, how n bodies influence each other through, for example, gravitational or electrostatic forces. When the number of bodies is in the thousands or millions, as occurs for simulating development of galaxies, a quadratic complexity is prohibitive. <p> Finally, a glossy global illumination algorithm using clustering is described, along with the initial construction of the cluster hierarchy and the refinement of clusters. 98 6.1 Background Related work on clustering was done in physics by Appel [5], Barnes and Hut <ref> [11] </ref>, and Greengard [43], among others. They considered the so-called n-body problem, where the forces between a set of bodies have to be computed for example, gravitational forces between stars in a galaxy or electrostatic forces between elementary particles.
Reference: [12] <author> Petr Bechmann and Andre Spizzichino. </author> <title> The Scattering of Electromagnetic Waves from Rough Surfaces. </title> <publisher> Pergamon Press, </publisher> <address> New York, </address> <year> 1963. </year>
Reference-contexts: Glossy reflection is directional but not restricted to a single direction. These three types of reflection are illustrated in figure 1.1. In computer graphics, glossy reflection is typically modeled using microfacet theory. There is a plethora of glossy reflection models <ref> [12, 15, 25, 47, 53, 74, 94, 98] </ref>. Any of these models can be used with the techniques developed here, as could any other realistic model. diffuse glossy specular Diffuse, glossy, and specular reflection. <p> There are many models of glossy reflection, ranging from the very simple Phong model [15] to more accurate models such as the Beckmann-Spizzichino <ref> [12] </ref>, Torrance-Sparrow [94], and other models [25, 47, 53, 74, 98]. Any of these reflection models can be used for our glossy global illumination algorithm. In fact, any model that simulates realistic reflection can be used.
Reference: [13] <author> Gregory Beylkin, Ronald Coifman, and Vladimir Rokhlin. </author> <title> Fast wavelet transforms and numerical algorithms I. </title> <journal> Communications on Pure and Applied Mathematics, </journal> <volume> 44 </volume> <pages> 141-183, </pages> <year> 1991. </year>
Reference-contexts: We are free to choose one that makes computations efficient; for example, a hierarchical basis. Results by Alpert [2, 3, 4], Beylkin et al. <ref> [13, 14] </ref>, Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis. <p> Results by Alpert [2, 3, 4], Beylkin et al. [13, 14], Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis. Alpert [3] and Beylkin et al. <ref> [13] </ref> discovered that a large class of operators can be approximated with sparse matrices in a wavelet basis. <p> 1 (u 1 )OE i 2 (u 2 )OE i 3 (u 3 )OE i 4 (u 4 ) with 0 i 1 , i 2 , i 3 , i 4 &lt; 2 j : For hierarchical bases, there are two alternative methods: the so-called standard and nonstandard constructions <ref> [13] </ref>. The standard construction forms a basis from all possible tensor products of univariate basis functions: scaling functions in V 0 and wavelets in higher spaces. <p> Here we will describe the choices in operator decomposition, that is, which basis functions are used to represent the radiance distribution and which basis functions can transport light to with each other. We distinguish between three decomposition of an operator: the so-called standard and nonstandard decompositions <ref> [13] </ref> and a HR-style decomposition [46]. To illustrate the advantages of a wavelet decomposition, let us first consider an example of a matrix in a nonhierarchical basis. To ease illustration of the concepts, it is necessary to reduce the dimensionality of the global illumination problem. <p> The pushing and pulling ensure a consistent representation at all levels of the hierarchy. One can informally say that the fine scaling functions act as proxies for the wavelets in coarser spaces and the scaling function in V 0 . Beylkin et al. <ref> [13] </ref> showed that the nonstandard operator decomposition gives a linear bound O (n b ). The nonstandard decomposition is not a basis change since the function is overrepresented. <p> Like the nonstandard decomposition, the HR-style decomposition is O (n b ). 5.4.4 Choice of Decomposition The nonstandard decomposition and HR-style decomposition have been shown to be O (n b ) while the standard decomposition has been shown to be O (n b log n b ) <ref> [13, 46] </ref>. (More precisely, it has been shown that for a given tolerance larger than zero, O (n b ) or O (n b logn b ) multiplies are sufficient to apply an operator to a function.) However, experimental results [16, 52, 78] show that the standard decomposition is often more <p> Refinement is determined by an oracle, described in the following section. 5.6 Refinement In many applications of wavelets in numerical analysis <ref> [13] </ref>, the goal is to obtain a sparse representation of a given matrix, thereby making repeated matrix-vector multiplications much faster.
Reference: [14] <author> Gregory Beylkin, Ronald R. Coifman, and Vladimir Rokhlin. </author> <title> Wavelets in numerical analysis. </title> <editor> In Mary Beth Rushkai et al., editors, </editor> <booktitle> Wavelets and Their Applications, </booktitle> <pages> pages 181-210. </pages> <publisher> Jones and Bartlett, </publisher> <address> Boston, Mas-sachusetts, </address> <year> 1992. </year>
Reference-contexts: We are free to choose one that makes computations efficient; for example, a hierarchical basis. Results by Alpert [2, 3, 4], Beylkin et al. <ref> [13, 14] </ref>, Gortler et al. [41, 78], Hanrahan et al. [45, 46] and others indicate that significant performance gains can be achieved by using a hierarchical basis.
Reference: [15] <author> Phong Bui-Tuong. </author> <title> Illumination for computer-generated pictures. </title> <journal> Communications of the ACM, </journal> <volume> 18(6) </volume> <pages> 311-317, </pages> <month> June </month> <year> 1975. </year>
Reference-contexts: Glossy reflection is directional but not restricted to a single direction. These three types of reflection are illustrated in figure 1.1. In computer graphics, glossy reflection is typically modeled using microfacet theory. There is a plethora of glossy reflection models <ref> [12, 15, 25, 47, 53, 74, 94, 98] </ref>. Any of these models can be used with the techniques developed here, as could any other realistic model. diffuse glossy specular Diffuse, glossy, and specular reflection. <p> There are many models of glossy reflection, ranging from the very simple Phong model <ref> [15] </ref> to more accurate models such as the Beckmann-Spizzichino [12], Torrance-Sparrow [94], and other models [25, 47, 53, 74, 98]. Any of these reflection models can be used for our glossy global illumination algorithm. In fact, any model that simulates realistic reflection can be used.
Reference: [16] <author> Per Christensen, Eric Stollnitz, David Salesin, and Tony DeRose. </author> <title> Global illumination of glossy environments using wavelets and importance. </title> <type> Technical Report 94-10-01, </type> <institution> Department of Computer Science and Engineering, University of Washington, </institution> <address> Seattle, Washington, </address> <month> October </month> <year> 1994. </year>
Reference-contexts: The results are shown in figure 5.16. The wavelet matrix decompositions require a much smaller number of transports than the original 88 matrix to achieve a given level of accuracy. Similar tests with perpendicular lines and occlusion are presented in Chris tensen et al. <ref> [16] </ref>. - 0.001 0.1 1 10 100 1000 10000 realtive error # matrix elements direct nonstandard standard Error vs. number of transports: original matrix, standard decomposition, and nonstandard decomposition (described in section 5.4.2). 5.4.2 Nonstandard Operator Decomposition The nonstandard operator decomposition utilizes an overrepresentation of the basis with both scaling functions <p> shown to be O (n b log n b ) [13, 46]. (More precisely, it has been shown that for a given tolerance larger than zero, O (n b ) or O (n b logn b ) multiplies are sufficient to apply an operator to a function.) However, experimental results <ref> [16, 52, 78] </ref> show that the standard decomposition is often more sparse than the nonstandard decomposition.
Reference: [17] <author> Per H. Christensen, David H. Salesin, and Tony D. DeRose. </author> <title> A continuous adjoint formulation for radiance transport. </title> <booktitle> In Proceedings of the Fourth Eurographics Workshop on Rendering, </booktitle> <pages> pages 95-104, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: Recent advances such as hierarchical representation [9, 41, 46, 79, 88], importance-driven refinement <ref> [17, 89] </ref>, error control [8, 59], discontinuity meshing [49, 60], etc. have made finite-element methods a promising approach to global illumination. Most of these advances have been for diffuse global illumination, but, as we shall see, they can also be generalized to glossy global illumination. <p> The use of importance has been extended to glossy global illumination. Aup-perle and Hanrahan [9] and Pattanaik [68, 69] defined directional importance to be an adjoint of radiance. This type of importance directly gives the contribution of a given radiance distribution. In Christensen et al. <ref> [17] </ref> we found it advantageous to define directional importance in a different way. We define it so that importance is transported exactly like radiance, simplifying the algorithm. <p> Such sampling methods generally give noisy artifacts and have slow convergence, unless only specular reflections are considered. Recent advances in finite-element techniques (such as hierarchical representation [9, 19, 41, 46, 79, 88, 89], importance-driven refinement <ref> [17, 89] </ref>, error control [8, 59], discontinuity meshing [49, 60], etc.) have made it a promising approach. We therefore use a finite-element solution method: we approximate the unknown radiance in a finite basis and compute an approximate solution using the Galerkin method. <p> Proof Since T fl j G ffi R = G fl ffi R fl = (R ffi G) fl and T j R ffi G it follows that T fl and T are adjoint. (This was shown in <ref> [17, 79, 96] </ref>.) 2 Adjoint equations and adjoint functions are defined as follows: Definition Adjoint equations and adjoint functions: For an equation g = Of the adjoint equations are the set of equations h = O fl f fl for all functions h. <p> The fact that importance is propagated like light allows us to use data structures and transport algorithms that treat importance as if it were another set of color channels. This type of importance was introduced by Christensen et al. <ref> [17] </ref> (there it was called exitant directional importance), and used by Christensen et al. [19], 63 Schr oder and Hanrahan [79] with a spatial parameterization, and Veach and Guibas [96] for a Monte Carlo method. 4.6 Diffuse Importance The first work on importance in global illumination was done by Smits et
Reference: [18] <author> Per H. Christensen, Eric J. Stollnitz, David H. Salesin, and Tony D. DeRose. </author> <title> Importance-driven wavelet radiance. </title> <type> Technical Report 94-01-05, </type> <institution> Department of Computer Science and Engineering, University of Washington, </institution> <month> January </month> <year> 1994. </year>
Reference-contexts: On the other hand, flatlets have wider support and more costly integration formulas. Multiwavelets also require costly integration formulas. There are more wavelet bases than the ones described here, each with its own set of advantages and disadvantages. We have experimented with spline-lets <ref> [18] </ref>, Daubechies's coiflets, and the Haar basis. As a result of these experiments and weighing the trade-offs above we have chosen to implement our glossy global illumination algorithm using the Haar basis.
Reference: [19] <author> Per H. Christensen, Eric J. Stollnitz, David H. Salesin, and Tony D. DeRose. </author> <title> Wavelet radiance. </title> <booktitle> In Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <pages> pages 287-302, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: Hierarchical bases were first used for diffuse global illumination by Hanra-han et al. [45, 46] and for glossy global illumination by Aupperle and Hanra-han [9]. Wavelets were first used for diffuse global illumination by Gortler et al. [41, 78] and for glossy global illumination by Christensen et al. <ref> [19] </ref>, Schr oder and Hanrahan [79], and Pattanaik and Bouatouch [70]. The application of wavelets to global illumination introduces special requirements in the hierarchical basis, and the trade-offs come out differently than in other fields. In this dissertation, the criteria for selecting wavelet bases for glossy global illumination are described. <p> The choice is based on efficiency and the minimum number of transports. Kajiya [54] introduced the use of rigorous equilibrium equations in global illumination. He expressed his equilibrium equation (the rendering equation) using two-point transport intensity. Since then, radiance has been preferred by 35 most researchers <ref> [9, 19, 51, 70, 79, 85] </ref> because it is a standard term in the radiometry field. Two fundamentally different parameterizations of radiance have been used for glossy global illumination. <p> Such sampling methods generally give noisy artifacts and have slow convergence, unless only specular reflections are considered. Recent advances in finite-element techniques (such as hierarchical representation <ref> [9, 19, 41, 46, 79, 88, 89] </ref>, importance-driven refinement [17, 89], error control [8, 59], discontinuity meshing [49, 60], etc.) have made it a promising approach. <p> The Galerkin solution method for the radiance equation is described, both for exact and approximate solution. Lastly, a simple iterative solution method with fixed resolution is described. The basis can be either nonhierarchical [39, 51, 85, 95, 105] or hierarchical <ref> [9, 19, 22, 41, 46, 70, 79, 88, 89] </ref>. Hierarchical bases enable faster, adaptive solution. In this chapter, we only consider nonhierarchical bases to keep the initial presentation simple. <p> This type of importance was introduced by Christensen et al. [17] (there it was called exitant directional importance), and used by Christensen et al. <ref> [19] </ref>, 63 Schr oder and Hanrahan [79] with a spatial parameterization, and Veach and Guibas [96] for a Monte Carlo method. 4.6 Diffuse Importance The first work on importance in global illumination was done by Smits et al. [89] for the diffuse case. <p> In the more general context of radiance, Aupperle and Hanrahan [9] used hierarchical piecewise-constant basis functions for a spatial parameterization of radiance; Schr oder and Hanrahan [79] and Pattanaik and Bouatouch [70] used wavelets for spatial parameterization of radiance; while Christensen et al. <ref> [19] </ref> used wavelets for a directional parameterization of radiance. In this chapter, we construct a hierarchical basis for efficiently representing radiance distributions along the lines of Christensen et al. [19]. 69 5.2 Multiresolution Analysis Hierarchical bases can be formally described with multiresolution analysis. <p> Schr oder and Hanrahan [79] and Pattanaik and Bouatouch [70] used wavelets for spatial parameterization of radiance; while Christensen et al. <ref> [19] </ref> used wavelets for a directional parameterization of radiance. In this chapter, we construct a hierarchical basis for efficiently representing radiance distributions along the lines of Christensen et al. [19]. 69 5.2 Multiresolution Analysis Hierarchical bases can be formally described with multiresolution analysis. Before describing multiresolution analysis in detail, it is interesting to compare it to function sampling and Fourier analysis. <p> It has two disadvantages: it is discontinuous, and the transport matrix is not as sparse as for bases with more vanishing mo 79 ments. The discontinuities can be ameliorated by performing a final gathering step during rendering <ref> [19, 61, 75, 87] </ref>. The non-optimal sparsity is to some extent overcome by the compact support and simple numerical integration. Splinelets can be defined on a bounded domain as in the example in sec tion 5.2. <p> Gortler et al. [41, 78] also used a hierarchical scaling function representation of radiosity, but used scaling functions corresponding to multiwa-velets and flatlets. Schr oder and Hanrahan [79] used a similar scaling function representation for radiance while Christensen et al. <ref> [19] </ref> used a wavelet representation. Here we will describe the choices in operator decomposition, that is, which basis functions are used to represent the radiance distribution and which basis functions can transport light to with each other. <p> For the accurate transport, light is transported directly from all patches in cluster S to all patches in cluster R . For the approximate transport, a single transport suffices. between patches. It works well for scenes with few large patches <ref> [9, 19, 79] </ref>. We want a similar hierarchical approach for scenes with many small patches. In this chapter we extend the hierarchy upward, to allow light to be transported between many patches with a single transport. We first describe how our method differs from previous work.
Reference: [20] <author> Charles K. Chui. </author> <title> An Introduction to Wavelets. </title> <publisher> Academic Press, </publisher> <address> London, UK, </address> <year> 1992. </year>
Reference-contexts: In contrast, a multiresolution analysis gives information about local variation of the function, a mix of value and frequency information. Multiresolution analysis as formulated by Mallat [62] provides a convenient framework for studying hierarchical bases. Chui <ref> [20] </ref>, Daubechies [27], DeRose et al. [29], Stollnitz et al. [93] and others give more elaborate explanations of mul-tiresolution bases.
Reference: [21] <author> Charles K. Chui and Ewald Quak. </author> <title> Wavelets on a bounded interval. </title> <editor> In Dietrich Braess and Larry L. Schumaker, editors, </editor> <booktitle> Numerical Methods of Approximation Theory, </booktitle> <volume> volume 9, </volume> <pages> pages 53-75. </pages> <publisher> Birkhauser Verlag, </publisher> <address> Basel, Schwitzerland, </address> <year> 1992. </year> <month> 160 </month>
Reference-contexts: Meyer [63] and Chui and Quak <ref> [21] </ref> describe a way to de fine similar (but slightly more complicated) wavelets on a bounded interval. - OE 0 u 0 3 6 0 u 1 3 Daubechies's scaling function and coiflet of order N = 2. Example Gortler et al. [41, 78] used wavelet bases to represent radiosity.
Reference: [22] <author> Michael F. Cohen, Shenchang Eric Chen, John R. Wallace, and Donald P. Greenberg. </author> <title> A progressive refinement approach to fast radiosity image generation. </title> <booktitle> In Proceedings of ACM SIGGRAPH '88, </booktitle> <pages> pages 75-84, </pages> <month> August </month> <year> 1988. </year>
Reference-contexts: This method for approximate solution of an integral equation is known as the Galerkin method. This method was improved in two major ways. The first improvement was faster solution of the linear system using Southwell iteration (also known as progressive refinement or shooting <ref> [22, 40] </ref>). The second improvement was the use of basis functions that ensure better convergence: orthogonal polynomials (Troutman and Max [95] and Zatz [105]) and piecewise-linear functions with discontinuities along the dominant discontinuities of the solution (Heckbert [49] and Lischinski et al. [60]). <p> The Galerkin solution method for the radiance equation is described, both for exact and approximate solution. Lastly, a simple iterative solution method with fixed resolution is described. The basis can be either nonhierarchical [39, 51, 85, 95, 105] or hierarchical <ref> [9, 19, 22, 41, 46, 70, 79, 88, 89] </ref>. Hierarchical bases enable faster, adaptive solution. In this chapter, we only consider nonhierarchical bases to keep the initial presentation simple.
Reference: [23] <author> Michael F. Cohen, Donald P. Greenberg, David S. Immel, and Philip J. Brock. </author> <title> An efficient radiosity approach for realistic image synthesis. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 6(2) </volume> <pages> 26-35, </pages> <month> March </month> <year> 1986. </year>
Reference-contexts: They showed that for a univariate wavelet basis with n b basis functions, certain wavelet decompositions result in a matrix with O (n b ) significant entries. The use of hierarchical bases in global illumination started with Cohen et al. <ref> [23] </ref>. They observed that, in many cases, to get a satisfying result when transporting light between two patches, the accuracy at the receiving patch needs to be higher than at the sending patch.
Reference: [24] <author> Michael F. Cohen and John R. Wallace. </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press Professional, </publisher> <address> Boston, Massachusets, </address> <year> 1993. </year>
Reference-contexts: Without global illumination, there would be no secondary highlights. These effects, and other global illumination effects, are essential to convey the illusion of a real scene. Introductions to the global illumination problem can be found in several textbooks <ref> [24, 32, 36, 86] </ref>. 3 As already described, global illumination problems are challenging because we need a solution at all points in all directions, and because the light at all points depend on each other. <p> A somewhat smaller contribution concerns adjoints. The radiance equation <ref> [24] </ref> and Kajiya's rendering equation [54] are alternative descriptions of light transport. <p> In chapter 2, the propagation and reflection of light is described and the integral equation that governs light transport is presented. There are two alternative formulations of this integral equation: 17 the radiance equation <ref> [24] </ref> and Kajiya's rendering equation [54]. Even though these two formulations are equivalent, the radiance equation is preferred since it has a parameterization local to each patch. <p> It can be shown that for diffuse reflection, r (y) equals pf r (y) (see Cohen and Wallace <ref> [24] </ref>). <p> In terms of directional distribution coefficients, this update is accomplished by increasing the patch's coefficient by 1 i i D ~ ! i : Here r ch is the conical-to-hemispherical reflectance of the patch <ref> [24] </ref>, and D ~ ! i is the solid angle corresponding to the support of the i -th basis function on the sphere. <p> All of the these quantities are independent of n p , and therefore the total time taken by this stage of the algorithm is O (n p ). 7.7 Data Structure for Basis Function Coefficients As in hierarchical radiosity algorithms <ref> [24] </ref>, the matrices e T, e L, e L e , e , and e e are never formed explicitly.
Reference: [25] <author> Robert L. Cook. </author> <title> A reflectance model for computer graphics. </title> <journal> ACM Transactions on Graphics, </journal> <volume> 1(1) </volume> <pages> 7-24, </pages> <month> January </month> <year> 1982. </year>
Reference-contexts: Glossy reflection is directional but not restricted to a single direction. These three types of reflection are illustrated in figure 1.1. In computer graphics, glossy reflection is typically modeled using microfacet theory. There is a plethora of glossy reflection models <ref> [12, 15, 25, 47, 53, 74, 94, 98] </ref>. Any of these models can be used with the techniques developed here, as could any other realistic model. diffuse glossy specular Diffuse, glossy, and specular reflection. <p> There are many models of glossy reflection, ranging from the very simple Phong model [15] to more accurate models such as the Beckmann-Spizzichino [12], Torrance-Sparrow [94], and other models <ref> [25, 47, 53, 74, 98] </ref>. Any of these reflection models can be used for our glossy global illumination algorithm. In fact, any model that simulates realistic reflection can be used.
Reference: [26] <author> Robert L. Cook. </author> <title> Distributed ray tracing. </title> <booktitle> In Proceedings of ACM SIG-GRAPH '84, </booktitle> <pages> pages 137-146, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: For specular reflection, in contrast, the photon could only have come from the mirror direction. There are two techniques to simulate general photon transport: distribution ray tracing and path tracing. Cook <ref> [26] </ref> introduced distribution ray tracing, where each time a ray hits a surface, a new set of rays is traced. The new rays are cast in the directions where the photon most likely came from. If the contribution along a ray is sufficiently small, no further rays are cast. <p> The improvement brought about by the final gather can be seen by comparing figures 8.5 (e-f) and 8.11 (a-f). Another way of describing the final gathering step is in the context of distribution ray tracing <ref> [26] </ref>. When a ray cast from the eye intersects a surface in the scene, a group of reflected rays are traced from the intersection point to points on other surfaces in the scene.
Reference: [27] <author> Ingrid Daubechies. </author> <title> Ten Lectures on Wavelets. </title> <publisher> SIAM, </publisher> <address> Philadelphia, Penn-sylvania, </address> <year> 1992. </year>
Reference-contexts: In contrast, a multiresolution analysis gives information about local variation of the function, a mix of value and frequency information. Multiresolution analysis as formulated by Mallat [62] provides a convenient framework for studying hierarchical bases. Chui [20], Daubechies <ref> [27] </ref>, DeRose et al. [29], Stollnitz et al. [93] and others give more elaborate explanations of mul-tiresolution bases. <p> The basis shown is continuous, but not smooth. Smooth bases can be constructed from higher-order B-splines [29, 31, 93]. The corresponding wavelets have vanishing moments equal to the order of the spline. Example Daubechies <ref> [27] </ref> defined a class of wavelets called coiflets. These basis functions have as many vanishing moments as their order N, and are continuous and even smooth for higher orders. For order N = 2, the scaling function and wavelet are continuous, but not smooth; they are shown in figure 5.4. <p> The most important properties are: * Bounded domain. Multiresolution analysis is usually formulated for functions on the unbounded real line, whereas we wish to represent radiance distributions defined on bounded domains. Unbounded wavelets could be used on a bounded interval by artificially extending the functions of interest <ref> [27] </ref>, but it is unclear how radiance would be extended beyond the geometric extent of surface patches without introducing a number of artifacts. We have found it more convenient to use wavelets defined on a bounded interval. 78 * One-dimensional V 0 .
Reference: [28] <author> L. M. Delves and J. L. Mohamed. </author> <title> Computational Methods for Integral Equations. </title> <publisher> Cambridge University Press, </publisher> <address> Cambridge, UK, </address> <year> 1985. </year>
Reference-contexts: Both equilibrium equations are multidimensional Fredholm integral equa tions of the second kind <ref> [28, 48] </ref>. Such equations are in general written f (y) = g (y) + D where the function f is to be determined, and functions g (the boundary condition) and K (the kernel) are known. They are integral equations because the unknown function f appears inside the integral. <p> The term finite elements is a common name for all these methods. More on the theory behind the Galerkin method and other finite-element methods can be found in Delves and Mohamed <ref> [28] </ref> and the excellent course notes by Arvo [6]. 3.5 Simple Algorithm Here we will describe a simple, iterative, nonhierarchical solution method for the truncated radiance equation.
Reference: [29] <author> Tony D. DeRose, David H. Salesin, and Eric J. Stollnitz. </author> <title> Wavelets for computer graphics: A primer. </title> <booktitle> In SIGGRAPH '94 Computational Representations of Geometry, Course Notes 23, </booktitle> <pages> pages 113-141, </pages> <month> July </month> <year> 1994. </year>
Reference-contexts: In contrast, a multiresolution analysis gives information about local variation of the function, a mix of value and frequency information. Multiresolution analysis as formulated by Mallat [62] provides a convenient framework for studying hierarchical bases. Chui [20], Daubechies [27], DeRose et al. <ref> [29] </ref>, Stollnitz et al. [93] and others give more elaborate explanations of mul-tiresolution bases. <p> We call the corresponding wavelets splinelets. A few of these scaling functions and wavelets (defined on the interval [0, 1] for this example) are shown in figure 5.3. The basis shown is continuous, but not smooth. Smooth bases can be constructed from higher-order B-splines <ref> [29, 31, 93] </ref>. The corresponding wavelets have vanishing moments equal to the order of the spline. Example Daubechies [27] defined a class of wavelets called coiflets. These basis functions have as many vanishing moments as their order N, and are continuous and even smooth for higher orders.
Reference: [30] <author> Gerald Farin. </author> <title> Curves and Surfaces for Computer Aided Geometric Design: </title>
Reference-contexts: In our implementation, a patch can be either a Bezier surface or a quadrilateral. It would also be straightforward to add non-uniform rational B-spline surfaces <ref> [30] </ref>. In fact, the only requirements are that we need to be able to quickly 1. compute a position, surface normal, and differential area associated with a given parametric point (u 1 , u 2 ), and 2. determine the intersection of a ray with the surface.
References-found: 30

