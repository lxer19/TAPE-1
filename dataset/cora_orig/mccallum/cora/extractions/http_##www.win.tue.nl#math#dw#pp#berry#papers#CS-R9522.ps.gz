URL: http://www.win.tue.nl/math/dw/pp/berry/papers/CS-R9522.ps.gz
Refering-URL: http://www.win.tue.nl/math/dw/pp/berry/papers.html
Root-URL: http://www.win.tue.nl
Title: efficient electronic payment system withstanding parallel attacks  
Author: L.A.M. Schoenmakers 
Date: 1995  
Affiliation: Computer Science/Department of Algorithmics and  
Note: An  
Pubnum: Architecture CS-R9522  
Abstract: Centrum voor Wiskunde en Informatica REPORTRAPPORT 
Abstract-found: 1
Intro-found: 1
Reference: [Bra93] <author> S. Brands. </author> <title> An efficient off-line electronic cash system based on the representation problem. </title> <type> Report CS-R9323, </type> <institution> Centrum voor Wiskunde en Informatica, </institution> <month> March </month> <year> 1993. </year>
Reference-contexts: The goal is here to obtain a simple and efficient protocol that also makes the resulting payment system provably secure to some extent, thereby improving upon a similar system from <ref> [Bra93] </ref> (see also [Bra94a]). The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" [Cha92, CP93, CP94] as this can be added in a <p> The goal is here to obtain a simple and efficient protocol that also makes the resulting payment system provably secure to some extent, thereby improving upon a similar system from <ref> [Bra93] </ref> (see also [Bra94a]). The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" [Cha92, CP93, CP94] as this can be added in a modular way. <p> and efficient protocol that also makes the resulting payment system provably secure to some extent, thereby improving upon a similar system from <ref> [Bra93] </ref> (see also [Bra94a]). The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" [Cha92, CP93, CP94] as this can be added in a modular way. <p> By means of these three protocols, a coin "travels" along the triangle formed by the bank, user, and shop. These protocols are displayed in Figures 5, 6, and 7, respectively. The same mechanism as in <ref> [Bra93] </ref> is used to deal with the problem of double-spenders. In order to identify these we take g = g U 1 g 2 , where U denotes the user's secret key corresponding to the identity. <p> Yet, by using an additional generator g 0 , say, it is possible to achieve cryptographic protection against framing in much the same way as in <ref> [Bra93] </ref>. For registration each user chooses two random numbers U 0 and U 1 , and computes g = g U 0 1 g 2 . Subsequently, the user proves to the bank that he knows a representation of g=g 2 w.r.t. g 0 and g 1 . <p> The payment protocol is adapted accordingly and extended with an additional response r 0 . The verification relation for the shop becomes: g r 0 1 g r 2 ? To trace a double-spender the procedure from <ref> [Bra93] </ref> can be used. 7. Comparison with Brands' system We have not presented our payment system for the "wallet with observer" setting, since this can be done in exactly the same way as in [Bra93, Bra94b]. Therefore, we will not compare the proposed systems in this respect. <p> Comparison with Brands' system We have not presented our payment system for the "wallet with observer" setting, since this can be done in exactly the same way as in <ref> [Bra93, Bra94b] </ref>. Therefore, we will not compare the proposed systems in this respect. Also, we would like to stress that the blind signature protocol proposed in this paper is not intended as a building block for credential systems|in contrast with the intention of, e.g., [Bra95b].
Reference: [Bra94a] <author> S. Brands. </author> <title> Untraceable off-line cash in wallet with observers. </title> <booktitle> In Advances in Cryptology|CRYPTO '93, volume 773 of Lecture Notes in Computer Science, </booktitle> <pages> pages 302-318, </pages> <address> Berlin, 1994. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: The goal is here to obtain a simple and efficient protocol that also makes the resulting payment system provably secure to some extent, thereby improving upon a similar system from [Bra93] (see also <ref> [Bra94a] </ref>). The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" [Cha92, CP93, CP94] as this can be added in a modular way.
Reference: [Bra94b] <author> S. Brands. </author> <title> Off-line cash transfer by smart cards. </title> <editor> In V. Cordonnier and J.-J. Quisquater, editors, </editor> <booktitle> Proceedings First Smart Card Research and Advanced Application Conference, </booktitle> <pages> pages 101-117, </pages> <year> 1994. </year> <note> Also as report CS-R9455, </note> <institution> Centrum voor Wiskunde en Informatica. </institution>
Reference-contexts: Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" [Cha92, CP93, CP94] as this can be added in a modular way. The payment system is designed independently of <ref> [Bra94b] </ref>, however, which became available at the time of the CARDIS '94 conference (October 24-26, Lille, France) and later as technical report. A draft of the present paper [Sch94] has been circulated among members of the CAFE project in August 1994, but is independent of the results of that project. <p> At that time a few characteristics of an improved system had already been announced by Stefan Brands, but the solution was not revealed whatsoever. The above facts probably explain why the proposed systems are similar in structure and performance, yet with a crucial difference. The system of <ref> [Bra94b] </ref> is vulnerable to two types of so-called "parallel attacks", in which two users perform their withdrawals in parallel. <p> There are more reasons why the vulnerability to parallel attacks is undesirable, particularly when the protocols of <ref> [Bra94b] </ref> are applied to credential systems, as proposed in [Bra95b]. Needless to say that the straightforward way to prevent parallel attacks|by excluding parallel withdrawals (by different users) altogether|is undesirable. <p> For instance, if we take u = v, views match just when c c 0 = r 0 log g g 0 r, and the user's privacy is completely lost. 5. Security We now argue, informally, why the proposed payment system provides more security than the system of <ref> [Bra94b] </ref>. As for forgeries by single users, the security seems to be at least as good as the security of Brands' system: the proofs in [Bra95a] can be adapted to our system. <p> If this were the case, additional 1 A similar multiplicative property was used in the parallel attack [Ped94] on a previous version of [Sch94]. Later, this attack turned out to be applicable to <ref> [Bra94b] </ref> as well. Using the notation of that paper, it allows two users i and j, say, to obtain a certificate (h 0 ij ; : : :), where h 0 ij is of the form h s i h j . <p> Depending on the way this type of certificates is used, there are more undesirable consequences, even when the users are not able to break the tamper-resistance of their smart cards (or observers). For instance, the second way to deal with currency exchange rates proposed in Section 5 of <ref> [Bra94b] </ref> is completely insecure in the sense that users are able to obtain any rate they like without breaking the tamper-resistance of their smart cards. 6. Protection against framing 11 constraints on c i and c j might follow. <p> Comparison with Brands' system We have not presented our payment system for the "wallet with observer" setting, since this can be done in exactly the same way as in <ref> [Bra93, Bra94b] </ref>. Therefore, we will not compare the proposed systems in this respect. Also, we would like to stress that the blind signature protocol proposed in this paper is not intended as a building block for credential systems|in contrast with the intention of, e.g., [Bra95b]. <p> Also, we would like to stress that the blind signature protocol proposed in this paper is not intended as a building block for credential systems|in contrast with the intention of, e.g., [Bra95b]. The most important difference is the payment system of <ref> [Bra94b] </ref> is vulnerable to parallel attacks, which is considered highly undesirable (also for credential systems, of course), while our system seems to be resistant against this kind of attacks. <p> Another difference with Brands' system is that the generators g 1 and g 2 used in the interactive part of the payment protocol are different from the generators g and h used during withdrawal. In the system of <ref> [Bra94b] </ref> there is a generator g 0 , which is used both during withdrawal and during the interactive part of a payment. This double use of g 0 is a potential disadvantage. <p> References 13 Signer Receiver (h = g x a x b w a ; w b 2 R ZZ q a g b ! c r b w b + x b c ! g r a r b ? In <ref> [Bra94b, Bra95a, Bra95b] </ref> it is claimed that the approach applies to other signature schemes than Schnorr's scheme as well. The resulting payment systems are all subject to parallel attacks|as far as we can judge from these papers.
Reference: [Bra95a] <author> S. Brands. </author> <title> Off-line electronic cash based on secret-key certificates. </title> <type> References 14 Report CS-R9506, </type> <institution> Centrum voor Wiskunde en Informatica, </institution> <year> 1995. </year> <booktitle> To appear in the proceedings of the Second International Symposium of Latin American Theoretical Informatics (LATIN '95). </booktitle>
Reference-contexts: The first type of attack is by Torben Pedersen [Ped94], and was in fact conceived to break an earlier version of the blind signature protocol from [Sch94]. The second type of attack is by Stefan Brands, and is reported in <ref> [Bra95a] </ref> and [Bra95b]; in the former paper he also describes an "immunization" to his attack (at the cost of a loss in performance), but this doesn't help against the first type of attack. <p> Security We now argue, informally, why the proposed payment system provides more security than the system of [Bra94b]. As for forgeries by single users, the security seems to be at least as good as the security of Brands' system: the proofs in <ref> [Bra95a] </ref> can be adapted to our system. Since single-user attacks can thus be ignored at this point, the only thing that remains is that two or more users execute the withdrawal protocol in parallel. <p> References 13 Signer Receiver (h = g x a x b w a ; w b 2 R ZZ q a g b ! c r b w b + x b c ! g r a r b ? In <ref> [Bra94b, Bra95a, Bra95b] </ref> it is claimed that the approach applies to other signature schemes than Schnorr's scheme as well. The resulting payment systems are all subject to parallel attacks|as far as we can judge from these papers.
Reference: [Bra95b] <author> S. Brands. </author> <title> Restrictive blinding of secret-key certificates. </title> <type> Report CS-R9509, </type> <institution> Centrum voor Wiskunde en Informatica, </institution> <year> 1995. </year> <note> To appear in the proceedings of EUROCRYPT '95. </note>
Reference-contexts: The first type of attack is by Torben Pedersen [Ped94], and was in fact conceived to break an earlier version of the blind signature protocol from [Sch94]. The second type of attack is by Stefan Brands, and is reported in [Bra95a] and <ref> [Bra95b] </ref>; in the former paper he also describes an "immunization" to his attack (at the cost of a loss in performance), but this doesn't help against the first type of attack. <p> There are more reasons why the vulnerability to parallel attacks is undesirable, particularly when the protocols of [Bra94b] are applied to credential systems, as proposed in <ref> [Bra95b] </ref>. Needless to say that the straightforward way to prevent parallel attacks|by excluding parallel withdrawals (by different users) altogether|is undesirable. <p> Therefore, we will not compare the proposed systems in this respect. Also, we would like to stress that the blind signature protocol proposed in this paper is not intended as a building block for credential systems|in contrast with the intention of, e.g., <ref> [Bra95b] </ref>. The most important difference is the payment system of [Bra94b] is vulnerable to parallel attacks, which is considered highly undesirable (also for credential systems, of course), while our system seems to be resistant against this kind of attacks. <p> References 13 Signer Receiver (h = g x a x b w a ; w b 2 R ZZ q a g b ! c r b w b + x b c ! g r a r b ? In <ref> [Bra94b, Bra95a, Bra95b] </ref> it is claimed that the approach applies to other signature schemes than Schnorr's scheme as well. The resulting payment systems are all subject to parallel attacks|as far as we can judge from these papers.
Reference: [CFN90] <author> D. Chaum, A. Fiat, and M. Naor. </author> <title> Untraceable electronic cash. </title> <booktitle> In Advances in Cryptology|CRYPTO '88, volume 403 of Lecture Notes in Computer Science, </booktitle> <pages> pages 319-327, </pages> <address> Berlin, 1990. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: 1. Introduction 2 off-line payment systems was first introduced in <ref> [CFN90] </ref> as "accountability after the fact", and we will refer to it by this name. The hard nut to crack is therefore the design of a kind of blind signature protocol that can be used to issue such coins.
Reference: [Cha92] <author> D. Chaum. </author> <title> Achieving electronic privacy. </title> <publisher> Scientific American, </publisher> <pages> pages 96-101, </pages> <month> August </month> <year> 1992. </year>
Reference-contexts: The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" <ref> [Cha92, CP93, CP94] </ref> as this can be added in a modular way. The payment system is designed independently of [Bra94b], however, which became available at the time of the CARDIS '94 conference (October 24-26, Lille, France) and later as technical report.
Reference: [CP93] <author> D. Chaum and T. P. Pedersen. </author> <title> Wallet databases with observers. </title> <booktitle> In Advances in Cryptology|CRYPTO '92, volume 740 of Lecture Notes in Computer Science, </booktitle> <pages> pages 89-105, </pages> <address> Berlin, 1993. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" <ref> [Cha92, CP93, CP94] </ref> as this can be added in a modular way. The payment system is designed independently of [Bra94b], however, which became available at the time of the CARDIS '94 conference (October 24-26, Lille, France) and later as technical report.
Reference: [CP94] <author> R. Cramer and T. P. Pedersen. </author> <title> Improved privacy in wallets with observers. </title> <booktitle> In Advances in Cryptology|EUROCRYPT '93, volume 765 of Lecture Notes in Computer Science, </booktitle> <pages> pages 329-343, </pages> <address> Berlin, 1994. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: The payment system is designed along the lines of [Bra93] and incorporates several ideas from that paper. Therefore, to avoid too much overlap with [Bra93], we will, for instance, not treat the case of "wallet with observers" <ref> [Cha92, CP93, CP94] </ref> as this can be added in a modular way. The payment system is designed independently of [Bra94b], however, which became available at the time of the CARDIS '94 conference (October 24-26, Lille, France) and later as technical report.
Reference: [FY93] <author> M. Franklin and M. Yung. </author> <title> Secure and efficient off-line digital money. </title> <booktitle> In Automata, Languages and Programming, ICALP 93, volume 700 of Lecture Notes in Computer Science, </booktitle> <pages> pages 265-276, </pages> <address> Berlin, 1993. </address> <publisher> Springer-Verlag. </publisher>
Reference: [Oka93] <author> T. Okamoto. </author> <title> Provably secure and practical identification schemes and corresponding signature schemes. </title> <booktitle> In Advances in Cryptology| CRYPTO '92, volume 740 of Lecture Notes in Computer Science, </booktitle> <pages> pages 31-53, </pages> <address> Berlin, 1993. </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: Finally, in Section 7 we will summarize the differences between the proposed system and Brands' system, and it is shown that our approach is also applicable to Okamoto's variation of Schnorr's scheme <ref> [Oka93] </ref>. 2. Blind signature protocol In this section we present the blind signature protocol of [Sch94]. <p> Therefore, it is interesting to extend our approach to other signature schemes as well. As a first result in this direction we show how to obtain an efficient payment system that resists parallel attacks based on Okamoto's Identification Scheme 1 <ref> [Oka93] </ref>. The advantage of this scheme, which is a variation of Schnorr's scheme, is that it has been proven to be witness hiding (while this is only conjectured for Schnorr's scheme). Virtually the same approach can be followed, where g a plays the role of g, see Figure 9.
Reference: [Ped94] <author> T. P. Pedersen, </author> <month> August </month> <year> 1994. </year> <type> Personal communication. </type>
Reference-contexts: In the latter case, the bank will be unable to trace double-spenders, which means that the crucial property of accountability after the fact is not achieved. The first type of attack is by Torben Pedersen <ref> [Ped94] </ref>, and was in fact conceived to break an earlier version of the blind signature protocol from [Sch94]. <p> In addition we have that the values of r i and r j cannot be controlled by choosing proper values for c i and c j , respectively. If this were the case, additional 1 A similar multiplicative property was used in the parallel attack <ref> [Ped94] </ref> on a previous version of [Sch94]. Later, this attack turned out to be applicable to [Bra94b] as well. <p> The corresponding blind signature protocol can be derived in the same way as in Section 2. Acknowledgements It is a pleasure to thank Torben Pedersen <ref> [Ped94] </ref> for his instantaneous attack on an earlier version, to thank Ronald Cramer for his observations on the consequences of the existence of parallel attacks (e.g., the problem with the exchange rates mentioned in the footnote on page 10), and to thank both for inspiring discussions about the material for this
Reference: [Sch91] <author> C. P. Schnorr. </author> <title> Efficient signature generation by smart cards. </title> <journal> Journal of Cryptology, </journal> <volume> 4(3) </volume> <pages> 161-174, </pages> <year> 1991. </year>
Reference-contexts: The hard nut to crack is therefore the design of a kind of blind signature protocol that can be used to issue such coins. In this paper we will build such a protocol starting from Schnorr's signature protocol <ref> [Sch91] </ref>, which is based on the difficulty of computing discrete logarithms in groups of prime order. The goal is here to obtain a simple and efficient protocol that also makes the resulting payment system provably secure to some extent, thereby improving upon a similar system from [Bra93] (see also [Bra94a]). <p> Blind signature protocol In this section we present the blind signature protocol of [Sch94]. The protocol relies on several ideas, which we try to present kind of separately. 2.1 Schnorr signatures on a blind message In <ref> [Sch91] </ref> Schnorr presented an efficient signature scheme based on the difficulty of the discrete log problem. <p> The signature protocol is displayed in Figure 1, and is identical to Schnorr's identification scheme <ref> [Sch91] </ref> with the modification that c is computed as a hash-value of the initial value a and the message m, instead of choosing c random. 2.2 Blinded transcripts Although the protocol in Figure 1 has the property that the message signed remains unknown to the signer, the signer gains some information
Reference: [Sch94] <author> B. Schoenmakers. </author> <title> A new blind signature protocol. Internal CAFE document, </title> <publisher> Centrum voor Wiskunde en Informatica, </publisher> <month> August 8, </month> <year> 1994. </year>
Reference-contexts: The payment system is designed independently of [Bra94b], however, which became available at the time of the CARDIS '94 conference (October 24-26, Lille, France) and later as technical report. A draft of the present paper <ref> [Sch94] </ref> has been circulated among members of the CAFE project in August 1994, but is independent of the results of that project. At that time a few characteristics of an improved system had already been announced by Stefan Brands, but the solution was not revealed whatsoever. <p> The first type of attack is by Torben Pedersen [Ped94], and was in fact conceived to break an earlier version of the blind signature protocol from <ref> [Sch94] </ref>. The second type of attack is by Stefan Brands, and is reported in [Bra95a] and [Bra95b]; in the former paper he also describes an "immunization" to his attack (at the cost of a loss in performance), but this doesn't help against the first type of attack. <p> Finally, in Section 7 we will summarize the differences between the proposed system and Brands' system, and it is shown that our approach is also applicable to Okamoto's variation of Schnorr's scheme [Oka93]. 2. Blind signature protocol In this section we present the blind signature protocol of <ref> [Sch94] </ref>. The protocol relies on several ideas, which we try to present kind of separately. 2.1 Schnorr signatures on a blind message In [Sch91] Schnorr presented an efficient signature scheme based on the difficulty of the discrete log problem. <p> If this were the case, additional 1 A similar multiplicative property was used in the parallel attack [Ped94] on a previous version of <ref> [Sch94] </ref>. Later, this attack turned out to be applicable to [Bra94b] as well.
References-found: 14

