URL: http://www.cs.mtu.edu/~asandu/Deposit/sparse.ps.gz
Refering-URL: http://www.cs.mtu.edu/~asandu/publications.html
Root-URL: http://www.cs.mtu.edu
Title: of fully implicit methods for atmospheric chemical kinetics  
Author: A. Sandu F. A. Potra G. R. Carmichael V. Damian 
Keyword: Chemical kinetics, Stiff implicit integrators, Sparse linear algebra.  
Address: Iowa, Iowa City, IA 52246  Iowa, Iowa City, IA 52246  Iowa, Iowa City, IA 52246  Iowa, Iowa City, IA 52246  
Affiliation: Program in Applied Mathematics and Computational Sciences, The University of  Departments of Mathematics and Computer Science, The University of  Center for Global and Regional Environmental Research and Department of Chemical and Biochemical Engineering, The University of  Department of Computer Science, The University of  
Note: Efficient implementation  Subject classification:  
Email: (sandu@cgrer.uiowa.edu)  (potra@math.uiowa.edu).  (gcarmich@icaen.uiowa.edu)  (vdamian@cgrer.uiowa.edu)  
Web: 65L06, AA05.  
Abstract: REPORT ON COMPUTATIONAL MATHEMATICS 79/1995, DEPARTMENT OF MATHEMATICS, THE UNIVERSITY OF IOWA 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> E. Anderson, Z. Bai, C. Bischof, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum, S. Hammarling, A. McKenney, S. Ostrouchov, and D. Sorensen. </author> <title> LAPACK User's Guide, second edition. </title> <type> Technical report, </type> <institution> SIAM, </institution> <address> Philadelphia, PA, </address> <year> 1995. </year>
Reference-contexts: Such symmetric permutations can be viewed as a rearrangement (renumbering) of the species involved in the chemical mechanism (if the initial ordering was <ref> [1; :::; n] </ref> T , the new ordering will be [1; :::; n] T ). <p> Such symmetric permutations can be viewed as a rearrangement (renumbering) of the species involved in the chemical mechanism (if the initial ordering was <ref> [1; :::; n] </ref> T , the new ordering will be [1; :::; n] T ). We further restrict the class of possible permutations to those given by a global strategy; more exactly, we want to compute the permutation off-line, in the preprocessing stage (hence considering only the structure of the matrix and not particular numerical entries). <p> LINPACK O is LINPACK acting on the ordered matrix. Without any further intervention, other than species reordering, the decomposition time may be cut down significantly, as seen in Tables II, III. This is explained by the sparsity of L. 2. LAPACK The code available on netlib, see <ref> [1] </ref>. LAPACK is a collection of Fortran subroutines that supersedes both LINPACK and EIS-PACK. Tested routines: dgetrf and dgetrs. Results for both the ordered and the unordered system are given. 3. HARWELL MA28 The code, available on netlib, is written by I. S.
Reference: [2] <author> R.D. Atkinson, D.L. Baulch, R.A. Cox, R.F.JR. Hampson, J.A. Kerr, and J. Troe. </author> <title> Evaluated kinetic and photochemical data for atmospheric chemistry. </title> <journal> Journal of Chemical Kinetics, </journal> <volume> 21, </volume> <pages> p. 115-190, </pages> <year> 1989. </year>
Reference-contexts: The mechanism, based on the work of Lurmann et al. Efficient implementation of fully implicit methods 21 [14] and Atkinson et. al. <ref> [2] </ref> is representative of those presently being used in the study of chemically perturbed environments; it represents the major features of the photochemical oxidant cycle in the troposphere and can be used to study the chemistry of both highly polluted (e.g., near urban centers) and remote (e.g., marine) environments.
Reference: [3] <author> P.N. Brown, G.D. Byrne, and A.C. Hindmarsh. VODE: </author> <title> A Variable Step ODE Solver. </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 10, </volume> <pages> p. 1038-1051, </pages> <year> 1989. </year>
Reference-contexts: Three off-the-shelf integrators were used in the numerical experiments in both original and modified (sparse) versions. Each code is based on a different numerical scheme. * vode, the Variable coefficient ODE solver of Hindmarsch, Brown and Byrne, a BDF code. For details see <ref> [3] </ref>; * sdirk4 written by Hairer and Wanner, part of [10].
Reference: [4] <author> G.R. Carmichael, L.K. Peters, and T. Kitada. </author> <title> A second generation model for regional-scale transport/ chemistry/ deposition. Atmospheric environment, </title> <booktitle> 20, p. </booktitle> <pages> 173-188, </pages> <year> 1986. </year>
Reference-contexts: The values of initial concentrations for the most important species are given in Table IV. Test problem B employs the chemical mechanism that is presently used in the STEM-II regional-scale transport/ chemistry/ removal model (Carmichael et al., <ref> [4] </ref>), consisting of 86 chemical species involved in 142 thermal and 36 photolytic reactions . The mechanism, based on the work of Lurmann et al.
Reference: [5] <author> V. Damian-Iordache and A. Sandu. </author> <title> KPP A symbolic preprocessor for chemistry kinetics - User's guide. </title> <type> Technical report, </type> <institution> The University of Iowa, </institution> <address> Iowa City, IA 52246, </address> <year> 1995. </year>
Reference: [6] <author> J. J. B. de Swart and J. G. Blom. </author> <title> Experiences with sparse matrix solvers in parallel ODE software. </title> <type> Technical report, </type> <institution> Centrum voor Wiskunde en Informatica, </institution> <address> Kruislaan 413, 1098 SJ Amsterdam, </address> <year> 1995. </year>
Reference-contexts: The line parallelism shows that both code versions perform similarly in terms of accuracy; in particular, the accuracy does not seem to be affected by non-pivoting. This experimental conclusion is in agreement with the findings of other authors (see <ref> [6, 13, 21] </ref>). To summarize, figures 1 and 2 show that careful exploitation of sparsity leads to significant improvements in the efficiency of implicit numerical integrators.
Reference: [7] <author> J. J. Dongarra, J. R. Bunch, C. B. Moller, and G. W. Stewart. </author> <title> LINPACK User's Guide. </title> <type> Technical report, </type> <institution> SIAM, </institution> <address> Philadelphia, PA, </address> <year> 1979. </year>
Reference-contexts: Each call to DEC was followed by 0 and by 7 calls to SOL (for timing DEC only, and for simulating the calls made by an implicit integrator). 4.3 Short description of linear system solvers tested. 4.3.1 Off-the-shelf solvers 1. LINPACK The code is available on netlib, see <ref> [7] </ref>. LINPACK uses column-oriented algorithms to increase efficiency by preserving locality of reference. Here we test the routines dgefa and dgesl. LIN Efficient implementation of fully implicit methods 12 PACK U is LINPACK, acting on the unordered matrix.
Reference: [8] <author> I. S. Duff, A. M. Erisman, and J. K. Reid. </author> <title> Direct Methods for Sparse Matrices. </title> <publisher> Oxford Science Publications, Clarendon Press Oxford, </publisher> <year> 1986. </year>
Reference-contexts: This results in a small overhead when DECOMPOSE-ing, and a large speed-up when solving. This version is more efficient when a large number of SOLVEs follow each decomposition. 3. DOOLITTLE This routine uses a row-oriented Doolittle factorization (see <ref> [8] </ref> for more details on this algorithm). Line k in L is computed, Efficient implementation of fully implicit methods 15 followed by the computation of line k in U. <p> Has the advantage of working on a uniform representation of the matrix (one vector of nonzero elements, unlike SLAP, which requires one vector for L, one for U and one for D). Each row is decompressed before, and re-compressed again after processing (see <ref> [8] </ref>). Efficient implementation of fully implicit methods 17 This moves most of the indirect addressings from the O (n 2 ) loop to two O (n) loops.
Reference: [9] <author> G. Golub and C. F. van Loan. </author> <title> Matrix computations. </title> <publisher> Johns Hopkins University Press, </publisher> <address> Baltimore and London, </address> <year> 1983. </year> <title> Efficient implementation of fully implicit methods 32 </title>
Reference: [10] <author> E. Hairer and G. Wanner. </author> <title> Solving Ordinary Differential Equations II. Stiff and Differential-Algebraic Problems. </title> <publisher> Springer-Verlag, </publisher> <address> Berlin, </address> <year> 1991. </year>
Reference-contexts: Each code is based on a different numerical scheme. * vode, the Variable coefficient ODE solver of Hindmarsch, Brown and Byrne, a BDF code. For details see [3]; * sdirk4 written by Hairer and Wanner, part of <ref> [10] </ref>. <p> methods 20 Species Initial Species Initial name (ppb) name (ppb) O 8.15 O 3 656 HN O 3 0.35 H 2 O 6100 H 2 370 CH 4 490 HC` 2.15 HOC` 0.22 Table IV: Initial concentrations for stratospheric model A. * rodas written by Hairer and Wanner, part of <ref> [10] </ref>. Based on sti*y accurate Rosenbrock method of order four with six stages. 4.6 Test problems Test problem A corresponds to a stratospheric (altitude 40 Km) box model. It is available at NASA ftp site, contact Douglas E. Kinnison, kinni-son1@llnl.gov. <p> In this section the results for the test problem are compared to the solution computed by the code RADAU5 of E. Hairer and G. Wanner <ref> [10] </ref> with very tight tolerances rtol = 10 12 and atol = 10 10 [mlc=cm 3 ]. <p> Using higher order methods based on explicit formulas may not pay off, because of the order reduction phenomenon (see [15, 20]), and since higher accuracy and stability are in general contradictory requirements (see <ref> [10] </ref>). * Multistep, Runge-Kutta and standard Rosenbrock methods all enjoy the property of conserving the linear invariants of the system (for example, they are structurally mass-conservative). Neither qssa nor chemeq have this desirable property.
Reference: [11] <author> E. Hesstvedt, O. Hov, and I. Isaacsen. </author> <title> Quasi-steady-state-approximation in air pollution modelling: comparison of two numerical schemes for oxidant prediction. </title> <journal> Int. J. Chem. Kinet., </journal> <volume> 10, </volume> <pages> p. 971-994, </pages> <year> 1978. </year>
Reference-contexts: In addition to presenting the results for sparse implicit integrators, we perform a comparison with the widely used algorithms qssa (see <ref> [11] </ref>), chemeq (see [22]) and the sparse BDF code lsodes (see [12]). * qssa is used with a dynamic partitioning of the species into slow, fast and normal, function of step-size h and the species life-time t i = 1=D i .
Reference: [12] <author> A. Hindmarsch. ODEPACK: </author> <title> A systematized collection of ODE solvers. </title> <editor> Ed. </editor> <publisher> North Holland, </publisher> <address> Amsterdam, </address> <year> 1983. </year>
Reference-contexts: In addition to presenting the results for sparse implicit integrators, we perform a comparison with the widely used algorithms qssa (see [11]), chemeq (see [22]) and the sparse BDF code lsodes (see <ref> [12] </ref>). * qssa is used with a dynamic partitioning of the species into slow, fast and normal, function of step-size h and the species life-time t i = 1=D i .
Reference: [13] <author> M.Z. Jacobson and R.P. Turco. SMVGEAR: </author> <title> a sparse-matrix, vectorized Gear code for atmospheric models. Atmospheric Environment, </title> <booktitle> 17, p. </booktitle> <pages> 273-284, </pages> <year> 1994. </year>
Reference-contexts: On the other hand, exploitation of sparsity may significantly reduce the linear algebra overhead. Recently, several authors showed promising results with sparse BDF codes in atmospheric chemistry models. In <ref> [13] </ref> M. Jacobson and R. Turco describe smvgear a BDF code that uses vectorization around the grid cell-dimension. Treatment of sparsity is an essential ingredient in decreasing the computational time. In [21] J.G. Verwer et. al. use a sparse version of vode. <p> In [21] J.G. Verwer et. al. use a sparse version of vode. Their treatment of sparsity is based on the netlib package slap. In this paper we develop a systematic way of exploiting sparsity when integrating atmospheric chemistry equations. Unlike <ref> [13] </ref>, our target is not a specialized architecture; we concentrate on developing machine-independent algorithms. In section 3 we discuss and evaluate reordering techniques that lead to minimal fill-in during LU decomposition. <p> This form of the prediction matrix holds for multistep schemes and, after an equivalence transformation, for Runge-Kutta methods as well. Several authors ([6], <ref> [13] </ref>, [21]) report good results with non-pivoting sparse linear algebra solvers, when integrating atmospheric chemistry equations. This saves computational time. <p> The line parallelism shows that both code versions perform similarly in terms of accuracy; in particular, the accuracy does not seem to be affected by non-pivoting. This experimental conclusion is in agreement with the findings of other authors (see <ref> [6, 13, 21] </ref>). To summarize, figures 1 and 2 show that careful exploitation of sparsity leads to significant improvements in the efficiency of implicit numerical integrators. <p> What prevented so far implicit methods from being widely used in three dimensional, comprehensive atmospheric models is the fact that they are considered too slow for this type of application (except for the case when special hardware is available seethe smvgear code <ref> [13] </ref>, running on cray-ymp). However, we show that this is not the case when the linear algebra is carefully implemented. One can enjoy all the above benefits of implicit methods while remaining computationally very competitive.
Reference: [14] <author> F.W. Lurmann, A.C. Loyd, and R. Atkinson. </author> <title> A chemical mechanism for use in long-range transport/acid deposition computer modelling. </title> <journal> Journal of Geophysical Research, </journal> <volume> 91, </volume> <editor> p. 10,905-10,936, </editor> <year> 1986. </year>
Reference-contexts: The mechanism, based on the work of Lurmann et al. Efficient implementation of fully implicit methods 21 <ref> [14] </ref> and Atkinson et. al. [2] is representative of those presently being used in the study of chemically perturbed environments; it represents the major features of the photochemical oxidant cycle in the troposphere and can be used to study the chemistry of both highly polluted (e.g., near urban centers) and remote
Reference: [15] <author> L.O. Jay and A. Sandu and F.A. Potra and G.R. </author> <title> Carmichael Improved QSSA methods for atmospheric chemistry integration. </title> <note> Accepted for publication in Siam Journal on Scientific Computing, </note> <year> 1996. </year>
Reference-contexts: Using higher order methods based on explicit formulas may not pay off, because of the order reduction phenomenon (see <ref> [15, 20] </ref>), and since higher accuracy and stability are in general contradictory requirements (see [10]). * Multistep, Runge-Kutta and standard Rosenbrock methods all enjoy the property of conserving the linear invariants of the system (for example, they are structurally mass-conservative). Neither qssa nor chemeq have this desirable property.
Reference: [16] <author> A. Sandu, J. G. Verwer, M. van Loon, F.A. Potra and G.R. </author> <title> Carmichael Benchmarking stiff ODE solvers for atmospheric chemistry equations I: Implicit versus Explicit. </title> <note> Report in Computational Mathematics no 85, </note> <institution> The University of Iowa, Department of Mathematics, Iowa City, IA 52246. and CWI Report NM-9603, </institution> <address> Amsterdam. </address>
Reference-contexts: quality models usually contain chemical conditions ranging from ground level to upper troposphere and from marine environments to heavily polutted urban centers. * For problems involving inter-phase mass transfer explicit codes may become unstable; an example of gas-liquid chemistry for which all explicit integrators completely fail can be found in <ref> [16] </ref>. * The higher orders of consistency of standard implicit methods lead to substantial improvements in accuracy.
Reference: [17] <author> R. D. Saylor and G. D. Ford. </author> <title> On the comparison of numerical methods for the integration of kinetic equations in atmospheric chemistry and transport models. Atmospheric Environment, </title> <booktitle> 29, p. </booktitle> <pages> 2585-2593, </pages> <year> 1995. </year> <title> Efficient implementation of fully implicit methods 33 </title>
Reference-contexts: fully implicit methods 24 If t i &gt; 100 h the species is slow and is integrated with forward Euler formula; If t i &lt; 0:1 h the species is fast and is considered at steady state; Otherwise, exponential qssa formula is applied. * chemeq is used as specified in <ref> [17] </ref>: If t i &lt; 0:2 h the species is fast and is considered at steady-state; If t i &gt; 5 h the species is slow and is integrated with the nonstiff chemeq formula; For all other species the chemeq stiff formula is used. * lsodes is the sparse version of <p> LSODE and lsodes are often used to solve the atmospheric chemical kinetics equations (see <ref> [17] </ref>). The code was used with M F = 121, i.e. analytical Jacobian with an inner estimation of the sparsity structure. For implicit integrators, the same parameter setting for both sparse and off-the-shelf versions was used.
Reference: [18] <author> D. Shyan-Shu Shieh, Y. Chang, and G.R. </author> <title> Carmichael. The evaluation of numerical techniques for solution of stiff ODE arising from chemical kinetic problems. </title> <journal> Environmental Software, </journal> <volume> 3, </volume> <year> 1988. </year>
Reference-contexts: A comparison of the exactness and time efficiency of different integrators can be found in the paper of Shieh, Carmichael et al. <ref> [18] </ref>. On the other hand, exploitation of sparsity may significantly reduce the linear algebra overhead. Recently, several authors showed promising results with sparse BDF codes in atmospheric chemistry models. In [13] M. Jacobson and R. Turco describe smvgear a BDF code that uses vectorization around the grid cell-dimension.
Reference: [19] <author> S. Sillman. </author> <title> A numerical solution for the equations of tropospheric chemistry based on an analysis of sources and sinks of odd hydrogen. </title> <journal> Journal of Geophysical Research, </journal> <volume> 96, </volume> <pages> p. 20735-20744, </pages> <year> 1991. </year>
Reference-contexts: The same permutation is then used throughout the computation, thus reducing the workload associated with sparse data structure manipulation. The following strategies were considered: 1. Intuitive. A reordering based on the reactivity of the species. This requires specific knowledge regarding the chemical mechanism and has been applied successfully in <ref> [19] </ref>. Since our aim here is to minimize the fill-in, we ordered the species decreasingly after their characteristic life-time (the inverse of average destruction term, the average being taken over the two day integration interval); Efficient implementation of fully implicit methods 8 2. Row.
Reference: [20] <author> J. G. Verwer and M. </author> <title> van Loon An evaluation of explicit Pseudo-Steady-State Approximation schemes for stiff ODE systems from chemical kinetics. </title> <journal> Journal of Computational Physics, </journal> <volume> 113, </volume> <pages> p. 347-352, </pages> <year> 1994. </year>
Reference-contexts: Using higher order methods based on explicit formulas may not pay off, because of the order reduction phenomenon (see <ref> [15, 20] </ref>), and since higher accuracy and stability are in general contradictory requirements (see [10]). * Multistep, Runge-Kutta and standard Rosenbrock methods all enjoy the property of conserving the linear invariants of the system (for example, they are structurally mass-conservative). Neither qssa nor chemeq have this desirable property.
Reference: [21] <author> J. Verwer, J. G. Blom, M. van Loon, and E. J. Spee. </author> <title> A comparison of stiff ODE solvers for atmospheric chemistry problems. Atmospheric Environment, </title> <booktitle> 30, p. </booktitle> <pages> 49-58, </pages> <year> 1996. </year>
Reference-contexts: Recently, several authors showed promising results with sparse BDF codes in atmospheric chemistry models. In [13] M. Jacobson and R. Turco describe smvgear a BDF code that uses vectorization around the grid cell-dimension. Treatment of sparsity is an essential ingredient in decreasing the computational time. In <ref> [21] </ref> J.G. Verwer et. al. use a sparse version of vode. Their treatment of sparsity is based on the netlib package slap. In this paper we develop a systematic way of exploiting sparsity when integrating atmospheric chemistry equations. <p> In section 3 we discuss and evaluate reordering techniques that lead to minimal fill-in during LU decomposition. We then (section 4.3) test Efficient implementation of fully implicit methods 5 various linear system solvers, in particular showing that the chosen routine is twice as fast as the one used in <ref> [21] </ref>; finally (section 5) we demonstrate how the chosen solver can improve the efficiency of some state-of-the-art stiff ODE solvers. <p> This form of the prediction matrix holds for multistep schemes and, after an equivalence transformation, for Runge-Kutta methods as well. Several authors ([6], [13], <ref> [21] </ref>) report good results with non-pivoting sparse linear algebra solvers, when integrating atmospheric chemistry equations. This saves computational time. <p> The line parallelism shows that both code versions perform similarly in terms of accuracy; in particular, the accuracy does not seem to be affected by non-pivoting. This experimental conclusion is in agreement with the findings of other authors (see <ref> [6, 13, 21] </ref>). To summarize, figures 1 and 2 show that careful exploitation of sparsity leads to significant improvements in the efficiency of implicit numerical integrators.
Reference: [22] <author> T. R. Young and J. P. Boris. </author> <title> A numerical technique for solving stiff ODE associated with the chemical kinetics of reactive flow problems. </title> <journal> Journal of Physical Chemistry, </journal> <volume> 81, </volume> <pages> p. 2424-2427, </pages> <year> 1977. </year>
Reference-contexts: In addition to presenting the results for sparse implicit integrators, we perform a comparison with the widely used algorithms qssa (see [11]), chemeq (see <ref> [22] </ref>) and the sparse BDF code lsodes (see [12]). * qssa is used with a dynamic partitioning of the species into slow, fast and normal, function of step-size h and the species life-time t i = 1=D i .
References-found: 22

