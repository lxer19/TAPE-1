URL: http://www.crs4.it/~cmn/GeoComp/Papers/ParComp/mts.ps.gz
Refering-URL: http://www.crs4.it/~cmn/Parcomp/pcg_papers.html
Root-URL: 
Title: Parallel Implementation of the `Multiple Time Scales' Algorithm for Molecular Dynamics Applied to Flexible Water Models  
Author: Carlo Nardone Pietro Rossi Maria Valentini 
Date: Apr 1993  
Note: 7th  submitted to J. Comp. Chem.  
Address: via N.Sauro 10, I-09123 Cagliari, Italy  
Affiliation: Center for Advanced Studies, Research and Development in Sardinia  
Pubnum: CRS4,  
Abstract-found: 0
Intro-found: 1
Reference: [1] <author> G. Ciccotti and J.-P. Ryckaert, </author> <title> "Molecular dynamics simulation of rigid molecules", </title> <journal> Computer Phys. Rep., </journal> <volume> 4, </volume> <month> 345-392 </month> <year> (1986). </year>
Reference-contexts: The former is based on writing Euler equation for a rigid body, whereas the latter relies on adding Lagrange's multipliers to the forces, such that the constraints are fulfilled at each time step <ref> [1] </ref>. Those forces are found by solving a set of nonlinear equations, whose linearization is a sparse matrix, using an iterative scheme (the SHAKE algorithm or its variations [2]). A totally different approach would be to consider non-rigid molecules, where atoms follow their own dynamics. <p> A possible advantage over the SHAKE scheme implemented on MPP is due to the better load balancing among processors, because the number of SHAKE iterations is dominated by the worst case. Of course, one must consider that the model under study is radically changed. As pointed out in <ref> [1] </ref>, a constrained system is qualitatively different from a system with "hard" degrees of freedom. We adopted a MTS algorithm independently described by Sexton and Weingarten for Hybrid Monte Carlo calculations on Lattice Field Theory 6 [4], and by Tuckerman and coworkers [5]. <p> This also ensures good load balancing among processors in a MPP computer, while SHAKE performance is bounded to the worst case, being an iterative scheme. Finally, it is true that "hard" degrees of freedom are difficult to thermalise <ref> [1] </ref>, but there are suitable and 22 reliable tools like Maxwellian shu*ing, to circumvent this difficulty, as we have shown.
Reference: [2] <author> W. F. van Gunsteren and H. J. C. </author> <title> Berendsen, </title> <journal> Molec. Phys., </journal> <volume> 34, </volume> <month> 1311 </month> <year> (1977). </year>
Reference-contexts: Those forces are found by solving a set of nonlinear equations, whose linearization is a sparse matrix, using an iterative scheme (the SHAKE algorithm or its variations <ref> [2] </ref>). A totally different approach would be to consider non-rigid molecules, where atoms follow their own dynamics. In this case, the constraining bond lengths and angles would oscillate within suitably defined intramolecular potentials.
Reference: [3] <author> B. G. J. P. T. Murray, P. A. Bash, and M. Karplus, </author> <title> "Molecular dynamics on the connection machine system", </title> <type> Technical Report TMC-31 CB88-3, </type> <institution> Thinking Machines Corporation, </institution> <year> 1988. </year>
Reference-contexts: Therefore MTS offers the same computational complexity as rigid models. In a MPP data-parallel implementation, as long as the number of processors p ~ O (N), the computation time of the former scales as N, but the latter scales only as a constant <ref> [3] </ref>. A possible advantage over the SHAKE scheme implemented on MPP is due to the better load balancing among processors, because the number of SHAKE iterations is dominated by the worst case. Of course, one must consider that the model under study is radically changed. <p> status in a ring which is cshifted N 1 times in order to pass the status to every other particle, accumulating the forces acting onto each particle (the last cshift would correspond to self-interaction, therefore it is skipped); this technique is also called "digital orrery" in the Thinking Machine parlance <ref> [3] </ref>. In view of the target number of molecules to model, we have chosen the second approach, assigning a molecule to each processor.
Reference: [4] <author> J.C. Sexton and D.H. Weingarten, </author> <title> "Hamiltonian evolution for the hybrid monte carlo algorithm", </title> <type> Technical Report RC 17668, </type> <institution> IBM Research Division, </institution> <year> 1992. </year>
Reference-contexts: As pointed out in [1], a constrained system is qualitatively different from a system with "hard" degrees of freedom. We adopted a MTS algorithm independently described by Sexton and Weingarten for Hybrid Monte Carlo calculations on Lattice Field Theory 6 <ref> [4] </ref>, and by Tuckerman and coworkers [5]. <p> Par.3 is devoted to the parallel implementation, while we show some results of the simulation in Par.4. Finally, conclusions are drawn in Par.5. 7 1 The MTS algorithm Here we will describe briefly the MTS algorithm <ref> [4, 5] </ref> for reader's conve nience, using mostly Sexton and Weingarten's formalism. <p> t L (V f (q))]exp [ n 1 X p 2 m i t L (V f (q))] fi t L (V s (q))] (8) is equal to exp [tL (H) + t 3 *] i.e. again approximately equal to the Hamil-tonian evolution with an error O (t 3 ) <ref> [4] </ref>.
Reference: [5] <author> M.E. Tuckerman, B.J. Berne, and G. J. Martyna, </author> <title> "Reversible multiple time scale molecular dynamics", </title> <journal> J. Chemical Phys., </journal> <volume> 97, </volume> <year> 1990-2001 (1992). </year>
Reference-contexts: As pointed out in [1], a constrained system is qualitatively different from a system with "hard" degrees of freedom. We adopted a MTS algorithm independently described by Sexton and Weingarten for Hybrid Monte Carlo calculations on Lattice Field Theory 6 [4], and by Tuckerman and coworkers <ref> [5] </ref>. It has the advantage of being inherently time reversible and area-preserving (in the sense of Liouville's theorem), therefore the energy drift is negligible; furthermore the energy is conserved with an accuracy O (t 2 ), i.e. equivalent to the standard Verlet or leap-frog integration scheme. <p> Par.3 is devoted to the parallel implementation, while we show some results of the simulation in Par.4. Finally, conclusions are drawn in Par.5. 7 1 The MTS algorithm Here we will describe briefly the MTS algorithm <ref> [4, 5] </ref> for reader's conve nience, using mostly Sexton and Weingarten's formalism.
Reference: [6] <author> A. Rahman and F. H. Stillinger, </author> <title> "Molecular dynamics study of liquid water", </title> <journal> J. Chemical Phys., </journal> <volume> 55, </volume> <month> 3336-3359 </month> <year> (1971). </year> <month> 24 </month>
Reference-contexts: We choose to consider water because it is a simple, non-trivial example of a polyatomic molecule, which is also of obvious scientific interest. Indeed, one of the first MD simulations on polyatomic molecules, were performed on water using the quaternions method <ref> [6] </ref>. Furthermore, in [7] the properties of some flexible models of water are described, but the authors, there, used a naive MTS approach which has bad energy conservation properties. To our knowledge, this paper shows for the first time a reversible MTS simulation of a polyatomic molecule.
Reference: [7] <author> Anders Wallqvist and Olle Teleman, </author> <title> "Properties of flexible water models", </title> <journal> Molec. Phys., </journal> <volume> 74, </volume> <month> 515-533 </month> <year> (1991). </year>
Reference-contexts: We choose to consider water because it is a simple, non-trivial example of a polyatomic molecule, which is also of obvious scientific interest. Indeed, one of the first MD simulations on polyatomic molecules, were performed on water using the quaternions method [6]. Furthermore, in <ref> [7] </ref> the properties of some flexible models of water are described, but the authors, there, used a naive MTS approach which has bad energy conservation properties. To our knowledge, this paper shows for the first time a reversible MTS simulation of a polyatomic molecule. <p> Furthermore, the oxygen atoms interact each other through a Lennard-Jones potential V (r) = 4* 12 r (10) 12 with interaction length = 3:166 A and potential well * = 0:6502 kJ/mole. We tested as intramolecular potential an harmonic one, with the parameters used in reference <ref> [7] </ref>. <p> into account as well in a self-consistent way brought us to demonstrate the MTS algorithm on a simpler model, because the accuracy of the water model used is beyond the scope of the present paper. 13 Note that the MTS algorithm described in [12] (and used by the authors in <ref> [7] </ref>) is neither area preserving nor time reversible and therefore suffers from the problem of energy drift. <p> This is to be compared with <ref> [7] </ref> who have a drift of 9:3 10 4 ps 1 , i.e. 400 times higher, on a system of 216 19 molecules on a comparable number of steps. <p> The data is fitted reasonably well by the predicted O (t 2 ) accuracy. Adding the inner degrees of freedom in the water model induces some interesting effect already pointed out in <ref> [7] </ref>. We also observe a streching of the OH bond length by 0:015 A at 300 K and a concomitant decrease of the HOH bond angle by 4 o , which can be explained by the formation of water dimers through hydrogen bonds.
Reference: [8] <author> M. P. Allen and D. J. Tildesley, </author> <title> Computer Simulation of Liquids, </title> <publisher> Claren-don Press, </publisher> <year> 1987. </year>
Reference-contexts: This 2-step form of the leapfrog scheme is equivalent to the "velocity Verlet" scheme <ref> [8] </ref>, as can be seen by substi tuting the first equation in the third one. The reversibility stems naturally from the symmetry of the product Eq.6; the area d (p)d (q) is preserved because of the Hamiltonian character of the propagators Eq.4 and Eq.5.
Reference: [9] <author> H. J. C. Berendsen, J. P. M. </author> <title> Postma, </title> <editor> W. F. van Gunsteren, and J. Her-mans, in B. Pullman (ed.), </editor> <booktitle> Intermolecular Forces, </booktitle> <publisher> Reidel, </publisher> <year> 1981, </year> <month> p.331. </month>
Reference-contexts: The SPC water model <ref> [9] </ref> is a 3-sites model where the sites coincide with the O and H nuclei and are assigned respectively -0.82e and 0.41e electric charge.
Reference: [10] <author> J. H. Dunn, S. G. Lambrakos, P. G. Moore, and M. Nagumo, </author> <title> "An algorithm for calculating intramolecular angle-dependent forces on vector computers", </title> <journal> J. Comput. Phys., </journal> <volume> 100, </volume> <month> 17-24 </month> <year> (1992). </year>
Reference-contexts: The constants k r and k have been chosen equal respectively to 4:637 10 5 kJ=mole nm 2 and 383 kJ=mole rad 2 . The contribution of the term depending on the angle bending is spread over the atoms using formulas (12-14) in <ref> [10] </ref>. It must be noted that a refinement of the model is necessary, because SPC has been calibrated for a rigid situation while we simply superimposed the intramolecular interactions on top of it.
Reference: [11] <author> G. Corongiu, </author> <title> "Molecular dynamics simulations for liquid water using a polarizable and flexible potential", </title> <journal> Int. J. Quantum Chem., </journal> <volume> 42, </volume> <month> 1209-1235 </month> <year> (1992). </year>
Reference-contexts: An example of model which takes into account flexibility in a rigorous ab initio approach is given in <ref> [11] </ref>.
Reference: [12] <author> O. Teleman and B. Jonsson, </author> <title> "Vectorizing a general purpose molecular dynamics simulation program", </title> <journal> J. Comput. Chem., </journal> <volume> 7, </volume> <month> 59 </month> <year> (1986). </year>
Reference-contexts: However the necessity of taking polarizability into account as well in a self-consistent way brought us to demonstrate the MTS algorithm on a simpler model, because the accuracy of the water model used is beyond the scope of the present paper. 13 Note that the MTS algorithm described in <ref> [12] </ref> (and used by the authors in [7]) is neither area preserving nor time reversible and therefore suffers from the problem of energy drift. <p> First of all, it lacks reversibility, secondly the mixed term containing L ( P i p i;f p i;s ) is absent. A poor energy conservation is indeed observed, and the authors suggest swapping q i;s and q i;f from time to time to ease the problem <ref> [12] </ref>. 3 Parallel implementation Molecular Dynamics is a typical example of the N-body problem. When the interactions are long-range (which is the case in charged systems like water) one must consider all the N (N 1)=2 pairs of particles (discarding multiple interactions).
Reference: [13] <author> Ernesto Bonomi and Marco Tomassini, </author> <title> "Massively data-parallel molecular dynamics", </title> <journal> Int. J. Modern Phys. C, </journal> <volume> 3, </volume> <month> 709-731 </month> <year> (1992). </year> <month> 25 </month>
Reference-contexts: Leaving aside known methods to handle the O (N 2 ) interactions indirectly, such as multipole expansion and particle-mesh, we are left with a particle-particle treatment. This class of problems displays an intrinsic data-parallelism <ref> [13] </ref> that can be exploited differently (in the framework of a MPP computational environment) according to the ratio between the number of particles N and the number of (virtual) processors p available: 1. p ~ O (N 2 ) ) one processor per binary interaction; 2. p ~ O (N) )
Reference: [14] <author> Ernesto Bonomi, </author> <title> "Molecular dynamical simulation of the canonical ensemble", </title> <journal> J. Stat. Phys., </journal> <volume> 39, </volume> <month> 167-180 </month> <year> (1985). </year>
Reference-contexts: We have found that the Maxwellian shu*e technique thermalise each degree of freedom at room temperature within 2 ps only (see Fig. 2b). This technique consists in updating the velocities of all atoms with a Maxwell-Boltzmann distribution at the desired temperature every few time steps <ref> [14, 15] </ref> (in our case, every 100 time steps of 1 fs). This corresponds to putting each particle instantaneously in contact with a heat bath, to force ergodicity of the N-body system.
Reference: [15] <author> J. L. Fattebert and E. Bonomi, </author> <title> "Isothermal molecular dynamics: a practical study", </title> <journal> Int. J. Modern Phys. C, </journal> <month> 4 </month> <year> (1993). </year>
Reference-contexts: We have found that the Maxwellian shu*e technique thermalise each degree of freedom at room temperature within 2 ps only (see Fig. 2b). This technique consists in updating the velocities of all atoms with a Maxwell-Boltzmann distribution at the desired temperature every few time steps <ref> [14, 15] </ref> (in our case, every 100 time steps of 1 fs). This corresponds to putting each particle instantaneously in contact with a heat bath, to force ergodicity of the N-body system.
Reference: [16] <author> Dieter W. Heermann, </author> <title> Computer Simulation Methods in Theoretical Physics, </title> <publisher> Springer-Verlag (1986). </publisher>
Reference-contexts: The time steps used were t = 1 fs for the "slow" and t f = 0.1 fs for the "fast" forces, which gives a fluctuation of the total energy of approximately 1% of the fluctuation in the total potential energy, as commonly required <ref> [16] </ref>. Fig. 3 shows the total energy fluctuation observed in our system of 512 molecules at 300 K as a function of t in log-log plot. The data is fitted reasonably well by the predicted O (t 2 ) accuracy.

References-found: 16

