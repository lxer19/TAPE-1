URL: http://www.graphics.cornell.edu/pubs/1994/LSG94.ps.gz
Refering-URL: http://www.graphics.cornell.edu/pubs/1994/LSG94.html
Root-URL: 
Title: Bounds and Error Estimates for Radiosity  
Author: Dani Lischinski Brian Smits Donald P. Greenberg 
Keyword: CR Categories and Subject Descriptors: I.3.3[Computer Graphics]: Picture/Image Generation; I.3.7[Computer Graphics]: Three-Dimensional Graphics and Realism Radiosity. Additional Key Words and Phrases: a posteriori error bounds and estimates, adaptive refinement, global illumination, hierarchical radiosity, importance  
Affiliation: Program of Computer Graphics Cornell University  
Abstract: We present a method for determining a posteriori bounds and estimates for local and total errors in radiosity solutions. The ability to obtain bounds and estimates for the total error is crucial for reliably judging the acceptability of a solution. Realistic estimates of the local error improve the efficiency of adaptive radiosity algorithms, such as hierarchical radiosity, by indicating where adaptive refinement is necessary. First, we describe a hierarchical radiosity algorithm that computes conservative lower and upper bounds on the exact radiosity function, as well as on the approximate solution. These bounds account for the propagation of errors due to interreflections, and provide a conservative upper bound on the error. We also describe a non-conservative version of the same algorithm that is capable of computing tighter bounds, from which more realistic error estimates can be obtained. Finally, we derive an expression for the effect of a particular interaction on the total error. This yields a new error-driven refinement strategy for hierarchical radiosity, which is shown to be superior to brightness-weighted refinement. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> ANSELONE, P. M. </author> <title> Convergence and Error Bounds for Approximate Solutions of Integral and Operator Equations. In Error in Digital Computation, </title> <editor> L. B. Rall, Ed., </editor> <volume> vol. 2, </volume> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1965, </year> <pages> pp. 231-252. </pages>
Reference-contexts: The theory of integral equations <ref> [1, 10] </ref> provides an a priori error analysis of computational methods for Fredholm equations of the second kind. This general framework is valuable for analyzing convergence rates [10], and for bounding various components of the error in terms of the corresponding operator norms [3].
Reference: [2] <author> ARVO, JAMES. </author> <title> The Irradiance Jacobian for Partially Occluded Polyhedral Sources. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1994. </year>
Reference-contexts: Such numerical methods are discussed in detail by Campbell [7]. These methods generally require the computation of form-factor gradients in the presence of occluders, which can be done either using finite differences or analytically, as described by Arvo <ref> [2] </ref>. In our current implementation we estimate form-factor bounds by evaluating the analytical point-to-polygon form-factor [18] at the center and at the vertices of each receiving patch. In the partially occluded case, the analytical formula is applied only to the visible parts of the source [16]. <p> In all these fields numerical accuracy of the results is even more crucial than in image synthesis. Much further work is needed on a posteriori error analysis for radiosity. For instance, we need techniques for efficiently computing reliable tight bounds on form-factors, perhaps using tools such as irradiance Jacobians <ref> [2] </ref>. Also, we would like to extend the techniques described in this paper to higher order basis functions. While we are able to bound the exact radiosity function, our bounds will not necessarily apply to higher order approximations, as they may exhibit oscillations [22].
Reference: [3] <author> ARVO, JAMES, KENNETH TORRANCE, AND BRIAN SMITS. </author> <title> A Framework for the Analysis of Error in Global Illumination Algorithms. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1994. </year>
Reference-contexts: The theory of integral equations [1, 10] provides an a priori error analysis of computational methods for Fredholm equations of the second kind. This general framework is valuable for analyzing convergence rates [10], and for bounding various components of the error in terms of the corresponding operator norms <ref> [3] </ref>. However, a priori error bounds are typically pessimistic and often difficult to evaluate, requiring information about the operators or the exact solution, which may not be available.
Reference: [4] <author> BABU SKA, I., O. C. ZIENKIEWICZ, J. GAGO, AND E. R. DE A. OLIVEIRA, EDS. </author> <title> Accuracy Estimates and Adaptive Refinements in Finite Element Computations, </title> <publisher> John Wiley & Sons, </publisher> <address> Chichester, </address> <year> 1986. </year>
Reference-contexts: Because the analysis takes place after or during the computation of the solution, such methods can provide tighter bounds more easily. During the 1980's the issues of a posteriori error estimation and automatic adaptive refinement received considerable attention in the finite elements literature <ref> [4, 19] </ref>. Most of the work has related to partial differential equations. More recently, results have become available also for boundary integral equations and boundary element methods [5], which are essentially similar to radiosity methods. In the radiosity literature, however, very little has been written regarding a posteriori error analysis.
Reference: [5] <editor> BREBBIA, C. A. AND M. H. ALIABADI, EDS. </editor> <title> Adaptive Finite and Boundary Element Methods, </title> <publisher> Computational Mechanics Publications, Southampton, and Elsevier Applied Science, </publisher> <address> London, </address> <year> 1993. </year>
Reference-contexts: During the 1980's the issues of a posteriori error estimation and automatic adaptive refinement received considerable attention in the finite elements literature [4, 19]. Most of the work has related to partial differential equations. More recently, results have become available also for boundary integral equations and boundary element methods <ref> [5] </ref>, which are essentially similar to radiosity methods. In the radiosity literature, however, very little has been written regarding a posteriori error analysis.
Reference: [6] <author> BROWN, R. W. </author> <title> Upper and Lower Bounds for Solutions of Integral Equations. In Error in Digital Computation, </title> <editor> L. B. Rall, Ed., </editor> <volume> vol. 2, </volume> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1965, </year> <pages> pp. 219-230. </pages>
Reference-contexts: These bounds pertain to both B (x) and b B (x), so they can be used to compute a conservative upper bound on the error kB (x) b B (x)k. Our algorithm resembles the general bracketing technique suggested by Brown <ref> [6] </ref>, but we utilize special properties of equation (1) to produce tighter bounds. In many instances, a conservative error bound is not required, or is too pessimistic, and a good error estimate is preferable.
Reference: [7] <author> CAMPBELL, III, A. T. </author> <title> Modeling Global Diffuse Illumination for Image Synthesis, </title> <type> PhD dissertation, </type> <institution> University of Texas at Austin, Austin, Texas, </institution> <month> December </month> <year> 1991. </year>
Reference-contexts: Thus, the difference between radiosities of adjacent elements is treated as an indicator of the local error. Note that this heuristic may fail to identify elements that should be subdivided. A more conservative approach is described by Campbell <ref> [7] </ref>, who uses numerical optimization to find the minimum and the maximum radiosity over each element. The difference between these extrema is used as a criterion for adaptive subdivision. <p> Thus, we must resort to numerical optimization to find the minimum and the maximum values of the point-to-polygon form-factor from points on S i to S j . Such numerical methods are discussed in detail by Campbell <ref> [7] </ref>. These methods generally require the computation of form-factor gradients in the presence of occluders, which can be done either using finite differences or analytically, as described by Arvo [2].
Reference: [8] <author> COHEN, MICHAEL F., DONALD P. GREENBERG, DAVID S. IMMEL, AND PHILIP J. BROCK. </author> <title> An Efficient Radiosity Approach for Realistic Image Synthesis. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 6(2), </volume> <month> March </month> <year> 1986, </year> <pages> pp. 26-35. </pages>
Reference-contexts: This expression uses bounds on importance and on radiosity that can be computed using our algorithms. This gives rise to a new error-driven refinement strategy for hierarchical radiosity, which is shown to be superior to brightness-weighted refinement. 2 ERROR ESTIMATION IN RADIOSITY Cohen's adaptive subdivision algorithm <ref> [8] </ref> can be viewed as the first attempt at a posteriori error estimation. In this algorithm, elements are subdivided if their radiosity differs from that of their neighbors by more than a certain threshold.
Reference: [9] <author> COHEN, MICHAEL F. AND JOHN R. WALLACE. </author> <title> Radiosity and Realistic Image Synthesis, </title> <publisher> Academic Press Professional, </publisher> <address> Cambridge, Mas-sachusets, </address> <year> 1993. </year>
Reference-contexts: However, this does not take into account propagation of errors, which parallels the propagation of light. Several other error estimation techniques are surveyed by Cohen and Wallace <ref> [9] </ref>. These techniques can be classified into two groups: (i) comparing the approximation to a higher order approximation, and (ii) computing the residual r (x) = b B (x) E (x) (x) k (x, y) b B (y) dy.
Reference: [10] <author> DELVES, L. M. AND J. L. MOHAMED. </author> <title> Computational Methods for Integral Equations, </title> <publisher> Cambridge University Press, </publisher> <address> Cambridge, Great Britain, </address> <year> 1985. </year>
Reference-contexts: The theory of integral equations <ref> [1, 10] </ref> provides an a priori error analysis of computational methods for Fredholm equations of the second kind. This general framework is valuable for analyzing convergence rates [10], and for bounding various components of the error in terms of the corresponding operator norms [3]. <p> The theory of integral equations [1, 10] provides an a priori error analysis of computational methods for Fredholm equations of the second kind. This general framework is valuable for analyzing convergence rates <ref> [10] </ref>, and for bounding various components of the error in terms of the corresponding operator norms [3]. However, a priori error bounds are typically pessimistic and often difficult to evaluate, requiring information about the operators or the exact solution, which may not be available. <p> For most practical purposes good non-conservative error estimates could prove more useful than conservative error bounds. To quote Delves and Mohamed <ref> [10] </ref>: Given two error estimates of equal realism and equal cost and given that one is also a bound, we would clearly prefer the bound. In practice bounds usually prove expensive and pessimistic.
Reference: [11] <author> GOLUB, GENE H. AND CHARLES F. VAN LOAN. </author> <title> Matrix Computations, </title> <publisher> The Johns Hopkins University Press, </publisher> <address> Baltimore, Maryland, 2nd edition, </address> <year> 1989. </year>
Reference-contexts: Proof. It is easy to see that the matrix I K is strictly diagonally dominant, from which it follows <ref> [11] </ref> that the spectral radius of K is strictly less than 1.
Reference: [12] <author> GORTLER, STEVEN J., PETER SCHR ODER, MICHAEL F. COHEN, AND PAT HANRAHAN. </author> <title> Wavelet Radiosity. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pp. 221-230. </pages>
Reference-contexts: Radiosity algorithms compute an approximate solution b B (x) to equation (1) by projecting the continuous integral equation into a finite dimensional function space. Most radiosity algorithms use spaces of piecewise constant functions, although recently several investigators described radiosity algorithms that use higher order basis functions <ref> [12, 21, 22] </ref>.
Reference: [13] <author> HANRAHAN, PAT, DAVID SALZMAN, AND LARRY AUPPERLE. </author> <title> A Rapid Hierarchical Radiosity Algorithm. </title> <journal> Computer Graphics, </journal> <volume> 25(4), </volume> <month> July </month> <year> 1991, </year> <pages> pp. 197-206. </pages>
Reference-contexts: The difference between these extrema is used as a criterion for adaptive subdivision. Among the various radiosity methods, hierarchical radiosity (HR) comes closest to bounding the errors in the solution: a bound is computed on the error in each interaction (link) between patches. Hanrahan et al. <ref> [13] </ref> compute an approximate upper bound on the form-factor corresponding to the link, and use it to obtain an approximate upper bound on the transferred energy. <p> Both types of estimates become closer to the measured error as the accuracy of the solutions increases. Both the estimated and the measured errors vary linearly in the element size h, as expected for piecewise-constant approximations. 5 ERROR-DRIVEN REFINEMENT The original hierarchical radiosity algorithm <ref> [13] </ref> adaptively improves the accuracy of a solution by estimating the error associated with each link. All links for which this error estimate exceeds a given threshold * are refined and the solution is recomputed.
Reference: [14] <author> LEWINS, JEFFERY. </author> <title> Importance, The Adjoint Function: The Physical Basis of Variational and Perturbation Theory in Transport and Diffusion Problems, </title> <publisher> Pergamon Press, </publisher> <address> New York, </address> <year> 1965. </year>
Reference-contexts: This is done by using the concept of importance. 5.1 Importance and Linear Functionals Recall that importance, which we shall denote by Z, is the solution to the adjoint of the transport equation <ref> [14, 17] </ref>: M Z = R where M T is the adjoint of the real matrix M. In the context of radiosity, M = I K. R is the receiver vector, which is dual to the emission vector E.
Reference: [15] <author> LISCHINSKI, DANI, FILIPPO TAMPIERI, AND DONALD P. GREENBERG. </author> <title> Combining Hierarchical Radiosity and Discontinuity Meshing. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pp. 199-208. </pages>
Reference-contexts: While these bounds are not conservative, as elements decrease in size the point-to-area form-factor function becomes monotonic over most elements, and the heuristic yields accurate bounds. This is particularly so when a discontinuity-driven subdivision strategy <ref> [15] </ref> is employed. 3.5 Results The plots in Figures 2, 3, and 4 show the piecewise-constant bounding functions computed by the hierarchical bounding algorithm for three simple environments shown in Figure 5. The exact radiosity function is also plotted for each of the three cases. <p> Even if the approximation is contained within our bounds, equations (7) and (8) will probably produce pessimistic error estimates, since they assume that the approximation is piecewise-constant. Prior to rendering an image, the radiosity solution is usually projected onto a new set of basis functions, typically piecewise-linear or piecewise-quadratic <ref> [15] </ref>. We need to analyze the effect of such projections on the error in order to extend our error estimates from solutions to images. Finally, we would like to emphasize the need for the development of perceptual error metrics for image synthesis.
Reference: [16] <author> NISHITA, TOMOYUKI AND EIHACHIRO NAKAMAE. </author> <title> Half-Tone Representation of 3-D Objects Illuminated by Area Sources or Polyhedron Sources. </title> <booktitle> Proceedings of COMPSAC '83 (Chicago, </booktitle> <address> Illinois, </address> <month> November </month> <year> 1983), </year> <pages> pp. 237-241. </pages>
Reference-contexts: In our current implementation we estimate form-factor bounds by evaluating the analytical point-to-polygon form-factor [18] at the center and at the vertices of each receiving patch. In the partially occluded case, the analytical formula is applied only to the visible parts of the source <ref> [16] </ref>. The upper and lower bounds on the form-factor are then set to the maximum and the minimum of these values. While these bounds are not conservative, as elements decrease in size the point-to-area form-factor function becomes monotonic over most elements, and the heuristic yields accurate bounds.
Reference: [17] <author> SMITS, BRIAN E., JAMES R. ARVO, AND DAVID H. SALESIN. </author> <title> An Importance-Driven Radiosity Algorithm. </title> <journal> Computer Graphics, </journal> <volume> 26(4), </volume> <month> July </month> <year> 1992, </year> <pages> pp. 273-282. </pages>
Reference-contexts: Hanrahan et al. [13] compute an approximate upper bound on the form-factor corresponding to the link, and use it to obtain an approximate upper bound on the transferred energy. Smits et al. <ref> [17] </ref> obtain an estimate of the error in each interaction by point sampling the kernel function over the areas of the two interacting patches. The difference between the maximum and the minimum values thus obtained is taken to be the error in the form-factor. <p> This is done by using the concept of importance. 5.1 Importance and Linear Functionals Recall that importance, which we shall denote by Z, is the solution to the adjoint of the transport equation <ref> [14, 17] </ref>: M Z = R where M T is the adjoint of the real matrix M. In the context of radiosity, M = I K. R is the receiver vector, which is dual to the emission vector E. <p> Any linear functional f (B) of the radiosities can be expressed as an inner product R T B, where R i gives the contribution of B i to the value of f (B). It can be shown <ref> [17] </ref> that R B = Z E. <p> In particular this expression applies to the view-dependent function-als used by Smits et al. <ref> [17] </ref>. Thus, the expression that Smits et al. used to assess the view-dependent error can be viewed as an approximation to our more conservative bound. 5.2 A New Refinement Strategy Equation (9) suggests a new error-driven refinement strategy for HR.
Reference: [18] <author> SPARROW, E. M. </author> <title> A New and Simpler Formulation for Radiative Angle Factors. </title> <journal> ASME Journal of Heat Transfer, </journal> <volume> 85(2), </volume> <month> May </month> <year> 1963, </year> <pages> pp. 81-88. </pages>
Reference-contexts: These methods generally require the computation of form-factor gradients in the presence of occluders, which can be done either using finite differences or analytically, as described by Arvo [2]. In our current implementation we estimate form-factor bounds by evaluating the analytical point-to-polygon form-factor <ref> [18] </ref> at the center and at the vertices of each receiving patch. In the partially occluded case, the analytical formula is applied only to the visible parts of the source [16].
Reference: [19] <author> SZAB O, BARNA AND IVO BABU SKA. </author> <title> Finite Element Analysis, </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1991. </year>
Reference-contexts: Because the analysis takes place after or during the computation of the solution, such methods can provide tighter bounds more easily. During the 1980's the issues of a posteriori error estimation and automatic adaptive refinement received considerable attention in the finite elements literature <ref> [4, 19] </ref>. Most of the work has related to partial differential equations. More recently, results have become available also for boundary integral equations and boundary element methods [5], which are essentially similar to radiosity methods. In the radiosity literature, however, very little has been written regarding a posteriori error analysis.
Reference: [20] <author> TARJAN, ROBERT ENDRE. </author> <title> Data Structures and Network Algorithms, </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1983. </year>
Reference-contexts: Sorting is only necessary when the sum of the contributing form-factors exceeds 1. Even then, only a few of the dimmest sources must be removed from the list. This can be done efficiently using a heap data structure with a DeleteMin operation. Tarjan <ref> [20] </ref> provides a detailed description of such data structures. 3.4 Bounding Form-Factors Thus far we have assumed that the bounds F ij and F ij are available to us. How do we obtain them? We know of no analytical way of computing such bounds.
Reference: [21] <author> TROUTMAN, ROY AND NELSON L. MAX. </author> <title> Radiosity Algorithms Using Higher Order Finite Elements. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pp. 209-212. </pages>
Reference-contexts: Radiosity algorithms compute an approximate solution b B (x) to equation (1) by projecting the continuous integral equation into a finite dimensional function space. Most radiosity algorithms use spaces of piecewise constant functions, although recently several investigators described radiosity algorithms that use higher order basis functions <ref> [12, 21, 22] </ref>.
Reference: [22] <author> ZATZ, HAROLD R. </author> <title> Galerkin Radiosity: A Higher Order Solution Method for Global Illumination. </title> <booktitle> In Computer Graphics Proceedings, Annual Conference Series, </booktitle> <year> 1993, </year> <pages> pp. 213-220. </pages>
Reference-contexts: Radiosity algorithms compute an approximate solution b B (x) to equation (1) by projecting the continuous integral equation into a finite dimensional function space. Most radiosity algorithms use spaces of piecewise constant functions, although recently several investigators described radiosity algorithms that use higher order basis functions <ref> [12, 21, 22] </ref>. <p> Also, we would like to extend the techniques described in this paper to higher order basis functions. While we are able to bound the exact radiosity function, our bounds will not necessarily apply to higher order approximations, as they may exhibit oscillations <ref> [22] </ref>. Even if the approximation is contained within our bounds, equations (7) and (8) will probably produce pessimistic error estimates, since they assume that the approximation is piecewise-constant.
References-found: 22

