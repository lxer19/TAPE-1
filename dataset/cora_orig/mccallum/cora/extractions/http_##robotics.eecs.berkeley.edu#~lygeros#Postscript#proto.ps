URL: http://robotics.eecs.berkeley.edu/~lygeros/Postscript/proto.ps
Refering-URL: http://robotics.eecs.berkeley.edu/~lygeros/Publications/protocol.html
Root-URL: 
Email: fgodbole,lygeros,ekta,akash,lind@eecs.berkeley.edug  
Title: Design and Verification of Communication Protocols for Degraded Modes of Operation of AHS  
Author: D.N. Godbole, J. Lygeros, E. Singh, A. Deshpande, A.E. Lindsey 
Keyword: Automated Highway Systems, Discrete Event Systems, Verification, Hybrid Systems, Safety  
Address: Berkeley, CA 94720  
Affiliation: Department of Electrical Engineering and Computer Sciences University of California  
Abstract: We present the design and verification of inter-vehicle communication protocols for degraded modes of operation on the Automated Highway System (AHS). We consider various hardware and sensor faults that can develop on the automated vehicle in an AHS and design discrete event supervisory controllers to stop the faulty vehicle or take it out of the highway in a safe manner. The protocols are verified for logical correctness by using automatic formal verification tools. This work presents an important step towards analyzing the safety of the AHS. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> P. Varaiya, </author> <title> "Smart cars on smart roads: problems of control," </title> <journal> IEEE Transactions on Automatic Control, </journal> <volume> vol. AC-38, no. 2, </volume> <pages> pp. 195-207, </pages> <year> 1993. </year>
Reference-contexts: The control and coordination of a large number of vehicles poses a formidable problem. In <ref> [1] </ref> a hierarchical controller was proposed for normal conditions of operation, i.e. when environmental conditions are benign and the operation of the vehicles is faultless. In [2] the hierarchy was extended to deal with a wide range of faults and adverse environmental conditions. <p> concluding section. 2 Background In this section, we give a brief summary of previous work on control architectures on which this paper is based. (In the final version of this paper, this section shall be replaced by references to the earlier work.) 2.1 Normal Operation The control architecture proposed in <ref> [1] </ref> for operation under normal conditions consists of a hierarchy of five levels (Figure 1). The top two layers of the hierarchy provide centralized control for vehicles on entire sections of the highway. <p> From a hybrid systems point of view, the physical layer is merged with the regulation layer, as they both use ordinary differential equations to describe the system. Since this hierarchical structure was proposed in <ref> [1] </ref>, extensive work has been carried out on modeling and controller design for all the layers, as well as on the underlying communication, sensor and actuator technologies. Various parts of the design have been tested in simulation, experiment and theoretical analysis. <p> Crash Stop: This maneuver is similar to Gentle Stop except the severity of the fault requires the faulty vehicle to apply maximum emergency braking. 3.4 Priorities and mutual exclusion In the normal mode architecture of <ref> [1] </ref>, mutual exclusion between maneuvers was achieved by imposing the constraint that each leader can be engaged in at most one maneuver at a time. Any other request received during this time is discarded.
Reference: [2] <author> J. Lygeros, D. N. Godbole, and M. E. Broucke, </author> <title> "Design of an extended architecture for degraded modes of operation of IVHS," </title> <booktitle> in American Control Conference, </booktitle> <year> 1995. </year> <note> To Appear. </note>
Reference-contexts: The control and coordination of a large number of vehicles poses a formidable problem. In [1] a hierarchical controller was proposed for normal conditions of operation, i.e. when environmental conditions are benign and the operation of the vehicles is faultless. In <ref> [2] </ref> the hierarchy was extended to deal with a wide range of faults and adverse environmental conditions. The work presented here follows from this extended scheme. We describe the design and verification of communication protocols and maneuvers for safely removing the faulty vehicles from the system. <p> We also present the motivation for our work and state the problems it addresses. In section 3 we describe in detail the protocol design and show how it fits in the framework for emergency maneuver initiation and fault classification presented in <ref> [2] </ref>. In section 4 we describe how the design was modeled formally using finite state machines and verified using automatic verification tools. We explore the implications of the verification results and relate them to the original goals set for the design. <p> Most of the work in this area has been concerned with countering the effect of specific faults, rather than investigating the overall performance of the system. In <ref> [2] </ref> a consistent attempt of extending the normal mode architecture so that it is capable of dealing with degraded conditions of operation was presented. <p> The system capability information, like the sensor data, needs to be presented in a form compatible with the abstraction at the level at which it is addressed. Therefore the control and sensor hierarchies need to be extended. In <ref> [2] </ref> this extension was done by means of two more hierarchical structures, called the quantitative and qualitative capability structures. The first encodes the discrete changes in the system capability due to faults in the vehicle and roadside hardware. <p> Under degraded conditions of operation however this is no longer possible. Because the system capabilities may change, the controller needs to be able to change the strategy. The architecture proposed in <ref> [2] </ref> makes this explicit by dividing each level of the hierarchy into two layers. <p> The resulting structure for the combined coordination and regulation levels is shown in Figure 3. A similar structure was proposed for the link layer. 2.3 Problem Formulation The extended architecture of <ref> [2] </ref> requires additional control laws for all the layers as the current normal mode design is insufficient to deal with all cases of interest. In this paper we propose a set of communication protocols to address vehicle faults 2 . <p> In addition, for the former case, link layer intervention may be needed to maintain acceptable system performance. In this paper we present a formal way of classifying faults according to severity and we present coordination layer strategies for each class. We also present 2 <ref> [2] </ref> contains a comprehensive list of faults for both vehicle and roadside. 5 verification results that indicate that the proposed strategies produce the desired effect. Recall that the goal of the design is to maintain safe operation while minimizing the impact of faults on the highway throughput. <p> Proving such a claim is not easy, however, as it involves the ill-understood interaction between the link and coordination layer models. 3 Design of Coordination Protocols The fault classification of <ref> [2] </ref> considers vehicle as well as infrastructure faults including adverse weather conditions. As this paper deals with coordination layer protocols, we consider only vehicle faults. Vehicle faults are divided into the following four classes: A. Vehicle stopped or vehicle must stop 1. <p> Controllers are designed to deal with faults in classes A, B and C. 3.1 Structure of the controller The coordination layer controller is divided into two levels (Figure 3): a strategic planning level called coordination supervisor and an execution level called coordination maneuver. According to the framework of <ref> [2] </ref>, once a fault is detected the monitors (see Figure 2) uniquely classify it into one of the fault classes. Depending on the class or subclass the fault belongs to, the coordination supervisor (see Figure 3) selects an appropriate strategy called a compound maneuver. <p> This is a reasonable assumption and will be fundamental in stating our claims, as the verification results presented here concern only with the execution of the emergency maneuvers and not their initiation. Extensive work has already been done on fault detection, while <ref> [2] </ref> presents a possible emergency procedure initiation scheme. 2. The second assumption we need to make is that the normal mode protocols have been properly designed and verified. This is a valid assumption based on the results of [4]. 3. <p> Multiple faults on the same vehicle will result in loss of many capabilities of the vehicle which might make many of the strategies unusable. <ref> [2] </ref> describes a systematic way of keeping track of the capabilities of the vehicle. Based on the remaining capability of the vehicle, the best possible strategy among the possible ones can be chosen. 2 It should be noted that this claim is not very informative.
Reference: [3] <author> B. S. Y. Rao and P. Varaiya, </author> <title> "Roadside intelligence for flow control in an IVHS," </title> <journal> Transportation Research - C, </journal> <volume> vol. Vol.2, no. 1, </volume> <pages> pp. 49-72, </pages> <year> 1994. </year> <month> 25 </month>
Reference-contexts: It also monitors incidents on the highway and diverts traffic in order to minimize the impact of incidents on traffic flow and safety. The link layer design is based on a traffic flow model which uses aggregate statistical information about the traffic in a section. <ref> [3] </ref> provides details of the link layer design. The remaining levels are responsible for decentralized control of individual vehicles. The next level below the link layer is called the coordination layer. It's task is to coordinate the operation of platoons with their neighbors. <p> This aspect of highway automation has already been explored by some researchers. For example, <ref> [3] </ref> investigated the effect of stalled vehicles or accidents on travel times and proposed a scheme for minimizing the delays, [7] investigated the effect of tire blow-out on the lateral dynamics of the vehicle and designed controllers for vehicle safety and [8] proposed a safety specification for the operation of the
Reference: [4] <author> A. Hsu, F. Eskafi, S. Sachs, and P. Varaiya, </author> <title> "Protocol design for an automated highway system," Discrete Event Dynamic Systems, </title> <journal> vol. Vol.2, </journal> <volume> no. 1, </volume> <pages> pp. 183-206, </pages> <year> 1994. </year>
Reference-contexts: The coordination layer controller receives the link layer commands and translates them to specific maneuvers that the platoon can carry out. The design of <ref> [4] </ref> uses protocols, in the form of finite state machines, to organize the maneuvers in a systematic way. The protocols receive the commands of the link layer and aggregated sensor information from the individual vehicles (of the form "there is a vehicle in the adjacent lane"). <p> Take Immediate Exit Normal (TIE-N): This strategy is similar to the TIE strategy except the faulty vehicle uses a normal lane change protocol of <ref> [4] </ref> instead of emergency lane change. The FSM diagram for TIE-N is similar to Figure 18, except the state ELC is replaced by LC [9]. 3.3 Atomic Maneuvers Following atomic maneuvers are designed to execute the above strategies. <p> The finite state machines (Appendix A) represent the inter-vehicle coordination to carry out these maneuvers. Forced Split: This maneuver is similar to the split maneuver of <ref> [4] </ref>. It is used by a faulty vehicle to become a free agent. If the faulty vehicle is a follower it requests the leader of the platoon to initiate a forced split . The leader breaks the platoon at any desired location (see Figure 21). <p> Front Dock: This maneuver (Figure 23) is initiated by a platoon leader that wants to join with the vehicle in front but, because of a fault, it cannot execute the join maneuver of <ref> [4] </ref> which requires accelerating to close the gap and then decelerating to match the speed. The initiating vehicle requests the leader of the preceding platoon for a front dock. <p> We also use the fact that the protocols for the normal mode of operation have been verified <ref> [4] </ref>, to abstract their behavior into smaller FSM. verification of the three most interesting strategies; TIE, TIE-E and TIE-N. The panel on the left consists of the informal state machines for the maneuvers and the supervisors introduced for verification. <p> Extensive work has already been done on fault detection, while [2] presents a possible emergency procedure initiation scheme. 2. The second assumption we need to make is that the normal mode protocols have been properly designed and verified. This is a valid assumption based on the results of <ref> [4] </ref>. 3. The third assumption is that the regulation layer behavior is adequately summarized by the corresponding environment machine used in our verification.
Reference: [5] <author> D. N. Godbole and J. Lygeros, </author> <title> "Longitudinal control of the lead car of a platoon," </title> <journal> IEEE Transactions on Vehicular Technology, </journal> <volume> vol. 43, no. 4, </volume> <pages> pp. 1125-1135, </pages> <year> 1994. </year>
Reference-contexts: These commands are received by the regulation layer. Its task is to translate the coordination layer commands to throttle, steering and brake input for the actuators on the vehicle. For this purpose it utilizes a number of continuous time feedback control laws (see <ref> [5] </ref> and references therein) that use the sensor readings to calculate the actuator inputs required for a particular maneuver. The regulation layer occasionally needs to communicate with the coordination layer to inform it of the outcome of a maneuver. The bottom layer is not part of the control hierarchy.
Reference: [6] <author> D. N. Godbole, J. Lygeros, and S. Sastry, </author> <title> "Hierarchical hybrid control: An IVHS case study," </title> <booktitle> in IEEE Control and Decision Conference, </booktitle> <pages> pp. 1592-1597, </pages> <year> 1994. </year>
Reference-contexts: Various parts of the design have been tested in simulation, experiment and theoretical analysis. Many interesting problems in hierarchical control (information abstraction, 3 model consistency across the levels) and in hybrid systems (verification of the combined discrete event and continuous layers) have emerged in the process (see <ref> [6] </ref>) and are currently under investigation. 2.2 Operation under degraded conditions The work discussed above was carried out under the assumption that the operation of the system takes place under "normal" conditions. <p> The verification would be complete if we could show that this finite state description is indeed an abstraction of the regulation layer behavior. However, this task is not trivial, as indicated by the results in <ref> [6] </ref>. Similar problems are encountered when trying to verify claims about the improvement in throughput produced by our design.
Reference: [7] <author> M. Tomizuka, S. Patwardhan, W. B. Zhang, and P. Devlin, </author> <title> "Theory and experiments of tire blow-out effects and hazard reduction control for automated vehicle lateral control system," </title> <booktitle> in American Control Conference, </booktitle> <pages> pp. 1207-1209, </pages> <year> 1994. </year>
Reference-contexts: This aspect of highway automation has already been explored by some researchers. For example, [3] investigated the effect of stalled vehicles or accidents on travel times and proposed a scheme for minimizing the delays, <ref> [7] </ref> investigated the effect of tire blow-out on the lateral dynamics of the vehicle and designed controllers for vehicle safety and [8] proposed a safety specification for the operation of the systems in the presence of faults.
Reference: [8] <author> A. Hitchcock, </author> <title> "A specification of an automated freeway with vehicle-borne intelligence." </title> <type> PATH Technical Report UCB-ITS-PRR-92-18, </type> <institution> Institute of Transportation Studies, University of Cal-ifornia, Berkeley, </institution> <year> 1994. </year>
Reference-contexts: For example, [3] investigated the effect of stalled vehicles or accidents on travel times and proposed a scheme for minimizing the delays, [7] investigated the effect of tire blow-out on the lateral dynamics of the vehicle and designed controllers for vehicle safety and <ref> [8] </ref> proposed a safety specification for the operation of the systems in the presence of faults. Most of the work in this area has been concerned with countering the effect of specific faults, rather than investigating the overall performance of the system. <p> Recall that the goal of the design is to maintain safe operation while minimizing the impact of faults on the highway throughput. A safety requirement can be formalized using the following definitions, proposed in <ref> [8] </ref>: Definition 1 A Catastrophe is a high speed collision. A possible catastrophe is a situation that can give rise to a high speed collision without an additional fault developing in the system. Definition 2 A Hazard is a situation in which one additional fault leads to a possible catastrophe. <p> Definition 2 A Hazard is a situation in which one additional fault leads to a possible catastrophe. Using the above definitions the following safety specification was proposed in <ref> [8] </ref>: Definition 3 The AHS is safe if a hazard does not arise without two simultaneous faults of system components in a small neighborhood in space and time. Thus, the system is safe if up to 3 faults in any neighborhood cannot result in a catastrophe. <p> Such a probabilistic analysis was done by means of monte carlo simulations by Hitchcock <ref> [8] </ref>. We would like to use analytical methods as much as possible, and use simulation to verify our predictions. It should also be noted that the above analysis does not take into account redundant hardware/equipment used for obtaining the same functional capability. <p> We formally verified that under certain assumptions on environment, regulation and physical layer responses, our design does not deadlock and either brings the faulty vehicle to a stop or takes it to the exit safely. We showed that the original safety specification proposed in <ref> [8] </ref>, that up to three faults in a neighborhood do not lead to a catastrophe, cannot be met. Instead, we propose a refinement of this specification and show that our design meets it.
Reference: [9] <author> D. N. Godbole, J. Lygeros, E. Singh, A. Deshpande, and A. Lindsey, </author> <title> "Design and verification of coordination layer protocols for degraded modes of operation of AHS." </title> <type> (preprint) PATH Technical Report, </type> <institution> Institute of Transportation Studies, University of California, Berkeley, </institution> <year> 1995. </year>
Reference-contexts: We now describe these coordination layer controllers in greater detail. The FSM diagrams representing the protocols are given in Figures 12-24. We include only the most interesting FSM diagrams in this paper. For a complete set of figures, refer to <ref> [9] </ref>. 3.1.2 Control Complexity vs Performance Degradation The design of controllers for degraded modes involves tradeoffs between complexity of coordination and control and performance degradation of the AHS. For example consider the following solution: A faulty vehicle always stops on the highway regardless of the type of fault. <p> The names of the strategies indicate the severity of braking used to execute the maneuver. They do not need any assistance from the neighboring vehicles. (see <ref> [9] </ref> for the FSM diagram.) Aided Stop Strategy: The faulty vehicle with a "brakes off" failure is aided by the vehicle immediately ahead of it in the same platoon to come to a stop. <p> Take Immediate Exit Normal (TIE-N): This strategy is similar to the TIE strategy except the faulty vehicle uses a normal lane change protocol of [4] instead of emergency lane change. The FSM diagram for TIE-N is similar to Figure 18, except the state ELC is replaced by LC <ref> [9] </ref>. 3.3 Atomic Maneuvers Following atomic maneuvers are designed to execute the above strategies. The finite state machines (Appendix A) represent the inter-vehicle coordination to carry out these maneuvers. Forced Split: This maneuver is similar to the split maneuver of [4]. <p> In testing the higher level supervisors: SUPR-TIE, SUPR-TIE-E, and SUPR-TIE-N, we use a monitor FSM to check that concatenations of the "atomic" maneuvers occur, based on valid "e-transformations" of their "grid snapshots". 21 The complete COSPAN code for all the FSM can be found in <ref> [9] </ref>. It also includes the COSPAN output upon performing the verification task for all the maneuvers. The statistical results are summarized in Figure 15. During the verification process, some errors, in message passing and event synchronization between vehicles were found in the original design of the protocols.
Reference: [10] <author> J. Lygeros and D. N. Godbole, </author> <title> "An interface between continuous and discrete-event controllers for vehicle automation," </title> <booktitle> in American Control Conference, </booktitle> <pages> pp. 801-805, </pages> <year> 1994. </year>
Reference-contexts: This proof will involve the interface between the coordination and regulation layers. We hope to be able to show this by means of automatic verification, under minimal and realistic assumptions about the regulation layer (see <ref> [10] </ref> for a similar treatment of normal mode operation). Using the above definition we can now define the extent of a fault. Assume that the entire highway has been divided into cells like the ones discussed above and let l be the number of lanes.
Reference: [11] <author> Z. Har'El and R. Kurshan, </author> <title> Cospan User's Guide. </title> <institution> AT&T Bell Laboratories, </institution> <year> 1987. </year>
Reference-contexts: SUPR-TIE consists of two protocol processes: SUPR-FS, SUPR-ELC, and three environment processes: IP, LANE, and FSTYPE. The supervisor for TIE is shown in Figure 13. 4.3.4 Verification Results The formal FSM described in the previous section were transcribed into the language used by the verification software, COSPAN <ref> [11] </ref>. The design was verified by using a set of monitors. The monitors themselves are finite state machines whose transitions can be based on the states and transitions of the design FSM.
Reference: [12] <author> F. Eskafi, D. Khorramabadi, and P. Varaiya, "SmartPath: </author> <title> An automated highway system simulator." </title> <type> PATH Technical Report UCB-ITS-94-4. </type> <institution> Institute of Transportation Studies, University of California, Berkeley, </institution> <year> 1994. </year>
Reference-contexts: This is a topic for future research and we have suggested directions in this context. We propose to implement our scheme on the highway simulator SmartPath <ref> [12] </ref> to gain confidence in the modeling, design, and verification.
References-found: 12

