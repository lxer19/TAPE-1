URL: http://www.cs.toronto.edu/~ftp/pub/reports/na/tr-94-1.ps.Z
Refering-URL: http://www.cs.toronto.edu/NA/reports.html
Root-URL: 
Title: An Analysis of The Order of Runge-Kutta Methods That Use an Iterative Scheme To Compute
Author: K. R. Jackson A. Kvrnt and S. P. Ntrsett 
Keyword: Key words. Numerical Solution, Initial Value Problem, IVP, Ordinary Differential Equation, ODE, Runge-Kutta Method, Order, Internal Stage Values, Iterative Scheme, Newton's Method.  
Address: Toronto, Toronto, Ontario, Canada, M5S 1A4.  N-7034 Trondheim NTH, Norway.  N-7034 Trondheim NTH, Norway.  
Affiliation: Sciences and Engineering Research Council of Canada, the Information Technology Research Centre of Ontario, and the Norwegian Research Council for Science and Humanities. Computer Science Department, University of  Division of Mathematical Sciences, Norwegian Institute of Technology,  Division of Mathematical Sciences, Norwegian Institute of Technology,  
Note: AMS(MOS) subject classification. 65L05. This work was supported in part by the Natural  
Email: E-mail: krj@cs.toronto.edu.  E-mail: anne@imf.unit.no.  E-mail: norsett@imf.unit.no.  
Degree: Submitted to BIT  
Date: May 1994  
Abstract: We employ B-series to analyze the order of Runge-Kutta (RK) methods that use simple iteration, modified Newton iteration or full Newton iteration to compute their internal stage values. Our assumptions about the initial guess for the internal stage values cover a wide range of practical schemes. Moreover, the analytical techniques developed in this paper can be applied in many other similar contexts. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> N. G. R. Broderick, C. M. de Sterke, and K. R. Jackson. </author> <title> Coupled mode equations with free carrier effects: A numerical solution. </title> <editor> J. </editor> <booktitle> Optical and Quantum Electronics, </booktitle> <address> 26:S219-S234, </address> <year> 1994. </year>
Reference-contexts: One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics. Even for serial computation on this class of problems, RK-PC schemes have important advantages not shared by more conventional ODE methods, as explained in more detail in <ref> [1, 5] </ref>.
Reference: [2] <author> K. Burrage. </author> <title> The error behaviour of a general class of predictor-corrector methods. </title> <journal> Appl. Numer. Math., </journal> <volume> 8 </volume> <pages> 201-216, </pages> <year> 1991. </year>
Reference-contexts: We developed a theoretical explanation for this order behaviour based on B-series (sometimes called Butcher series). A more tutorial and less rigorous overview of our approach is presented in [11]. Burrage <ref> [2] </ref> adapts our analysis to determine the error coefficients for y n+1 y (x n+1 ; x n ; y n ) in his study of RK-PC schemes and Kvrnt [15] extends our approach to differential algebraic equations (DAEs). 2 In this paper, we consider the more general class of iterated
Reference: [3] <author> K. Burrage, J. C. Butcher and F. H. Chipman. </author> <title> An implementation of singly-implicit Runge-Kutta methods. </title> <journal> BIT, </journal> <volume> 20 </volume> <pages> 326-340, </pages> <year> 1980. </year>
Reference-contexts: Iterative schemes of the form (1.13)-(1.14) are also used to approximate the solution of (1.4)-(1.5) in standard sequential codes based on implicit RK formulas. Both stride <ref> [3] </ref> and simple [17] use simple iteration to solve (1.4)-(1.5) in the nonstiff intervals of the integration and a variant of modified Newton in the stiff intervals.
Reference: [4] <author> J. C. Butcher. </author> <title> The Numerical Analysis of Ordinary Differential Equations. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1987. </year>
Reference-contexts: As noted in x1, we use B-series to prove Theorem 1.1. However, before giving the proof in x3, we first introduce some necessary notation and provide a few definitions and preliminary results in this section. Some of these results are new while others have appeared before. See <ref> [4] </ref> or [8] for a more comprehensive introduction to B-series. To begin, we introduce two types of trees that are fundamental to the theory of B-series. A rooted tree is a tree with one distinguished node, called the root. <p> q; H (t = [t 1 ; : : : ; t m ]; q) = 1 + max H (t i ; q) 8 t 2 T s.t. (t) q + 2: H (t; q) is a generalization of the height H (t) of a tree t defined in <ref> [4, p. 88] </ref>: H (t) = H (t; 0). <p> We again use the 8 th -order extrapolation scheme exhibited in Figure 4.1 as the underlying RK formula, but we replace the 3 rd -order predictor used in the previous example by Heun's 2 nd -order explicit RK formula <ref> [4, p. 173] </ref>. We refer to this iterated RK method as Scheme A. Note, q = 2 and r = 1. Only one full Newton iteration is performed, so k = 2, q 2 = 6 and q 2 = 7. <p> We again use the 8 th -order extrapolation scheme exhibited in Figure 4.1 as the underlying RK formula, but now we use Heun's 2 nd -order explicit RK formula <ref> [4, p. 173] </ref> to predict the internal stage values Y n;i for i = 1, 2, 4, 5, 7 and 8 only. (The c i associated with each of these Y (0) n;i s satisfies c i 2 [0; 1=2].) We use Heun's more accurate 3 rd -order explicit RK formula
Reference: [5] <author> C. M. de Sterke, K. R. Jackson, and B. D. Robert. </author> <title> Nonlinear coupled mode equations on a finite interval: A numerical procedure. </title> <journal> J. of the Optical Society of America B, </journal> <volume> 8 </volume> <pages> 403-412, </pages> <year> 1991. </year>
Reference-contexts: One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics. Even for serial computation on this class of problems, RK-PC schemes have important advantages not shared by more conventional ODE methods, as explained in more detail in <ref> [1, 5] </ref>.
Reference: [6] <author> J. L. M. van Dorsselaer and M. N. Spijker. </author> <title> The error committed by stopping Newton iterations in the numerical solution of stiff initial value problems. </title> <type> Technical Report TW-92-02, </type> <institution> Dept. of Mathematics and Computer Science, Div. of Applied Mathematics, Leiden University, </institution> <year> 1992. </year>
Reference-contexts: Furthermore, we are not guaranteed that Y (k) ! Y as k ! 1, except for sufficiently small h. This topic is carefully investigated by van Dorsselaer and Spijker <ref> [6] </ref>. 51
Reference: [7] <author> R. F. Enenkel. </author> <title> The implementation of parallel Runge-Kutta methods. </title> <type> Master's thesis, </type> <institution> Computer Science Dept., University of Toronto, Toronto, Canada, </institution> <year> 1988. </year>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics.
Reference: [8] <author> E. Hairer, S. P. Ntrsett and G. Wanner. </author> <title> Solving Ordinary Differential Equations I, Nonstiff Problems. </title> <publisher> Springer-Verlag, </publisher> <address> Berlin, </address> <year> 1987. </year>
Reference-contexts: As noted in x1, we use B-series to prove Theorem 1.1. However, before giving the proof in x3, we first introduce some necessary notation and provide a few definitions and preliminary results in this section. Some of these results are new while others have appeared before. See [4] or <ref> [8] </ref> for a more comprehensive introduction to B-series. To begin, we introduce two types of trees that are fundamental to the theory of B-series. A rooted tree is a tree with one distinguished node, called the root. <p> key result Theorem 2.2 If a 2 G and a (;) = " l , then hf (B (a; y)) = B (a 0 ; y) where a 0 (;) = 0 a 0 (t = [t 1 ; : : : ; t m ]) = (t) i=1 See <ref> [8, p. 246] </ref> for a proof. Ntrsett and Wolfbrandt prove the following result in [18, Theorem 2.2]. Theorem 2.3 Let B (a; y) and B (b; y) be two B-series with a; b 2 G, a (;) = " l and b (;) = 0. <p> In the tables below, we use Fortran notation for some numbers. For example, we represent 6:25 10 3 as 6.25e-3. Example 4.1 The iterated RK method in this example is based on the 4-stage Kuntzmann Butcher formula <ref> [8, p. 205] </ref> of order p = 8 together with the trivial predictor Y (0) i = 1; : : : ; s, whence q = r = 0. The methods use simple, modified Newton and full Newton iteration. <p> The methods use simple, modified Newton and full Newton iteration. The numerical results given in Table 4.1 show that the predicted and observed orders agree well. Example 4.2 As in Example 4.1, the underlying method is the 4-stage Kuntzmann-Butcher formula <ref> [8, p. 205] </ref> of order p = 8, but, in this case, we use the associated collocation polynomial to calculate Y (0) n . Thus, for k 2, q = r = 4. <p> The starting values Y (0) n for the iteration are computed by Heun's 3 rd -order explicit RK formula <ref> [8, p. 133] </ref>, whence q = 3. However, the stage order of the underlying RK formula is 1, so r = 1. <p> p. 173] to predict the internal stage values Y n;i for i = 1, 2, 4, 5, 7 and 8 only. (The c i associated with each of these Y (0) n;i s satisfies c i 2 [0; 1=2].) We use Heun's more accurate 3 rd -order explicit RK formula <ref> [8, p. 133] </ref> employed in Example 4.3 to predict the other internal stage values Y (0) c i associated with each of these Y (0) n;i s satisfies c i 2 (1=2; 1].) We refer to this iterated RK method as Scheme B. <p> The H-restricted order values for this formula are p H 1 = 6, 2 = 4 and p H k = 3 for k 3. The starting values Y (0) n for the iteration are computed by Fehlberg's 8 th -order explicit RK-formula, <ref> [8, p. 194] </ref>. So q = 8. Moreover, the iterated RK method employs simple iteration. By Theorem 3.1.4 the order of y (k) k . For completeness, the numerical results for the modified and full Newton iterations are included also in Table 4.5. <p> This could lead to the RK method being of lower order than expected, and as a result possibly unreliable and/or inefficient. For example, suppose * a code is based on the 4-stage Kuntzmann-Butcher formula <ref> [8, p. 205] </ref> of order 8, * its error estimate is based on local extrapolation using the one-step-two-half-steps approach, * the code uses the modified Newton iteration to compute the internal stage values, and * it starts the iteration with predicted values computed from the associated collocation polynomial of degree 4
Reference: [9] <author> P. J. van der Houwen, B. P. Sommeijer, and W. Couzy. </author> <title> Embedded diagonally implicit Runge-Kutta algorithms on parallel computers. </title> <journal> Math. Comp., </journal> <volume> 58 </volume> <pages> 135-159, </pages> <year> 1992. </year>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics. <p> For example, as noted above, they can be used to compute the error coefficients of a RK-PC method to any order desired. Also, our techniques can be used to analyze similar schemes, such as the PDIRK methods of van der Houwen, Sommeijer and Couzy <ref> [9] </ref>. Moreover, our approach can be extended to allow for perturbed Jacobians in Cases 2 and 3 of Theorem 1.1. <p> practice that may be problematic is using either y (k) (k+1) n+1 to advance the integration together with the difference l n+1 = y n+1 y n+1 = t2T ~ s+1 (t) ~ s+1 (t) F (t)(y n ) (t)! as the basis for an error estimate, as suggested in <ref> [9] </ref> for example.
Reference: [10] <author> K. R. Jackson. </author> <title> A survey of parallel numerical methods for initial value problems for ordinary differential equations. </title> <journal> IEEE Trans. on Magnetics, </journal> <volume> 27 </volume> <pages> 3792-3797, </pages> <year> 1991. </year>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics.
Reference: [11] <author> K. R. Jackson, A. Kvrnt and S. P. Ntrsett. </author> <title> The use of Butcher series in the analysis of Newton-like iterations in Runge-Kutta formulas. </title> <note> To appear in Applied Numerical Mathematics. </note>
Reference-contexts: We developed a theoretical explanation for this order behaviour based on B-series (sometimes called Butcher series). A more tutorial and less rigorous overview of our approach is presented in <ref> [11] </ref>. <p> We do not, though, pursue the latter topic in detail in this paper. In addition, the theory developed in x3 can be used to explain some possibly surprising order behaviour, an instance of which is the order increase phenomenon described in Exam ple 2 of <ref> [11] </ref>. Another such peculiarity is that the order of y (k) n+1 might decrease as k increases, 4 as shown in Example 4.5 of x4. Other numerical results illustrating our theory are presented in x4. We end with a few concluding remarks in x5. <p> See for instance Example 2 of <ref> [11] </ref>. <p> at least doubles for full Newton iteration if C (q 1) is satisfied, where q is the order of the predictor, or almost doubles if C (q 1) is not satisfied, up to the maximum order of the underlying RK formula, although we have given examples in this paper and <ref> [11] </ref> that illustrate that exceptions to these rules occur. We used B-series to prove Theorem 1.1 and associated results. <p> Often only a few terms restrict the order of the iterated RK method. Partly because of this, the order of a particular iterated RK scheme might be higher than that guaranteed by Theorem 1.1, as explained in x3 and illustrated in x4 and <ref> [11] </ref>. In addition to forming the theoretical basis for iterated RK methods, this work sheds some light on several questions of practical importance, as illustrated by the following two examples of possibly problematic practices.
Reference: [12] <author> K. R. Jackson and S. P. Ntrsett. </author> <title> The potential for parallelism in Runge-Kutta methods. Part 1: RK formulas in standard form. </title> <note> To appear in SIAM J. Numer. Anal. </note>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics. <p> The general scheme (1.13)-(1.14) shares with (1.7)-(1.8) the advantage that all function evaluations associated with f (Y (k) n ) can be evaluated simultaneously. Thus, as discussed in 3 <ref> [12] </ref>, the effective implementation of parallel RK methods in Cases 2 or 3 depends on being able to solve the linear system (1.13) effectively in parallel. Iterative schemes of the form (1.13)-(1.14) are also used to approximate the solution of (1.4)-(1.5) in standard sequential codes based on implicit RK formulas.
Reference: [13] <author> K. R. Jackson and S. P. Ntrsett. </author> <title> The potential for parallelism in Runge-Kutta methods. Part 2: RK predictor-corrector formulas. </title> <note> In preparation. </note>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics.
Reference: [14] <author> J. Kalvenes. </author> <title> Experimentation with parallel ODE-solvers. </title> <type> Technical Report NM-R8912, </type> <institution> Mathematical Sciences Div., Norwegian Institute of Technology, Trondheim, Norway, </institution> <year> 1986. </year>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics.
Reference: [15] <author> A. Kvrnt. </author> <title> The order of Runge-Kutta methods applied to semi-explicit DAEs of index 1, using Newton-type iterations to compute the internal stage values. </title> <type> Technical Report 2/1992, </type> <institution> Mathematical Sciences Div., Norwegian Institute of Technology, Trondheim, Norway, </institution> <year> 1992. </year>
Reference-contexts: A more tutorial and less rigorous overview of our approach is presented in [11]. Burrage [2] adapts our analysis to determine the error coefficients for y n+1 y (x n+1 ; x n ; y n ) in his study of RK-PC schemes and Kvrnt <ref> [15] </ref> extends our approach to differential algebraic equations (DAEs). 2 In this paper, we consider the more general class of iterated RK methods n Y (k+1) n = y n " s + hAf (Y (k) n ; (1.13) (k+1) n ); (1.14) where k 0, I s is the s <p> Hence it might not be relevant for stiff problems. The same objection is raised for the classical order analysis of RK formulas. To address this weakness, Kvrnt <ref> [15] </ref> has performed a similar analysis for semi-explicit index 1 DAEs, a collection of problems which can be viewed as the limiting case of a large and important class of stiff ODEs.
Reference: [16] <author> S. P. Ntrsett and H. H. Simonsen. </author> <title> Aspects of parallel Runge-Kutta methods. </title> <editor> In A. Bellen, C. W. Gear and E. Russo, editors, </editor> <title> Numerical Methods for Ordinary Differential Equations, </title> <address> pages 103-107, Berlin, </address> <year> 1989. </year> <title> Springer Verlag. </title> <booktitle> Lecture Notes in Mathematics #1386, Proceedings of the l'Aquila Symposium 1987. </booktitle>
Reference-contexts: A more complete discussion of RK-PC schemes can be found in <ref> [7, 9, 10, 12, 13, 14, 16] </ref>. One of us has also recently used RK-PC schemes to solve systems of hyperbolic equations by the method of characteristics.
Reference: [17] <author> S. P. Ntrsett and P. G. Thomsen. </author> <title> User's guide for SIMPLE, a stiff system solver. </title> <booktitle> Working notes. </booktitle>
Reference-contexts: Iterative schemes of the form (1.13)-(1.14) are also used to approximate the solution of (1.4)-(1.5) in standard sequential codes based on implicit RK formulas. Both stride [3] and simple <ref> [17] </ref> use simple iteration to solve (1.4)-(1.5) in the nonstiff intervals of the integration and a variant of modified Newton in the stiff intervals.
Reference: [18] <author> S. P. Ntrsett and A. Wolfbrandt. </author> <title> Order conditions for Rosenbrock type methods. </title> <journal> Nu-mer. Math., </journal> <volume> 32 </volume> <pages> 1-15, </pages> <year> 1979. </year>
Reference-contexts: Ntrsett and Wolfbrandt prove the following result in <ref> [18, Theorem 2.2] </ref>. Theorem 2.3 Let B (a; y) and B (b; y) be two B-series with a; b 2 G, a (;) = " l and b (;) = 0.
Reference: [19] <author> L. F. Shampine. </author> <title> Numerical Solution of Ordinary Differential Equations. </title> <publisher> Chapman & Hall, </publisher> <address> New York, </address> <year> 1994. </year> <month> 53 </month>
Reference-contexts: Moreover, this example is typical of the general case. It has long been recognized <ref> [19, x7.5.3] </ref> as undesirable for the lower-order formula in an explicit RK formula pair to have principal error terms equal to zero and we believe it is undesirable for iterated RK methods too.
References-found: 19

