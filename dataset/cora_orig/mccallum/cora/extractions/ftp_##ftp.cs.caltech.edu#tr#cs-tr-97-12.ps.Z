URL: ftp://ftp.cs.caltech.edu/tr/cs-tr-97-12.ps.Z
Refering-URL: ftp://ftp.cs.caltech.edu/tr/INDEX.html
Root-URL: http://www.cs.caltech.edu
Title: Partial-Volume Bayesian Classification of Material Mixtures in MR Volume Data using Voxel Histograms  
Author: David H. Laidlaw Kurt W. Fleischer Alan H. Barr 
Date: June 17, 1997  
Address: Pasadena, CA 91125 2 Pixar Animation Studios, Richmond, CA 94804,  
Affiliation: 1 California Institute of Technology,  
Abstract: We present a new algorithm for identifying the distribution of different material types in volumetric datasets such as those produced with Magnetic Resonance Imaging (MRI) or Computed Tomography (CT). Because we allow for mixtures of materials and treat voxels as regions, our technique reduces the classification artifacts that thresholding can create along boundaries between materials and is particularly useful for creating accurate geometric models and renderings from volume data. It also has the potential to make more-accurate volume measurements and classifies noisy, low-resolution data well. There are two unusual aspects to our approach. First, we assume that, due to partial-volume effects, voxels can contain more than one material, e.g., both muscle and fat; we compute the relative proportion of each material in the voxels. Second, we incorporate information from neighboring voxels into the classification process by reconstructing a continuous function, (x), from the samples and then looking at the distribution of values that takes on within the region of a voxel. This distribution of values is represented by a histogram taken over the region of the voxel; the mixture of materials that those values 
Abstract-found: 1
Intro-found: 1
Reference: [Choi et al., 1991] <author> Choi, H. S., Haynor, D. R., and Kim, Y. M. </author> <year> (1991). </year> <title> Partial volume tissue classification of multichannel magnetic resonance images a mixel model. </title> <journal> IEEE Transactions on Medical Images, </journal> <volume> 10(3) </volume> <pages> 395-407. </pages>
Reference-contexts: A disadvantage is that the linear operations are not as flexible as non-linear operations, and so either more data must be acquired or classification results will not be as accurate. <ref> [Choi et al., 1991] </ref> and [Ney et al., 1990] address the partial-volume issue by identifying combinations of materials for each sample value. As with many other approaches to identifying mixtures, these techniques use only a single measurement taken within a voxel to represent its contents. <p> This band is incorrectly classified, and could lead to errors in models or images produced from the classified data. The original dataset is simulated, two-valued data of two concentric shells, as shown in (iv). of [Windham et al., 1988] or the classification results of <ref> [Choi et al., 1991] </ref>. Their results are visually similar to ours, and underscore the need for quantitative comparison.
Reference: [Clarke et al., 1995] <author> Clarke, L. P., Velthuizen, R. P., Camacho, M. A., Neine, J. J., Vaidyanathan, M., Hall, L. O., Thatcher, R. W., and Silbiger, M. L. </author> <year> (1995). </year> <title> MRI segmentation: Methods and applications. </title> <journal> Magnetic Resonance Imaging, </journal> <volume> 13(3) </volume> <pages> 343-368. </pages>
Reference-contexts: The advantages of this are discussed further in Section 8. Related Work. Many researchers have worked on identifying the locations of materials in sampled datasets [Vannier et al., 1985], [Vannier et al., 1988], [Cline et al., 1990], [Duda and Hart, 1973]. <ref> [Clarke et al., 1995] </ref> gives an extensive review of the segmentation of MRI data.
Reference: [Cline et al., 1990] <author> Cline, H. E., Lorensen, W. E., Kikinis, R., and Jolesz, F. </author> <year> (1990). </year> <title> Three-dimensional segmentation of MR images of the head using probability and connectivity. </title> <journal> Journal of Computer Assisted Tomography, </journal> <volume> 14(6) </volume> <pages> 1037-1045. </pages>
Reference-contexts: The advantages of this are discussed further in Section 8. Related Work. Many researchers have worked on identifying the locations of materials in sampled datasets [Vannier et al., 1985], [Vannier et al., 1988], <ref> [Cline et al., 1990] </ref>, [Duda and Hart, 1973]. [Clarke et al., 1995] gives an extensive review of the segmentation of MRI data.
Reference: [Drebin et al., 1988] <author> Drebin, R. A., Carpenter, L., and Hanrahan, P. </author> <year> (1988). </year> <title> Volume rendering. </title> <editor> In Dill, J., editor, </editor> <booktitle> Computer Graphics (SIGGRAPH '88 Proceedings), </booktitle> <volume> volume 22, </volume> <pages> pages 65-74. </pages>
Reference-contexts: Both types of artifacts can be ascribed to the partial-volume effects ignored by the segmentation algorithms. <ref> [Drebin et al., 1988] </ref> demonstrates that accounting for mixtures of materials within a voxel can reduce these artifacts, and approximates the relative volume of each material represented by a sample as the probability that the sample is that material.
Reference: [Duda and Hart, 1973] <author> Duda, R. P. and Hart, P. E. </author> <year> (1973). </year> <title> Pattern Classification and Scene Analysis. </title> <publisher> John Wiley and Sons, </publisher> <address> New York. </address>
Reference-contexts: The advantages of this are discussed further in Section 8. Related Work. Many researchers have worked on identifying the locations of materials in sampled datasets [Vannier et al., 1985], [Vannier et al., 1988], [Cline et al., 1990], <ref> [Duda and Hart, 1973] </ref>. [Clarke et al., 1995] gives an extensive review of the segmentation of MRI data.
Reference: [Ghosh et al., 1995] <author> Ghosh, P. R., Laidlaw, D. H., Fleischer, K. W., Barr, A. H., and Jacobs, R. E. </author> <year> (1995). </year> <title> Pure phase-encoded MRI and classification of solids. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 14(3) </volume> <pages> 616-620. </pages>
Reference-contexts: This work has been applied to satellite imaging data, and so results are difficult to compare, but aspects may combine well with our technique. [Laidlaw et al., 1997] gives an overview of this technique in the context of the Human Brain Project, and [Laidlaw, 1995] gives a complete description. <ref> [Ghosh et al., 1995] </ref> describes an imaging protocol for acquiring MRI data from solids and applies the technique to the extraction of a geometric model from MRI data of a human tooth (see Figure 12). 2 Overview In this section we describe the classification problem that we solve, define terms, state <p> These models and images illustrate the underlying geometries, and are particularly sensitive to errors at geometric boundaries. 20 decreased above cutting planes to show details of the classification process within the hand. that images hard solid materials <ref> [Ghosh et al., 1995] </ref> and classifying dentine and enamel in the volume data with our new partial-volume mixtures algorithm. Polygonal isosurfaces define the bounding surfaces of the dentine and enamel. <p> All datasets except the tooth were collected with a spin-echo or fast spin-echo protocol, with one proton-weighted and one T 2 -weighted acquisition. The tooth was acquired with a technique described in <ref> [Ghosh et al., 1995] </ref>. 8 Discussion We have made several assumptions and approximations while developing and implementing this algorithm. This section will discuss some of the tradeoffs and suggest some possible directions for further work. Mixtures of Three or More Materials.
Reference: [Kao et al., 1996] <author> Kao, Y.-H., Sorenson, J. A., and Winkler, S. S. </author> <year> (1996). </year> <title> MR image segmentation using vector decompsition and probability techniques: A general model and its application to dual-echo images. </title> <journal> Magnetic Resonance in Medicine, </journal> <volume> 35 </volume> <pages> 114-125. </pages>
Reference-contexts: Their technique works well for differentiating air, soft tissue, and bone in CT data, but not for differentiating materials in MR data, where the measured data value for one material may often be identical to the measured value for a mixture of two other materials. [Windham et al., 1988] and <ref> [Kao et al., 1996] </ref> avoid partial-volume artifacts by taking linear combinations of components of vector measurements. An advantage of their techniques is that the linear operations they perform preserve the partial-volume mixtures within each sample value, and so partial-volume artifacts 6 are not created. <p> Their results are visually similar to ours, and underscore the need for quantitative comparison. Because we interpolate neighboring sample values, we are able to work with two-valued or even scalar data, while their technique is likely to require more vector components. <ref> [Kao et al., 1996] </ref> shows good results for a human brain dataset, but we believe their technique will be less robust in the presence of material mixture signatures that overlap, a situation their examples do not include.
Reference: [Laidlaw, 1992] <author> Laidlaw, D. H. </author> <year> (1992). </year> <title> Tissue classification of magnetic resonance volume data. </title> <type> Master's project, </type> <institution> California Institute of Technology. </institution> <month> 34 </month>
Reference-contexts: This assumption is not necessary for the derivation, but is needed for the implementation to work reliably. For many types of medical imaging data, including MRI and CT, these assumptions hold reasonably well, or can be satisfied sufficiently with preprocessing <ref> [Laidlaw, 1992] </ref>. Other types of sampled data, e.g., ultrasound, and video or film images with lighting and shading, violate these assumptions, and our technique does not apply directly. 10 Sketch of Derivation. Histograms represent the values taken on by (x) over various spatial regions. <p> The green streak between the red and yellow dots is a mixture of skin and muscle. These fitted basis functions were used to produce the classified data used in Figures 1 and 11. feature-space locations for them with an automated optimization <ref> [Laidlaw, 1992] </ref> to refine the parameter estimates. Under some circumstances, users may wish to group materials with similar measurements into a single material, whereas in other cases they may wish the materials to be separate.
Reference: [Laidlaw, 1995] <author> Laidlaw, D. H. </author> <year> (1995). </year> <title> Geometric model extraction from magnetic resonance volume data. </title> <type> Technical Report CS-TR-95-05, </type> <institution> Caltech. </institution>
Reference-contexts: This work has been applied to satellite imaging data, and so results are difficult to compare, but aspects may combine well with our technique. [Laidlaw et al., 1997] gives an overview of this technique in the context of the Human Brain Project, and <ref> [Laidlaw, 1995] </ref> gives a complete description. [Ghosh et al., 1995] describes an imaging protocol for acquiring MRI data from solids and applies the technique to the extraction of a geometric model from MRI data of a human tooth (see Figure 12). 2 Overview In this section we describe the classification problem <p> As a result, the histogram over that small region is not modeled ideally by a linear combination of pure material and mixture distributions. We are investigating model histogram basis functions with additional parameters to better match histograms <ref> [Laidlaw, 1995] </ref>, [Laidlaw et al., 1997].
Reference: [Laidlaw et al., 1997] <author> Laidlaw, D. H., Barr, A. H., and Jacobs, R. E. </author> <year> (1997). </year> <title> Goal-directed Brain Micro-imaging, </title> <journal> volume 1, </journal> <note> chapter 6. in press. </note>
Reference-contexts: This work has been applied to satellite imaging data, and so results are difficult to compare, but aspects may combine well with our technique. <ref> [Laidlaw et al., 1997] </ref> gives an overview of this technique in the context of the Human Brain Project, and [Laidlaw, 1995] gives a complete description. [Ghosh et al., 1995] describes an imaging protocol for acquiring MRI data from solids and applies the technique to the extraction of a geometric model from <p> As a result, the histogram over that small region is not modeled ideally by a linear combination of pure material and mixture distributions. We are investigating model histogram basis functions with additional parameters to better match histograms [Laidlaw, 1995], <ref> [Laidlaw et al., 1997] </ref>.
Reference: [Levoy, 1988] <author> Levoy, M. </author> <year> (1988). </year> <title> Display of surfaces from volume data. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 8(3) </volume> <pages> 29-37. </pages>
Reference-contexts: Note the smooth boundaries where materials meet and the much lower incidence of misclassified samples than in Figure 5. 3 region surrounding a sample. to selectively visualize parts of the data, thus better controlling a volume-rendered image <ref> [Levoy, 1988] </ref>, a surface model [Lorensen and Cline, 1987], or a volume model created from the data, and making visible otherwise obscured or subtle features. Classification is a key step towards understanding such geometry (Figure 1).
Reference: [Loredo, 1989] <author> Loredo, T. J. </author> <year> (1989). </year> <title> From Laplace to supernova SN1987A: Bayesian inference in astrophysics. </title> <editor> In Fougere, P., editor, </editor> <title> Maximum Entropy and Bayesian Methods. </title> <publisher> Kluwer Academic Publishers, </publisher> <address> Denmark. </address>
Reference-contexts: Our Approach. We use Bayesian probability theory to estimate the posterior probability based on conditional and prior probabilities derived from our assumptions about what we are measuring and how the measurement process works <ref> [Loredo, 1989] </ref>. With this information we identify the materials contained within each voxel based on the sample values for the voxel and its neighbors. We treat each voxel as a region (see Figure 3), not as a single point. <p> We use Bayesian probability theory <ref> [Loredo, 1989] </ref> to derive an expression for the probability that a given histogram was produced by a particular set of parameter values in our model. <p> The posterior probabilities P all and P vox share many common terms. In the following derivation we distinguish them only where necessary, using P where their definitions coincide. B.1 Definitions Table 3 lists Bayesian probability terminology as used in <ref> [Loredo, 1989] </ref> and in our derivations. Table 2 defines additional terms used in this section. <p> P (ff; c; s; Njh) posterior probability (we maximize this) P (ff; c; s; N) prior probability P (hjff; c; s; N) likelihood P (h) global likelihood Table 3: Probabilities, using Bayesian terminology from <ref> [Loredo, 1989] </ref>. With P P all , we fit histogram basis function parameters c; s, ff all to the histogram of an entire dataset, h all (v). With P P vox , we fit ff vox , N to classify the histogram of a voxel-sized region, h vox (v).
Reference: [Lorensen and Cline, 1987] <author> Lorensen, W. E. and Cline, H. E. </author> <year> (1987). </year> <title> Marching cubes: A high resolution 3D surface construction algorithm. </title> <editor> In Stone, M. C., editor, </editor> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> volume 21, </volume> <pages> pages 163-169. </pages>
Reference-contexts: Note the smooth boundaries where materials meet and the much lower incidence of misclassified samples than in Figure 5. 3 region surrounding a sample. to selectively visualize parts of the data, thus better controlling a volume-rendered image [Levoy, 1988], a surface model <ref> [Lorensen and Cline, 1987] </ref>, or a volume model created from the data, and making visible otherwise obscured or subtle features. Classification is a key step towards understanding such geometry (Figure 1). Figure 2 shows an example of classified MRI data; each color represents a single material identified within the data.
Reference: [NAG, 1993] <author> NAG (1993). </author> <title> NAG Fortran Library. Numerical Algorithms Group, </title> <type> 1400 Opus Place, Suite 200, </type> <address> Downers Grove, Illinois 60515. </address>
Reference-contexts: Deriving appropriate spatial functions and calibrating them is likely to be somewhat time consuming but may pay off with more-accurate classification results. Implementation. Our implementation is written in C and C++ on Unix workstations. We use a sequential-quadratic-programming constrained-optimization algorithm <ref> [NAG, 1993] </ref> to fit h vox for each voxel-sized region, and a quasi-Newton optimization algorithm for fitting h all . The algorithm classifies approximately 10 voxels per second on a single HP9000/730, IBM RS6000/550E, or DEC Alpha AXP 3000 Model 500 workstation.
Reference: [Ney et al., 1990] <author> Ney, D. R., Fishman, E. K., Magid, D., and Drebin, R. A. </author> <year> (1990). </year> <title> Volumetric rendering of computed tomography data: Principles and techniques. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 10(2) </volume> <pages> 24-32. </pages>
Reference-contexts: A disadvantage is that the linear operations are not as flexible as non-linear operations, and so either more data must be acquired or classification results will not be as accurate. [Choi et al., 1991] and <ref> [Ney et al., 1990] </ref> address the partial-volume issue by identifying combinations of materials for each sample value. As with many other approaches to identifying mixtures, these techniques use only a single measurement taken within a voxel to represent its contents.
Reference: [Oppenheim et al., 1983] <author> Oppenheim, A. V., Willsky, A. S., and Young, I. T. </author> <year> (1983). </year> <title> Signals and Systems. </title> <publisher> Prentice-Hall, Inc., </publisher> <address> New Jersey. </address>
Reference-contexts: With this information we identify the materials contained within each voxel based on the sample values for the voxel and its neighbors. We treat each voxel as a region (see Figure 3), not as a single point. The sampling theorem <ref> [Oppenheim et al., 1983] </ref> allows us to reconstruct a continuous function, (x), from the samples. We then represent all of the values that (x) takes on within a voxel by creating a histogram of (x) over the voxel. <p> The effect of this band-limited noise is discussed further in Section 6. 9 3: Sampling theorem is satisfied. The third assumption we make is that the sampled datasets we classify satisfy the sampling theorem <ref> [Oppenheim et al., 1983] </ref>. The sampling theorem states that if we sample a sufficiently band-limited function, we can exactly reconstruct that function from the samples, as demonstrated in Figure 4 (ii). The band-limiting creates smooth transitions in (x) as it traverses boundaries where otherwise (x) would be discontinuous.
Reference: [Santago and Gage, 1993] <author> Santago, P. and Gage, H. D. </author> <year> (1993). </year> <title> Quantification of MR brain images by mixture density and partial volume modeling. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 12(3) </volume> <pages> 566-574. 35 </pages>
Reference-contexts: As with many other approaches to identifying mixtures, these techniques use only a single measurement taken within a voxel to represent its contents. Without the additional information available within each voxel region, these classification algorithms are limited in their accuracy. <ref> [Santago and Gage, 1993] </ref> shares a mixture distribution for histograms with our technique.
Reference: [Vannier et al., 1985] <author> Vannier, M. W., Butterfield, R. L., Jordan, D., Murphy, W. A., Levitt, R. G., and Gado, M. </author> <year> (1985). </year> <title> Multispectral analysis of magnetic resonance images. </title> <journal> Radiology, </journal> <volume> 154 </volume> <pages> 221-224. </pages>
Reference-contexts: The advantages of this are discussed further in Section 8. Related Work. Many researchers have worked on identifying the locations of materials in sampled datasets <ref> [Vannier et al., 1985] </ref>, [Vannier et al., 1988], [Cline et al., 1990], [Duda and Hart, 1973]. [Clarke et al., 1995] gives an extensive review of the segmentation of MRI data.
Reference: [Vannier et al., 1988] <author> Vannier, M. W., Speidel, C. M., and Rickman, D. L. </author> <year> (1988). </year> <title> Magnetic resonance imaging multispectral tissue classification. </title> <booktitle> In Proc. Neural Information Processing Systems (NIPS). </booktitle>
Reference-contexts: The advantages of this are discussed further in Section 8. Related Work. Many researchers have worked on identifying the locations of materials in sampled datasets [Vannier et al., 1985], <ref> [Vannier et al., 1988] </ref>, [Cline et al., 1990], [Duda and Hart, 1973]. [Clarke et al., 1995] gives an extensive review of the segmentation of MRI data.
Reference: [Windham et al., 1988] <author> Windham, J. P., Abd-Allah, M. A., Reimann, D. A., Froelich, J. W., and Haggar, A. M. </author> <year> (1988). </year> <title> Eigenimage filtering in MR imaging. </title> <journal> Journal of Computer Assisted Tomography, </journal> <volume> 12(1) </volume> <pages> 1-9. </pages>
Reference-contexts: Their technique works well for differentiating air, soft tissue, and bone in CT data, but not for differentiating materials in MR data, where the measured data value for one material may often be identical to the measured value for a mixture of two other materials. <ref> [Windham et al., 1988] </ref> and [Kao et al., 1996] avoid partial-volume artifacts by taking linear combinations of components of vector measurements. An advantage of their techniques is that the linear operations they perform preserve the partial-volume mixtures within each sample value, and so partial-volume artifacts 6 are not created. <p> Note the band of background material in (ii) between the two curved regions. This band is incorrectly classified, and could lead to errors in models or images produced from the classified data. The original dataset is simulated, two-valued data of two concentric shells, as shown in (iv). of <ref> [Windham et al., 1988] </ref> or the classification results of [Choi et al., 1991]. Their results are visually similar to ours, and underscore the need for quantitative comparison.
Reference: [Wu et al., 1988] <author> Wu, Z., Chung, H.-W., and Wehrli, F. W. </author> <year> (1988). </year> <title> A bayesian approach to subvoxel tissue classification in NMR microscopic images of trabecular bone. </title> <journal> Journal of Computer Assisted Tomography, </journal> <volume> 12(1) </volume> <pages> 1-9. </pages>
Reference-contexts: Their technique, however, estimates material amounts in an entire dataset, and does not classify the data at a voxel level. <ref> [Wu et al., 1988] </ref> presents an interesting approach to partial-volume imaging that makes assumptions similar to ours about the underlying geometry being measured and about the measurement process. The results of their algorithm are a material assignment for each sub-voxel of the dataset.
References-found: 21

