URL: ftp://ftp.cs.columbia.edu/pub/bhat/motion.ps.gz
Refering-URL: http://www.cs.columbia.edu/~bhat/
Root-URL: http://www.cs.columbia.edu
Title: Motion Estimation using Ordinal Measures  
Author: Dinkar N. Bhat and Shree K. Nayar and Alok Gupta 
Address: NY 10027  NJ  
Affiliation: Department of Computer Science, Columbia University,  Siemens Corporate Research,  
Note: To Appear in Proc. of Computer Vision and Pattern Recognition (CVPR '97), San Juan  
Abstract: We present a method for motion estimation using ordinal measures. Ordinal measures are based on relative ordering of intensity values in a image region called rank permutation. While popular measures like the sum-of-squared-difference (SSD) and normalized correlation (N CC) rely on linearity between corresponding intensity values, ordinal measures only require them to be monon-tonically related so that rank permutations between corresponding regions are preserved. This property turns out to be very useful for motion estimation in tagged Magnetic Resonance Images. We study the imaging equation involved in two methods of tagging and observe temporal monotonicity in intensity under certain conditions though the tags themselves fade. We compare our method to SSD and N CC in a simulated rotating ring phantom image sequence. We discuss computational issues and present an experiment on a real heart image sequence, which suggests the suitability of our method. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> Authors. </author> <title> Motion estimation using ordinal measures. </title> <type> Technical report. </type> <note> (To appear). </note>
Reference-contexts: One reason for the better performance is that N CC compensates only for linear variations. As expected of any window measure, most errors occur on the boundary between the tagged region and the background. We have tabulated N fn and N fp independently, for each case, in <ref> [1] </ref>. From a computational speed perspective, SSD was superior. flow obtained with (to the nearest pixel) with images (c) and (d). It would be illuminating to study matching when the tag frequency is altered.
Reference: [2] <author> P. Anandan. </author> <title> A unified perspective on computational techniques for the measurement of visual motion. </title> <journal> International Journal of Computer Vision, </journal> <volume> 2 </volume> <pages> 283-310, </pages> <year> 1989. </year>
Reference-contexts: Consider the situation when no imaging parameters are available regarding the acquisition of the tagged MRI sequence. Here, recourse to a standard region matching approach or a gradient-based method becomes necessary. Our approach based on ordinal measures belongs to the former category. However, unlike the popular sum-of-squared-difference measure (SSD) <ref> [2] </ref> and the normalized correlation coefficient (N CC) for region matching which rely on linearity between intensities at corresponding points, ordinal measures only require them to be related monotonically. <p> Currently, a quadratic polynomial is independently fitted in x and y directions. The abscissae corresponding to the minima of the fitted polynomials, if they exist, are used as subpixel motion estimates. This is similar to interpolation of SSD as in <ref> [2] </ref> only that this method works better under variable intensity. We use this scheme in following experiment. 6 (a) (b) (a) is marked for which flow is depicted separately in figure 9.
Reference: [3] <author> S Androutsellis-Theotokis and J. L. Prince. </author> <title> Experiments in multiresolution motion estimation for multifrequency tagged cardiac mr images. </title> <booktitle> International Conference on Image Processing, </booktitle> <month> Sept </month> <year> 1996. </year>
Reference-contexts: They have closely analyzed several issues including variants to standard optical flow 1 [14], [9], optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods <ref> [3] </ref>. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters.
Reference: [4] <author> J. L. Barron, D. J. Fleet, and S. S. Beauchemin. </author> <title> Performance of optical flow techniques. </title> <journal> International Journal of Computer Vision, </journal> <volume> 12(1) </volume> <pages> 29-56, </pages> <year> 1994. </year>
Reference-contexts: Extensive research has been reported in the area of motion estimation and optical flow, and it is impossible to list all related work here for lack of space. A few surveys have appeared in the literature and two excellent recent ones are <ref> [4] </ref> and [13]. Regardless of the approach used, almost all methods implicitly or explicitly assume that intensities at corresponding points are identical, which is sometimes called the Lambertian assumption.
Reference: [5] <author> J. R. Bergen, P. Anandan, K. J. Hanna, and R. Hingorani. </author> <title> Hierarchical model-based motion estimation. </title> <booktitle> Proceedings of the European Conference on Computer Vision, </booktitle> <pages> pages 237-252, </pages> <year> 1992. </year>
Reference-contexts: We discussed it in the context of tagged MR imaging where intensities at corresponding points in image pairs, though not identical, are related in a monotonic fashion. A restriction of our approach is that parameterized motion models like an affine model <ref> [5] </ref> cannot be embedded within the correlation measure, unlike SSD based schemes. In other words, our approach does not permit a regression based approach where motion model parameters could be determined iteratively, possibly in a hierarchical fashion.
Reference: [6] <author> D. N. Bhat and S. K. Nayar. </author> <title> Ordinal measures for visual correspondence. </title> <booktitle> Proceedings of the IEEE Computer Society Conference on Computer Vision and Pattern Recognition, </booktitle> <pages> pages 351-357, </pages> <year> 1996. </year>
Reference-contexts: We also discuss computational issues and present an experiment on heart images which suggests the suitability of our method. 2 An Ordinal Measure As stated earlier, the similarity criterion used for identifying corresponding windows is an ordinal measure. In <ref> [6] </ref>, this measure was presented in the context of stereo matching where its robustness to the presence of depth discontinuities and occlusion was discussed and demonstrated. Methods based on local transformation of intensity values like those in [16] and [12] would also be interesting to consider. <p> Below, we present a method for defining the distance between rank permutations similar to that re ported by [8]. Here we assume that there are no ties in the data. The method to handle tied values is discussed in <ref> [6] </ref>. A composition permutation s can be defined as follows: s i = k 1 ) i (1) where 1 1 denotes the inverse permutation of 1 . The inverse permutation is defined as follows: If i 1 = j, then ( 1 1 ) j = i. <p> The vector of d i m values is termed as the distance vector d m (s; u). This measure has its analog in the definition of the Kolmogorov-Smirnov test statistic (see <ref> [6] </ref> for details). Each component of the distance vector, referenced by its positional index, estimates the number of predecess-ing elements in s that are out of position. If (I 1 ; I 2 ) were perfectly correlated, then d m (s; u) = (0; 0; : : : ; 0). <p> However, remains at 1 because 2 remains the same as 1 . Note that any ordinal measure like one based on the Euclidean distance between rank permutations also possesses the monotonicity property. However, in <ref> [6] </ref>, was seen to have better robustness to depth discontinuities which is desirable in tagged MR too. 3 Tagged MRI Imaging To study cardiac motion during systolic contraction, tags are generated by applying a magnetic field in the left-ventricle (LV) at the beginning of contraction (end-diastole).
Reference: [7] <author> M. A. Gennert and S. Negahdaripour. </author> <title> Relaxing the brightness constancy assumption in computing optical flow. </title> <type> Technical Report Memo no. 975, </type> <institution> MIT, AI Lab, </institution> <month> June </month> <year> 1987. </year>
Reference-contexts: Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. Gupta and Prince [9] proposed an interesting alternative by adopting Gennert's <ref> [7] </ref> model of image intensity variation which relates intensity at corresponding points by a multiplier term that smoothly changes. This technique requires estimates, though only approximate, of certain tissue parameters. Therefore, the above schemes may be considered as parametric techniques for motion computation.
Reference: [8] <author> R. A. Gideon and R. A. Hollister. </author> <title> A rank correlation coefficient. </title> <journal> Journal of the American Statistical Association, </journal> <volume> 82(398) </volume> <pages> 656-666, </pages> <year> 1987. </year>
Reference-contexts: Below, we present a method for defining the distance between rank permutations similar to that re ported by <ref> [8] </ref>. Here we assume that there are no ties in the data. The method to handle tied values is discussed in [6]. A composition permutation s can be defined as follows: s i = k 1 ) i (1) where 1 1 denotes the inverse permutation of 1 . <p> Now, a measure of correlation (I 1 ; I 2 ) is defined as: (I 1 ; I 2 ) = 1 i=1 d i b n (3) Unlike <ref> [8] </ref>, we do not consider the deviation from the negative identity permutation since that is computa-tionally more expensive. If I 1 and I 2 are perfectly cor related (s = u), then = 1. It falls to 1 when (I 1 ; I 2 ) are perfectly negatively correlated. <p> s T 1 (longitudinal relaxation time) 0.3 s T 2 (transverse relaxation time) 0.1 s k x (frequency in radial x) 4.71 rad/cm k y (frequency in radial y) 4.71 rad/cm (Tip angle) 45 ffi Table 1: Typical parameter values for the imaging equation, as described in Gupta and Prince <ref> [8] </ref>. In general D 0 ; T 1 and T 2 are not constant over the image. over a window. It follows that the intensity at a point is a monotonically increasing function of time (also seen in figure 4). <p> 150 fi 150 Pixel size (along x and y) 0.078125 cm Period of rotation of ring 10 s Time interval between images (ffit) 0.05 s Inner and outer radii of ring 2.5 cm, 4.5 cm Table 2: Image and ring parameters used in the ring sequence (from Gupta and Prince <ref> [8] </ref>). (a) t=0s (b) t=0.05s (c) t=0.1s phantom image sequence obtained from Johns Hopkins University (courtesy Sandeep Gupta). matching window in the next image (S) in a pre-defined search range. Table 3 summarizes the results of matching with each measure for four different pairs in the image sequence.
Reference: [9] <author> S. N. Gupta and J. L. Prince. </author> <title> On variable brightness optical flow for tagged mri. </title> <booktitle> International Conference on Information Processing in Medical Imaging, </booktitle> <month> June </month> <year> 1995. </year>
Reference-contexts: Consequently, algorithms that assume intensity constancy are deficient. The use of optical flow techniques for cardiac motion analysis was pioneered by Prince and his colleagues at Johns Hopkins University. They have closely analyzed several issues including variants to standard optical flow 1 [14], <ref> [9] </ref>, optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. Gupta and Prince [9] proposed an <p> 1 [14], <ref> [9] </ref>, optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. Gupta and Prince [9] proposed an interesting alternative by adopting Gennert's [7] model of image intensity variation which relates intensity at corresponding points by a multiplier term that smoothly changes. This technique requires estimates, though only approximate, of certain tissue parameters. <p> In appendix 8, we discuss how ordinal measures are equally applicable on images acquired using this method. 4 Comparison We now compare the performance of the ordinal measure against the sum-of-squared-differences SSD and normalized correlation N CC using a sequence (Figure 4) provided by Gupta <ref> [9] </ref> at the Johns Hopkins University. The sequence is that of a rotating ring phantom obtained using a Tesla whole-body scanner (see [14] for details).
Reference: [10] <author> B. K. P. Horn and B. G. Schunk. </author> <title> Determining optical flow. </title> <journal> Artificial Intelligence, </journal> <volume> 17 </volume> <pages> 185-203, </pages> <year> 1981. </year>
Reference-contexts: They have closely analyzed several issues including variants to standard optical flow 1 [14], [9], optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over <ref> [10] </ref>. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. Gupta and Prince [9] proposed an interesting alternative by adopting Gennert's [7] model of image intensity variation which relates intensity at corresponding points by a multiplier term that smoothly changes.
Reference: [11] <author> T. S. Denney Jr. and J. L. Prince. </author> <title> Optimal brightness functions for optical flow estimation of de-formable motion. </title> <journal> IEEE Transactions on Image Processing, </journal> <volume> 3(2) </volume> <pages> 178-191, </pages> <month> March </month> <year> 1994. </year>
Reference-contexts: Consequently, algorithms that assume intensity constancy are deficient. The use of optical flow techniques for cardiac motion analysis was pioneered by Prince and his colleagues at Johns Hopkins University. They have closely analyzed several issues including variants to standard optical flow 1 [14], [9], optimal intensity patterns for tagging <ref> [11] </ref>, and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters.
Reference: [12] <author> R. Kories and G. Zimmerman. </author> <title> A versatile method for the estimation of displacement vector fields from image sequences. </title> <booktitle> Proceedings of the IEEE Workshop on Motion: Representation and Analysis, </booktitle> <pages> pages 101-107, </pages> <year> 1986. </year>
Reference-contexts: In [6], this measure was presented in the context of stereo matching where its robustness to the presence of depth discontinuities and occlusion was discussed and demonstrated. Methods based on local transformation of intensity values like those in [16] and <ref> [12] </ref> would also be interesting to consider. Let I 1 be a window in one image, and I 2 be a window in the next image of the sequence.
Reference: [13] <author> A. Mitiche and P. Bouthemy. </author> <title> Computation and analysis of image motion: A synopsis of current problems and methods. </title> <journal> International Journal of Computer Vision, </journal> <volume> 19(1) </volume> <pages> 29-56, </pages> <year> 1996. </year>
Reference-contexts: Extensive research has been reported in the area of motion estimation and optical flow, and it is impossible to list all related work here for lack of space. A few surveys have appeared in the literature and two excellent recent ones are [4] and <ref> [13] </ref>. Regardless of the approach used, almost all methods implicitly or explicitly assume that intensities at corresponding points are identical, which is sometimes called the Lambertian assumption.
Reference: [14] <author> J. L. Prince and E. R. McVeigh. </author> <title> Motion estimation from tagged mr image sequences. </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 11(2) </volume> <pages> 238-249, </pages> <month> June </month> <year> 1992. </year>
Reference-contexts: A strikingly illustrative example where the constant intensity assumption breaks is Tagged Magnetic Resonance (MR) imaging which is the main focus of the paper. Standard cardiac MR imaging produces images in which the tissue has nearly constant brightness, making it impossible to determine image motion. However, by tagging <ref> [14] </ref>, a prespecified spatially varying intensity pattern can be made to appear on the otherwise homogenous tissue. The pattern itself deforms according to the heart motion, and is then imaged by standard MR methods. But, the tag pattern fades with time as seen in figure 1. <p> Consequently, algorithms that assume intensity constancy are deficient. The use of optical flow techniques for cardiac motion analysis was pioneered by Prince and his colleagues at Johns Hopkins University. They have closely analyzed several issues including variants to standard optical flow 1 <ref> [14] </ref>, [9], optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. <p> They have closely analyzed several issues including variants to standard optical flow 1 <ref> [14] </ref>, [9], optimal intensity patterns for tagging [11], and the use of pre-filtering and multi-resolution methods [3]. Prince and McVeigh [14] developed the variable brightness flow algorithm which is a significant improvement over [10]. It requires prior knowledge regarding spatial distribution of tissue and imaging parameters. <p> However, unlike the popular sum-of-squared-difference measure (SSD) [2] and the normalized correlation coefficient (N CC) for region matching which rely on linearity between intensities at corresponding points, ordinal measures only require them to be related monotonically. We carefully analyze the tagged spin-echo MR imaging equation <ref> [14] </ref> and the echo-planar imaging equation which are used by medical methods for generating tags. From the analysis, we observe that intensity of a point in the tagged images at different times are related by a monotonic function, under certain assumptions. This forms the motivation for use of our measures. <p> Under the assumption of zero heart mo tion, the intensity of a point r = r (x; y) in the heart, at time t, is given by the tagged spin-echo MR imaging equation <ref> [14] </ref> as: I (r; t) = K (r) [(r) 1]e T 1 (r) T R K (r) = D 0 (r)e T 2 (r) (4) where D 0 ; T 1 and T 2 (called the spin density, longitudinal and transversal relaxation times, respectively) are determined by the properties of the <p> T E and T R , (called the echo time and pulse repetition time, respectively) are fixed imaging parameters. (r) is the spatially varying magnetization pattern applied at end-diastole, or t = 0, which causes the tags to appear and an example function (see <ref> [14] </ref> for more details) is given below: (r) = [cos 2 sin 2 cos (k x r x )] where k x ; k y and are prespecified constants, and r x and r y are components of r. <p> The sequence is that of a rotating ring phantom obtained using a Tesla whole-body scanner (see <ref> [14] </ref> for details). While the object undergoing motion is not the heart, an operational tagged MR imaging system was used to obtain the images which distinguishes this sequence from a synthetic one. The parameters used in obtaining the images are given in table 1 and table 2.
Reference: [15] <author> C. Tang, E. R. McVeigh, and E. A. Zerhouni. </author> <title> Multi-shot epi for improvement of myocardial tag contrast: Comparison with segmented spgr. </title> <journal> Magnetic Resonance in Medicine, </journal> <volume> 33(3) </volume> <pages> 443-447, </pages> <month> March </month> <year> 1995. </year>
Reference-contexts: Notice the progressively narrowing difference between the intensity profiles which results in the image becoming more and more uniform. quite adequate. There are other forms of tagging used in medical imaging. In one method, called echo-planar imaging (EPI) <ref> [15] </ref>, there is a distinction between tagged and non-tagged regions in terms of applied magnetization.
Reference: [16] <author> R. Zabih. </author> <title> Individuating Unknown Objects by Combining Motion and Stereo. </title> <type> PhD thesis, </type> <institution> Stanford University, </institution> <month> August </month> <year> 1994. </year> <month> 8 </month>
Reference-contexts: In [6], this measure was presented in the context of stereo matching where its robustness to the presence of depth discontinuities and occlusion was discussed and demonstrated. Methods based on local transformation of intensity values like those in <ref> [16] </ref> and [12] would also be interesting to consider. Let I 1 be a window in one image, and I 2 be a window in the next image of the sequence.
References-found: 16

