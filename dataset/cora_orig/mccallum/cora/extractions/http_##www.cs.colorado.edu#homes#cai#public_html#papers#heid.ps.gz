URL: http://www.cs.colorado.edu/homes/cai/public_html/papers/heid.ps.gz
Refering-URL: http://www.cs.colorado.edu/homes/cai/public_html/mypapers.html
Root-URL: http://www.cs.colorado.edu
Title: Newton-Krylov-Schwarz Methods in CFD  
Author: X.-C. Cai W. D. Gropp D. E. Keyes M. D. Tidriri 
Address: Boulder, CO 80309 USA  Argonne, IL 60439 USA  NASA-LaRC, Hampton, VA 23681 USA,  Norfolk, VA 23529 USA, and  New Haven, CT 06520 USA  NASA-LaRC, Hampton, VA 23681 USA  
Affiliation: Department of Computer Science University of Colorado,  Mathematics and Computer Science Division Argonne National Laboratory,  Institute for Computer Applications in Science and Engineering  Department of Computer Science Old Dominion University,  Department of Mechanical Engineering Yale University,  Institute for Computer Applications in Science and Engineering  
Abstract: Summary Newton-Krylov methods are potentially well suited for the implicit solution of nonlinear problems whenever it is unreasonable to compute or store a true Jacobian. Krylov-Schwarz iterative methods are well suited for the parallel implicit solution of multidimensional systems of boundary value problems that arise in CFD. They provide good data locality so that even a high-latency workstation network can be employed as a parallel machine. We call the combination of these two methods Newton-Krylov-Schwarz and report numerical experiments on some algorithmic and implementation aspects: the use of mixed discretization schemes in the (implicitly defined) Jacobian and its preconditioner, the selection of the differencing parameter in the formation of the action of the Jacobian, the use of a coarse grid in additive Schwarz preconditioning, and workstation network implementation. Three model problems are considered: a convection-diffusion problem, the full potential equation, and the Euler equations. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D. P. Young, C. C. Ashcraft, R. G. Melvin, M. B. Bieterman, W. P. Huffman, T. F. Johnson, C. L. Hilmes, and J. E. Bussoletti, </author> <title> Ordering and Incomplete Factorization Issues for Matrices Arising from the TRANAIR CFD Code, </title> <institution> Boeing Computer Services TR BCSTECH-93-025, </institution> <address> Seattle, </address> <year> 1993. </year>
Reference-contexts: This advantage may be artificial in the sense that global incomplete LU is superior to a Schwarz method using exact subdomain solvers in serial, and ILU should replace nested dissection as the subdomain solver. In recent experiments <ref> [1] </ref> on Jacobians from the TRANAIR code, a threshhold drop tolerance form of ILU was employed as the subdomain solver in a Schwarz preconditioner, and the drop tolerance was varied from zero (exact nested dissection factorization) to a value that filtered out all but the largest entries in the approximate factors.
Reference: [2] <author> X.-C. Cai, </author> <title> An Optimal Two-level Overlapping Domain Decomposition Method for Elliptic Problems in Two and Three Dimensions, </title> <journal> SIAM J. Sci. Comp. </journal> <year> (1993) </year> <month> 239-247. </month>
Reference-contexts: In a situation in which there are more subdomains than processors, hybrid multicolored multiplicative/additive Schwarz is recommended for optimal convergence at a given parallel granularity <ref> [2] </ref>. Parallelism is not the sole motivation for Schwarz methods. We remark that, given a preconditioner for the global domain, a Krylov-Schwarz method in which the same preconditioner is applied locally on each subdomain may provide a better serial algorithm than Krylov acceleration of the original global preconditioner.
Reference: [3] <author> X.-C. Cai, </author> <title> A Non-nested Coarse Space for Schwarz Type Domain Decomposition Methods, </title> <type> Tech. Rep. </type> <institution> CU-CS-705-94, Dept. of Comp. Sci., Univ. of Colorado at Boulder, </institution> <year> 1994. </year>
Reference-contexts: The coarse grid is not necessarily nested within the fine grid, and its elements are not necessarily vertices of the subdomains, which have sides of size H s , <ref> [3] </ref>. Bilinear rectilinear elements are used for both coarse and fine grids, and bilinear interpolation for intergrid transfers.
Reference: [4] <author> X.-C. Cai and M. Dryja, </author> <title> Domain Decomposition Methods for Monotone Nonlinear Elliptic Problems, </title> <editor> in D. E. Keyes and J. Xu, eds., </editor> <booktitle> Seventh International Conference on Domain Decomposition Methods in Scientific Computing (Penn. </booktitle> <institution> State Univ.), AMS, Providence, </institution> <year> 1994, </year> <note> to appear. </note>
Reference-contexts: Here, a is the sound speed, q the flow speed, and 1 refers to the freestream. When the flow is everywhere subsonic the full potential formulation fits within the monotone nonlinear elliptic framework of additive Schwarz methods <ref> [4] </ref>.
Reference: [5] <author> X.- C. Cai, W. D. Gropp, and D. E. Keyes, </author> <title> A Comparison of Some Domain Decomposition and ILU Preconditioned Iterative Methods for Nonsymmetric Elliptic Problems, </title> <journal> J. Numer. </journal> <note> Lin. Alg. Applics. (1994), to appear. </note>
Reference-contexts: The convergence rate of block Jacobi can be improved, at higher cost per iteration, with subdomain overlap and (for many problems) by solving an additional judiciously chosen coarse grid system. It is demonstrated numerically in <ref> [5] </ref> for a variety of nonselfadjoint scalar elliptic problems that additive Schwarz with a nested coarse grid, containing one degree of freedom per subdomain, provides an "optimal" preconditioning, in the sense that the number of iterations required to attain a fixed reduction in residual is bounded by a constant as either
Reference: [6] <author> J. E. Dennis, Jr. and R. B. Schnabel, </author> <title> Numerical Methods for Unconstrained Optimization and Nonlinear Equations, </title> <publisher> Prentice-Hall, </publisher> <address> Englewood Cliffs, NJ, </address> <year> 1983. </year>
Reference-contexts: ffiu l , for l = 0; 1; : : : ; until the residual is sufficiently small, where ffiu l approximately solves the Newton correction equation J (u l )ffiu l = f (u l ), and parameter l is selected by some line search or trust region algorithm <ref> [6] </ref>. Krylov methods, such as the method of conjugate gradients for symmetric positive definite systems or GMRES for general nonsingular systems, find the best approximation of the solution in a relatively small-dimensional subspace that is built up from successive powers of the Jacobian on the initial residual.
Reference: [7] <author> M. Dryja and O. B. Widlund, </author> <title> An Additive Variant of the Alternating Method for the Case of Many Subregions, </title> <institution> Courant Institute, NYU, </institution> <type> TR 339, </type> <year> 1987. </year>
Reference-contexts: The simplest of the Schwarz preconditioners is block Jacobi, which can be regarded as a zero-overlap form of additive Schwarz <ref> [7] </ref>. The convergence rate of block Jacobi can be improved, at higher cost per iteration, with subdomain overlap and (for many problems) by solving an additional judiciously chosen coarse grid system.
Reference: [8] <author> A. Ern, V. Giovangigli, D. E. Keyes and M. D. Smooke, </author> <title> Towards Polyalgorithmic Linear System Solvers for Nonlinear Elliptic Problems, </title> <note> SIAM J. Sci. Comp. 15(1994), to appear. </note>
Reference-contexts: To connect the opening iterations to the asymptotic regime, polyalgorithmic linear solvers for the Newton corrections were shown to be desirable in, for instance, <ref> [8] </ref>. Regarding (2), we refer to [19] for recent developments. The last three considerations are the most important with respect to parallel CFD.
Reference: [9] <author> Ralph Butler and Ewing Lusk, </author> <title> Monitors, Messages, and Clusters: The p4 Parallel Programming System, </title> <institution> Argonne National Laboratory MCS Div. </institution> <note> preprint P362-0493, and J. Parallel Comput., to appear. </note>
Reference-contexts: The Euler code has been executed on an ethernet network of workstations using a package of distributed sparse linear system routines developed at Argonne National Laboratory by Gropp and Smith [11], with p4 <ref> [9] </ref> as the data exchange layer. Table 6 shows CPU times for each of three Schwarz preconditioners with different parallel granularity, for a fixed number of iterations on a fixed size problem.
Reference: [10] <author> W. D. Gropp, D. E. Keyes and J. S. Mounts, </author> <title> Implicit Domain Decomposition Algorithms for Steady, Compressible Aerodynamics, </title> <editor> in A. Quarteroni et al., eds., </editor> <title> Sixth International Symposium on Domain Decomposition Methods for Partial Differential Equations (Como, Italy), </title> <publisher> AMS, </publisher> <address> Providence, </address> <year> 1994. </year>
Reference-contexts: The Krylov solver used throughout this paper is GMRES [15], because of previous comparisons <ref> [10] </ref> with other modern Krylov solvers on the same problem class that showed CPU cost differences to be small and unsystematic when well-enough preconditioned that any of the methods were practical. <p> the Jacobian determinant of the coordinate system transformation, J = x ~ y y ~ x , through ~ Q = J 1 Q ~ G = J 1 ( t Q + x F + y G) : C-grids of 128 fi 16 or 128 fi 32 cells (from <ref> [10] </ref>) around a NACA0012 airfoil at an angle of attack of 1:25 ffi and an M 1 of 0.8 are considered. <p> Schwarz CFL No. 1 10 2 1 10 2 1 10 2 2 fi 2 4 14 7 14 2 7 8 fi 8 5 28 10 23 3 8 For a given granularity of decomposition, curvilinear "box" decompositions are generally better than curvilinear "strip" decompositions for this problem <ref> [10] </ref>.
Reference: [11] <author> W. D. Gropp and B. F. Smith, </author> <title> Simplified Linear Equations Solvers Users Manual, </title> <institution> ANL-93/8, Argonne National Laboratory, </institution> <year> 1993. </year>
Reference-contexts: The Euler code has been executed on an ethernet network of workstations using a package of distributed sparse linear system routines developed at Argonne National Laboratory by Gropp and Smith <ref> [11] </ref>, with p4 [9] as the data exchange layer. Table 6 shows CPU times for each of three Schwarz preconditioners with different parallel granularity, for a fixed number of iterations on a fixed size problem.
Reference: [12] <author> D. E. Keyes and W. D. Gropp, </author> <title> Domain-Decomposable Preconditioners for Second-order Upwind Discretizations of Multicomponent Systems, </title> <editor> in R. Glowinski et al., eds., </editor> <title> Fourth International Symposium on Domain Decomposition Methods for Partial Differential Equations (Moscow), </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1991, </year> <pages> pp. 129-139. </pages>
Reference-contexts: We do not consider second-order central discretization of the convective term in the Jacobian, as is sometimes allowed in stationary defect correction methods, since, as was shown in <ref> [12] </ref>, the preconditioned operator has an eigenvalue that tends to zero in the limit of large Peclet number for this choice. pairs at each of three cell Peclet numbers: 0.1, 1.0, and 10.0.
Reference: [13] <author> P. R. McHugh and D. A. Knoll, </author> <title> Inexact Newton's Method Solutions to the Incompressible Navier-Stokes and Energy Equations Using Standard and Matrix-Free Implementations, </title> <type> AIAA Paper, </type> <year> 1993. </year>
Reference-contexts: The action of Jacobian J on an arbitrary Krylov vector w can be approximated by J (u l )w * f (u l + *w) f (u l ) : Finite-differencing with * makes such matrix-free methods potentially much more susceptible to finite word-length effects than ordinary Krylov methods <ref> [13] </ref>. Steady aerodynamics applications require the solution of linear systems that lack strong diagonal dominance, so it is important to verify that properly-scaled matrix-free methods can be employed in this context. An approximation to the Jacobian can be used to precondition the Krylov process.
Reference: [14] <author> J. S. Mounts, D. M. Belk and D. L. Whitfield, </author> <title> Program EAGLE User's Manual, Vol. IV Multi-block Implicit, Steady-state Euler Code, </title> <institution> Air Force Armament Laboratory TR-88-117, Vol. IV, </institution> <month> September </month> <year> 1988. </year>
Reference-contexts: An Euler Problem Our Euler example is a two-dimensional transonic airfoil flow modeled using an EAGLE-derivative code <ref> [14] </ref> that employs a finite volume discretization over a body-fitted coordinate grid. <p> To obtain a representative matrix/RHS pair on which to test the behavior of Euler Jacobians under Krylov-Schwarz, we first ran a demonstration case from <ref> [14] </ref> partway to convergence and linearized about the resulting flow state.
Reference: [15] <author> Y. Saad and M. H. Schultz, </author> <title> GMRES: A Generalized Minimal Residual Algorithm for Solving Nonsymmetric Linear Systems, </title> <journal> SIAM J. Sci. Stat. Comp. </journal> <volume> 7(1986), </volume> <pages> 865-869. </pages>
Reference-contexts: The Krylov solver used throughout this paper is GMRES <ref> [15] </ref>, because of previous comparisons [10] with other modern Krylov solvers on the same problem class that showed CPU cost differences to be small and unsystematic when well-enough preconditioned that any of the methods were practical.
Reference: [16] <author> J. L. Steger and R. F. Warming, </author> <title> Flux Vector Splitting of the Inviscid Gasdynamics Equations with Applications to Finite-Difference Methods, </title> <journal> J. Comp. Phys. </journal> <volume> 40(1981), </volume> <pages> 263-293. </pages>
Reference-contexts: Following the defect correction practice of <ref> [16] </ref>, a flux vector split scheme of Van Leer type is employed for the implicit operators, A and B, and the vector of steady-state residuals, f (u), is discretized by a Roe-type flux difference split scheme.
Reference: [17] <author> M. D. Tidriri, </author> <type> PhD thesis, </type> <institution> Univ. of Paris XI, </institution> <month> May </month> <year> 1992. </year>
Reference-contexts: A Convection-Diffusion Problem The academic nonlinear convection-diffusion Dirichlet problem @u + u @x @u -r 2 u = 0 from <ref> [17] </ref> is employed for tests of the Newton-Krylov method because, under the assumption of backward Euler time-differencing, @u @t (u n+1 u n )=t, an exact semi-discrete solution can be constructed for u n+1 . <p> This problem is discretized on a Courant-triangulated unit square using a hybrid finite-volume/finite-element first-order approximation <ref> [17] </ref>. It is extended to second-order upwinding for the convective terms using MUSCL-type approach [22].
Reference: [18] <author> L. N. Trefethen, </author> <title> Approximation Theory and Numerical Linear Algebra, </title> <editor> in J. C. Mason and M. G. Cox, </editor> <title> Algorithms for Approximation, </title> <publisher> Chapman (1990), </publisher> <pages> pp. 336-360. </pages>
Reference-contexts: It should be noted that since the preconditioned operators are generally non-normal, no conclusions should be drawn about the performance of Krylov-accelerated version of these methods on the basis of the exact spectra alone. It has been shown <ref> [18] </ref> that, in the presence of finite-precision arithmetic, the spectrum itself may be misleading for non-normal operators, and the pseudo-spectrum is more revealing.
Reference: [19] <author> V. Venkatakrishnan, </author> <title> Convergence to Steady State Solutions of the Euler Equations on Unstructured Grids with Limiters, </title> <journal> J. Comp. Phys. </journal> <note> (1994), submitted. </note>
Reference-contexts: To connect the opening iterations to the asymptotic regime, polyalgorithmic linear solvers for the Newton corrections were shown to be desirable in, for instance, [8]. Regarding (2), we refer to <ref> [19] </ref> for recent developments. The last three considerations are the most important with respect to parallel CFD. For a variety of reasons, industrial CFD groups are inclining towards the distributed network computing environment characterized by coarse to medium granularity, large memory per node, and very high latency.
Reference: [20] <author> V. Venkatakrishnan, </author> <title> Parallel Implicit Unstructured Grid Euler Solvers, </title> <type> AIAA Paper 94-0759, </type> <address> Reno, Nevada, </address> <month> January </month> <year> 1994. </year>
Reference-contexts: Decomp. Iterations Serial Time 1 fi 1 1 38.1 4 fi 4 14 21.0 parallel algorithm. Though we have not yet experimented with a coarse grid in the Eu-ler context, <ref> [20] </ref> shows that even a piecewise constant coarse grid operator substantially improves Krylov-Schwarz convergence rates in unstructured problems. The serial benefit of the Schwarz preconditioning is illustrated in Table 5.
Reference: [21] <author> P. N. Brown and Y. Saad, </author> <title> Hybrid Krylov Methods for Nonlinear Systems of Equations, </title> <journal> SIAM J. Sci. Stat. Comp. </journal> <volume> 11(1990), </volume> <pages> 450-481. </pages>
Reference-contexts: Right preconditioning spoils the perfect unit two-norm, however, and the second technique retains an advantage in this context. For an extended discussion of matrix-free applications of the Jacobian in the Krylov context, see <ref> [21] </ref>.
Reference: [22] <author> B. Van Leer, </author> <title> Towards the Ultimate Conservative Difference Scheme, II. Monotonicity and conservation combined in a Second Order Scheme, </title> <journal> J. Comp. Phys. </journal> <volume> 14(1974), </volume> <pages> 361-370. </pages>
Reference-contexts: This problem is discretized on a Courant-triangulated unit square using a hybrid finite-volume/finite-element first-order approximation [17]. It is extended to second-order upwinding for the convective terms using MUSCL-type approach <ref> [22] </ref>. <p> Of the first two, the four-point formula, with one stencil point on the downwind side, corresponds to the second-order upwind extension of the cell-upwind scheme developed in <ref> [22] </ref> and considered further in the two-dimensional nonlinear convection-diffusion cases described below. The three-point formula, with all stencil points on the upwind side is a commonly used finite-difference form, which appears further below only for one-dimensional comparison purposes.
References-found: 22

