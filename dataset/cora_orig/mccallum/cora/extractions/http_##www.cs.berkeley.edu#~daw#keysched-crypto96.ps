URL: http://www.cs.berkeley.edu/~daw/keysched-crypto96.ps
Refering-URL: http://www.cs.berkeley.edu/~daw/me.html
Root-URL: 
Email: fkelsey,schneierg@counterpane.com daw@cs.berkeley.edu  
Title: Key-Schedule Cryptanalysis of IDEA, G-DES, GOST, SAFER, and Triple-DES  
Author: John Kelsey Bruce Schneier David Wagner E. Minnehaha Parkway 
Address: Soda Hall Minneapolis, MN 55419 Berkeley, CA 94720-1776  
Affiliation: Counterpane Systems U.C. Berkeley  C.S. Div.,  
Abstract: We present new attacks on key schedules of block ciphers. These attacks are based on the principles of related-key differential cryptanalysis: attacks that allow both keys and plaintexts to be chosen with specific differences. We show how these attacks can be exploited in actual protocols and cryptanalyze the key schedules of a variety of algorithms, including three-key triple-DES.
Abstract-found: 1
Intro-found: 1
Reference: [BR94] <author> M. Bellare and P. Rogaway, </author> <title> "Optimal Asymmetric Encryption|How to Encrypt with RSA," </title> <booktitle> Advances in Cryptology|EUROCRYPT '94, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp. 92-111. </pages>
Reference-contexts: keys K; K 0 such that E K (P ) = E K 0 (P ) holds with high probability. 5 Other researchers, e.g. [MB94], have also noted the need for message integrity pro tection in key distribution protocols. 6 Standard public key schemes such as PKCS [PKCS] and Bellare-Rogaway <ref> [BR94] </ref> use padding and thus are not vulnerable to this sort of attack. 6 Key exchange protocols may also be vulnerable when they transmit some key data as salt in the clear (perhaps to avoid dictionary attacks), since this practice gives an adversary some control over the input to the bulk
Reference: [BB93] <author> I. Ben-Aroya and E. Biham, </author> <title> "Differential Cryptanalysis of Lucifer," </title> <booktitle> Advances in Cryptology|CRYPTO '93, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994. </year>
Reference-contexts: One out of 256 keys are detectable, and a detectable key has about a 13.8% chance of revealing 16 bits of the key in the first output byte. Lucifer has differential characteristics which are conditional on the key <ref> [BB93] </ref>. 1 It is interesting to note that the weak keys in DES were instrumental in proving that the cipher is not a group [CW93]. 2 RC5 The following is a new detectable key class attack on RC5 [Riv95].
Reference: [Ber83] <author> T.A. Berson, </author> <title> "Long Key Variants of DES," </title> <booktitle> Advances in Cryptology: CRYPTO '82, </booktitle> <publisher> Plenum Press, </publisher> <year> 1983, </year> <pages> pp. 311-313. </pages>
Reference-contexts: in this way until all 128 bits of K are known. 13 The 1R attack allows one to extract more information about the last round subkey from a right pair than Knudsen's 0R attack does. 10 4.4 DES with Independent Round Subkeys A 768-bit DES variant uses independent round subkeys <ref> [Ber83] </ref>. This variant will be much weaker in some situations: there is a very simple related-key attack needing just 15 related keys and 60 chosen plaintexts.
Reference: [Bih94] <author> E. Biham, </author> <title> "New Types of Cryptanalytic Attacks Using Related Keys," </title> <booktitle> Advances in Cryptology|EUROCRYPT '93, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 398-409. </pages>
Reference-contexts: Biham introduced a form of related-key cryptanalysis of product ciphers based on rotating the round subkeys <ref> [Bih94] </ref>. Grossman and Tuckerman have described an attack on Feistel ciphers with identical subkeys in each round [GT78]. 4 With hindsight, the ideas used in their known-plaintext attack seem similar to the general approach of Biham's related-key attacks, though their paper predated Biham's by 16 years. <p> This method is successful against LOKI and Lucifer <ref> [Bih94] </ref>. One very useful cryptanalytic technique considers a differential attack in which the keys, as well as the plaintexts, are chosen with specific differences.
Reference: [BS93a] <author> E. Biham and A. Shamir, </author> <title> Differential Cryptanalysis of the Data Encryption Standard, </title> <publisher> Springer-Verlag, </publisher> <year> 1993, </year> <pages> pp. 187-199. </pages>
Reference-contexts: He finds a related-key attack which has a 1=73 probability of recovering 8 key bits given one chosen related-key query and 2 30 -2 36 chosen plaintexts. We believe that Knudsen's differential attack can be optimized by using standard ideas from differential cryptanalysis <ref> [BS93a] </ref>. Adopt a 1R attack, so that the differential characteristic covers rounds 2-5; the first round can be bypassed by using structures of 2 8 plaintexts, as Knudsen suggested in [Knu95b].
Reference: [BS93b] <author> E. Biham and A. Shamir, </author> <title> "Differential Cryptanalysis of the Full 16-round DES," </title> <booktitle> Advances in Cryptology|CRYPTO '92, </booktitle> <publisher> Springer-Verlag 1993, </publisher> <pages> pp. 487-496. </pages>
Reference-contexts: For instance, recovering a few round subkeys allows one to recover most of the master key in the DES key schedule; Biham and Shamir exploited this to optimize their differential attack on DES <ref> [BS93b] </ref>.
Reference: [Bla93] <author> M. </author> <title> Blaze, "A Cryptographic File System for UNIX," </title> <booktitle> 1st ACM Conference on Computer and Communications Security, </booktitle> <publisher> ACM Press, </publisher> <year> 1993, </year> <pages> pp. 9-16. </pages>
Reference-contexts: Note this attack does not work against two-key triple-DES, and is the first attack for which two-key triple-DES is stronger than three-key triple-DES. 4.7 ECB+OFB Matt Blaze proposed a double-DES variant <ref> [Bla93] </ref>, as follows: M n+1 = E (K 1 ; M n ) M 0 = IV It was intended as a stronger replacement for single DES for use in a cryptographic filesystem. This scheme is also vulnerable to related key attack.
Reference: [Bla94] <author> M. </author> <title> Blaze, "Key Management in an Encrypting File System," </title> <booktitle> Proceedings of the 1994 USENIX Summer Tech. Conference, </booktitle> <month> June </month> <year> 1994. </year>
Reference-contexts: In total, the attack requires one related-key query, one chosen-ciphertext query, and 2 57 trial encryptions. Note that Blaze's encrypting filesystem <ref> [Bla94] </ref> actually implements a modification of this mode; the deployed mode is resistant to our attack. 5 Designing Strong Key Schedules Two basic approaches prevent related-key attacks on a cryptosystem. First, one may provide protection in the high-level protocol.
Reference: [CW93] <author> K.W. Campbell and M.J. Wiener, </author> <title> "DES is Not a Group," </title> <booktitle> Advances in Cryptology|CRYPTO '92, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1993, </year> <pages> pp. 512-520. 13 </pages>
Reference-contexts: Lucifer has differential characteristics which are conditional on the key [BB93]. 1 It is interesting to note that the weak keys in DES were instrumental in proving that the cipher is not a group <ref> [CW93] </ref>. 2 RC5 The following is a new detectable key class attack on RC5 [Riv95]. Suppose all but the first pair of RC5 subkeys has only 0 bits in their low 5 bit positions.
Reference: [CE86] <author> D. Chaum and J.-H. Evertse, </author> <title> "Cryptanalysis of DES With a Reduced Num--ber of Rounds," </title> <booktitle> Advances in Cryptology|CRYPTO '85, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1986, </year> <pages> pp. 192-211. </pages>
Reference-contexts: Six-round DES has a linear factor <ref> [CE86] </ref>. 2.3 Weak Keys A weak key, K, is a key for which encryption is the same function as decryption. A pair of semi-weak keys, K and K 0 , are keys for which encryption with K is the same as decryption with K 0 and vice versa.
Reference: [Cop86] <author> D. Coppersmith, </author> <title> "The Real Reason for Rivest's Phenomenon," </title> <booktitle> Advances in Cryptology|CRYPTO '85, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1986, </year> <pages> pp. 535-536. </pages>
Reference-contexts: A pair of semi-weak keys, K and K 0 , are keys for which encryption with K is the same as decryption with K 0 and vice versa. Both DES and LOKI89 have weak keys <ref> [Dav83, Cop86, MS87, Knu93a] </ref>. 1 If the number of weak keys is relatively small, they may not compromise the cipher when used to assure confidentiality.
Reference: [DGV93] <author> J. Daemen, R. Govaerts, and J. Vanderwalle, </author> <title> "Block Ciphers Based on Modular Arithmetic," </title> <booktitle> Proceedings of the 3rd Symposium on State and Progress of Research in Cryptography, </booktitle> <year> 1993, </year> <pages> pp. 80-89. </pages>
Reference-contexts: For example, certain keys in Blowfish [Sch94] result in identical S-box entries, and can be detected in reduced-round variants [Vau96]. IDEA [LMM91] has several classes of keys detectable with just two chosen-plaintext encryptions <ref> [DGV93] </ref>. The key schedule in LOKI91 allows two different keys to have several round keys in common; this reduces the effective keyspace by almost a factor of four using 2 33 chosen plaintexts [Knu93b].
Reference: [Dav83] <author> D.W. Davies, </author> <title> "Some Regular Properties of the DES," </title> <booktitle> Advances in Cryptology|CRYPTO '92, </booktitle> <publisher> Plenum Press, </publisher> <year> 1983, </year> <pages> pp. 89-96. </pages>
Reference-contexts: A pair of semi-weak keys, K and K 0 , are keys for which encryption with K is the same as decryption with K 0 and vice versa. Both DES and LOKI89 have weak keys <ref> [Dav83, Cop86, MS87, Knu93a] </ref>. 1 If the number of weak keys is relatively small, they may not compromise the cipher when used to assure confidentiality.
Reference: [GOST89] <author> GOST, </author> <title> Gosudarstvennyi Standard 28147-89, "Cryptographic Protection for Data Processing Systems," </title> <institution> Government Committee of the USSR for Standards, </institution> <year> 1989. </year>
Reference-contexts: In other words, for hash functions, related-key queries are cheap|usually cheaper than chosen-plaintext queries. Accordingly, hash functions must rely on the underlying block cipher to have an exceedingly strong key schedule. 4 New Related-Key Attacks 4.1 GOST GOST <ref> [GOST89] </ref> is an excellent example of a cipher that was designed to resist rotating-subkey related-key attacks but not related-key differential cryptanalysis. Let K 0::7 be the eight 32-bit words of the key.
Reference: [GT78] <author> E.K. Grossman and B. Tuckerman, </author> <title> "Analysis of a Weakened Feistel-like Cipher," </title> <booktitle> 1978 International Conference on Communications, </booktitle> <publisher> Alger Press Limited, </publisher> <year> 1978, </year> <pages> pp. </pages> <month> 46.3.1-46.3.5. </month>
Reference-contexts: Biham introduced a form of related-key cryptanalysis of product ciphers based on rotating the round subkeys [Bih94]. Grossman and Tuckerman have described an attack on Feistel ciphers with identical subkeys in each round <ref> [GT78] </ref>. 4 With hindsight, the ideas used in their known-plaintext attack seem similar to the general approach of Biham's related-key attacks, though their paper predated Biham's by 16 years. Others have used similar techniques to exploit key schedule weaknesses in chosen-plaintext attacks [Knu93b].
Reference: [Knu93a] <author> L.R. Knudsen, </author> <title> "Cryptanalysis of LOKI," </title> <booktitle> Advances in Cryptology| ASIACRYPT '91, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1993, </year> <pages> pp. 22-35. </pages>
Reference-contexts: A pair of semi-weak keys, K and K 0 , are keys for which encryption with K is the same as decryption with K 0 and vice versa. Both DES and LOKI89 have weak keys <ref> [Dav83, Cop86, MS87, Knu93a] </ref>. 1 If the number of weak keys is relatively small, they may not compromise the cipher when used to assure confidentiality.
Reference: [Knu93b] <author> L.R. Knudsen, </author> <title> "Cryptanalysis of LOKI91," </title> <booktitle> Advances in Cryptology| AUSCRYPT '92, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1993, </year> <pages> pp. 196-208. </pages>
Reference-contexts: IDEA [LMM91] has several classes of keys detectable with just two chosen-plaintext encryptions [DGV93]. The key schedule in LOKI91 allows two different keys to have several round keys in common; this reduces the effective keyspace by almost a factor of four using 2 33 chosen plaintexts <ref> [Knu93b] </ref>. Due to the weak mixing in its key schedule, RC4 has a class of detectable keys [Roo95]. One out of 256 keys are detectable, and a detectable key has about a 13.8% chance of revealing 16 bits of the key in the first output byte. <p> Others have used similar techniques to exploit key schedule weaknesses in chosen-plaintext attacks <ref> [Knu93b] </ref>. Let SK i be the ith round subkey generated from master key K under the key schedule.
Reference: [Knu94] <author> L.R. Knudsen, </author> <title> "Practically Secure Feistel Ciphers," Fast Software Encryption, </title> <booktitle> Cambridge Security Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 211-221. </pages>
Reference-contexts: However, we need to worry about this attack if we try to build hash functions out of RC5 with almost any R. 2.5 Simple Relations and Equivalent Keys A simple relation occurs between two different keys, manifesting itself as a relationship between the resulting plaintexts and ciphertexts <ref> [Knu94] </ref>. This also allows the keyspace to be reduced in a search. DES and LOKI have a simple relation known as the complementation property: if K encrypts P to C, then the bitwise complement of K encrypts the bitwise complement of P to the bitwise complement of C. <p> This type of approach was adopted by SEAL [RC94] and Blowfish 14 An anonymous reviewer has pointed out that the known-plaintext attack can be converted to a ciphertext-only attack with knowledge of a faulty P 0 ; C pair. 12 [Sch94], and suggested in <ref> [Knu94] </ref>, and resulted in strong key schedules. The key schedules of FEAL [SM88] and RC5 [Riv95] also resist related-key cryptanalysis. As an open question, we note that the DES key schedule is linear, and wonder why it appears to resist related-key attacks.
Reference: [Knu95a] <author> L.R. Knudsen, </author> <title> "New Potentially `Weak' Keys for DES and LOKI," </title> <booktitle> Advances in Cryptology|EUROCRYPT '94, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp. 419-424. </pages>
Reference-contexts: This reduces the effective keyspace by one bit. DES and LOKI have pairs of keys for which a simple relation exists, for at least a fraction of all plaintexts <ref> [Knu95a] </ref>. Kwan and Pieprzyk describe a technique for locating complementation properties in linear key schedules [KP93]. Two keys are equivalent if they transform all plaintexts identically. This can be considered a special kind of simple relation. TEA TEA [WN95] is an easy-to-memorize Feistel block cipher.
Reference: [Knu95b] <author> L.R. Knudsen, </author> <title> "A Key-schedule Weakness in SAFER K-64," </title> <booktitle> Advances in Cryptology|CRYPTO '95, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp. 274-286. </pages>
Reference-contexts: Given a vulnerable key schedule, we can often insert a chosen difference into the middle of a cipher, rather than having to pass through all rounds of the cipher. This formulation appears to be novel, though some earlier work <ref> [Knu95b] </ref> implicitly used this type of method. 3.2 Motivation and Impact Related-key cryptanalysis has commonly been considered a powerful, but strictly theoretical, attack. We believe that this view is inaccurate and that related-key cryptanalysis is of practical interest as well. Certain real-world cryptographic implementations may allow for related-key cryptanalysis. <p> Knudsen shows that this regularity in the SAFER K-64 key schedule causes serious weaknesses in the block cipher <ref> [Knu95b] </ref>. He finds a related-key attack which has a 1=73 probability of recovering 8 key bits given one chosen related-key query and 2 30 -2 36 chosen plaintexts. We believe that Knudsen's differential attack can be optimized by using standard ideas from differential cryptanalysis [BS93a]. <p> We believe that Knudsen's differential attack can be optimized by using standard ideas from differential cryptanalysis [BS93a]. Adopt a 1R attack, so that the differential characteristic covers rounds 2-5; the first round can be bypassed by using structures of 2 8 plaintexts, as Knudsen suggested in <ref> [Knu95b] </ref>. This 4-round characteristic has probability approximately 2 23 to 2 28 (when the key difference is favorable, which happens about 1=73 of the time) and S=N ratio of at least 2 11 . <p> SAFER SK is a variant with an updated key schedule, designed to increase its avalanche qualities; it is not vulnerable to the related-key attack described above <ref> [Knu95b] </ref>. 11 These numbers reflect the machine and implementation used for the experiment| other machines and implementations may change these significantly.
Reference: [Koc96] <author> P.C. Kocher, </author> <title> "Timing Attack Cryptanalysis of Diffie-Hellman, RSA, and Other Systems," </title> <booktitle> Advances in Cryptology|CRYPTO '96, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1996, </year> <note> this volume. </note>
Reference-contexts: We will usually find only one such value for these two subkeys. Related-Key Differential Timing Attacks <ref> [Koc96] </ref> cryptanalyzes several important cryptosystems by timing their operation. We present a relatively simple chosen-key timing attack on IDEA.
Reference: [KP93] <author> M. Kwan and J. Pieprzyk, </author> <title> "A General Purpose Technique for Locating Key Scheduling Weaknesses in DES-like Cryptosystems," </title> <booktitle> Advances in Cryptology|ASIACRYPT '91, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1993, </year> <pages> pp. 237-246. </pages>
Reference-contexts: This reduces the effective keyspace by one bit. DES and LOKI have pairs of keys for which a simple relation exists, for at least a fraction of all plaintexts [Knu95a]. Kwan and Pieprzyk describe a technique for locating complementation properties in linear key schedules <ref> [KP93] </ref>. Two keys are equivalent if they transform all plaintexts identically. This can be considered a special kind of simple relation. TEA TEA [WN95] is an easy-to-memorize Feistel block cipher.
Reference: [LMM91] <author> X. Lai, J. Massey, and S. Murphy, </author> <title> "Markov Ciphers and Differential Cryptanalysis," </title> <booktitle> Advances in Cryptology|CRYPTO '91, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1991, </year> <pages> pp. 17-38. </pages>
Reference-contexts: In some instances, the workload of identifying a key with a specific class is very small; these too are sometimes referred to as weak keys. For example, certain keys in Blowfish [Sch94] result in identical S-box entries, and can be detected in reduced-round variants [Vau96]. IDEA <ref> [LMM91] </ref> has several classes of keys detectable with just two chosen-plaintext encryptions [DGV93]. The key schedule in LOKI91 allows two different keys to have several round keys in common; this reduces the effective keyspace by almost a factor of four using 2 33 chosen plaintexts [Knu93b]. <p> Randomly chosen S-boxes were much weaker. The average probability over 10000 random S-boxes was 2 54 ; other values were in the range 2 43 to 2 80 , with a large variation between trials. 4.2 IDEA IDEA <ref> [LMM91] </ref> is an eight-round block cipher with a 64-bit block and a 128-bit key. Each round key is 96 bits long; there is also a final output transformation which uses a 64 bit round key. IDEA's key schedule is very simple.
Reference: [MB94] <author> W. Mao and C. Boyd, </author> <title> "Development of Authentication Protocols: Some Misconceptions and a New Approach," </title> <booktitle> Computer Security Foundations Workshop VII, </booktitle> <publisher> IEEE Computer Society Press, </publisher> <year> 1994, </year> <pages> p. 178-86. </pages>
Reference-contexts: sort of key difference needed for a key rotation attack. 6 4 Furthermore, their optional protocol extension for key integrity can fail when there are related keys K; K 0 such that E K (P ) = E K 0 (P ) holds with high probability. 5 Other researchers, e.g. <ref> [MB94] </ref>, have also noted the need for message integrity pro tection in key distribution protocols. 6 Standard public key schemes such as PKCS [PKCS] and Bellare-Rogaway [BR94] use padding and thus are not vulnerable to this sort of attack. 6 Key exchange protocols may also be vulnerable when they transmit some
Reference: [Mas94] <author> J.L. Massey, "SAFER K-64: </author> <title> A Byte-Oriented Block-Ciphering Algorithm", Fast Software Encryption, </title> <booktitle> Cambridge Security Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 1-17. </pages>
Reference-contexts: of K and exhaustively search over the remaining 48 unknown bits. 12 4.3 SAFER K-64 SAFER K-64 is a 6-round block cipher whose round function combines the input with a round subkey, applies eight parallel 8-bit permutation S-boxes, combines the result with another subkey, and ends with a diffusion layer <ref> [Mas94] </ref>. The key schedule rotates the ith master key byte and adds a constant to obtain the ith byte of each round subkey; therefore master key byte i affects only the input and output of S-box i in every round.
Reference: [Mer91] <author> R.C. Merkle, </author> <title> "Fast Software Encryption Functions," </title> <booktitle> Advances in Cryptology|CRYPTO '90, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1991, </year> <pages> pp. 476-501. </pages>
Reference-contexts: Key schedules are used in several ways: a. To specify the round keys of a product cipher. DES [NBS77] uses its key schedule in this way, as do many other product ciphers. b. To initialize some fixed elements of a cryptographic transform. Khufu <ref> [Mer91] </ref>, Blowfish [Sch94], and SEAL [RC94] use a key schedule this way. c. To initialize the state of a stream cipher prior to generating keystream. RC4 [Sch96] uses a key schedule in this way.
Reference: [MH81] <author> R.C. Merkle and M. Hellman, </author> <title> "On the Security of Multiple Encryption," </title> <journal> Communications of the ACM, v. </journal> <volume> 24, </volume> <editor> n. </editor> <volume> 7, </volume> <month> Jul </month> <year> 1981 </year> <month> pp. </month> <pages> 465-467. </pages>
Reference-contexts: This allows an attacker to attack the two parts independently, and works against double-encryption with a block cipher and two different keys <ref> [MH81, OW91, OW95] </ref>. 2.2 Linear Factors A linear factor is a fixed set of key bits whose complementation leaves the XOR of a fixed set of ciphertext bits unchanged; this weakness can be used to speed up an exhaustive key search. <p> After that, one can find k b ; k c with a meet-in-the-middle attack on double-DES, which has complexity of approximately 2 56 to 2 72 <ref> [MH81, OW91, OW95] </ref>. In total, we need one chosen related-key query, one chosen-ciphertext query, and 2 56 -2 72 o*ine trial encryptions.
Reference: [MS87] <author> J.H. Moore and G.J. Simmons, </author> <title> "Cycle Structure of the DES with Weak and Semi-Weak Keys," </title> <booktitle> Advances in Cryptology|CRYPTO '86, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1987, </year> <pages> pp. 3-32. </pages>
Reference-contexts: A pair of semi-weak keys, K and K 0 , are keys for which encryption with K is the same as decryption with K 0 and vice versa. Both DES and LOKI89 have weak keys <ref> [Dav83, Cop86, MS87, Knu93a] </ref>. 1 If the number of weak keys is relatively small, they may not compromise the cipher when used to assure confidentiality.
Reference: [NBS77] <institution> National Bureau of Standards, </institution> <note> NBS FIPS PUB 46, </note> <institution> "Data Encryption Stand--ard," National Bureau of Standards, U.S. Department of Commerce, </institution> <month> Jan </month> <year> 1977. </year>
Reference-contexts: Key schedules are used in several ways: a. To specify the round keys of a product cipher. DES <ref> [NBS77] </ref> uses its key schedule in this way, as do many other product ciphers. b. To initialize some fixed elements of a cryptographic transform. Khufu [Mer91], Blowfish [Sch94], and SEAL [RC94] use a key schedule this way. c. To initialize the state of a stream cipher prior to generating keystream.
Reference: [OW91] <author> P.C. van Oorschot and M.J. Wiener, </author> <title> "A Known-Plaintext Attack on Two-Key Triple Encryption," </title> <booktitle> Advances in Cryptology|CRYPTO '90, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1991, </year> <pages> pp. 318-325. </pages>
Reference-contexts: This allows an attacker to attack the two parts independently, and works against double-encryption with a block cipher and two different keys <ref> [MH81, OW91, OW95] </ref>. 2.2 Linear Factors A linear factor is a fixed set of key bits whose complementation leaves the XOR of a fixed set of ciphertext bits unchanged; this weakness can be used to speed up an exhaustive key search. <p> After that, one can find k b ; k c with a meet-in-the-middle attack on double-DES, which has complexity of approximately 2 56 to 2 72 <ref> [MH81, OW91, OW95] </ref>. In total, we need one chosen related-key query, one chosen-ciphertext query, and 2 56 -2 72 o*ine trial encryptions.
Reference: [OW95] <author> P.C. van Oorschot and M.J. Wiener, </author> <title> "Parallel Collision Search with Cryptanalytic Applications," </title> <note> to appear, </note> <year> 1995. </year>
Reference-contexts: This allows an attacker to attack the two parts independently, and works against double-encryption with a block cipher and two different keys <ref> [MH81, OW91, OW95] </ref>. 2.2 Linear Factors A linear factor is a fixed set of key bits whose complementation leaves the XOR of a fixed set of ciphertext bits unchanged; this weakness can be used to speed up an exhaustive key search. <p> After that, one can find k b ; k c with a meet-in-the-middle attack on double-DES, which has complexity of approximately 2 56 to 2 72 <ref> [MH81, OW91, OW95] </ref>. In total, we need one chosen related-key query, one chosen-ciphertext query, and 2 56 -2 72 o*ine trial encryptions.
Reference: [PA90a] <author> A. Pfitzmann and R. Abmann, </author> <title> "Efficient Software Implementations of (Generalized) DES," </title> <booktitle> Proc. </booktitle> <address> SECURICOM '90, Paris, </address> <year> 1990, </year> <pages> pp. 139-158. </pages>
Reference-contexts: This may be useful in attacking some systems that leave expanded keys vulnerable to change. 4.5 G-DES G-DES <ref> [PA90a, PA90b] </ref> is a DES variant with independent round subkeys. The authors foresee difficulty if it is used for hashing (such as a Davies-Meyer construction), so they specify two special modes for use as a one-way function.
Reference: [PA90b] <author> A. Pfitzmann and R. Abmann, </author> <title> "More Efficient Software Implementations of (Generalized) DES," </title> <type> Technical Report PfAb90, </type> <institution> Interner Bericht 18/90, Fakultat fur Informatik, Universitat Karlsruhe, </institution> <year> 1990. </year> <month> 15 </month>
Reference-contexts: This may be useful in attacking some systems that leave expanded keys vulnerable to change. 4.5 G-DES G-DES <ref> [PA90a, PA90b] </ref> is a DES variant with independent round subkeys. The authors foresee difficulty if it is used for hashing (such as a Davies-Meyer construction), so they specify two special modes for use as a one-way function.
Reference: [PKCS] <author> RSA Data Security, Inc., </author> <title> "Public-Key Cryptography Standard (PKCS) #1: RSA Encryption Standard," </title> <note> Version 1.5, </note> <month> Nov </month> <year> 1993. </year>
Reference-contexts: there are related keys K; K 0 such that E K (P ) = E K 0 (P ) holds with high probability. 5 Other researchers, e.g. [MB94], have also noted the need for message integrity pro tection in key distribution protocols. 6 Standard public key schemes such as PKCS <ref> [PKCS] </ref> and Bellare-Rogaway [BR94] use padding and thus are not vulnerable to this sort of attack. 6 Key exchange protocols may also be vulnerable when they transmit some key data as salt in the clear (perhaps to avoid dictionary attacks), since this practice gives an adversary some control over the input
Reference: [Riv95] <author> R.L. Rivest, </author> <title> "The RC5 Encryption Algorithm," Fast Software Encryption, </title> <booktitle> Second International Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp. 86-96. </pages>
Reference-contexts: Lucifer has differential characteristics which are conditional on the key [BB93]. 1 It is interesting to note that the weak keys in DES were instrumental in proving that the cipher is not a group [CW93]. 2 RC5 The following is a new detectable key class attack on RC5 <ref> [Riv95] </ref>. Suppose all but the first pair of RC5 subkeys has only 0 bits in their low 5 bit positions. This is a weak key, because it is possible (with 1024 tries) to get a plaintext value that never rotates. <p> The key schedules of FEAL [SM88] and RC5 <ref> [Riv95] </ref> also resist related-key cryptanalysis. As an open question, we note that the DES key schedule is linear, and wonder why it appears to resist related-key attacks.
Reference: [RC94] <author> P. Rogaway and D. Coppersmith, </author> <title> "A Software-Optimized Encryption Algorithm," Fast Software Encryption, </title> <booktitle> Cambridge Security Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 56-63. </pages>
Reference-contexts: Key schedules are used in several ways: a. To specify the round keys of a product cipher. DES [NBS77] uses its key schedule in this way, as do many other product ciphers. b. To initialize some fixed elements of a cryptographic transform. Khufu [Mer91], Blowfish [Sch94], and SEAL <ref> [RC94] </ref> use a key schedule this way. c. To initialize the state of a stream cipher prior to generating keystream. RC4 [Sch96] uses a key schedule in this way. Note that (b) and (c) are the only instances where synchronous stream ciphers can fall prey to any chosen-input attack. <p> Every key bit should affect nearly every round, if possible, but not in exactly the same way; also the key schedule should be designed to resist differential attacks. This type of approach was adopted by SEAL <ref> [RC94] </ref> and Blowfish 14 An anonymous reviewer has pointed out that the known-plaintext attack can be converted to a ciphertext-only attack with knowledge of a faulty P 0 ; C pair. 12 [Sch94], and suggested in [Knu94], and resulted in strong key schedules.
Reference: [Roo95] <author> A. Roos, </author> <title> "A Class of Weak Keys in the RC4 Stream Cipher," </title> <institution> Vironix Software Laboratories, Westville, South Africa Sep 1995. </institution> <month> 16 </month>
Reference-contexts: The key schedule in LOKI91 allows two different keys to have several round keys in common; this reduces the effective keyspace by almost a factor of four using 2 33 chosen plaintexts [Knu93b]. Due to the weak mixing in its key schedule, RC4 has a class of detectable keys <ref> [Roo95] </ref>. One out of 256 keys are detectable, and a detectable key has about a 13.8% chance of revealing 16 bits of the key in the first output byte.
Reference: [Sch94] <author> B. Schneier, </author> <title> "Description of a New Variable-Length Key, 64-Bit Block Cipher (Blowfish)," Fast Software Encryption, </title> <booktitle> Cambridge Security Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994, </year> <pages> pp. 191-204. </pages>
Reference-contexts: Key schedules are used in several ways: a. To specify the round keys of a product cipher. DES [NBS77] uses its key schedule in this way, as do many other product ciphers. b. To initialize some fixed elements of a cryptographic transform. Khufu [Mer91], Blowfish <ref> [Sch94] </ref>, and SEAL [RC94] use a key schedule this way. c. To initialize the state of a stream cipher prior to generating keystream. RC4 [Sch96] uses a key schedule in this way. <p> In some instances, the workload of identifying a key with a specific class is very small; these too are sometimes referred to as weak keys. For example, certain keys in Blowfish <ref> [Sch94] </ref> result in identical S-box entries, and can be detected in reduced-round variants [Vau96]. IDEA [LMM91] has several classes of keys detectable with just two chosen-plaintext encryptions [DGV93]. <p> This type of approach was adopted by SEAL [RC94] and Blowfish 14 An anonymous reviewer has pointed out that the known-plaintext attack can be converted to a ciphertext-only attack with knowledge of a faulty P 0 ; C pair. 12 <ref> [Sch94] </ref>, and suggested in [Knu94], and resulted in strong key schedules. The key schedules of FEAL [SM88] and RC5 [Riv95] also resist related-key cryptanalysis. As an open question, we note that the DES key schedule is linear, and wonder why it appears to resist related-key attacks.
Reference: [Sch96] <author> B. Schneier, </author> <title> Applied Cryptography, Second Edition, </title> <publisher> John Wiley & Sons, </publisher> <year> 1996. </year>
Reference-contexts: To initialize some fixed elements of a cryptographic transform. Khufu [Mer91], Blowfish [Sch94], and SEAL [RC94] use a key schedule this way. c. To initialize the state of a stream cipher prior to generating keystream. RC4 <ref> [Sch96] </ref> uses a key schedule in this way. Note that (b) and (c) are the only instances where synchronous stream ciphers can fall prey to any chosen-input attack. In this paper, we present new attacks on key schedules. <p> We examined the security of the "standard" set of GOST S-boxes <ref> [Sch96] </ref>: we estimate that the 12-round characteristic has probability about 2 68 , which is too low to make the attack practical. Randomly chosen S-boxes were much weaker.
Reference: [SM88] <author> A. Shimizu and S. Miyaguchi, </author> <title> "Fast Data Encipherment Algorithm FEAL," </title> <booktitle> Advances in Cryptology|EUROCRYPT '87, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1988, </year> <pages> pp. 267-278. </pages>
Reference-contexts: The key schedules of FEAL <ref> [SM88] </ref> and RC5 [Riv95] also resist related-key cryptanalysis. As an open question, we note that the DES key schedule is linear, and wonder why it appears to resist related-key attacks.
Reference: [TH93] <author> G. Tsudik and E.V. Herreweghen, </author> <title> "On Simple and Secure Key Distribution," </title> <booktitle> 1st ACM Conference on Computer and Communications Security, </booktitle> <month> Nov. </month> <year> 1993, </year> <pages> pp. 49-57. </pages>
Reference-contexts: To demonstrate this protocol attack, we examine the 2PKDP key distribution protocol <ref> [TH93] </ref>. The 2PKDP protocol is A ! B : A; N where M AC is a cryptographic message authentication code, N; N 0 are nonces, K ab is a long-term symmetric shared key between A and B, and K s is the negotiated session key.
Reference: [Vau96] <author> S. Vaudenay, </author> <title> "On the Weak Keys in Blowfish," Fast Software Encryption, </title> <booktitle> Third International Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1996, </year> <pages> pp. 27-32. </pages>
Reference-contexts: In some instances, the workload of identifying a key with a specific class is very small; these too are sometimes referred to as weak keys. For example, certain keys in Blowfish [Sch94] result in identical S-box entries, and can be detected in reduced-round variants <ref> [Vau96] </ref>. IDEA [LMM91] has several classes of keys detectable with just two chosen-plaintext encryptions [DGV93]. The key schedule in LOKI91 allows two different keys to have several round keys in common; this reduces the effective keyspace by almost a factor of four using 2 33 chosen plaintexts [Knu93b].
Reference: [WN95] <author> D. Wheeler and R. Needham, </author> <title> "TEA, a Tiny Encryption Algorithm," Fast Software Encryption, </title> <booktitle> Second International Workshop Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp. 97-110. </pages>
Reference-contexts: Kwan and Pieprzyk describe a technique for locating complementation properties in linear key schedules [KP93]. Two keys are equivalent if they transform all plaintexts identically. This can be considered a special kind of simple relation. TEA TEA <ref> [WN95] </ref> is an easy-to-memorize Feistel block cipher.
Reference: [Win84] <author> R. Winternitz, </author> <title> "Producing One-Way Hash Functions from DES," </title> <booktitle> Advances in Cryptology: Proceedings of Crypto 83, </booktitle> <publisher> Plenum Press, </publisher> <year> 1984, </year> <pages> pp. 203-207. </pages>
Reference-contexts: We can also complement the most significant bits of K 2 ; K 3 without any effect. This means that each TEA key has 3 other equivalent keys. In particular, it is easy to construct collisions for TEA when used in a Davies-Meyer hashing mode <ref> [Win84] </ref>. 2.6 Attacks on One-Wayness A key schedule is one-way if, given several round subkeys, it is infeasible for an attacker to gain any new information about the master key or about other unknown round subkeys.
Reference: [WH87] <author> R. Winternitz and M. Hellman, </author> <title> "Chosen-key Attacks on a Block Cipher," </title> <journal> Cryptologia, v. </journal> <volume> 11, </volume> <editor> n. </editor> <volume> 1, </volume> <month> Jan </month> <year> 1987, </year> <pages> pp. </pages> <month> 16-20. </month> <title> This article was processed using the L A T E X macro package with LLNCS style 15 http://www.informatik.uni-hildesheim.de/~sirene/lit/abstr90.html#PfAss 90 16 http://www.itribe.net/CTRS/Papers/CTRS-0008.txt 15 </title>
Reference-contexts: Winternitz and Hellman show that by obtaining the encryption of a single chosen plaintext under 2 n chosen keys, n k, one may recover the key values with 2 kn o*ine trial encryptions, if the cipher uses k-bit keys <ref> [WH87] </ref>. This attack easily extends to a probabilistic known-key attack with similar complexities, and shows that any cipher has strength of at most 2 k=2 against the naive black box attack, if related-key queries are not much more expensive than chosen-plaintext queries.
References-found: 45

