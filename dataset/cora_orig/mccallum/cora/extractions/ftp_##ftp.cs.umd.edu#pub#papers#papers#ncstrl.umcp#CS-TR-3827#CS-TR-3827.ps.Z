URL: ftp://ftp.cs.umd.edu/pub/papers/papers/ncstrl.umcp/CS-TR-3827/CS-TR-3827.ps.Z
Refering-URL: http://www.cs.umd.edu/~elman/
Root-URL: http://www.cs.umd.edu
Title: EFFICIENT ITERATIVE SOLUTION OF THE THREE-DIMENSIONAL HELMHOLTZ EQUATION  
Author: HOWARD C. ELMAN AND DIANNE P. O'LEARY 
Keyword: Key words. Helmholtz equation, preconditioning, iterative methods, parallel, fast transform methods.  
Note: AMS(MOS) subject classifications. 65F10, 65N22, 78A40, 65Y05.  
Abstract: We examine preconditioners for the discrete indefinite Helmholtz equation on a three-dimensional box-shaped domain with Sommerfeld-like boundary conditions. The preconditioners are of two types. The first is derived by discretization of a related continuous operator that differs from the original only in its boundary conditions. The second is derived by a block Toeplitz approximation to the discretized problem. The resulting preconditioning matrices allow the use of fast transform methods and differ from the discrete Helmholtz operator by an operator of low rank. We present experimental results demonstrating that when these methods are combined with Krylov subspace iteration, convergence rates depend only mildly on both the wave number and discretization mesh size. In addition, the methods display high efficiencies in an implementation on an IBM SP-2 parallel computer. 1. Introduction. The problem considered in this paper is to compute the numerical solution of the Helmholtz equation 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> E. Anderson et al., </author> <note> LAPACK Users' Guide, SIAM, Philadelphia, second ed., </note> <year> 1995. </year>
Reference-contexts: In all tests, the linear system (4) is defined by choosing a discrete solution u, and the right hand side is then computed as f = Au. We consider two discrete solutions: 1. a vector with real and imaginary parts consisting of uniformly distributed random numbers in the interval <ref> [1; 1] </ref>; 2. a smooth vector whose value at the mesh point with index (j; k; l) is 10a jkl i a jkl , where a jkl = 10; 000j + 100k + l. <p> The computational component of the program was written in Fortran90 and compiled using the mpxlf90 compiler with the optimization (-O) switch. All modules were taken from off-the-shelf software and modified to conform to Fortran90: GMRES is derived from the TEMPLATES package [2]; the two-dimensional direct solvers use the LAPACK <ref> [1] </ref> bandsolver cgbsv and cgbtrs, as do the tridiagonal solvers used for the one-dimensional precondi-tioners; and the sine-transform and cosine-transform routines are from FFTPACK [26]. All tests used double precision complex floating point computations. Communication was performed using MPI [24] with nonblocking sends (MPI ISEND) and blocking receives (MPI RECV).
Reference: [2] <author> R. Barrett et al., </author> <title> Templates for the Solution of Linear Systems: Building Blocks for Iterative Methods, </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1993. </year>
Reference-contexts: The computational component of the program was written in Fortran90 and compiled using the mpxlf90 compiler with the optimization (-O) switch. All modules were taken from off-the-shelf software and modified to conform to Fortran90: GMRES is derived from the TEMPLATES package <ref> [2] </ref>; the two-dimensional direct solvers use the LAPACK [1] bandsolver cgbsv and cgbtrs, as do the tridiagonal solvers used for the one-dimensional precondi-tioners; and the sine-transform and cosine-transform routines are from FFTPACK [26]. All tests used double precision complex floating point computations.
Reference: [3] <author> A. Bayliss, C. I. Goldstein, and E. Turkel, </author> <title> An iterative methods for the helmholtz equation, </title> <journal> J. Comput. Phys., </journal> <volume> 49 (1983), </volume> <pages> pp. 443-457. </pages>
Reference-contexts: This method has been used to good effect for solving the Helmholtz equation with multiple right hand sides (derived e.g., from incident waves at different angles) in [13], cf. also <ref> [3] </ref>.
Reference: [4] <author> A. Bayliss, M. Gunzburger, and E. Turkel, </author> <title> Boundary conditions for the numerical solution of elliptic equations in exterior domains, </title> <journal> SIAM J. Appl. Math., </journal> <volume> 42 (1982), </volume> <pages> pp. 430-451. </pages>
Reference-contexts: We also expect them to perform well for more accurate local approximations to the radiation boundary conditions (3), of the type considered in <ref> [4] </ref>. Acknowledgements. We thank Alan Sussman for a great deal of advice on using the IBM-SP2, Ilya Zavorine for help with programming, and Olof Widlund for some helpful discussions.
Reference: [5] <author> J. H. Bramble, J. E. Pasciak, and J. Xu, </author> <title> The analysis of multigrid algorithms for nonsymmetric and indefinite problems, </title> <journal> Math. Comp., </journal> <volume> 51 (1988), </volume> <pages> pp. 389-414. </pages>
Reference-contexts: S. Office of Naval Research under grant N000149510338 and by a General Research Board Grant from the Office of Graduate Studies and Research of the University of Maryland. 1 that coarse spaces used must be fine enough to accurately represent the solution; see e.g. <ref> [5, 7, 19] </ref>. In addition, the complex symmetric coefficient matrix A typically has eigenvalues with both positive and negative real parts. This can cause difficulties for iterative solution methods, and preconditioning of the matrix is essential in order to attain efficiency.
Reference: [6] <author> B. L. Buzbee, F. W. Dorr, J. A. George, and G. H. Golub, </author> <title> The direct solution of the discrete Poisson equation on irregular regions, </title> <journal> SIAM J. on Numerical Analysis, </journal> <volume> 8 (1971), </volume> <pages> pp. 722-736. </pages>
Reference-contexts: Many solvers use fast Fourier transforms (FFT's) to achieve separation of variables and then solve the resulting set of decoupled problems using sparse matrix methods. Fast direct methods are standard tools for solving the Poisson equation on regular domains with Dirichlet, Neumann or periodic boundary conditions <ref> [6] </ref>; they can be adapted to other domains via capacitance matrix or embedding methods [14, 22].
Reference: [7] <author> X.-C. Cai and O. B. Widlund, </author> <title> Domain decomposition algorithms for indefinite elliptic problems, </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 13 (1992), </volume> <pages> pp. 243-258. </pages>
Reference-contexts: S. Office of Naval Research under grant N000149510338 and by a General Research Board Grant from the Office of Graduate Studies and Research of the University of Maryland. 1 that coarse spaces used must be fine enough to accurately represent the solution; see e.g. <ref> [5, 7, 19] </ref>. In addition, the complex symmetric coefficient matrix A typically has eigenvalues with both positive and negative real parts. This can cause difficulties for iterative solution methods, and preconditioning of the matrix is essential in order to attain efficiency.
Reference: [8] <author> R. H. Chan and M. K. Ng, </author> <title> Conjugate gradient methods for Toeplitz systems, </title> <journal> SIAM Rev., </journal> <volume> 38 (1996), </volume> <pages> pp. 427-482. </pages>
Reference-contexts: Combining our techniques with capacitance matrix methods would produce solvers for general geometries in Cartesian coordinates, including exterior problems. Our idea generalizes some results developed for two-dimensional Helmholtz problems by Ernst and Golub [12]. (See also <ref> [8, x4] </ref> for variants applied to definite elliptic problems.) We approximate the discrete operator A with a matrix Q that can be treated with fast direct methods.
Reference: [9] <author> R. Dautray and J.-L. Lions, </author> <title> Mathematical Analysis and Numerical Methods for Science and Technology, </title> <journal> vol. </journal> <volume> 1, </volume> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1990. </year>
Reference-contexts: 1. Introduction. The problem considered in this paper is to compute the numerical solution of the Helmholtz equation u k 2 u = f:(1) This equation arises in numerous physical applications <ref> [9, pp. 640ff] </ref>.
Reference: [10] <author> I. S. Duff, A. M. Erisman, and J. K. Reid, </author> <title> Direct Methods for Sparse Matrices, </title> <publisher> Clarendon Press, Oxford, </publisher> <year> 1986. </year>
Reference-contexts: The solution of the two-dimensional problems required in Step 2 can be done using a variety of techniques, including general sparse direct methods <ref> [10] </ref>, band solvers, and domain decomposition. Consider a variant of this preconditioner, derived using Dirichlet boundary conditions at two pairs of opposite faces of @: x = 0; 1 and y = 0; 1. <p> The communication cost is the same for the two-dimensional direct solvers Q d or Q n , and the smallest possible arithmetic cost is O i p if a nested dissection method is used <ref> [10] </ref>; this strategy would neglect any need for pivoting. For the tests described below, we used a bandsolver (which allows pivoting), resulting in cost proportional to m 5 p . Remark 4.2.
Reference: [11] <author> O. Ernst, </author> <title> Fast Numerical Solution of Exterior Helmholtz Problems with Radiation Boundary Condition by Imbedding, </title> <type> PhD thesis, </type> <institution> Stanford University, Program in Scientific Computing and Computational Mathematics, </institution> <year> 1994. </year>
Reference-contexts: They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain [21], and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions [18] (derived from a Dirichlet-to-Neumann mapping) in <ref> [11, 15] </ref>. In this work, we develop efficient solvers for problems with Sommerfeld-like boundary conditions on box-shaped domains. Combining our techniques with capacitance matrix methods would produce solvers for general geometries in Cartesian coordinates, including exterior problems.
Reference: [12] <author> O. Ernst and G. H. Golub, </author> <title> A domain decomposition approach to solving the Helmholtz equation with a radiation boundary condition, </title> <type> tech. report, </type> <institution> Computer Science Department, Stan-ford University, Stanford, CA Numerical Analysis Project NA-92-08, </institution> <year> 1992. </year>
Reference-contexts: In this work, we develop efficient solvers for problems with Sommerfeld-like boundary conditions on box-shaped domains. Combining our techniques with capacitance matrix methods would produce solvers for general geometries in Cartesian coordinates, including exterior problems. Our idea generalizes some results developed for two-dimensional Helmholtz problems by Ernst and Golub <ref> [12] </ref>. (See also [8, x4] for variants applied to definite elliptic problems.) We approximate the discrete operator A with a matrix Q that can be treated with fast direct methods. <p> It was shown by Ernst and Golub <ref> [12] </ref> that for the Helmholtz equation on a two-dimensional rectangular domain, an effective preconditioner can be devised by replacing Sommerfeld-like boundary conditions on two opposite edges by Dirichlet or Neumann conditions. Let us extend this idea to three-dimensional problems.
Reference: [13] <author> R. W. Freund and M. Malhotra, </author> <title> A block-QMR Algorithm for non-Hermitian linear systems with multiple right hand sides, </title> <journal> Linear Algebra Appl., </journal> <volume> 254 (1997), </volume> <pages> pp. 197-257. </pages>
Reference-contexts: This method has been used to good effect for solving the Helmholtz equation with multiple right hand sides (derived e.g., from incident waves at different angles) in <ref> [13] </ref>, cf. also [3].
Reference: [14] <author> J. A. George, </author> <title> The use of direct methods for the solution of the discrete Poisson equation on non-rectangular regions, </title> <type> tech. report, </type> <institution> Computer Science Department, Stanford University, Stanford, </institution> <address> CA STAN-CS-70-159, </address> <year> 1970. </year>
Reference-contexts: Fast direct methods are standard tools for solving the Poisson equation on regular domains with Dirichlet, Neumann or periodic boundary conditions [6]; they can be adapted to other domains via capacitance matrix or embedding methods <ref> [14, 22] </ref>. They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain [21], and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions [18] (derived from a Dirichlet-to-Neumann mapping) in [11, 15].
Reference: [15] <author> E. Heikkola, T. Rossi, P. Tarvainen, and Y. Kuznetsov, </author> <title> Efficient preconditioners based on fictitious domains for elliptic fe-problems with lagrange multipliers, </title> <type> Tech. Report 11/1996, </type> <institution> University of Jyvaskyla, </institution> <year> 1996. </year> <month> 17 </month>
Reference-contexts: They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain [21], and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions [18] (derived from a Dirichlet-to-Neumann mapping) in <ref> [11, 15] </ref>. In this work, we develop efficient solvers for problems with Sommerfeld-like boundary conditions on box-shaped domains. Combining our techniques with capacitance matrix methods would produce solvers for general geometries in Cartesian coordinates, including exterior problems.
Reference: [16] <author> F. Ihlenburg and I. Babu ska, </author> <title> Finite element solution of the Helmholtz with high wave number. Part I: The h-version of the FEM, </title> <journal> Computers Math. Applic., </journal> <volume> 30 (1995), </volume> <pages> pp. 9-37. </pages>
Reference-contexts: For any k, accurate discrete solutions of (1) will be obtained only if the mesh is fine enough to resolve the features of the problem. A commonly used criterion is for the mesh to include at least ten grid points per wave, i.e., to require k 2=(10h). See <ref> [16] </ref> for rigorous justification of this criterion for one-dimensional problems, instead of the more stringent requirement that k 3 h 2 be bounded.
Reference: [17] <author> M. C. Junger and D. Feit, </author> <title> Sound, Structures and their Interaction, </title> <publisher> MIT Press, </publisher> <address> Cambridge, MA, </address> <publisher> 2nd ed., </publisher> <year> 1986. </year>
Reference-contexts: 2 ; b 2 ) fi (a 3 ; b 3 ) ae &lt; 3 , with Sommerfeld-like boundary conditions u n iku = 0 (2) on @, which constitute an approximation to the Sommerfeld radiation condition lim r (u n iku) = 0;(3) used in models of acoustic scattering <ref> [17] </ref>. Discretization of the problem (1)-(2) results in a linear system of equations Au = f:(4) Since the problem is fully three-dimensional, any reasonable discretization will contain a large number of unknowns and require considerable storage.
Reference: [18] <author> J. B. Keller and D. Givoli, </author> <title> Exact nonreflecting boundary conditions, </title> <journal> J. Comput. Phys., </journal> <volume> 82 (1989), </volume> <pages> pp. 172-192. </pages>
Reference-contexts: They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain [21], and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions <ref> [18] </ref> (derived from a Dirichlet-to-Neumann mapping) in [11, 15]. In this work, we develop efficient solvers for problems with Sommerfeld-like boundary conditions on box-shaped domains. Combining our techniques with capacitance matrix methods would produce solvers for general geometries in Cartesian coordinates, including exterior problems.
Reference: [19] <author> M. Malhotra and P. M. Pinsky, </author> <title> Parallel Preconditioning Based on h-Hierarchical Finite Elements with Applications to Acoustics, </title> <type> Tech. Report SCCM 95-05, </type> <institution> Scientific Computing and Computational Mathematics Program, Stanford University, </institution> <year> 1995. </year> <note> To appear in Comp. Meths. Appl. Mech. Engrg. </note>
Reference-contexts: S. Office of Naval Research under grant N000149510338 and by a General Research Board Grant from the Office of Graduate Studies and Research of the University of Maryland. 1 that coarse spaces used must be fine enough to accurately represent the solution; see e.g. <ref> [5, 7, 19] </ref>. In addition, the complex symmetric coefficient matrix A typically has eigenvalues with both positive and negative real parts. This can cause difficulties for iterative solution methods, and preconditioning of the matrix is essential in order to attain efficiency.
Reference: [20] <author> A. E. Naiman, I. M. Babu ska, and H. C. Elman, </author> <title> A note on conjugate gradient convergence, </title> <journal> Numerische Mathematik, </journal> <volume> 76 (1997), </volume> <pages> pp. 209-230. </pages>
Reference-contexts: The differences are especially dramatic for smooth problems. (We also remark, however, that the SSOR method was surprisingly insensitive to mesh size in the non-smooth case. An analysis of behavior like this for a simple elliptic model problem is given in <ref> [20] </ref>.) In addition, these tests were run with a "natural" ordering of the unknowns, which does not have efficient parallel implementation. Tests with point red-black ordering for the finite difference examples (for n 40, k 20 and non-smooth problems) required on average 65% more steps. 4. Parallel implementation and performance.
Reference: [21] <author> D. P. O'Leary and O. Widlund, </author> <title> Capacitance matrix methods for the Helmholtz equation on general three dimensional regions, </title> <journal> Mathematics of Computation, </journal> <volume> 33 (1979), </volume> <pages> pp. 849-879. </pages>
Reference-contexts: They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain <ref> [21] </ref>, and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions [18] (derived from a Dirichlet-to-Neumann mapping) in [11, 15]. In this work, we develop efficient solvers for problems with Sommerfeld-like boundary conditions on box-shaped domains. <p> Performance of restarted GMRES with these preconditioners is relatively insensitive to discretization mesh size and wave number, and the algorithms are highly parallelizable. We have tested these methods on simple box-shaped domains. They can be adapted for use on exterior Helmholtz problems by applying the capacitance method of <ref> [21] </ref>, perhaps using a nonuniform grid in the neighborhood of the scatterer. The techniques are potentially applicable in non-Cartesian coordinate systems, although the "fast" solvers in such settings are not nearly as fast, relying on generation and solution of general block tridiagonal systems [25].
Reference: [22] <author> W. Proskurowski and O. Widlund, </author> <title> On the numerical solution of Helmholtz's equation by the capacitance matrix method, </title> <journal> Mathematics of Computation, </journal> <volume> 30 (1976), </volume> <pages> pp. 433-468. </pages>
Reference-contexts: Fast direct methods are standard tools for solving the Poisson equation on regular domains with Dirichlet, Neumann or periodic boundary conditions [6]; they can be adapted to other domains via capacitance matrix or embedding methods <ref> [14, 22] </ref>. They have been used for the three-dimensional Helmholtz equation with Dirichlet or Neumann boundary conditions on an irregular domain [21], and for the two-dimensional problem in polar coordinates with nonreflecting boundary conditions [18] (derived from a Dirichlet-to-Neumann mapping) in [11, 15].
Reference: [23] <author> Y. Saad and M. H. Schultz, </author> <title> GMRES: A generalized minimal residual algorithm for solving nonsymmetric linear systems, </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 7 (1986), </volume> <pages> pp. 856-869. </pages>
Reference-contexts: In particular, we will show that for several choices of Q, the experimental convergence behavior of preconditioned restarted GMRES <ref> [23] </ref> depends only mildly on both the wave number k and the discretization mesh size. In addition, we will demonstate how the methods can be implemented on a parallel computer with high efficiency. The paper is organized as follows. <p> Experimental results. In this section, we present the results of numerical experiments in which the preconditioners described in Section 2 are used with iterative method GMRES (20) <ref> [23] </ref> to solve the discrete Helmholtz equation. Our concern here is the effect of mesh size and wave number on performance. Additional results showing behavior on a parallel computer are given in Section 4. <p> If m z is not divisible by p, then the number of x-y planes assigned to each processor differs by at most one. 4.1.1. Parallel implementation of the iterative method. We use the original form of the restarted GMRES algorithm, based on the Arnoldi basis, as presented in <ref> [23] </ref>.
Reference: [24] <author> M. Snir, S. W. Otto, S. Huss-Lederman, D. W. Walker, and J. Dongarra, </author> <title> MPI: The Complete Reference, </title> <publisher> The MIT Press, </publisher> <address> Cambridge, Massachusetts, </address> <year> 1996. </year>
Reference-contexts: All tests used double precision complex floating point computations. Communication was performed using MPI <ref> [24] </ref> with nonblocking sends (MPI ISEND) and blocking receives (MPI RECV). Inner products were performed and broadcast using MPI ALLREDUCE. The results on parallel performance are summarized in Table 9 for finite differences and Table 10 for trilinear finite elements. Again, dashed lines correspond to problems that were too large.
Reference: [25] <author> P. Swarztrauber and R. Sweet, </author> <title> Efficient Fortran subprograms for the solution of elliptic equations, </title> <type> tech. report, </type> <institution> National Center for Atmospheric Research, Boulder, CO, </institution> <note> NCAR TN/IA-109; code available through http://www.netlib.org, 1975. </note>
Reference-contexts: The techniques are potentially applicable in non-Cartesian coordinate systems, although the "fast" solvers in such settings are not nearly as fast, relying on generation and solution of general block tridiagonal systems <ref> [25] </ref>. We also expect them to perform well for more accurate local approximations to the radiation boundary conditions (3), of the type considered in [4]. Acknowledgements.
Reference: [26] <author> P. N. Swarztrauber, </author> <title> Vectorizing the fft's, in Parallel Computations, </title> <editor> G. Rodrigue, ed., </editor> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1982, </year> <pages> pp. 51-83. </pages>
Reference-contexts: were taken from off-the-shelf software and modified to conform to Fortran90: GMRES is derived from the TEMPLATES package [2]; the two-dimensional direct solvers use the LAPACK [1] bandsolver cgbsv and cgbtrs, as do the tridiagonal solvers used for the one-dimensional precondi-tioners; and the sine-transform and cosine-transform routines are from FFTPACK <ref> [26] </ref>. All tests used double precision complex floating point computations. Communication was performed using MPI [24] with nonblocking sends (MPI ISEND) and blocking receives (MPI RECV). Inner products were performed and broadcast using MPI ALLREDUCE.
Reference: [27] <author> D. M. Young, </author> <title> Iterative Solution of Large Linear Systems, </title> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1970. </year> <month> 18 </month>
Reference-contexts: In addition, we show that the new methods are more effective than a standard algebraic preconditioner based on symmetric successive overrelaxation (SSOR) <ref> [27] </ref>. In Section 4, we show how the methods can be implemented on parallel computers, and we demonstrate their parallel efficiency using experiments on a sixteen processor IBM SP-2. Finally, in Section 5, we make some concluding remarks. 2. The preconditioners. <p> maximum of 300 steps was used, and for the smooth problems the stopping criterion was not satisfied in a majority of the runs.) To compare the performance of the new preconditioners with a "standard" algebraic preconditioner, we show in Tables 7 and 8 iteration counts obtained using the SSOR preconditioner <ref> [27] </ref> (with ! = 1) with GMRES (20). This method has been used to good effect for solving the Helmholtz equation with multiple right hand sides (derived e.g., from incident waves at different angles) in [13], cf. also [3].
References-found: 27

