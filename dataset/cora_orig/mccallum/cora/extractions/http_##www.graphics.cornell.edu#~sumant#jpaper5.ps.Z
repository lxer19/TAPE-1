URL: http://www.graphics.cornell.edu/~sumant/jpaper5.ps.Z
Refering-URL: http://www.graphics.cornell.edu/~sumant/cv.html
Root-URL: 
Title: Computation of Global Illumination in a Participating Medium by Monte Carlo Simulation  
Author: S.N.Pattanaik and S.P.Mudur 
Keyword: Participating Medium, Uncertainty Reduction.  
Address: Juhu, Bombay 400 049, INDIA  
Affiliation: Graphics CAD Division, National Centre for Software Technology,  
Abstract: This paper discusses techniques for the computation of global illumination in environments with participating medium using a Monte Carlo simulation of the particle model of light. Efficient algorithms and data structures for tracking the particles inside the volume have been developed. The necessary equation for computing the illumination along any given direction has been derived for rendering a scene with participating medium. A major issue in any Monte Carlo simulation is the uncertainty in the final simulation results. Various steps of the algorithm have been analysed to identify major sources of uncertainty. To reduce the uncertainty, suitable modifications to the simulation algorithm have been suggested using variance reduction methods of forced collision, absorption suppression and particle divergence. Some sample scenes showing the results of applying these methods are also included. CR Categories and Subject Descriptors: I.3.7 [Computer Graphics]: Three Dimensional Graphics and Realism; I.3.3 [Computer Graphics]: Picture/Image Generation. General Terms: Algorithms Additional Keywords and Phrases: Monte Carlo Simulation, Global Illumination, 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> E. E. Lewis and W.F. Miller Jr. </author> <title> Computational Methods of Neutron Transport. </title> <publisher> John Wiley & Sons, </publisher> <year> 1984. </year>
Reference-contexts: 1 Introduction The Monte Carlo simulation technique has been used for a long time for the solution of problems in particle transport <ref> [1, 2] </ref>. In an earlier paper [3] the authors have described in detail its application to the computation of global illumination in a geometrically and optically complex 3-D environment. <p> Since a part of these interacting particles are going to contribute towards the brightness of the volume elements, this sampling procedure is likely to introduce errors in the final illumination computation. The variance reduction method of Forced Interaction <ref> [1] </ref> avoids this sampling problem by forcing the sample particle to interact with each of the volume elements it is passing through, in the process losing a part of its energy to the volume and exiting the volume with its energy reduced exactly by the amount lost inside the volume. <p> This process can introduce errors into the illumination results of the individual surface or volume element. The Absorption Suppression <ref> [1] </ref> method, avoids this error by assuming that unless the reflection coefficient (or the scattering albedo) is zero, a particle interacting with the surface (or volume) is always reflected (or scattered) with its energy content reduced to a value equal to the original energy content times the reflection coefficient (or scattering
Reference: [2] <author> J. R. Howell. </author> <title> Application of monte carlo to heat transfer problems. </title> <booktitle> Advances in Heat Transfer, </booktitle> <volume> 5 </volume> <pages> 1-54, </pages> <year> 1968. </year> <month> 16 </month>
Reference-contexts: 1 Introduction The Monte Carlo simulation technique has been used for a long time for the solution of problems in particle transport <ref> [1, 2] </ref>. In an earlier paper [3] the authors have described in detail its application to the computation of global illumination in a geometrically and optically complex 3-D environment.
Reference: [3] <author> S. N. Pattanaik and S. P. Mudur. </author> <title> Computation of global illumination by monte carlo simulation of the particle model of light. </title> <booktitle> In Proceedings of the Third Eurographics Workshop on Rendering, </booktitle> <pages> pages 71-83, </pages> <address> Bristol, UK, </address> <month> May </month> <year> 1992. </year>
Reference-contexts: 1 Introduction The Monte Carlo simulation technique has been used for a long time for the solution of problems in particle transport [1, 2]. In an earlier paper <ref> [3] </ref> the authors have described in detail its application to the computation of global illumination in a geometrically and optically complex 3-D environment. This paper is primarily concerned with the application of the Monte Carlo simulation technique for the computation of global illumination in the presence of a participating medium.
Reference: [4] <author> James Blinn. </author> <title> Light reflection functions for simulation of clouds & dusty surfaces. </title> <booktitle> Computer Graphics (SIGGRAPH '82 Proceedings), </booktitle> <volume> 16(3) </volume> <pages> 21-26, </pages> <year> 1982. </year>
Reference-contexts: Emission by the medium generates light energy and hence always has the effect of augmenting the radiance. Pioneering work on the computation of illumination in the presence of participating (absorbing and scattering) medium for use in image synthesis was first carried out by Blinn <ref> [4] </ref>. For certain specific conditions, such as a uniformly scattering medium with a low scattering albedo and a single light source, Blinn formulated a simple equation for computing the radiance of light reaching the eye.
Reference: [5] <author> James T. Kajiya and Brian P. Von Herzen. </author> <title> Ray tracing volume densities. </title> <booktitle> Computer Graphics (SIGGRAPH '84 Proceedings), </booktitle> <volume> 18(3) </volume> <pages> 165-174, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: For certain specific conditions, such as a uniformly scattering medium with a low scattering albedo and a single light source, Blinn formulated a simple equation for computing the radiance of light reaching the eye. A number of other researchers <ref> [5, 6, 7] </ref> have extended Blinn's work to accommodate more complex participating behaviours of the medium and to use ray tracing for image synthesis.
Reference: [6] <author> Nelson L. Max. </author> <title> Atmospheric illumination and shadows. </title> <booktitle> Computer Graphics (SIG-GRAPH '86 Proceedings), </booktitle> <volume> 20(4) </volume> <pages> 117-124, </pages> <month> Aug. </month> <year> 1986. </year>
Reference-contexts: For certain specific conditions, such as a uniformly scattering medium with a low scattering albedo and a single light source, Blinn formulated a simple equation for computing the radiance of light reaching the eye. A number of other researchers <ref> [5, 6, 7] </ref> have extended Blinn's work to accommodate more complex participating behaviours of the medium and to use ray tracing for image synthesis.
Reference: [7] <author> Tomoyuki Nishita, Yashuhiro Miyawaki, and Eihachiro Nakamae. </author> <title> A shading model for atmospheric scattering considering luminous intensity distribution of light sources. </title> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> 21(4) </volume> <pages> 303-310, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: For certain specific conditions, such as a uniformly scattering medium with a low scattering albedo and a single light source, Blinn formulated a simple equation for computing the radiance of light reaching the eye. A number of other researchers <ref> [5, 6, 7] </ref> have extended Blinn's work to accommodate more complex participating behaviours of the medium and to use ray tracing for image synthesis.
Reference: [8] <author> Holly E. Rushmeier and Kenneth E. Torrance. </author> <title> The zonal method for calculating light intensities in the presence of a participating medium. </title> <booktitle> Computer Graphics (SIGGRAPH '87 Proceedings), </booktitle> <volume> 21(4) </volume> <pages> 293-302, </pages> <month> July </month> <year> 1987. </year>
Reference-contexts: All this work is however based on the use of a local illumination model in which the interaction of all the volumes and surfaces with one another with respect to the propagation of light is not accurately modeled. Rushmeier and Torrance <ref> [8] </ref> extended the radiosity method to include surface-volume, volume-surface and volume-volume interaction and computed global illumination by solving a set of linear equations one for each surface patch and for each volume element.
Reference: [9] <author> Michael Cohen, Shenchang Eric Chen, John R. Wallace, and Donald P. Greenberg. </author> <title> A progressive refinement approach to fast radiosity image generation. </title> <booktitle> Computer Graphics (SIGGRAPH '88 Proceedings), </booktitle> <volume> 22(4) </volume> <pages> 75-84, </pages> <month> Aug. </month> <year> 1988. </year>
Reference-contexts: The simulation algorithm along with details of the volume interaction related computations are discussed in the next section. Illumination computation by simulating the propagation of light starting from the light 2 sources in not entirely new. Progressive radiosity <ref> [9] </ref> is one of the most well established methods in which light energy is recursively shot from emitting surfaces and other bright surface to all other visible surfaces in the environment.
Reference: [10] <author> Subdeb Chattopadhyay and Akira Fujimoto. </author> <title> Bi-directional ray tracing. </title> <booktitle> In Computer Graphics 1987 (Proceedings of CG International '87), </booktitle> <pages> pages 335-343. </pages> <year> 1987. </year>
Reference-contexts: Progressive radiosity [9] is one of the most well established methods in which light energy is recursively shot from emitting surfaces and other bright surface to all other visible surfaces in the environment. Bidirectional ray tracing <ref> [10] </ref> is another method, a two pass method, in which in the first pass rays carry energy to points arranged in a 3D regular grid covering the environment.
Reference: [11] <author> Andrew Glassner. </author> <title> An Introduction to Ray Tracing. </title> <publisher> Academic Press, </publisher> <year> 1989. </year>
Reference-contexts: For the given environment the average number of reflections that a particle undergoes is about 3.57 i.e. about three and a half million rays have been traced. By using a suitable acceleration technique <ref> [11] </ref> this ray tracing can be generally contained. In fact we have found that with the spatial subdivision based acceleration technique that has been implemented the average time for the Monte Carlo simulation method is more or less independent of the geometric complexity in the environment. <p> reaches here it means that the particle did not interact in the inter vening volume. 4 Implementation Strategy The volume structure assumed for the implementation of this technique is very similar to the one used in a ray tracing acceleration method for computing ray-surface interaction, namely the Spatial Enumeration technique <ref> [11] </ref>. Since finding the nearest surface along a particle path is done by performing ray-surface intersections, the same data-structure may be adopted. However, the requirement that the volume interaction properties within a voxel must be uniform would most often imply a fine subdivision of the environment.
Reference: [12] <author> A.T. Campbell, III, and Donald S. Fussell. </author> <title> Adaptive mesh generation for global diffuse illumination. </title> <booktitle> Computer Graphics (SIGGRAPH '90 Proceedings), </booktitle> <volume> 24(4) </volume> <pages> 155-164, </pages> <month> Aug. </month> <year> 1990. </year>
Reference-contexts: However in such a case, the choice of the mesh is important for eventually it is this which determines how well the illumination gradient has been captured. The automatic discretisation problem is being researched extensively <ref> [12, 13, 14] </ref> and any of these methods could be used.
Reference: [13] <author> Daniel R. Baum, Stephen Mann, Kevin P. Smith, and James M. Winget. </author> <title> Making radiosity usable: Automatic preprocessing and meshing techniques for the generation of accurate radiosity solutions. </title> <booktitle> Computer Graphics (SIGGRAPH '91 Proceedings), </booktitle> <volume> 25(4) </volume> <pages> 51-60, </pages> <month> July </month> <year> 1991. </year>
Reference-contexts: However in such a case, the choice of the mesh is important for eventually it is this which determines how well the illumination gradient has been captured. The automatic discretisation problem is being researched extensively <ref> [12, 13, 14] </ref> and any of these methods could be used.
Reference: [14] <author> S.P. Mudur and S.N. Pattanaik. </author> <title> Multidimensional illumination functions for visu-alisation of complex 3d environments. </title> <journal> The Journal of Visualisation and Computer Animation, </journal> <volume> 1(2) </volume> <pages> 49-58, </pages> <year> 1990. </year>
Reference-contexts: However in such a case, the choice of the mesh is important for eventually it is this which determines how well the illumination gradient has been captured. The automatic discretisation problem is being researched extensively <ref> [12, 13, 14] </ref> and any of these methods could be used.
Reference: [15] <author> Channing P. Verbeck and Donald Greenberg. </author> <title> A comprehensive light-source description for computer graphics. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 4(3) </volume> <pages> 213-222, </pages> <year> 1984. </year>
Reference-contexts: In our present implementation the particle distribution is accumulated over a rectangular mesh (in UV space) imposed over each surface and over a uniform spatial mesh imposed over the volume. 2.2 Assigning Positions to Emitted Particles There are mainly three important characteristics of the emitter that influence the illumination <ref> [15] </ref>. They are geometry (emitter surface shape), spectral distribution (emitter strength at different wavelengths) and luminous radiance distribution (emitter strength in different directions at different positions). <p> A direction is defined by a pair (; ) where is the circumferential angle and is the cone angle. It is generally assumed that the emission does not depend on the circumferential angle and hence radiance distribution is specified only along the cone angle by goniometric diagrams <ref> [15] </ref>. In such a case can be sampled as = 2~ where ~ is a uniform random number chosen from the range 0 and 1 and is sampled by Rejection Sampling of the Goniometer Curve.
Reference: [16] <author> Cindy M. Goral, Kenneth E. Torrance, Donald P. Greenberg, and Bennett Battaile. </author> <title> Modelling the interaction of light between diffuse surfaces. </title> <booktitle> Computer Graphics (SIG-GRAPH '84 Proceedings), </booktitle> <volume> 18(3) </volume> <pages> 212-222, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: The very first treatment of real area geometry has been in the radiosity method <ref> [16] </ref>. In the radiosity method any large or complex surface must be first broken down into small patches with constant emission strength before its use in illumination computation.
Reference: [17] <author> Peter Shirley. </author> <title> Physically Based Lighting Calculations for Computer Graphics. </title> <type> PhD thesis, </type> <year> 1990. </year> <month> 17 </month>
Reference-contexts: If the surface brdf is given by Phong's specular model then the sampled reflection direction is given by the vector which makes angle (cos 1 (1 r 1 ) 1 n+1 ; 2r 2 ) with the mirror reflection of the incident vector <ref> [17] </ref>.
Reference: [18] <author> Gregory J. Ward. </author> <title> Measuring and modeling anisotropic reflection. </title> <booktitle> Computer Graphics (SIGGRAPH '92 Proceedings), </booktitle> <volume> 26(4) </volume> <pages> 265-272, </pages> <year> 1992. </year>
Reference-contexts: Similarly for the surface brdf modelled using Ward's anisotropic reflectance model <ref> [18] </ref> the sampled direction is given by: ffi = log ~ 1 x + sin 2 =ff 2 # ff x where (ffi, ) represent the direction of the bisector vector of the incident and sampled outgoing direction, ff x , ff y are the standard deviation of the surface slope
Reference: [19] <author> Malvin H. Kalos and Paula A. Whitlock. </author> <title> Monte Carlo Methods. Volume I. </title> <publisher> John Wiley & Sons, </publisher> <year> 1986. </year>
Reference-contexts: 1 e 0 K (u)du Since this probability is the cumulative probability of the particle interaction at every point along the path from 0 to S we get the following expression for the cumulative distribution function, cdf. cdf = 1 e R S By the principle of Random Variable Transformation <ref> [19] </ref>, sampling of a pdf is carried out by finding an expression for its cdf and solving the equation cdf = ~, where ~ is the uniform random number in the range 0 to 1.
Reference: [20] <author> Robert Siegel and John R. Howell. </author> <title> Thermal Radiation Heat Transfer. </title> <publisher> Hemisphere Publishing Corporation, </publisher> <year> 1981. </year>
Reference-contexts: However, for a medium which is not homogeneous in its participating properties, the sampling of path length requires the evaluation of the integral and hence is difficult. Howell <ref> [20] </ref> has proposed a solution to a similar problem by making the simplifying assumption that the interacting volume may be divided into plane increments of S inside which the interaction properties are fairly homogeneous. <p> If we make a further assumption that the volume emits uniformly in all the directions 1 then the radiance coming out of the differential volume as given in <ref> [20] </ref> is: di volume = dE volume 4dA p where dA p is the projected differential volume along the direction of interest. Each voxel has been assumed to have uniform interaction property (and hence constant K voxel ) and the simulation results have been captured over the whole voxel.
Reference: [21] <author> A. Fujimoto, T. Tanaka, and K. Iwata. </author> <title> Arts: Accelerated ray-tracing system. </title> <journal> IEEE Computer Graphics and Applications, </journal> <volume> 6(4) </volume> <pages> 16-26, </pages> <year> 1986. </year>
Reference-contexts: A particle traveling through the volume can be tracked through a list of voxels very simply by using the 3D-DDA algorithm <ref> [21] </ref> and the above equations can be solved to determine the point of interaction.

References-found: 21

