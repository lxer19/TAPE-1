URL: http://www.cse.ucsc.edu/research/compbio/papers/nullmod.ps
Refering-URL: http://www.cse.ucsc.edu/research/compbio/sam.html
Root-URL: http://www.cse.ucsc.edu
Title: Scoring Hidden Markov Models  
Author: Christian Barrett Richard Hughey Kevin Karplus 
Address: Santa Cruz, CA 95064, USA  
Affiliation: Computer Engineering, University of California,  
Note: REPRINT from CABIOS  
Email: email: rph@cse.ucsc.edu  
Phone: Tel: (408) 459-2939, Fax: (408) 459-4829,  
Date: 13(2):191-199, 1997  
Abstract: 1 Abstract 
Abstract-found: 1
Intro-found: 1
Reference: <author> Altschul, S. F. </author> <year> (1991). </year> <title> Amino acid substitution matrices from an information theoretic perspective. </title> <journal> JMB, </journal> <volume> 219, </volume> <pages> 555-565. </pages>
Reference-contexts: We present an analysis of methods that solve these problems and in the process eliminate the need for Z 2 scoring altogether. 4.2 Scoring Sequence alignments under probabilistic models can be scored using the log-odds ratio, an information-theoretic means of scoring an alignment <ref> (Altschul, 1991) </ref> that has been used by HMMer since its inception (Eddy et al., 1995).
Reference: <author> Altschul, S. F. et al. </author> <year> (1994). </year> <title> Issues in searching molecular sequence databases. </title> <journal> Nature Genetics, </journal> <volume> 6, </volume> <pages> 119-129. </pages>
Reference-contexts: The meaning of is the same as BLAST's E parameter, the expected number of false positives <ref> (Altschul et al., 1994) </ref>. Consider searching a database of length L residues in S sequences with an HMM. What value should be assigned to N ? If the HMM is considered to be matching each sequence in its entirety, then N should just be the number of sequences S.
Reference: <author> Bairoch, A. & Boeckmann, B. </author> <year> (1994). </year> <title> The SWISS-PROT protein sequence data bank: current status. </title> <journal> Nucleic Acids Research, </journal> <volume> 22, </volume> <pages> 3578-3580. </pages>
Reference-contexts: HMMer is freely available from http://genome.wustl.edu/eddy/hmm.html. 1.4 Contact rph@cse.ucsc.edu 2 Introduction Linear hidden Markov models (HMMs) (Haussler et al., 1993; Krogh et al., 1994) and the related generalized profiles <ref> (Bucher & Bairoch, 1994) </ref> have been quite successful in detecting conserved patterns in multiple sequences (Hughey & Krogh, 1996; Baldi et al., 1994; Eddy et al., 1995; Eddy, 1995; Bucher et al., 1996; McClure et al., 1996). <p> This raw NLL-score is exceedingly dependent on the lengths of s and m, and cannot be used directly to classify the sequence. Using the original Z-score method, SAM overcame this problem by appropriately normalizing the NLL-score. First, all proteins in a standard database, such as Swis-sProt <ref> (Bairoch & Boeckmann, 1994) </ref>, are scored against the model, and smoothed average curves of NLL-score versus length and standard deviation versus sequence length are calculated. Using this data, the difference between the NLL-score of a sequence and the mean NLL-score of sequences of similar length in standard deviations is calculated. <p> We also analyzed the complex null model based on the trained model's transitions and the geometric mean of its match states, SAM's Z-scoring heuristic, and HMMer's hmmsw. 5.1 Globins For the globins, we used Prosite <ref> (Bairoch & Bucher, 1994) </ref> to extract 685 globin sequences from SwissProt 32 (Bairoch & Boeckmann, 1994) of lengths 19 to 403. From these 685 sequences, we used the same 333 training sequences of lengths 40 to 403, as in a previous study (Bucher et al., 1996). <p> We also analyzed the complex null model based on the trained model's transitions and the geometric mean of its match states, SAM's Z-scoring heuristic, and HMMer's hmmsw. 5.1 Globins For the globins, we used Prosite (Bairoch & Bucher, 1994) to extract 685 globin sequences from SwissProt 32 <ref> (Bairoch & Boeckmann, 1994) </ref> of lengths 19 to 403. From these 685 sequences, we used the same 333 training sequences of lengths 40 to 403, as in a previous study (Bucher et al., 1996).
Reference: <author> Bairoch, A. & Bucher, P. </author> <year> (1994). </year> <title> PROSITE: recent developments. </title> <journal> NAR, </journal> <volume> 22, </volume> <pages> 3583-3589. </pages>
Reference-contexts: HMMer is freely available from http://genome.wustl.edu/eddy/hmm.html. 1.4 Contact rph@cse.ucsc.edu 2 Introduction Linear hidden Markov models (HMMs) (Haussler et al., 1993; Krogh et al., 1994) and the related generalized profiles <ref> (Bucher & Bairoch, 1994) </ref> have been quite successful in detecting conserved patterns in multiple sequences (Hughey & Krogh, 1996; Baldi et al., 1994; Eddy et al., 1995; Eddy, 1995; Bucher et al., 1996; McClure et al., 1996). <p> This raw NLL-score is exceedingly dependent on the lengths of s and m, and cannot be used directly to classify the sequence. Using the original Z-score method, SAM overcame this problem by appropriately normalizing the NLL-score. First, all proteins in a standard database, such as Swis-sProt <ref> (Bairoch & Boeckmann, 1994) </ref>, are scored against the model, and smoothed average curves of NLL-score versus length and standard deviation versus sequence length are calculated. Using this data, the difference between the NLL-score of a sequence and the mean NLL-score of sequences of similar length in standard deviations is calculated. <p> We also analyzed the complex null model based on the trained model's transitions and the geometric mean of its match states, SAM's Z-scoring heuristic, and HMMer's hmmsw. 5.1 Globins For the globins, we used Prosite <ref> (Bairoch & Bucher, 1994) </ref> to extract 685 globin sequences from SwissProt 32 (Bairoch & Boeckmann, 1994) of lengths 19 to 403. From these 685 sequences, we used the same 333 training sequences of lengths 40 to 403, as in a previous study (Bucher et al., 1996). <p> We also analyzed the complex null model based on the trained model's transitions and the geometric mean of its match states, SAM's Z-scoring heuristic, and HMMer's hmmsw. 5.1 Globins For the globins, we used Prosite (Bairoch & Bucher, 1994) to extract 685 globin sequences from SwissProt 32 <ref> (Bairoch & Boeckmann, 1994) </ref> of lengths 19 to 403. From these 685 sequences, we used the same 333 training sequences of lengths 40 to 403, as in a previous study (Bucher et al., 1996).
Reference: <author> Baldi, P., Chauvin, Y., Hunkapillar, T., & McClure, M. </author> <year> (1994). </year> <title> Hidden Markov models of biological primary sequence information. </title> <journal> PNAS, </journal> <volume> 91, </volume> <pages> 1059-1063. </pages> <note> 9 Bucher, </note> <author> P. & Bairoch, A. </author> <year> (1994). </year> <title> A generalized profile syn-tax for biomolecular sequence motifs and its function in automatic sequence interpretation. </title> <booktitle> In: </booktitle> <pages> ISMB-94 pp. 53-61, </pages> <address> Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference: <author> Bucher, P., Karplus, K., Moeri, N., & Hoffman, K. </author> <year> (1996). </year> <title> A flexible motif search technique based on generalized profiles. </title> <journal> Computers and Chemistry, </journal> <volume> 20 (1), </volume> <pages> 3-24. </pages>
Reference-contexts: From these 685 sequences, we used the same 333 training sequences of lengths 40 to 403, as in a previous study <ref> (Bucher et al., 1996) </ref>. Because the globin domain is quite conserved, it is relatively easy to model. each of which are a function of the setting of threshold score or .
Reference: <author> Eddy, S. </author> <year> (1995). </year> <title> Multiple alignment using hidden Markov models. </title> <editor> In: ISMB-95, (Rallings, C. et al., eds) pp. </editor> <address> 114-120, Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference-contexts: of methods that solve these problems and in the process eliminate the need for Z 2 scoring altogether. 4.2 Scoring Sequence alignments under probabilistic models can be scored using the log-odds ratio, an information-theoretic means of scoring an alignment (Altschul, 1991) that has been used by HMMer since its inception <ref> (Eddy et al., 1995) </ref>. <p> Rather than delve into these subjective choices, we choose instead to use the pessimistic N . Log-odds scoring has always been used by HMMer, which suggests use of log (L) for discrimination ( = 1) <ref> (Eddy, 1995) </ref>. 5 Results To evaluate scoring methods, we performed discrimination experiments on three families of sequences, globins, EF-hands, and ferredoxins, and searched for remote ho-mologues of 1hurA.
Reference: <author> Eddy, S., Mitchison, G., & Durbin, R. </author> <year> (1995). </year> <title> Maximum discrimination hidden Markov models of sequence consensus. </title> <journal> J. Comput. Biol. </journal> <volume> 2, </volume> <pages> 9-23. </pages>
Reference-contexts: of methods that solve these problems and in the process eliminate the need for Z 2 scoring altogether. 4.2 Scoring Sequence alignments under probabilistic models can be scored using the log-odds ratio, an information-theoretic means of scoring an alignment (Altschul, 1991) that has been used by HMMer since its inception <ref> (Eddy et al., 1995) </ref>. <p> Rather than delve into these subjective choices, we choose instead to use the pessimistic N . Log-odds scoring has always been used by HMMer, which suggests use of log (L) for discrimination ( = 1) <ref> (Eddy, 1995) </ref>. 5 Results To evaluate scoring methods, we performed discrimination experiments on three families of sequences, globins, EF-hands, and ferredoxins, and searched for remote ho-mologues of 1hurA.
Reference: <author> Gotoh, O. </author> <year> (1982). </year> <title> An improved algorithm for matching biological sequences. </title> <journal> JMB, </journal> <volume> 162 (3), </volume> <pages> 705-708. </pages>
Reference-contexts: For each of these lines there is an associated transition probability, which is the probability of going from one state to the other. This model topology features insertions and deletions similar to biological sequence alignment techniques based on affine gap penalties <ref> (Gotoh, 1982) </ref>. Building an HMM is a process that iteratively estimates the parameters from a set of unaligned training sequences. SAM uses a maximum a posteriori (MAP) approach, where a prior probability distribution, or reg-ularizer, over all possible parameters is assumed.
Reference: <author> Haussler, D., Krogh, A., Mian, I. S., & Sjolander, K. </author> <year> (1993). </year> <title> Protein modeling using hidden Markov models: Analysis of globins. </title> <booktitle> In: Proceedings of the Hawaii International Conference on System Sciences volume 1 pp. </booktitle> <pages> 792-802, </pages> <address> Los Alamitos, CA: </address> <publisher> IEEE Computer Society Press. </publisher>
Reference: <author> Henikoff, S. & Henikoff, J. G. </author> <year> (1994). </year> <title> Position-based sequence weights. </title> <journal> JMB, </journal> <volume> 243 (4), </volume> <pages> 574-578. </pages>
Reference-contexts: To build models, we created a model based on the unaligned sequences in the training set using SAM's default settings and a Dirichlet mixture prior (Sjolander et al., 1996). From this model, we generated a multiple alignment of the training sequences and calculated position-based sequence weights <ref> (Henikoff & Henikoff, 1994) </ref>, using an unpublished method to determine total sequence weight. With these weights, the unaligned sequences, and the mixture prior, we built the final HMM.
Reference: <author> Holm, L. & Sander, C. </author> <year> (1996). </year> <title> The FSSP database: Fold classification based on structure-structure alignment of proteins. </title> <journal> NAR, </journal> <volume> 24 (1), </volume> <pages> 206-209. </pages>
Reference-contexts: We used this HMM to search the FSSP database of representative proteins <ref> (Holm & Sander, 1996) </ref>. Because no two sequences in the FSSP database have greater than 25% residue identity, we are looking for remote homologs, not close ones.
Reference: <author> Hughey, R. & Krogh, A. </author> <year> (1996). </year> <title> Hidden Markov models for sequence analysis: Extension and analysis of the basic method. </title> <journal> CABIOS, </journal> <volume> 12 (2), </volume> <pages> 95-107. </pages>
Reference-contexts: Finally, the model can be used to discriminate between family and non-family sequences when employed for database searching. It is this last issue that we address here using the Sequence Analysis and Modeling software suite (SAM) <ref> (Hughey & Krogh, 1996) </ref>. While previous work with SAM has shown notable success in sequence family discrimination, the methods used to determine sequence homology were admittedly crude (Krogh et al., 1994).
Reference: <author> Krogh, A., Brown, M., Mian, I. S., Sjolander, K., & Haussler, D. </author> <year> (1994). </year> <title> Hidden Markov models in computational biology: Applications to protein modeling. </title> <journal> JMB, </journal> <volume> 235, </volume> <pages> 1501-1531. </pages>
Reference-contexts: It is this last issue that we address here using the Sequence Analysis and Modeling software suite (SAM) (Hughey & Krogh, 1996). While previous work with SAM has shown notable success in sequence family discrimination, the methods used to determine sequence homology were admittedly crude <ref> (Krogh et al., 1994) </ref>. The basic scores reported by SAM are highly length dependent, so a heuristic was used to Z-score each sequence based on the distribution of scores for sequences of similar length. This paper studies techniques to overcome problems with the Z-score heuristic. <p> Although a number of proteins possess the EF-hand motif, some of these regions have lost their calcium binding property. For a training set, we used the same set of EF-hand sequences as in earlier work <ref> (Krogh et al., 1994) </ref>. This set is based on the June 1992 set of EF-hand sequences maintained by Kretsinger and co-workers (Nakayama et al., 1992).
Reference: <author> McClure, M., Smith, C., & Elton, P. </author> <year> (1996). </year> <title> Parameterization studies for the SAM and HMMER methods of hidden Markov model generation. </title> <booktitle> In: </booktitle> <pages> ISMB-96 pp. 155-164, </pages> <address> St. Louis: </address> <publisher> AAAI Press. </publisher>
Reference: <author> Milosavljevic, A. & Jurka, J. </author> <year> (1993). </year> <title> Discovering simple DNA sequences by the algorithmic similarity method. </title> <journal> CABIOS, </journal> <volume> 9 (4), </volume> <pages> 407-411. </pages>
Reference-contexts: This method evaluates how much better a sequence fits the model than some underlying background distribution or null model. The significance of these scores is evaluated with the al 1 gorithmic significance method <ref> (Milosavljevic & Jurka, 1993) </ref>. The primary result of this paper is an experimental evaluation of null model alternatives for log-odds scoring. 3 System and Methods The work discussed herein was performed using the SAM HMM program suite on UltraSparc 140 workstations. SAM is programmed in ANSI C for Unix workstations. <p> use of Milosavljevic's algorithmic significance test, which asserts that the probability of getting a score larger than d is less than or equal to z d (where z is the logarithm base), assuming that the null model is a reasonably accurate description of the space the sequences are drawn from <ref> (Milosavljevic & Jurka, 1993) </ref>.
Reference: <author> Moncrief, N. D., Kretsinger, R. H., & Goodman, M. </author> <year> (1990). </year> <title> Evolution of EF-hand calcium-modulated proteins. I. relationships based on amino acid sequences. </title> <journal> Journal of Molecular Evolution, </journal> <volume> 30, </volume> <pages> 522-562. </pages>
Reference: <author> Nakayama, S., Moncrief, N. D., & Kretsinger, R. H. </author> <year> (1992). </year> <title> Evolution of EF-hand calcium-modulated proteins. ii. domains of several subfamilies have diverse evolutionary histories. </title> <journal> Journal of Molecular Evolution, </journal> <volume> 34, </volume> <pages> 416-448. </pages>
Reference-contexts: For a training set, we used the same set of EF-hand sequences as in earlier work (Krogh et al., 1994). This set is based on the June 1992 set of EF-hand sequences maintained by Kretsinger and co-workers <ref> (Nakayama et al., 1992) </ref>. The EF-hand structures were extracted from each of the 242 sequences in the EF-hand database to obtain 885 EF-hand motifs having an average length of 29.
Reference: <author> Persechini, A., Moncrief, N. D., & Kretsinger, R. H. </author> <year> (1989). </year> <title> The EF-hand family of calcium-modulated proteins. </title> <booktitle> Trends in Neurosciences, </booktitle> <volume> 12 (11), </volume> <pages> 462-467. </pages>
Reference: <author> Sander, C. & Schneider, R. </author> <year> (1991). </year> <title> Database of homology-derived protein structures and the structural meaning of sequence alignment. </title> <journal> Proteins, </journal> <volume> 9 (1), </volume> <pages> 56-68. </pages>
Reference-contexts: This, plus the sequence and structural conservation needed to retain functional properties, make the ferredoxin family as a whole difficult to model. Thus we chose the 2Fe-2S subgroup. The 2Fe-2S ferredoxins are proteins or domains of approximately 100 amino acid residues that bind a single 2Fe-2S iron-sulfur cluster <ref> (Sander & Schneider, 1991) </ref>. Using the Prosite classification of true 2Fe-2S ferredox-ins, we extracted 100 sequences from SwissProt 32 of lengths 32 to 1353. Two of these were fragments. Model training involved 49 sequences, with fragments excluded. <p> are listed in order of intersection with the vertical axis. 5.4 Remote Homologue Detection In order to test the effect of null model choice on searches for remote homologs, we selected an HMM trained on 1hurA (human ADP-ribosylation factor 1) and its close homologs, as given in the HSSP database <ref> (Sander & Schneider, 1991) </ref>. We used this HMM to search the FSSP database of representative proteins (Holm & Sander, 1996). Because no two sequences in the FSSP database have greater than 25% residue identity, we are looking for remote homologs, not close ones.
Reference: <author> Sjolander, K., Karplus, K., Brown, M. P., Hughey, R., Krogh, A., Mian, I. S., & Haussler, D. </author> <year> (1996). </year> <title> Dirichlet mixtures: A method for improving detection of weak but significant protein sequence homology. </title> <journal> CABIOS, </journal> <volume> 12 (4), </volume> <pages> 327-345. </pages>
Reference-contexts: To build models, we created a model based on the unaligned sequences in the training set using SAM's default settings and a Dirichlet mixture prior <ref> (Sjolander et al., 1996) </ref>. From this model, we generated a multiple alignment of the training sequences and calculated position-based sequence weights (Henikoff & Henikoff, 1994), using an unpublished method to determine total sequence weight. With these weights, the unaligned sequences, and the mixture prior, we built the final HMM.
Reference: <author> Smith, T. F. & Waterman, M. S. </author> <year> (1981). </year> <title> Identification of common molecular subsequences. </title> <journal> JMB, </journal> <volume> 147, </volume> <pages> 195-197. 10 </pages>
Reference-contexts: With full local scoring, which allows a sub-region of the sequence to match a subregion of the model <ref> (Smith & Waterman, 1981) </ref>, the number of placements is the sum of the length of the model and the length of the sequence.
References-found: 22

