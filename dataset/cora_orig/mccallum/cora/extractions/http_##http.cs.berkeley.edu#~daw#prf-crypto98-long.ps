URL: http://http.cs.berkeley.edu/~daw/prf-crypto98-long.ps
Refering-URL: http://http.cs.berkeley.edu/~daw/me.html
Root-URL: http://www.cs.berkeley.edu
Email: fhall,kelsey,schneierg@counterpane.com  daw@cs.berkeley.edu  
Phone: (612) 823-1098 2  
Title: Building PRFs from PRPs  
Author: Chris Hall David Wagner John Kelsey and Bruce Schneier E. Minnehaha 
Address: Pkwy Minneapolis, MN 55419  Berkeley  Soda Hall Berkeley, CA 94720-1776  
Affiliation: 1 Counterpane Systems  U.C.  
Abstract: We evaluate constructions for building pseudo-random functions (PRFs) from pseudo-random permutations (PRPs). We present two constructions: a slower construction which preserves the security of the PRP and a faster construction which has less security. One application of our construction is to build a wider block cipher given a block cipher as a building tool. We do not require any additional constructions|e.g. pseudo-random generators|to create the wider block cipher. The security of the resulting cipher will be as strong as the original block cipher. Keywords. pseudo-random permutations, pseudo-random functions, con crete security, block ciphers, cipher feedback mode.
Abstract-found: 1
Intro-found: 1
Reference: [AV96] <author> W. Aiello, R. Venkatesan, </author> <title> "Foiling birthday attacks in length doubling transformations," </title> <booktitle> Advances in Cryptology|EUROCRYPT '96 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 307-320. </pages>
Reference-contexts: In addition to designing PRPs from PRFs, some researchers have studied designing PRFs from smaller PRFs. Aiello and Venkatesan built a 2n-bit to 2n-bit function from eight n-bit to n-bit functions using a Benes transform <ref> [AV96] </ref>. <p> Bellare et al. initiated this study in [BKR94,BGR95]. When it comes to building PRFs from PRPs, though several different people have noted that a PRP can be used as a PRF with advantage O (m 2 =2 n ) for m &lt; 2 n=2 (e.g. <ref> [AV96] </ref>), there has been a notable lack of research in this area. One recent exception is the excellent paper of Bellare et. al. [BKR98], which uses the notion of data-dependent keying to build a PRF from a PRP. <p> One interesting motivation for building PRFs from PRPs is that we could build larger PRPs from smaller PRPs by first constructing PRFs from the PRPs, using the results of <ref> [AV96] </ref> to strengthen the function, and finally using one of the many results available for building PRPs from PRFs. <p> This paper provides new results in this area. If we have a trusted cipher, then we can model it as a PRP family. Using one of our constructions we can construct a PRF family, use the Benes transform <ref> [AV96] </ref> to create a wider PRF family, and finally use Luby-Rackoff to create a PRP family again. The nice thing is that the resulting PRP family will be almost four times as wide as the original construction. <p> The reason we do not obtain a family F 2 IF 116:116 is that the modified Benes transform requires six independent functions. Hence we can use the first three bits of our functions in F to obtain eight independent function families for constructing IF 2 . The results of <ref> [AV96] </ref> show that F 2 is a (t; q=64; e+e 0 )-secure PRF, where e 0 is neglible for q=64 &lt; 2 110 .
Reference: [BCK96] <author> M. Bellare, R. Canetti, H. Krawczyk, </author> <title> "Pseudorandom Functions Revisited: The Cascade Construction and its Concrete Security," </title> <booktitle> Proceedings of the 37th Symposium on Foundations of Computer Science, IEEE, </booktitle> <year> 1996. </year>
Reference-contexts: Aside from building wider functions, some researchers have examined building variable-length input PRFs (VI-PRFs). In <ref> [BCK96] </ref>, Bellare et al. formalize the notation of VI-PRFs and analyze the security of several constructions. Their functions are constructed using simpler primitives: fixed-length input PRFs (FI-PRFs) which were first defined in [BKR94] in order to model the Data Encryption Algorithm (DES).
Reference: [BDJR97] <author> M. Bellare, A. Desai, E. Jokipii, P. Rogaway, </author> <title> "A Concrete Security Treatment of Symmetric Encryption: Analysis of the DES Modes of Operation," Full version, </title> <booktitle> Extended abstract in Proceedings of 38th Annual Symposium on Foundations of Computer Science (FOCS 97), IEEE, </booktitle> <year> 1997. </year>
Reference-contexts: However, the only results we are aware of for going in the reverse directions are the recent results of Bellare et. al. in [BKR98] 1 . One primary justification for building pseudo-random functions is that it allows one to use the results of Bellare et. al. <ref> [BDJR97] </ref> to produce an n-bit cipher that can be used to encrypt more than 2 n=2 blocks. Due to birthday attacks, n-bit permutations will leak information about the plaintext after 2 n=2 blocks. <p> PRFs and PRPs were initially defined in [GGM86] as functions (resp. permutations) which a polynomially-bounded attacker cannot to distinguish from truly random functions (resp. permutations) with more than neglible probability. A more recent paper by Bellare et al. <ref> [BDJR97] </ref> evaluates four different notions of security and applies those notions to the definitions of PRFs and PRPs. In addition, M. Luby has written a book on pseudorandomness which provides an excellent summary of the theoretical constructions leading up to PRFs [Lub96].
Reference: [BGR95] <author> M. Bellare, R. Guerin, P. Rogaway, </author> <title> "XOR MACs: New methods for message authentication using finite pseudorandom functions," </title> <booktitle> Advances in Cryptology|CRYPTO '95 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1995, </year> <pages> pp 15-28. </pages>
Reference: [BKR94] <author> M. Bellare, J. Kilian, P. Rogaway, </author> <title> "The security of cipher block chaining," </title> <booktitle> Advances in Cryptology|CRYPTO '94 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1994. </year>
Reference-contexts: Aside from building wider functions, some researchers have examined building variable-length input PRFs (VI-PRFs). In [BCK96], Bellare et al. formalize the notation of VI-PRFs and analyze the security of several constructions. Their functions are constructed using simpler primitives: fixed-length input PRFs (FI-PRFs) which were first defined in <ref> [BKR94] </ref> in order to model the Data Encryption Algorithm (DES). One important feature of these papers is that they focus on concrete security analysis, which attempts to provide precise estimates of security, rather than being satisfied with asymptotic results. Bellare et al. initiated this study in [BKR94,BGR95].
Reference: [BKR98] <author> M. Billare, T. Krovetz, P. Rogaway, </author> <title> "Luby-Rackoff Backwards: Increasing Security by Making Block Ciphers Non-Invertible (Extended Abstract)," </title> <booktitle> Advances in Cryptology|EUROCRYPT '98 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1998. </year>
Reference-contexts: There are several well known constructions for building pseudorandom permutations from pseudo-random functions, notably [LR88]. However, the only results we are aware of for going in the reverse directions are the recent results of Bellare et. al. in <ref> [BKR98] </ref> 1 . One primary justification for building pseudo-random functions is that it allows one to use the results of Bellare et. al. [BDJR97] to produce an n-bit cipher that can be used to encrypt more than 2 n=2 blocks. <p> One recent exception is the excellent paper of Bellare et. al. <ref> [BKR98] </ref>, which uses the notion of data-dependent keying to build a PRF from a PRP. Their results present strong evidence for the security of their PRP!PRF construction, and they take some initial steps towards a more complete analysis of its strength against computationally-bounded adversaries. <p> In contrast, 64-bit block ciphers typically run into security problems when used in a standard chaining mode to encrypt more than 2 32 known texts, no matter how strong the cipher is. Bellare et. al. have explored this application further in <ref> [BKR98] </ref>. 3.1 Building Wider Block Ciphers Techniques for building wider block ciphers are especially relevant as the AES standards effort ramps up. <p> However, at present the available proofs provide no guarantee of security past about 2 36 texts, which is probably not a compelling advantage over the 2 32 birthday bound. As a third alternative, one could use the re-keying construction of Bellare et. al. <ref> [BKR98] </ref> to build F out of Triple-DES (say). Applying the Benes transform and the Naor-Reingold construction would then provide a 256-bit cipher which is only 3 times slower than Triple-DES. The disadvantage is that the available security results are difficult to compare with the figures given above.
Reference: [BM84] <author> M. Blum, S. Micali, </author> <title> "How to Generate Cryptographically Strong Sequences of Pseudo-random Bits," </title> <journal> SIAM J. Comput., </journal> <volume> 13 (Nov. </volume> <year> 1984), </year> <pages> pp. 850-864. </pages>
Reference: [C97] <author> D. Coppersmith, "Luby-Rackoff: </author> <title> Four rounds is not enough," </title> <note> IBM Research Report, RC 20674 (12/24/96), Mathematics. </note>
Reference: [GGM86] <author> O. Goldreich, S. Goldwasser, S. Micali, </author> <title> "How to Construct Random Functions," </title> <journal> Journal of the ACM, </journal> <volume> Vol. 33, No. 4, </volume> <month> October </month> <year> 1986, </year> <pages> pp. 792-807. </pages>
Reference-contexts: Our work extends previous work on pseudo-random functions (PRFs) and permutations (PRPs). PRFs and PRPs were initially defined in <ref> [GGM86] </ref> as functions (resp. permutations) which a polynomially-bounded attacker cannot to distinguish from truly random functions (resp. permutations) with more than neglible probability. A more recent paper by Bellare et al. [BDJR97] evaluates four different notions of security and applies those notions to the definitions of PRFs and PRPs.
Reference: [LR88] <author> M. Luby, C. Rackoff, </author> <title> "How to Construct Pseudorandom Permutations from Pseudorandom Functions," </title> <journal> SIAM J. Comput., </journal> <volume> Vol. 17, No. 2, </volume> <month> April </month> <year> 1988, </year> <pages> pp. 373-386. </pages>
Reference-contexts: 1 Introduction and Background In this paper we examine building psuedo-random functions from pseudo-random permutations. There are several well known constructions for building pseudorandom permutations from pseudo-random functions, notably <ref> [LR88] </ref>. However, the only results we are aware of for going in the reverse directions are the recent results of Bellare et. al. in [BKR98] 1 . <p> Luby has written a book on pseudorandomness which provides an excellent summary of the theoretical constructions leading up to PRFs [Lub96]. Some authors have made a distinction between PRPs and super PRPs. With a super PRP, an adversary is allowed to query for inverse evaluations of the permutation <ref> [LR88] </ref>. For our applications, we require the "super" variety of PRP. Therefore, for the remainder of this paper we shall consider only super PRPs; we usually omit the "super" prefix for conciseness. Extensive research has been conducted on building PRPs from PRFs. <p> Therefore, for the remainder of this paper we shall consider only super PRPs; we usually omit the "super" prefix for conciseness. Extensive research has been conducted on building PRPs from PRFs. Many of the constructions are based on Luby and Rackoff's original work <ref> [LR88] </ref>. Let F (l; r) = m (f 1 ; : : : ; f m )(l; r) denote an m-round Feistel network where f i 2 IF n:n . <p> Then F (l; r) 2 IP 2n where i (f 1 ; : : : ; f i ) is defined by (f )(l; r) = (r; l f (r)) Luby and Rackoff <ref> [LR88] </ref> showed that an adversary has advantage at most m (m 1)=2 n if they make m &lt; Q (n) queries for some polynomial Q (x). <p> Probably one of the most interesting is that we "close the loop" between PRFs and PRPs. Luby-Rackoff <ref> [LR88] </ref> gave a nice PRF ! PRP construction; we have now shown how to go the other direction 3 . We explore two additional possibilities in the next sections. <p> This is definitely very slow, but it is provably secure! 4 Note: the security proof of the Luby-Rackoff construction given in <ref> [LR88] </ref> actually assume that the g i are independent; but the proofs in [NR96] remove that restriction. An alternative to using Luby-Rackoff is to use a construction by M. Naor and O. Reingold [NR96]. There you get a twofold speed-up in execution and we only require 768 invocations of Triple-DES.
Reference: [Lub96] <author> M. Luby, </author> <title> Pseudorandomness and Cryptographic Applications, </title> <publisher> Princeton University Press, </publisher> <year> 1996. </year>
Reference-contexts: A more recent paper by Bellare et al. [BDJR97] evaluates four different notions of security and applies those notions to the definitions of PRFs and PRPs. In addition, M. Luby has written a book on pseudorandomness which provides an excellent summary of the theoretical constructions leading up to PRFs <ref> [Lub96] </ref>. Some authors have made a distinction between PRPs and super PRPs. With a super PRP, an adversary is allowed to query for inverse evaluations of the permutation [LR88]. For our applications, we require the "super" variety of PRP.
Reference: [Luc96] <author> S. Lucks, </author> <title> "Faster Ruby-Lackoff Ciphers," </title> <booktitle> Proceedings of Third Fast Software Encryption Workshop, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 189-203. </pages>
Reference: [M92] <author> U.M. Maurer, </author> <title> "A Simplified and Generalized Treatment of Luby-Rackoff Pseudorandom Permutation Generators," </title> <booktitle> Advances in Cryptology| EUROCRYPT '92 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <year> 1992, </year> <pages> pp. 239-255. </pages>
Reference: [MMO85] <author> S.M. Matyas, C.H. Meyeter, J. Oseas, </author> <title> "Generating strong one-way functions with cryptographic algorithm," </title> <journal> IBM Technical Disclosure Bulletin, </journal> <volume> 27 (1985), </volume> <pages> 5658-5659. </pages>
Reference-contexts: It is worth noting that this analysis also establishes the security of another related construction. One might naively propose a construction based (loosely) on the Davies-Meyer hashing mode <ref> [MMO85] </ref>: f p (x) = p (x) x: The final xor of x into the ciphertext destroys the bijective property of p, so at first glance f p might look like a reasonable candidate for a better PRF. However, we note that this construction has no better security than before.
Reference: [NR96] <author> M. Naor, O. Reingold, </author> <title> "On the construction of pseudo-random permutations: Luby-Rackoff revisited.," </title> <note> preliminary version, http://www.wisdom.weizmann.ac.il/Papers/trs/CS96-10/abstract.html </note>
Reference-contexts: This is definitely very slow, but it is provably secure! 4 Note: the security proof of the Luby-Rackoff construction given in [LR88] actually assume that the g i are independent; but the proofs in <ref> [NR96] </ref> remove that restriction. An alternative to using Luby-Rackoff is to use a construction by M. Naor and O. Reingold [NR96]. There you get a twofold speed-up in execution and we only require 768 invocations of Triple-DES. This translates to a total of roughly 223 times worse performance than Triple-DES. <p> slow, but it is provably secure! 4 Note: the security proof of the Luby-Rackoff construction given in [LR88] actually assume that the g i are independent; but the proofs in <ref> [NR96] </ref> remove that restriction. An alternative to using Luby-Rackoff is to use a construction by M. Naor and O. Reingold [NR96]. There you get a twofold speed-up in execution and we only require 768 invocations of Triple-DES. This translates to a total of roughly 223 times worse performance than Triple-DES.
Reference: [P90] <author> J. Pieprzyk, </author> <title> "How to Construct Pseudorandom Permutations from Single Pseudorandom Functions," </title> <booktitle> Advances in Cryptology|EUROCRYPT '90, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 140-150. </pages>
Reference: [P91a] <author> J. Patarin, </author> <title> "Etude des gnrateurs de permutations bases sure le Schema du D.E.S.," </title> <type> Ph. D. Thesis, </type> <institution> INRIA, Domaine de Voluceau, Le Chesnay, France, </institution> <year> 1991. </year>
Reference: [P91b] <author> J. Patarin, </author> <title> "New Results on Pseudorandom Permutation Generators Based on the DES Scheme," </title> <booktitle> Advances in Cryptology|CRYPTO '91 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 301-312. </pages>
Reference: [P92] <author> J. Patarin, </author> <title> "How to Consruct Pseudorandom and Super Pseudorandom Permutations from One Single Pseudorandom Function," </title> <booktitle> Advances in Cryptology|EUROCRYPT '92 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 256-266. </pages>
Reference: [P97] <author> J. Patarin, </author> <title> "Improved Security Bounds for Pseudorandom Permutations," </title> <booktitle> Proceedings of the Fourth ACM Conference on Computer and Communications Security, </booktitle> <month> April 1-4, </month> <year> 1997, </year> <pages> pp. 142-150. </pages>
Reference: [P98] <author> J. Patarin, </author> <title> "About Feistel Schemes with Six (or More) Rounds," </title> <booktitle> Proceedings of the Fifth Fast Software Encryption Workshop, </booktitle> <publisher> LNCS 1372, Springer, </publisher> <year> 1998, </year> <pages> pp. 103-121. </pages>
Reference-contexts: However, eliminating the Benes transform could produce significant performance speedups, so this motivates the search for PRP constructions with better security. For example, by using Patarin's recent results on the 6-round Luby-Rackoff construction <ref> [P98] </ref>, we can build a widened cipher P 3 P 116 that is secure with up to about minfq; 2 43:5 g texts; by using single-DES instead of Triple-DES as our starting point, we can get a 116-bit cipher which is provably as secure as DES and has performance about 212
Reference: [PO95] <author> B. Preneel, P. van Oorschot, </author> <title> "MDx MAC and building fast MACs from hash functions," </title> <booktitle> Advances in Cryptology|CRYPTO '95 Proceedings, </booktitle> <publisher> LNCS 1070, Springer-Verlag, </publisher> <year> 1996. </year>
Reference-contexts: We believe that these limits are not inherent, but 6 The study of the properties of bit-truncation may also have some independent interest, as several authors have already suggested applying a bit-truncation output transform to existing MAC constructions in hopes of improving their security (see, e.g., <ref> [PO95] </ref>). rather are a reflection of the inadequacy of our analysis. As an illustration, the best attack we can find needs q = O (2 (n+m)=2) texts to distinguish f from random with significant advantage (see Theorem 8), so this leaves a substantial gap between the upper and lower bounds.
Reference: [SP91] <author> B. Sadeghiyan, J. Pieprzyk, </author> <title> "On Necessary and Sufficient Conditions for the Construction of Super Pseudorandom Permutations," </title> <booktitle> Advances in Cryptology|ASIACRYPT '91, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 194-209. </pages>
Reference: [SP92] <author> B. Sadeghiyan, J. Pieprzyk, </author> <title> "A Construction for Super Pseudorandom Permutations from A Single Pseudorandom Function," </title> <booktitle> Advances in Cryptology| EUROCRYPT '92, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 267-284. </pages>
Reference: [Y82] <author> A.C. Yao, </author> <title> "Theory and Applications of Trapdoor Functions," </title> <booktitle> Proceedings of the 23rd IEEE Symposium on Foundations of Computer Science, IEEE, </booktitle> <address> New York, </address> <year> 1982, </year> <pages> pp. 80-91. </pages> <editor> [ZMI89a] , Y. Zheng, T. Matsumoto, H. Imai, </editor> <title> "On the Construction of Block Ciphers Provably Secure and Not Relying on Any Unproved Hypothesis," </title> <booktitle> Advances in Cryptology|CRYPTO '89 Proceedings, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 461-480. </pages>
Reference: [ZMI89b] <author> Y. Zheng, T. Matsumoto, H. Imai, </author> <title> "Impossibility and Optimality Results on Constructing Pseudorandom Permutations," </title> <booktitle> Advances in Cryptology| EUROCRYPT '89, </booktitle> <publisher> Springer-Verlag, </publisher> <pages> pp. 412-421. </pages>
References-found: 26

