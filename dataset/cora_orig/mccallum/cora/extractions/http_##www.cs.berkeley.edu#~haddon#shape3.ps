URL: http://www.cs.berkeley.edu/~haddon/shape3.ps
Refering-URL: http://www.cs.berkeley.edu/projects/vision/publications.html
Root-URL: 
Title: Shape representations from shading primitives  
Author: John Haddon and David Forsyth 
Keyword: shape, shading, recognition, representation, symmetry  
Address: Berkeley CA 94720  
Affiliation: Computer Science Division University of California,  
Email: haddon@eecs.berkeley.edu, daf@cs.berkeley.edu  
Phone: Phone: +1-510-643-6763, +1-510-642-9582 Fax: +1-510-643-1534  
Date: November 7, 1997  
Abstract: Diffuse interreflections mean that surface shading and shape are related in ways that are difficult to untangle; in particular, distant and invisible surfaces may affect the shading field that one sees. The effects of distant surfaces are confined to relatively low spatial frequencies in the shading field, meaning that we can expect signatures, called shading primitives, corresponding to shape properties. We demonstrate how these primitives can be used to support the construction of useful shape representations, using a sequence of tests learned from real image data. One approach is to test hypotheses of geometric primitives for consistency with the shading field, and we show that a shading test can be successfully used on images of real scenes to determine whether an image symmetry actually comes from a view of a human body segment or not. A second approach looks for shading events that are distinctive of some shape event; in earlier work, we demonstrated finding folds and grooves in this way. We show that these approaches can be composed, leading to an attractive process of representation that is intrinsically bottom up, where a back is represented as a surface that is roughly cylindrical with a groove in it. For the case of backs, we show that this representation can be extracted from images of real scenes, and that the representation is diagnostic. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> I. Biederman. Recognition-by-components: </author> <title> A theory of human image understanding. </title> <journal> Psych. Review, </journal> <volume> 94(2):115 14 147, </volume> <year> 1987. </year>
Reference-contexts: The classical approach to alleviating difficulties with abstraction is to view recognition in terms of assemblies of stylised primitives. In this view, which has been espoused in a variety of forms <ref> [1, 2, 20, 22] </ref>, objects are represented as assemblies of shapes taken from a collection of parametric families with "good" properties. A classical difficulty with this view of representation is that it is hard to know what the primitives should be.
Reference: [2] <author> T. Binford. </author> <title> Visual perception by computer. </title> <booktitle> In Proc. IEEE Conference on Systems and Control, </booktitle> <year> 1971. </year>
Reference-contexts: The classical approach to alleviating difficulties with abstraction is to view recognition in terms of assemblies of stylised primitives. In this view, which has been espoused in a variety of forms <ref> [1, 2, 20, 22] </ref>, objects are represented as assemblies of shapes taken from a collection of parametric families with "good" properties. A classical difficulty with this view of representation is that it is hard to know what the primitives should be.
Reference: [3] <author> A. Blake. </author> <title> Boundary conditions for lightness computation in mondrian world. Computer Vision, </title> <journal> Graphics and Image Processing, </journal> <volume> 32 </volume> <pages> 314-327, </pages> <year> 1985. </year>
Reference-contexts: This effect suggests that the widely established convention (e.g. <ref> [3, 14, 17] </ref>) of classifying effects in shading as due to reflectance if the spatial frequency is high ("edges") and the dynamic range is relatively low, and due to illumination otherwise, can be expanded.
Reference: [4] <author> J. Brady and H. Asada. </author> <title> Smoothed local symmetries and their implementation. </title> <journal> International Journal of Robotics Research, </journal> <volume> 3(3), </volume> <year> 1984. </year>
Reference-contexts: The geometric approach to finding image regions that could represent cylinders involves finding boundaries, constructing local symmetries between boundary points (as in <ref> [4, 13] </ref>) and then constructing collections of symmetries that have the same length and whose centers lie roughly on a straight line to which they are roughly perpendicular. In this case, exploiting shading is easy because there is already an hypothesis as to the underlying geometry (as in [10]).
Reference: [5] <author> C. Cortes and V. Vapnik. </author> <title> Support-vector networks. </title> <journal> Machine Learning, </journal> <volume> 20(3) </volume> <pages> 273-97, </pages> <year> 1995. </year>
Reference-contexts: To determine this classifier, we developed a simple geometric model of a limb cross-section, and then applied a simple shading model to the limb model to generate typical shading cross-sections. We then used these analytically determined shading cross-sections to train a support vector classifier (the classifiers are described in <ref> [5] </ref>; other recent uses of this classifier in vision applications include [24, 21]). Passing the segment under test to the classifier then tells us whether the shading is consistent with that on a limb. The geometrical model of a limb is approximately cylindrical, with a few variations. <p> It is the energy of this difference which we call the residual. For our classifier, we trained a support vector machine <ref> [5] </ref> using the projection onto principal components and the residual. In contrast to the use of SVMs in [24] and [23], we culled our positive training data from the results of our theoretical shading model applied to the geometrical limb model.
Reference: [6] <author> A. Dempster, N. Laird, and D. Rubin. </author> <title> Maximum likelihood from incomplete data via the EM algorithm. </title> <journal> Journal of the Royal Statistical Society B, </journal> <volume> 39, </volume> <year> 1977. </year>
Reference-contexts: While there are probably better ways of interpolating over the groove|one might use the expectation maximisation <ref> [6] </ref> algorithm to fill in this "missing" data|our approach gives perfectly acceptable results. In fact, in our current implementation, we have not actually found it necessary to discount the effect of the grooves.
Reference: [7] <author> D. Forsyth and M. Fleck. </author> <title> Body plans. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <year> 1997. </year>
Reference-contexts: Our horse finder has low recall|about 15%|but marks only 0.65% of pictures without horses, and has been extensively tested on a large set of images <ref> [7] </ref>. The weakness in this program lies in the fact that there are so many sets of nearly-parallel, nearly-straight edges (potentially body segments) that, if the number is not reduced, the kinematic tests become overwhelmed.
Reference: [8] <author> D. Forsyth, J. Malik, M. Fleck, and J. Ponce. </author> <title> Primitives, perceptual organisation and object recognition. </title> <note> in review. </note>
Reference-contexts: For example, a cylinder is a significant property, because many objects are made of crude cylinders. A third useful property is robustness; cylindrical primitives are quite easy to find even in the presence of some deformations. In the work described in <ref> [8] </ref>, it was shown that viewing objects as assemblies of primitives can be used successfully, if crudely, to find images containing horses.
Reference: [9] <author> D. Forsyth and A. Zisserman. </author> <title> Reflections on shading. </title> <journal> IEEE T. Pattern Analysis and Machine Intelligence, </journal> <volume> 13(7) </volume> <pages> 671-679, </pages> <year> 1991. </year>
Reference-contexts: New models of shape from shading can be obtained by changing either the type of shape representation sought in the shading field <ref> [9] </ref>, or the model of shading [18, 19, 16]. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in [28, 21, 27, 29].
Reference: [10] <author> A. D. Gross and T. E. Boult. </author> <title> Recovery of shgcs from a single intensity view. </title> <journal> IEEE T. Pattern Analysis and Machine Intelligence, </journal> <volume> 18(2) </volume> <pages> 161-180, </pages> <year> 1996. </year>
Reference-contexts: In this case, exploiting shading is easy because there is already an hypothesis as to the underlying geometry (as in <ref> [10] </ref>). In particular, we can test the shading along a symmetry to see whether it is consistent with the shading across a limb. 3.1 Method Testing whether the shading across a symmetry represents the shading across a limb cross-section requires a classifier of some form.
Reference: [11] <author> J. Haddon and D. Forsyth. </author> <title> Shading primitives: Finding folds and shallow grooves. </title> <booktitle> In Int. Conf. on Computer Vision, </booktitle> <year> 1998. </year>
Reference-contexts: To predict the shading on our geometrical limb model, we use the same shading model as in <ref> [11] </ref>. <p> There appears to be some correlation with pose, which probably has to do with reduced contrast for body segments occluding other segments. 4 Composite shading primitives In <ref> [11] </ref>, we developed a technique for finding grooves and folds. We applied our shading model to a geometrical model of the shape, and used these theoretical predictions to train a support vector machine to recognize grooves or folds. In that work, we were merely concerned with finding isolated shading primitives.
Reference: [12] <author> B. Horn. </author> <title> Shape from shading : a method for obtaining the shape of a smooth opaque object from one view. Ai tr-232, </title> <publisher> MIT, </publisher> <year> 1970. </year>
Reference-contexts: 1 Background Changes in surface brightness are a powerful cue to the shape of a surface; the study of extracting shape information from image shading starts with <ref> [12] </ref> and is comprehensively summed up in Brooks' book [13].
Reference: [13] <author> B. Horn and M. Brooks. </author> <title> Shape from shading. </title> <publisher> MIT Press, </publisher> <year> 1989. </year>
Reference-contexts: 1 Background Changes in surface brightness are a powerful cue to the shape of a surface; the study of extracting shape information from image shading starts with [12] and is comprehensively summed up in Brooks' book <ref> [13] </ref>. The approach views shading as a local effect; surface brightness is modelled as a product of a visibility term and a non-negative function of the Gauss map, leading to a partial differential equation|the image irradiance equation|which expresses the relationship between surface geometry and image brightness. <p> The geometric approach to finding image regions that could represent cylinders involves finding boundaries, constructing local symmetries between boundary points (as in <ref> [4, 13] </ref>) and then constructing collections of symmetries that have the same length and whose centers lie roughly on a straight line to which they are roughly perpendicular. In this case, exploiting shading is easy because there is already an hypothesis as to the underlying geometry (as in [10]).
Reference: [14] <author> B. K. P. Horn. </author> <title> Determining lightness from an image. Computer Vision, </title> <journal> Graphics and Image Processing, </journal> <volume> 3 </volume> <pages> 277-299, </pages> <year> 1974. </year>
Reference-contexts: This effect suggests that the widely established convention (e.g. <ref> [3, 14, 17] </ref>) of classifying effects in shading as due to reflectance if the spatial frequency is high ("edges") and the dynamic range is relatively low, and due to illumination otherwise, can be expanded.
Reference: [15] <author> J. Koenderink. Vignetting and reflexes. </author> <note> Shading Course Notes. </note>
Reference-contexts: This is a version of a model suggested by Koenderink <ref> [15] </ref> and also used by Langer et al.[18]. Because the limb has translational symmetry, we can model the "sky" (distant radiators) as an infinitely long half cylinder above the limb with its axis collinear with that of the limb.
Reference: [16] <author> J. Koenderink and A. V. Doorn. </author> <title> Geometrical modes as a method to treat diffuse interreflections in radiometry. </title> <journal> J. Opt. Soc. Am., </journal> <volume> 73(6) </volume> <pages> 843-850, </pages> <year> 1983. </year>
Reference-contexts: New models of shape from shading can be obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading <ref> [18, 19, 16] </ref>. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in [28, 21, 27, 29]. <p> For our purposes a dense depth map is heavily redundant|instead, we will concentrate on finding stylised events in the shading field that are strongly coupled to shape, which we call shading primitives. In <ref> [16] </ref>, Koenderink observed that deep holes and grooves in surfaces have characteristic shading properties|they are usually dark, because it is "hard" to get light into them. This is clearly an important component of the appearance of surfaces.
Reference: [17] <author> E. Land and J. </author> <title> McCann. </title> <journal> Lightness and retinex theory. J. Opt. Soc. Am., </journal> <volume> 61(1) </volume> <pages> 1-11, </pages> <year> 1971. </year>
Reference-contexts: This effect suggests that the widely established convention (e.g. <ref> [3, 14, 17] </ref>) of classifying effects in shading as due to reflectance if the spatial frequency is high ("edges") and the dynamic range is relatively low, and due to illumination otherwise, can be expanded.
Reference: [18] <author> M. Langer and S. Zucker. </author> <title> Shape-from-shading on a cloudy day. </title> <journal> Journal of the Optical Society of America A, </journal> <volume> 11(2) </volume> <pages> 467-78. </pages>
Reference-contexts: New models of shape from shading can be obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading <ref> [18, 19, 16] </ref>. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in [28, 21, 27, 29].
Reference: [19] <author> M. Langer and S. Zucker. </author> <title> Diffuse shading, visibility fields, and the geometry of ambient light. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <pages> pages 138-47, </pages> <year> 1993. </year>
Reference-contexts: New models of shape from shading can be obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading <ref> [18, 19, 16] </ref>. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in [28, 21, 27, 29].
Reference: [20] <author> D. Marr and K. Nishihara. </author> <title> Representation and recognition of the spatial organization of three-dimensional shapes. </title> <booktitle> Proc. </booktitle> <publisher> Royal Society, </publisher> <address> London, B-200:269-294, </address> <year> 1978. </year>
Reference-contexts: The classical approach to alleviating difficulties with abstraction is to view recognition in terms of assemblies of stylised primitives. In this view, which has been espoused in a variety of forms <ref> [1, 2, 20, 22] </ref>, objects are represented as assemblies of shapes taken from a collection of parametric families with "good" properties. A classical difficulty with this view of representation is that it is hard to know what the primitives should be.
Reference: [21] <author> S. Nayar, K. Ikeuchi, and T. Kanade. </author> <title> Shape from interreflections. </title> <journal> IJCV, </journal> <volume> 6(3) </volume> <pages> 173-195, </pages> <month> August </month> <year> 1991. </year>
Reference-contexts: obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading [18, 19, 16]. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in <ref> [28, 21, 27, 29] </ref>. A problem arises outside controlled environments, however, because there may be surfaces that are not visible, but radiate to the objects in view (so called "distant surfaces"). <p> We then used these analytically determined shading cross-sections to train a support vector classifier (the classifiers are described in [5]; other recent uses of this classifier in vision applications include <ref> [24, 21] </ref>). Passing the segment under test to the classifier then tells us whether the shading is consistent with that on a limb. The geometrical model of a limb is approximately cylindrical, with a few variations.
Reference: [22] <author> R. Nevatia and T. Binford. </author> <title> Description and recognition of complex curved objects. </title> <journal> Artificial Intelligence, </journal> <volume> 8 </volume> <pages> 77-98, </pages> <year> 1977. </year>
Reference-contexts: The classical approach to alleviating difficulties with abstraction is to view recognition in terms of assemblies of stylised primitives. In this view, which has been espoused in a variety of forms <ref> [1, 2, 20, 22] </ref>, objects are represented as assemblies of shapes taken from a collection of parametric families with "good" properties. A classical difficulty with this view of representation is that it is hard to know what the primitives should be.
Reference: [23] <author> M. Oren, C. Papageorgiou, P. Sinha, and E. Osuna. </author> <title> Pedestrian detection using wavelet templates. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <pages> pages 193-9, </pages> <year> 1997. </year>
Reference-contexts: It is the energy of this difference which we call the residual. For our classifier, we trained a support vector machine [5] using the projection onto principal components and the residual. In contrast to the use of SVMs in [24] and <ref> [23] </ref>, we culled our positive training data from the results of our theoretical shading model applied to the geometrical limb model. Negative training data consisted of randomly oriented lines selected from randomly chosen images. 4 and theoretical positive data.
Reference: [24] <author> E. Osuna, R. Freund, and F. Girosi. </author> <title> Training support vector machines: an application to face detection. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <pages> pages 130-6, </pages> <year> 1997. </year>
Reference-contexts: We then used these analytically determined shading cross-sections to train a support vector classifier (the classifiers are described in [5]; other recent uses of this classifier in vision applications include <ref> [24, 21] </ref>). Passing the segment under test to the classifier then tells us whether the shading is consistent with that on a limb. The geometrical model of a limb is approximately cylindrical, with a few variations. <p> It is the energy of this difference which we call the residual. For our classifier, we trained a support vector machine [5] using the projection onto principal components and the residual. In contrast to the use of SVMs in <ref> [24] </ref> and [23], we culled our positive training data from the results of our theoretical shading model applied to the geometrical limb model. Negative training data consisted of randomly oriented lines selected from randomly chosen images. 4 and theoretical positive data.
Reference: [25] <author> J. Shi and J. Malik. </author> <title> Normalized cuts and image segmentation. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <year> 1997. </year> <title> [26] unknown. Pose file 6. unknown, unknown. A collection of photographs of human models, annotated in Japanese. </title>
Reference-contexts: One measure of success for measurements of shading is that they reduce this number of symmetries, without removing assemblies that could represent limbs. Since we see a shading test as more likely to be helpful in understanding large image segments (obtained using, for example, Shi's <ref> [25] </ref> normalized cut method), rather than in segmentation itself, we can apply this test on images of isolated human figures. For each of 20 images showing human figures in quite complex poses, taken from [26], we measured the rate at which the shading test rejected symmetries without losing body segments.
Reference: [27] <author> T. Wada, H. Ukida, and T. </author> <title> Matsuyama. Shape from shading with interreflections under proximal light source-3d shape reconstruction of unfolded book surface from a scanner image. </title> <booktitle> In Int. Conf. on Computer Vision, </booktitle> <pages> pages 66-71, </pages> <year> 1995. </year>
Reference-contexts: obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading [18, 19, 16]. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in <ref> [28, 21, 27, 29] </ref>. A problem arises outside controlled environments, however, because there may be surfaces that are not visible, but radiate to the objects in view (so called "distant surfaces").
Reference: [28] <author> R. Woodham. </author> <title> Photometric method for determining surface orientation from multiple images. </title> <journal> Optical Engineering, </journal> <volume> 19(1) </volume> <pages> 139-44, </pages> <year> 1980. </year>
Reference-contexts: obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading [18, 19, 16]. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in <ref> [28, 21, 27, 29] </ref>. A problem arises outside controlled environments, however, because there may be surfaces that are not visible, but radiate to the objects in view (so called "distant surfaces").
Reference: [29] <author> J. Yang, N. Ohnishi, D. Zhang, and N. Sugie. </author> <title> Determining a polyhedral shape using interreflections. </title> <booktitle> In IEEE Conf. on Computer Vision and Pattern Recognition, </booktitle> <pages> pages 110-115, </pages> <year> 1997. </year> <month> 15 </month>
Reference-contexts: obtained by changing either the type of shape representation sought in the shading field [9], or the model of shading [18, 19, 16]. 1.1 Distant surfaces and their effects Very few techniques for extracting shape information from shading fields are robust to the effects of diffuse interreflections|some approaches appear in <ref> [28, 21, 27, 29] </ref>. A problem arises outside controlled environments, however, because there may be surfaces that are not visible, but radiate to the objects in view (so called "distant surfaces").
References-found: 28

