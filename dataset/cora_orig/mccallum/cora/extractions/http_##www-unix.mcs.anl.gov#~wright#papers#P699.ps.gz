URL: http://www-unix.mcs.anl.gov/~wright/papers/P699.ps.gz
Refering-URL: http://www.mcs.anl.gov/~wright/papers/
Root-URL: http://www.mcs.anl.gov
Title: MODIFYING SQP FOR DEGENERATE PROBLEMS  
Author: STEPHEN J. WRIGHT 
Affiliation: MATHEMATICS AND COMPUTER SCIENCE DIVISION, ARGONNE NATIONAL LABORATORY  
Date: OCTOBER 17, 1997, (LATEST REVISION NOVEMBER 9, 1997),  
Note: PREPRINT ANL/MCS-P699-1097,  AMS(MOS) subject classifications. 90C33, 90C30, 49M45  
Abstract: Most local convergence analyses of the sequential quadratic programming (SQP) algorithm for nonlinear programming make strong assumptions about the solution, namely, that the active constraint gradients are linearly independent and that no weakly active constraints exist. In this paper, we establish a framework for variants of SQP that retain the characteristic superlinear convergence rate even when these assumptions are relaxed, proving general convergence results and placing some recently proposed SQP variants in this framework. We discuss the reasons for which implementations of SQP often continue to exhibit good local convergence behavior even when the assumptions commonly made in the analysis are violated. Finally, we describe a new algorithm that formalizes and extends standard SQP implementation techniques, and we prove convergence results for this method also. 1. Introduction. We investigate local convergence properties of variants of the 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D. P. Bertsekas, </author> <title> Nonlinear Programming, </title> <publisher> Athena Scientific, </publisher> <address> Belmont, Mass., </address> <year> 1995. </year>
Reference-contexts: for all w such that rg i (z fl ) T w = 0; for all i 2 B + ( fl ):(17) Any of these conditions, in tandem with Assumption 1, is sufficient to guarantee that z fl is a strict local solution of (1) (see, for instance, Bertsekas <ref> [1, Proposition 3.3.2, Exercise 3.7] </ref>). The following lemma relates these three conditions with the WCC and SC conditions of Section 2.
Reference: [2] <author> F. Facchinei, A. Fischer, and C. Kanzow, </author> <title> On the accurate identification of active constraints, </title> <type> DIS Technical Report 22.96, </type> <institution> Universita' di Roma "La Sapienza", </institution> <year> 1996. </year>
Reference-contexts: The estimate (52) was proposed by several other authors independently of this paper. Facchinei, Fischer, and Kanzow propose the same estimate in a revised version of their paper <ref> [2] </ref>. Hager and Gowda [7, Theorem 1, Theorem 3] propose a more general measure, which reduces to (52) when 0 and does not require the MFCQ condition to hold. MODIFYING SQP FOR DEGENERATE PROBLEMS 25
Reference: [3] <author> A. Fischer, </author> <title> Modified Wilson method for nonlinear programs with nonunique multipliers, </title> <type> Technical Report MATH-NM-04-1997, </type> <institution> Technische Universitat Dresden, Institute of Numerical Mathematics, Technische Universitat Dresden, </institution> <address> D-01062, Dresden, Germany, </address> <month> February </month> <year> 1997. </year>
Reference-contexts: Motivated by this observation and by the fact that primal-dual interior-point algorithms for related problems converge superlinearly under the conditions just described [14, 11], we proposed a stabilized SQP (sSQP) method [13] and proved a local superlinear convergence result, later enhanced by Hager [6]. Independently, Fischer <ref> [3] </ref> proposed an algorithm in which a special procedure for choosing the Lagrange multiplier estimate is inserted between iterations of SQP. He proved superlinear convergence under slightly different assumptions from ours. Our purposes in this paper are twofold. <p> The strict complementarity (SC) condition (which we use only sparingly in this paper) is that B 0 = ;:(7) At some points in the paper, we use a condition that Fischer <ref> [3] </ref> calls weak com plementarity (WCC), namely that range [rg i (z fl )] i2B + ( fl ) = range [rg i (z fl )] i2B + ; for all fl 2 S :(8) Despite its name, WCC is not weaker than SC; neither condition implies the other. <p> It is similar to Lemma 3.12 of Fischer <ref> [3] </ref>, though the latter result assumes WCC (8), which is not needed below.) Theorem 5.2. Suppose that Assumption 1, Condition 2s.1, and MFCQ hold. <p> Fischer's Method. Fischer's method, as described in the paper <ref> [3] </ref>, generates steps z in the primal variables by solving a standard SQP subproblem. The Lagrange multiplier estimate obtained from this subproblem is then discarded, and an auxiliary subproblem of similar complexity to the SQP subproblem is then solved to obtain the new multiplier estimate. <p> The Lagrange multiplier estimate obtained from this subproblem is then discarded, and an auxiliary subproblem of similar complexity to the SQP subproblem is then solved to obtain the new multiplier estimate. Superlinear convergence of the resulting algorithm is proved in <ref> [3] </ref>, under assumptions that we discuss later. Fischer's method can be described in terms of the iSQP framework of Section 4 as analyzed in Section 5. <p> MODIFYING SQP FOR DEGENERATE PROBLEMS 15 Note that in the auxiliary problem (58), (d; ^ ) is the primal-dual solution of the problem min 1 d T d + d T rOE (z); subject to rg (z) T d + g (z) 0 (see Fischer <ref> [3, p. 13] </ref>). More tellingly, we can view (58) as a perturbation of the problem rg (z fl ) T d + g (z fl ) 2 0 in which z has been replaced by z fl . <p> Fischer <ref> [3, Theorem 3.13] </ref> shows that under certain assumptions (discussed below), the primal component z for the solution of (59) is also the solution of the following iSQP subproblem: g (z) + rg (z) T z + r 2 0 where the perturbation vectors t and r and the multiplier estimates ~ <p> Quadratic convergence of the primal-dual iterates follows immediately from (61). Note that the multipliers ~ + are never calculated explicitly by the algorithm. The assumptions needed to prove Theorem 3.13 in <ref> [3] </ref> include the WCC condition (8), the MFCQ condition (9), the second-order sufficient Condition 2s.1, and the following constant-rank condition: rg B + (z) has constant rank for all z near z fl .(65) The need to solve the auxiliary subproblem (58) at every iteration is a disadvantage of Fischer's approach. <p> Therefore by Lemma 3.2, we have B k 2 . Note that the constant-rank condition assumed here is stronger than the corre sponding condition (65) used by Fischer <ref> [3] </ref>. Acknowledgments. I thank Michael Wagner and Mihai Anitescu for many interesting discussions on this topic. Thanks also to Michael for for carrying out nu merical experiments during his summer at Argonne. A. Estimating the Distance to the Optimal Set.
Reference: [4] <author> J. Gauvin, </author> <title> A necessary and sufficient regularity condition to have bounded multipliers in nonconvex programming, </title> <journal> Mathematical Programming, </journal> <volume> 12 (1977), </volume> <pages> pp. 136-138. </pages>
Reference-contexts: The following result concerning boundedness of the optimal multiplier set S is used often in the analysis of later sections. Lemma 2.1. (Gauvin <ref> [4] </ref>) Suppose that Assumption 1 holds. Then S is bounded if and only if the MFCQ (9) is satisfied. 4 STEPHEN J. WRIGHT Since S is defined by the linear conditions rOE (z fl ) + rg (z fl ) fl and fl 0, it is closed and convex.
Reference: [5] <author> P. E. Gill, W. Murray, and M. Saunders, SNOPT: </author> <title> An SQP algorithms for large-scale constrained optimization, </title> <type> Report NA 97-2, </type> <institution> Department of Mathematics, University of Cal-ifornia, </institution> <address> San Diego, </address> <year> 1997. </year>
Reference-contexts: We prove general convergence results for methods in the iSQP framework, highlighting the effect on the convergence rate of changes between successive Lagrange multiplier estimates. Our second goal requires a little more explanation. It arises from the observation that existing implementations of SQP (for example, SNOPT <ref> [5] </ref>) often continue to exhibit good local convergence behavior even on degenerate problems.
Reference: [6] <author> W. W. Hager, </author> <title> Convergence of Wright's stabilized SQP algorithm, </title> <type> Technical Report, </type> <institution> Department of Mathematics, University of Florida, </institution> <address> Gainesville, Fl., </address> <month> January </month> <year> 1997. </year>
Reference-contexts: Motivated by this observation and by the fact that primal-dual interior-point algorithms for related problems converge superlinearly under the conditions just described [14, 11], we proposed a stabilized SQP (sSQP) method [13] and proved a local superlinear convergence result, later enhanced by Hager <ref> [6] </ref>. Independently, Fischer [3] proposed an algorithm in which a special procedure for choosing the Lagrange multiplier estimate is inserted between iterations of SQP. He proved superlinear convergence under slightly different assumptions from ours. Our purposes in this paper are twofold. <p> The second result (42) also is immediate if we observe that the term containing + vanishes from ~ t when g () is linear. 6. Stabilized SQP. The stabilized SQP (sSQP) method described by Wright [13] and Hager <ref> [6] </ref> is known to converge superlinearly. We show here that this method can be placed in the iSQP framework and that the superlinear convergence result therefore can be derived from Theorem 5.3. The sSQP algorithm is derived by applying proximal point ideas to the SQP subproblem (22). <p> The following result is a simple consequence of Hager's result <ref> [6, Theorem 1] </ref>. Theorem 6.1. Suppose that Assumption 1, Condition 2s.3, and the MFCQ condition hold. <p> Moreover the choice (53) ensures that we have oe 0 ffi (z; ) oe 1 ; for ffi (z; ) sufficiently small, where oe 0 and oe 1 are constants defined in Theorem 1 of Hager <ref> [6] </ref>, with oe 0 "sufficiently large." By applying Hager's result, we find that there is a neighborhood U ( fl ) of (z fl ; fl ) such that if (z; ) 2 U ( fl ), then the sSQP subproblem (48) yields a solution in U ( fl ) such <p> WRIGHT For the remaining components, of + , we have + i = 0, i =2 ~ B. From Hager <ref> [6, eq. (15)] </ref>, we have that k + k = O (ffi (z; )):(56) Therefore if we define (t; r) as in (51), we have from (52), (53), and (56) that (t; r) = O (ffi (z; ) 1+o ):(57) By substituting (56) and (57) into (41), we obtain ffi (z
Reference: [7] <author> W. W. Hager and M. S. Gowda, </author> <title> Stability in the presence of degeneracy and error estimation, </title> <type> Technical Report, </type> <institution> Department of Mathematics, University of Florida, </institution> <month> November </month> <year> 1997. </year>
Reference-contexts: The estimate (52) was proposed by several other authors independently of this paper. Facchinei, Fischer, and Kanzow propose the same estimate in a revised version of their paper [2]. Hager and Gowda <ref> [7, Theorem 1, Theorem 3] </ref> propose a more general measure, which reduces to (52) when 0 and does not require the MFCQ condition to hold. MODIFYING SQP FOR DEGENERATE PROBLEMS 25
Reference: [8] <author> A. J. Hoffman, </author> <title> On approximate solutions of systems of linear inequalities, </title> <journal> Journal of Research of the National Bureau of Standards, </journal> <volume> 49 (1952), </volume> <pages> pp. 263-265. </pages>
Reference-contexts: Hence, by Hoffman's lemma <ref> [8] </ref> and uniqueness of fl , we find that there is a number fi ( ~ B) such that k fl P ()k fi ( ~ B) fl fl fl : MODIFYING SQP FOR DEGENERATE PROBLEMS 19 By choosing fi = max fi ( ~ B) + 1; combining this expression
Reference: [9] <author> R. Janin, </author> <title> Directional derivative of the marginal function in nonlinear programming, Mathematical Programming Study, </title> <booktitle> (1984), </booktitle> <pages> pp. 110-126. </pages>
Reference-contexts: Corollary 8.4. Suppose that Assumption 1, Condition 2s.3, and MFCQ are satisfied and that the CRCQ condition of Janin <ref> [9] </ref> holds; that is, there is an open neighborhood of z fl such that for any subset ^ B of B, the matrix [rg i (z)] i2 ^ B has constant rank for all z in this neighborhood.
Reference: [10] <author> O. L. Mangasarian and S. Fromovitz, </author> <title> The Fritz-John necessary optimality conditions in the presence of equality and inequality constraints, </title> <journal> Journal of Mathematical Analysis and Applications, </journal> <volume> 17 (1967), </volume> <pages> pp. 37-47. </pages>
Reference-contexts: We assume throughout that the Mangasarian-Fromovitz constraint qualification (MFCQ) holds at z fl <ref> [10] </ref>. That is, rg B (z fl ) T y &lt; 0 for some y 2 IR n ;(9) where rg B () is the n fi jBj Jacobian matrix for g B (). The general smoothness and first-order assumption that we make throughout the paper is as follows.
Reference: [11] <author> D. Ralph and S. J. Wright, </author> <title> Superlinear convergence of an interior-point method despite dependent constraints, </title> <type> Preprint ANL.MCS-P622-1196, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, Ill., </institution> <month> November </month> <year> 1996. </year>
Reference-contexts: Motivated by this observation and by the fact that primal-dual interior-point algorithms for related problems converge superlinearly under the conditions just described <ref> [14, 11] </ref>, we proposed a stabilized SQP (sSQP) method [13] and proved a local superlinear convergence result, later enhanced by Hager [6]. Independently, Fischer [3] proposed an algorithm in which a special procedure for choosing the Lagrange multiplier estimate is inserted between iterations of SQP.
Reference: [12] <author> S. M. Robinson, </author> <title> Generalized equations and their solutions. part II: Applications to nonlinear programming, Mathematical Programming Study, </title> <booktitle> 19 (1982), </booktitle> <pages> pp. 200-221. </pages>
Reference-contexts: Superlinear Convergence. In this section, we describe the improvement obtained in a single iSQP step (24), (25) (alternatively, (25), (26)). First, we apply a result of Robinson <ref> [12] </ref> to show that small-norm local solutions z exist for the inexact subproblem (24) provided that (z; ) is sufficiently close to the solution set S. <p> In particular, Theorem 5.3 demonstrates that superlinear convergence of the primal iterate depends critically on stability of the Lagrange multiplier estimates: must not change too much from one iteration to the next. The first result is obtained by applying Robinson's stability results <ref> [12, Theorem 3.1, Corollary 4.3] </ref> to the inexact SQP subproblem (24). Lemma 5.1. Suppose that Assumption 1, Condition 2s.1, and MFCQ hold. <p> We now consider the problem (24), in which z fl has been replaced by z and the perturbation terms t and r have been introduced. From Robinson <ref> [12, Theorem 3.1] </ref>, the problem (24) has at least one solution (z; + ) if these perturbations are sufficiently small. Moreover, from Robinson [12, Corollary 4.3], the distance from all such solutions to the solution set for (29) is bounded by a multiple of the norm of the perturbations. <p> From Robinson [12, Theorem 3.1], the problem (24) has at least one solution (z; + ) if these perturbations are sufficiently small. Moreover, from Robinson <ref> [12, Corollary 4.3] </ref>, the distance from all such solutions to the solution set for (29) is bounded by a multiple of the norm of the perturbations. <p> We can again apply Robinson's perturbation result <ref> [12, Corollary 4.3] </ref> to relate the solutions of (39) and (40) and thereby obtain the estimate ke T (z k + z k ) e (z k + z k )k = O (k~r k Since e N () = e () e T (), the result (31) follows immediately. <p> Viewing (43) as a perturbed version of (4), we can apply Theorem 4.3 of Robinson <ref> [12] </ref> to deduce that ffi (z + z; + ) = O (k ( ~ t; ~r)k):(45) By using the assumed smoothness of OE and g, boundedness of the sets containing and + , and the estimate (27), we obtain ~ t = r 2 OE (z)z + i=1 [rg (z <p> Noting that the solution set for (60) is (d; ^ ) 2 0 fi S , we can again apply Robinson's results from <ref> [12] </ref> (and in particular [12, Corollary 4.3]) to obtain the estimate kdk + ffi ( ^ ) = O (ffi (z));(61) for all solutions (d; ^ ) of (58). <p> Noting that the solution set for (60) is (d; ^ ) 2 0 fi S , we can again apply Robinson's results from [12] (and in particular <ref> [12, Corollary 4.3] </ref>) to obtain the estimate kdk + ffi ( ^ ) = O (ffi (z));(61) for all solutions (d; ^ ) of (58). <p> The more difficult part of the proof is to show that ffi (z; ) = O (j (z; )). Our main theoretical tool is again Theorem 4.2 of Robinson <ref> [12] </ref>. <p> Hence, (z; !) is the solution of a slightly perturbed nonlinear program, where the size of the perturbation is uniformly small for (z; ) near S, so we can apply Theorem 4.2 of Robinson <ref> [12] </ref>.
Reference: [13] <author> S. J. Wright, </author> <title> Superlinear convergence of a stabilized SQP method to a degenerate solution, </title> <type> Preprint ANL/MCS-P643-0297, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, Ill., </institution> <month> February </month> <year> 1997. </year> <note> To appear in Computational Optimization and Applications. </note>
Reference-contexts: We are interested in degenerate problems: those for which the active constraint gradients at the solution are linearly dependent and/or the strict complementarity condition fails to hold. We showed in <ref> [13] </ref> that even when strict complementarity and second-order sufficient conditions and a constraint qualification hold, nonuniqueness of the optimal multiplier can produce nonsuperlinear behavior of SQP. <p> Motivated by this observation and by the fact that primal-dual interior-point algorithms for related problems converge superlinearly under the conditions just described [14, 11], we proposed a stabilized SQP (sSQP) method <ref> [13] </ref> and proved a local superlinear convergence result, later enhanced by Hager [6]. Independently, Fischer [3] proposed an algorithm in which a special procedure for choosing the Lagrange multiplier estimate is inserted between iterations of SQP. He proved superlinear convergence under slightly different assumptions from ours. <p> This fact is somewhat surprising, given that these problems fail to satisfy the standard assumptions made in local convergence analyses and that theoretical examples of poor convergence behavior are easy to construct (see the example in Wright <ref> [13] </ref>). We are fl Mathematics and Computer Science Division, Argonne National Laboratory, 9700 South Cass Avenue, Argonne, Illinois 60439, U.S.A. This work was supported by the Mathematical, Information, and Computational Sciences Division subprogram of the Office of Computational and Technology Research, U.S. <p> result shows that while the iSQP step may not give a "superlinear" decrease in distance to the solution set, it does reduce the error substantially in the e N () component of the primal error vector. (This result explains an observation made while doing computational experiments for an earlier paper <ref> [13] </ref>. It is similar to Lemma 3.12 of Fischer [3], though the latter result assumes WCC (8), which is not needed below.) Theorem 5.2. Suppose that Assumption 1, Condition 2s.1, and MFCQ hold. <p> The second result (42) also is immediate if we observe that the term containing + vanishes from ~ t when g () is linear. 6. Stabilized SQP. The stabilized SQP (sSQP) method described by Wright <ref> [13] </ref> and Hager [6] is known to converge superlinearly. We show here that this method can be placed in the iSQP framework and that the superlinear convergence result therefore can be derived from Theorem 5.3. The sSQP algorithm is derived by applying proximal point ideas to the SQP subproblem (22). <p> Hence, the convergence rate of sSQP can be derived by placing it in the framework of iSQP. In Wright <ref> [13] </ref>, it was shown that if the initial estimate 0 is not too close to the boundary of S (in the sense that 0 i for some &gt; 0 and all i 2 B), then all steps are obtained from a system of the form (55) with ~ B = B.
Reference: [14] <author> S. J. Wright and D. Ralph, </author> <title> A superlinear infeasible-interior-point algorithm for monotone nonlinear complementarity problems, </title> <journal> Mathematics of Operations Research, </journal> <volume> 21 (1996), </volume> <pages> pp. 815-838. </pages>
Reference-contexts: Motivated by this observation and by the fact that primal-dual interior-point algorithms for related problems converge superlinearly under the conditions just described <ref> [14, 11] </ref>, we proposed a stabilized SQP (sSQP) method [13] and proved a local superlinear convergence result, later enhanced by Hager [6]. Independently, Fischer [3] proposed an algorithm in which a special procedure for choosing the Lagrange multiplier estimate is inserted between iterations of SQP.
References-found: 14

