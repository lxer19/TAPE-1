URL: http://www-graphics.stanford.edu/papers/non-symmetric/gamma-fixed/paper.ps
Refering-URL: http://www-graphics.stanford.edu/papers/non-symmetric/gamma-fixed/
Root-URL: http://www.cs.stanford.edu
Title: Non-symmetric Scattering in Light Transport Algorithms  
Author: Eric Veach 
Affiliation: Computer Science Department, Stanford University  
Abstract: Non-symmetric scattering is far more common in computer graphics than is generally recognized, and can occur even when the underlying scattering model is physically correct. For example, we show that non-symmetry occurs whenever light is refracted, and also whenever shading normals are used (e.g. due to interpolation of normals in a triangle mesh, or bump mapping [5]). We examine the implications of non-symmetric scattering for light transport theory. We extend the work of Arvo et al. [4] into a complete framework for light, importance, and particle transport with non-symmetric kernels. We show that physically valid scattering models are not always symmetric, and derive the condition for arbitrary models to obey Helmholtz reciprocity. By rewriting the transport operators in terms of optical invariants, we obtain a new framework where symmetry and reciprocity are the same. We also consider the practical consequences for global illumination algorithms. The problem is that many implementations indirectly assume symmetry, by using the same scattering rules for light and importance, or particles and viewing rays. This can lead to incorrect results for physically valid models. It can also cause different rendering algorithms to converge to different solutions (whether the model is physically valid or not), and it can cause shading artifacts. If the non-symmetry is recognized and handled correctly, these problems can easily be avoided.
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> AL-GWAIZ, M. A. </author> <title> Theory of Distributions. </title> <publisher> Marcel Dekker, Inc., </publisher> <address> New York, </address> <year> 1992. </year>
Reference: [2] <author> AMBARTZUMIAN, R. V. </author> <title> Factorization Calculus and Geometric Probability. </title> <publisher> Cambridge University Press, </publisher> <year> 1990. </year>
Reference-contexts: Formally, it can be defined as a composition of Lebesgue measures on fibers, where the fibers of R are sets of rays with the same origin x (similar to <ref> [2, p.11] </ref>). This measure is invariant under Euclidean transformations, which makes it unique up to a constant factor [2, p.51]. 3 The r in f r is usually assumed to be a label, denoting reflectance. <p> Formally, it can be defined as a composition of Lebesgue measures on fibers, where the fibers of R are sets of rays with the same origin x (similar to [2, p.11]). This measure is invariant under Euclidean transformations, which makes it unique up to a constant factor <ref> [2, p.51] </ref>. 3 The r in f r is usually assumed to be a label, denoting reflectance. However, Nicodemus et al. [27] derive the BRDF from the more general BSSRDF, which allows light to strike and leave the surface at different points (e.g. due to sub-surface scattering).
Reference: [3] <author> ARVO, J. </author> <title> Analytic Methods for Simulated Light Transport. </title> <type> PhD thesis, </type> <institution> Yale University, </institution> <month> Dec. </month> <year> 1995. </year> <title> 20 Note that when shading normals are used on a refractive interface, the results of both Sec. 3.1 and Sec. 3.2 apply. Thus radiance is scaled by ( t = i ) 2 , while particle weights are scaled by j! t N s j j! i N g j = j! t N g j j! i N s j, where particles go from ! t to ! i . 15 </title>
Reference-contexts: Arvo handles this with an isomorphism H between surface and field functions, such that HG and KH are equivalent to the G and K defined above <ref> [3, p.151] </ref>. 6 The GRDF described by Eric Lafortune [19] is simply the kernel of S. <p> To do this, we must evaluate (GS) fl . It is straightforward to show that G fl = G, i.e. G is self-adjoint <ref> [3, p.152] </ref>. Similarly, K is self-adjoint if we assume that the BSDF is symmetric [3]. Using standard identities, this implies that GS is self-adjoint as well. <p> To do this, we must evaluate (GS) fl . It is straightforward to show that G fl = G, i.e. G is self-adjoint [3, p.152]. Similarly, K is self-adjoint if we assume that the BSDF is symmetric <ref> [3] </ref>. Using standard identities, this implies that GS is self-adjoint as well.
Reference: [4] <author> ARVO, J., TORRANCE, K., AND SMITS, B. </author> <title> A framework for the analysis of error in global illumination algorithms. </title> <booktitle> In Proceedings of SIGGRAPH '94 (July 1994), </booktitle> <publisher> ACM Press, </publisher> <pages> pp. 75-84. </pages>
Reference-contexts: However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. <ref> [4] </ref>, Christensen et al. [7], and Pattanaik and Mudur [28]. Our approach is new in several ways. Due to the absence of symmetry assumptions, our framework has a richer structure: for each of the four basic transport quantities (exitant/incident radiance/importance), there is a distinct transport operator and measurement equation. <p> Previously he used the term bidirectional dis tribution function (BDF) [15], but this sounds more like a category (containing the B*DF's as members). 3 Following <ref> [4] </ref>, we define light transport in terms of operators acting on radiance functions. We distinguish between incident radiance functions L i (x; !), which give the radiance arriving at x from direction !, and exitant radiance functions L o (x; !), which measure the radiance leaving x in direction !. <p> It is defined by (GL)(x; ! i ) = L (x M (x; ! i ); ! i ) ; where x M (x; !) is the first point of M visible from x in direction !. The field radiance of <ref> [4] </ref> is related to incident radiance by L f (x; !) = L i (x; !) ; so the direction of ! i is reversed (compared to [4]) in the equations above. <p> The field radiance of <ref> [4] </ref> is related to incident radiance by L f (x; !) = L i (x; !) ; so the direction of ! i is reversed (compared to [4]) in the equations above. This has two advantages: G and K become self-adjoint (when f s is symmetric), 5 and ! i and ! o both point outward for reflective surfaces (as assumed by most BRDF formulas). <p> By inverting this operator equation, we obtain the formal solution L = SL e , where S = (I T) is called the solution operator. 6 The solution exists and is unique provided that kT k k &lt; 1 for some k 1. 5 The G and K of <ref> [4] </ref> are not self-adjoint. Arvo handles this with an isomorphism H between surface and field functions, such that HG and KH are equivalent to the G and K defined above [3, p.151]. 6 The GRDF described by Eric Lafortune [19] is simply the kernel of S.
Reference: [5] <author> BLINN, J. F. </author> <title> Simulation of wrinkled surfaces. </title> <booktitle> In Computer Graphics (SIG-GRAPH '78 Proceedings) (Aug. 1978), </booktitle> <volume> vol. 12, </volume> <pages> pp. 286-292. </pages>
Reference: [6] <author> CHANDRASEKAR, S. </author> <title> Radiative Transfer. </title> <publisher> Dover Publications, </publisher> <address> New York, </address> <year> 1960. </year>
Reference-contexts: states that if we follow a beam of light on any path through an optical system, the loss in intensity 12 is the same as for a beam traveling in the reverse direction. 13 With respect the symmetry of BRDF's, an observation of Lord Rayleigh is actually more relevant (cf. <ref> [6, p.177] </ref>). Consider a small reflective surface, exposed to a small light source and a small irradiance detector. His reciprocity principle states that if the positions of the source and detector are exchanged, the reflected irradi-ance measured by the sensor will be the same.
Reference: [7] <author> CHRISTENSEN, P. H., SALESIN, D. H., AND DEROSE, T. D. </author> <title> A continuous adjoint formulation for radiance transport. </title> <booktitle> In Fourth Eurographics Workshop on Rendering (Paris, </booktitle> <month> June </month> <year> 1993), </year> <pages> pp. 95-104. </pages>
Reference-contexts: However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. [4], Christensen et al. <ref> [7] </ref>, and Pattanaik and Mudur [28]. Our approach is new in several ways. Due to the absence of symmetry assumptions, our framework has a richer structure: for each of the four basic transport quantities (exitant/incident radiance/importance), there is a distinct transport operator and measurement equation. <p> We have defined both L e and W e as exitant quantities. This is natural, since it lets us define their values at points on the source or sensor (unlike the visual potential of [28]), and it reveals many similarities between light and importance transport <ref> [7] </ref>. The equilibrium solution L = SL e is also an exitant quantity. However, the measurement equation (4) requires an incident function.
Reference: [8] <author> CHRISTENSEN, P. H., STOLLNITZ, E. J., SALESIN, D. H., AND DEROSE, T. D. </author> <title> Global illumination of glossy environments using wavelets and importance. </title> <journal> ACM Trans. Graphics 15 (1996), </journal> <pages> 37-71. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches <ref> [33, 30, 8] </ref>, particle tracing algorithms [15, 28, 31], and bidirectional path-tracing [18, 37, 38].
Reference: [9] <author> COHEN, M. F., AND WALLACE, J. R. </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press Professional, </publisher> <address> San Diego, CA, </address> <year> 1993. </year>
Reference-contexts: This allows us to define the inner product of two functions on R, hf; gi = R The measure is called throughput <ref> [35, 25, 9] </ref>, and is defined 2 by d (r) = d (x; !) = dA (x) d x (!) ; (2) where A is the area measure on M, and ? x is the projected solid angle measure on S 2 [25, p.70]. <p> s (! i ! ! o ) = dL (! o ) = dE (! i ) ; so that f s (! i ! ! o ) is the observed radiance leaving in direction ! o , per unit of irradiance arriving from direction ! i (see [27, p.5], <ref> [9, p.28] </ref>). 2 The measure is similar to the usual geometric measure on lines in IR 3 . Formally, it can be defined as a composition of Lebesgue measures on fibers, where the fibers of R are sets of rays with the same origin x (similar to [2, p.11]). <p> This is very different than radiance sampling, where the samples are distributed according to j! i N s j. As another example, consider a perfect mirror, whose BRDF is a delta function ([27, p.44], <ref> [9, p.31] </ref>).
Reference: [10] <author> DELVES, L. M., AND MOHAMED, J. L. </author> <title> Computational Methods for Integral Equations. </title> <publisher> Cambridge University Press, </publisher> <address> New York, </address> <year> 1985. </year>
Reference-contexts: Note that S is closely related to the resolvent operator R used in spectral analysis, except that R has a parameter , and does not have a universally accepted definition (e.g. compare <ref> [10, p.74] </ref>, [36, p.272]). 4 2.3 Sensors and measurements Global illumination algorithms compute a finite number of measurements of the solution L. Each measurement is expressed as the response of a hypothetical sensor, e.g. a small area of film within a virtual camera.
Reference: [11] <author> DRUDE, P. </author> <title> The Theory of Optics. </title> <publisher> Dover Publications, </publisher> <address> New York, </address> <year> 1959. </year> <note> Original date of publication 1900. Translated from the German by C. </note> <author> R. Mann and R. A. </author> <month> Millikan. </month>
Reference-contexts: His reciprocity principle states that if the positions of the source and detector are exchanged, the reflected irradi-ance measured by the sensor will be the same. This implies the symmetry of the corresponding BRDF. Many reciprocity relationships, including these, can be derived from thermodynamic principles (e.g. [32, p.65], <ref> [11, p.505] </ref>). Such arguments consider an isothermal, black enclosure containing an arbitrary test surface (reflective or transmissive). <p> Interestingly, Helmholtz did not provide a proof of his principle, because anybody who is at all familiar with the laws of optics can easily prove it for himself [40, p.231]. 14 The dependence of blackbody radiation on 2 is often falsely attributed to Clausius (cf. <ref> [11, p.504] </ref>). 3.1.2 Perfect specular refraction. We show how these principles apply in the case of perfect specular refraction, where the interface between media is optically smooth.
Reference: [12] <author> FOURNIER, A. </author> <title> From local to global illumination and back. In Rendering Techniques `95 (New York, 1995), </title> <editor> P. M. Hanrahan and W. Purgathofer, Eds., </editor> <publisher> Springer-Verlag, </publisher> <pages> pp. 127-136. </pages>
Reference-contexts: Just before the definition of the BRDF, r is used to denote the distance between these points, so that the r in f r could be a parameter (whose value is usually zero in computer graphics). This has been interpreted both ways (e.g. <ref> [12] </ref>, [13, p.665], [13, p.722]). In his other writings, however, Nicodemus uses r only as a label [24, 23, 22]. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28].
Reference: [13] <author> GLASSNER, A. </author> <title> Principles of Digital Image Synthesis. </title> <publisher> Morgan Kaufmann, </publisher> <address> New York, </address> <year> 1995. </year>
Reference-contexts: Just before the definition of the BRDF, r is used to denote the distance between these points, so that the r in f r could be a parameter (whose value is usually zero in computer graphics). This has been interpreted both ways (e.g. [12], <ref> [13, p.665] </ref>, [13, p.722]). In his other writings, however, Nicodemus uses r only as a label [24, 23, 22]. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28]. <p> Just before the definition of the BRDF, r is used to denote the distance between these points, so that the r in f r could be a parameter (whose value is usually zero in computer graphics). This has been interpreted both ways (e.g. [12], [13, p.665], <ref> [13, p.722] </ref>). In his other writings, however, Nicodemus uses r only as a label [24, 23, 22]. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28].
Reference: [14] <author> HALL, R. </author> <title> Illumination and Color in Computer Generated Imagery. </title> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1989. </year>
Reference-contexts: Thus radiance must increase, by conservation of energy. In fact, the incident and transmitted radiance are related by L i = 2 t : (9) This can be shown using Snell's law (e.g. see [21], <ref> [14, p.30] </ref>). These arguments first prove a relationship between the throughputs of the incident and transmitted beams: i d (r i ) = t d (r t ) ; (10) where is the throughput measure (2). <p> Hall <ref> [14] </ref> pointed out the ( t = i ) 2 scaling for radiance, but many ray tracers ignore this. We are not aware of any system that implements different rules for radiance and importance/light particles.
Reference: [15] <author> HECKBERT, P. S. </author> <title> Adaptive radiosity textures for bidirectional ray tracing. </title> <booktitle> Computer Graphics 24, </booktitle> <month> 4 (July </month> <year> 1990), </year> <pages> 145-154. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms <ref> [15, 28, 31] </ref>, and bidirectional path-tracing [18, 37, 38]. <p> These ambiguities can be avoided by using different typefaces for labels and parameters (Roman vs. italics), as we do in this paper. 4 This name was introduced by Heckbert [16, p.26]. Previously he used the term bidirectional dis tribution function (BDF) <ref> [15] </ref>, but this sounds more like a category (containing the B*DF's as members). 3 Following [4], we define light transport in terms of operators acting on radiance functions.
Reference: [16] <author> HECKBERT, P. S. </author> <title> Simulating Global Illumination Using Adaptive Meshing. </title> <type> PhD thesis, </type> <institution> University of California, Berkeley, </institution> <month> June </month> <year> 1991. </year> <month> 16 </month>
Reference-contexts: These ambiguities can be avoided by using different typefaces for labels and parameters (Roman vs. italics), as we do in this paper. 4 This name was introduced by Heckbert <ref> [16, p.26] </ref>. Previously he used the term bidirectional dis tribution function (BDF) [15], but this sounds more like a category (containing the B*DF's as members). 3 Following [4], we define light transport in terms of operators acting on radiance functions.
Reference: [17] <author> KEITZ, H. A. E. </author> <title> Light Calculations and Measurements. </title> <publisher> The Macmillan Company, </publisher> <address> New York, </address> <year> 1971. </year>
Reference-contexts: To simplify things, we will assume that the beam follows a single path (no partial reflection, etc.) and that there are no losses due to absorption. The first quantity is L= 2 , which Nicodemus calls basic radiance [21] [25, p.29]. Its invariance is known as Abbe's law <ref> [17, p.195] </ref>, or radiance invariance [25, p.26]. 17 From this fact and conservation of energy, we can also show the invariance of 2 d. This quantity is known as basic throughput [25, p.37], or etendue [35]. 18 3.1.4 An invariant transport framework.
Reference: [18] <author> LAFORTUNE, E. P., AND WILLEMS, Y. D. </author> <title> Bi-directional path tracing. </title> <booktitle> In Proceedings of CompuGraphics (Alvor, </booktitle> <address> Portugal, </address> <month> Dec. </month> <year> 1993), </year> <pages> pp. 145-153. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms [15, 28, 31], and bidirectional path-tracing <ref> [18, 37, 38] </ref>. However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. [4], Christensen et al. [7], and Pattanaik and Mudur [28].
Reference: [19] <author> LAFORTUNE, E. P., AND WILLEMS, Y. D. </author> <title> A theoretical framework for physically based rendering. </title> <booktitle> Computer Graphics Forum 13, </booktitle> <month> 2 (June </month> <year> 1994), </year> <pages> 97-107. </pages>
Reference-contexts: Arvo handles this with an isomorphism H between surface and field functions, such that HG and KH are equivalent to the G and K defined above [3, p.151]. 6 The GRDF described by Eric Lafortune <ref> [19] </ref> is simply the kernel of S.
Reference: [20] <author> LEWINS, J. </author> <title> Importance, The Adjoint Function: The Physical Basis of Variational and Perturbation Theory in Transport and Diffusion Problems. </title> <publisher> Perga-mon Press, </publisher> <address> New York, </address> <year> 1965. </year>
Reference-contexts: The adjoint of an operator H is denoted H fl , and is defined by the property that hH fl f; gi = hf; Hgi 7 We follow the terminology of <ref> [20, p.7, p.21] </ref>, where an importance function pertains to a single meter reading (measurement). Since the average of several measurements is itself a measurement, importance functions may correspond to a set of measurements (e.g. all pixels in an image).
Reference: [21] <author> NICODEMUS, F. E. </author> <title> Radiance. </title> <journal> Am. J. Phys. </journal> <volume> 31 (1963), </volume> <pages> 368-377. </pages>
Reference-contexts: Thus radiance must increase, by conservation of energy. In fact, the incident and transmitted radiance are related by L i = 2 t : (9) This can be shown using Snell's law (e.g. see <ref> [21] </ref>, [14, p.30]). These arguments first prove a relationship between the throughputs of the incident and transmitted beams: i d (r i ) = t d (r t ) ; (10) where is the throughput measure (2). <p> To simplify things, we will assume that the beam follows a single path (no partial reflection, etc.) and that there are no losses due to absorption. The first quantity is L= 2 , which Nicodemus calls basic radiance <ref> [21] </ref> [25, p.29]. Its invariance is known as Abbe's law [17, p.195], or radiance invariance [25, p.26]. 17 From this fact and conservation of energy, we can also show the invariance of 2 d.
Reference: [22] <author> NICODEMUS, F. E. </author> <title> Directional reflectance and emissivity of an opaque surface. </title> <booktitle> Applied Optics 4 (1965), </booktitle> <pages> 767-773. </pages>
Reference-contexts: This has been interpreted both ways (e.g. [12], [13, p.665], [13, p.722]). In his other writings, however, Nicodemus uses r only as a label <ref> [24, 23, 22] </ref>. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28].
Reference: [23] <editor> NICODEMUS, F. E. Reflectance nomenclature and directional reflectance and emissivity. </editor> <booktitle> Applied Optics 9 (1970), </booktitle> <pages> 1474-1475. </pages>
Reference-contexts: This has been interpreted both ways (e.g. [12], [13, p.665], [13, p.722]). In his other writings, however, Nicodemus uses r only as a label <ref> [24, 23, 22] </ref>. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28].
Reference: [24] <author> NICODEMUS, F. E. </author> <title> Comment on current definitions of reflectance. </title> <journal> J. Opt. Soc. Am. </journal> <volume> 66 (1976), </volume> <pages> 283-285. </pages>
Reference-contexts: This has been interpreted both ways (e.g. [12], [13, p.665], [13, p.722]). In his other writings, however, Nicodemus uses r only as a label <ref> [24, 23, 22] </ref>. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used [27, p.28].
Reference: [25] <author> NICODEMUS, F. E., Ed. </author> <title> Self-Study Manual on Optical Radiation Measurements: Part IConcepts, </title> <note> Chapters 1 to 3. No. 910-1 in Technical Note. </note> <institution> National Bureau of Standards (US), </institution> <month> Mar. </month> <year> 1976. </year>
Reference-contexts: This allows us to define the inner product of two functions on R, hf; gi = R The measure is called throughput <ref> [35, 25, 9] </ref>, and is defined 2 by d (r) = d (x; !) = dA (x) d x (!) ; (2) where A is the area measure on M, and ? x is the projected solid angle measure on S 2 [25, p.70]. <p> gi = R The measure is called throughput [35, 25, 9], and is defined 2 by d (r) = d (x; !) = dA (x) d x (!) ; (2) where A is the area measure on M, and ? x is the projected solid angle measure on S 2 <ref> [25, p.70] </ref>. <p> To simplify things, we will assume that the beam follows a single path (no partial reflection, etc.) and that there are no losses due to absorption. The first quantity is L= 2 , which Nicodemus calls basic radiance [21] <ref> [25, p.29] </ref>. Its invariance is known as Abbe's law [17, p.195], or radiance invariance [25, p.26]. 17 From this fact and conservation of energy, we can also show the invariance of 2 d. <p> The first quantity is L= 2 , which Nicodemus calls basic radiance [21] [25, p.29]. Its invariance is known as Abbe's law [17, p.195], or radiance invariance <ref> [25, p.26] </ref>. 17 From this fact and conservation of energy, we can also show the invariance of 2 d. This quantity is known as basic throughput [25, p.37], or etendue [35]. 18 3.1.4 An invariant transport framework. <p> Its invariance is known as Abbe's law [17, p.195], or radiance invariance [25, p.26]. 17 From this fact and conservation of energy, we can also show the invariance of 2 d. This quantity is known as basic throughput <ref> [25, p.37] </ref>, or etendue [35]. 18 3.1.4 An invariant transport framework. By writing the transport equations in terms of these invariants, we obtain a framework where light and importance obey the same scattering rules. First, we use basic radiance L = L= for all lighting calculations. <p> To do this, we must know the refractive index of the surrounding medium. 19 17 Basic spectral radiance L - = 2 is invariant as well. If spectral radiance is parameterized by wavelength, then L = 3 is invariant <ref> [25, p.52] </ref>, since wavelengths (unlike frequencies) are modified at the interface. 18 This was first derived (in a simpler linear form) by Smith in 1738 (cf. [40, p.74]).
Reference: [26] <author> NICODEMUS, F. E., Ed. </author> <title> Self-Study Manual on Optical Radiation Measurements: Part IConcepts, </title> <note> Chapters 4 and 5. No. 910-2 in Technical Note. </note> <institution> National Bureau of Standards (US), </institution> <month> Feb. </month> <year> 1978. </year>
Reference-contexts: Linear sensors are characterized by a weighting function W e (x; !), which specifies the sensor response per unit power arriving at x from direction !. Nicodemus calls this the flux responsivity of the sensor <ref> [26, p.59] </ref>, with units [S W 1 ], where the unit S of sensor response depends on the sensor. To make a measurement, we integrate the radiance falling on the sensor, weighted according to W e . <p> To make a measurement, we integrate the radiance falling on the sensor, weighted according to W e . This is expressed by Nicodemus' measurement equation <ref> [26, p.85] </ref>, I = hW e ; L i i = R where I is the measurement (e.g. a pixel value), W e is the weighting function for this measurement, and L i is the incident radiance.
Reference: [27] <author> NICODEMUS, F. E., ET AL. </author> <title> Geometric considerations and nomenclature for reflectance. </title> <type> Monograph 161, </type> <institution> National Bureau of Standards (US), </institution> <month> Oct. </month> <year> 1977. </year>
Reference-contexts: as f s (! i ! ! o ) = dL (! o ) = dE (! i ) ; so that f s (! i ! ! o ) is the observed radiance leaving in direction ! o , per unit of irradiance arriving from direction ! i (see <ref> [27, p.5] </ref>, [9, p.28]). 2 The measure is similar to the usual geometric measure on lines in IR 3 . <p> This measure is invariant under Euclidean transformations, which makes it unique up to a constant factor [2, p.51]. 3 The r in f r is usually assumed to be a label, denoting reflectance. However, Nicodemus et al. <ref> [27] </ref> derive the BRDF from the more general BSSRDF, which allows light to strike and leave the surface at different points (e.g. due to sub-surface scattering). <p> This has been interpreted both ways (e.g. [12], [13, p.665], [13, p.722]). In his other writings, however, Nicodemus uses r only as a label [24, 23, 22]. For the distance interpretation of r, the notation S (! i ; ! r ; r) for the BSSRDF is used <ref> [27, p.28] </ref>. These ambiguities can be avoided by using different typefaces for labels and parameters (Roman vs. italics), as we do in this paper. 4 This name was introduced by Heckbert [16, p.26].
Reference: [28] <author> PATTANAIK, S. N., AND MUDUR, S. P. </author> <title> Adjoint equations and random walks for illumination computation. </title> <journal> ACM Trans. Graphics 14 (Jan. </journal> <year> 1995), </year> <pages> 77-102. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms <ref> [15, 28, 31] </ref>, and bidirectional path-tracing [18, 37, 38]. <p> However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. [4], Christensen et al. [7], and Pattanaik and Mudur <ref> [28] </ref>. Our approach is new in several ways. Due to the absence of symmetry assumptions, our framework has a richer structure: for each of the four basic transport quantities (exitant/incident radiance/importance), there is a distinct transport operator and measurement equation. <p> We have defined both L e and W e as exitant quantities. This is natural, since it lets us define their values at points on the source or sensor (unlike the visual potential of <ref> [28] </ref>), and it reveals many similarities between light and importance transport [7]. The equilibrium solution L = SL e is also an exitant quantity. However, the measurement equation (4) requires an incident function. <p> Since the average of several measurements is itself a measurement, importance functions may correspond to a set of measurements (e.g. all pixels in an image). In the case of importance-driven methods, the measurement may even be hypothetical [33, p.275]. The alternative term potential function <ref> [28] </ref> is undesirable because it has a well-known, different meaning in physics (a function satisfying Poisson's equation, e.g. the electric or gravitational potentials). 8 We assume that the sensors are modeled as part of the domain M. <p> Each B j is thus an incident importance function. 7 2.5.1 Particle tracing. Particle tracing algorithms have been explained in terms of energy packets (e.g. [31]), or as random walk solutions of the importance transport equation <ref> [28] </ref>. We explain how these algorithms are affected by non-symmetric BSDF's. Recall that the BSDF arguments are labeled according to the direction of light flow (from ! i to ! o ). For particle scattering, we are given ! i and must sample ! o .
Reference: [29] <author> PHONG, B. T. </author> <title> Illumination for computer generated pictures. </title> <journal> Communications of the ACM 18, </journal> <month> 6 (June </month> <year> 1975), </year> <pages> 311-317. </pages>
Reference-contexts: With this convention, f fl s applies to light particles and importance evaluation, while f s is used for importance particles and radiance evaluation. 3 Sources of non-symmetric scattering Most reflection models in computer graphics are symmetric. One notable exception is the original Phong model for glossy reflection <ref> [29] </ref>. 11 Although his shading formula is symmetric, the corresponding BRDF has an extra factor of 1= cos ( i ). However, some sources of non-symmetry are not so obvious.
Reference: [30] <author> SCHR ODER, P., AND HANRAHAN, P. </author> <title> Wavelet methods for radiance computations. </title> <booktitle> In Fifth Eurographics Workshop on Rendering (Darmstadt, </booktitle> <address> Germany, </address> <month> June </month> <year> 1994), </year> <pages> pp. 303-311. 17 </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches <ref> [33, 30, 8] </ref>, particle tracing algorithms [15, 28, 31], and bidirectional path-tracing [18, 37, 38].
Reference: [31] <author> SHIRLEY, P., WADE, B., HUBBARD, P. M., ZARESKI, D., WALTER, B., AND GREENBERG, D. P. </author> <title> Global illumination via density-estimation. In Rendering Techniques `95 (New York, 1995), </title> <editor> P. M. Hanrahan and W. Purgathofer, Eds., </editor> <publisher> Springer-Verlag, </publisher> <pages> pp. 219-230. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms <ref> [15, 28, 31] </ref>, and bidirectional path-tracing [18, 37, 38]. <p> Each B j is thus an incident importance function. 7 2.5.1 Particle tracing. Particle tracing algorithms have been explained in terms of energy packets (e.g. <ref> [31] </ref>), or as random walk solutions of the importance transport equation [28]. We explain how these algorithms are affected by non-symmetric BSDF's. Recall that the BSDF arguments are labeled according to the direction of light flow (from ! i to ! o ).
Reference: [32] <author> SIEGEL, R., AND HOWELL, J. R. </author> <title> Thermal Radiation Heat Transfer, second ed. </title> <publisher> Hemisphere Publishing Corp., </publisher> <address> New York, </address> <year> 1981. </year>
Reference-contexts: His reciprocity principle states that if the positions of the source and detector are exchanged, the reflected irradi-ance measured by the sensor will be the same. This implies the symmetry of the corresponding BRDF. Many reciprocity relationships, including these, can be derived from thermodynamic principles (e.g. <ref> [32, p.65] </ref>, [11, p.505]). Such arguments consider an isothermal, black enclosure containing an arbitrary test surface (reflective or transmissive). <p> Using this fact, we can derive a reciprocity principle that is satisfied by all physically valid BSDF's. By considering the energy exchange between two small surface elements of the enclosure, it is straightforward to show that f s (! i ! ! o ) = 2 i (8) (see <ref> [32, p.65] </ref> for a similar argument). This is clearly a generalization of the usual symmetry condition for BRDF's. However, we see that any BSDF involving refraction is not symmetric.
Reference: [33] <author> SMITS, B. E., ARVO, J. R., AND SALESIN, D. H. </author> <title> An importance-driven radiosity algorithm. </title> <booktitle> In Computer Graphics (SIGGRAPH '92 Proceedings) (July 1992), </booktitle> <volume> vol. 26, </volume> <pages> pp. 273-282. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches <ref> [33, 30, 8] </ref>, particle tracing algorithms [15, 28, 31], and bidirectional path-tracing [18, 37, 38]. <p> Since the average of several measurements is itself a measurement, importance functions may correspond to a set of measurements (e.g. all pixels in an image). In the case of importance-driven methods, the measurement may even be hypothetical <ref> [33, p.275] </ref>. The alternative term potential function [28] is undesirable because it has a well-known, different meaning in physics (a function satisfying Poisson's equation, e.g. the electric or gravitational potentials). 8 We assume that the sensors are modeled as part of the domain M.
Reference: [34] <author> SNYDER, J. M., AND BARR, A. H. </author> <title> Ray tracing complex models containing surface tessellations. </title> <booktitle> In Computer Graphics (SIGGRAPH '87 Proceedings) (July 1987), </booktitle> <volume> vol. 21, </volume> <pages> pp. 119-128. </pages>
Reference-contexts: The adjoint flag controls whether K or K fl is evaluated. We also show how to prevent light from leaking through the surface <ref> [34] </ref>, by checking that each direction lies on the same side of the surface with respect to both normals. The easiest solution is just to return zero when this happens.
Reference: [35] <author> STEEL, W. H. Luminosity, </author> <title> throughput, </title> <journal> or etendue? Applied Optics 13 (1974), </journal> <pages> 704-705. </pages>
Reference-contexts: This allows us to define the inner product of two functions on R, hf; gi = R The measure is called throughput <ref> [35, 25, 9] </ref>, and is defined 2 by d (r) = d (x; !) = dA (x) d x (!) ; (2) where A is the area measure on M, and ? x is the projected solid angle measure on S 2 [25, p.70]. <p> Its invariance is known as Abbe's law [17, p.195], or radiance invariance [25, p.26]. 17 From this fact and conservation of energy, we can also show the invariance of 2 d. This quantity is known as basic throughput [25, p.37], or etendue <ref> [35] </ref>. 18 3.1.4 An invariant transport framework. By writing the transport equations in terms of these invariants, we obtain a framework where light and importance obey the same scattering rules. First, we use basic radiance L = L= for all lighting calculations.
Reference: [36] <author> TAYLOR, A. E., AND LAY, D. C. </author> <title> Introduction to Functional Analysis, second ed. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <year> 1980. </year>
Reference-contexts: Note that S is closely related to the resolvent operator R used in spectral analysis, except that R has a parameter , and does not have a universally accepted definition (e.g. compare [10, p.74], <ref> [36, p.272] </ref>). 4 2.3 Sensors and measurements Global illumination algorithms compute a finite number of measurements of the solution L. Each measurement is expressed as the response of a hypothetical sensor, e.g. a small area of film within a virtual camera.
Reference: [37] <author> VEACH, E., AND GUIBAS, L. </author> <title> Bidirectional estimators for light transport. </title> <booktitle> In Fifth Eurographics Workshop on Rendering (Darmstadt, </booktitle> <address> Germany, </address> <month> June </month> <year> 1994), </year> <pages> pp. 147-162. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms [15, 28, 31], and bidirectional path-tracing <ref> [18, 37, 38] </ref>. However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. [4], Christensen et al. [7], and Pattanaik and Mudur [28]. <p> To avoid multiple representations of the same ray, we must include a visibility test V (x; x 0 ) in the measure , or restrict R to pairs where x and x 0 are mutually visible. We used this representation in <ref> [37] </ref>. Note that R and are independent of the parameterization, which is really just a way to assign labels to rays. 2 To integrate real-valued functions, we define a measure function .
Reference: [38] <author> VEACH, E., AND GUIBAS, L. J. </author> <title> Optimally combining sampling techniques for monte carlo rendering. </title> <booktitle> In SIGGRAPH '95 Conference Proceedings (Aug. 1995), </booktitle> <publisher> Addison Wesley, </publisher> <pages> pp. 419-428. </pages>
Reference-contexts: As mentioned in the abstract, we show that non-symmetric scattering is actually quite common. This can cause problems for any algorithm that uses both lighting and viewing information, including importance-driven finite element approaches [33, 30, 8], particle tracing algorithms [15, 28, 31], and bidirectional path-tracing <ref> [18, 37, 38] </ref>. However, we show that these problems are easy to fix. 2 Light transport with non-symmetric scattering We develop a consistent framework for light, importance, and particle transport, building on the work of Arvo et al. [4], Christensen et al. [7], and Pattanaik and Mudur [28].
Reference: [39] <author> VON FRAGSTEIN, C. </author> <title> Ist eine lichtbewegung stets umkehrbar? Opt. </title> <booktitle> Acta 2 (1955), </booktitle> <pages> 16-22. </pages>
Reference-contexts: There are some situations where optical paths are not reversible, i.e. light flowing in the reverse direction follows a different path. This can happen when electromagnetic waves are transmitted into metals <ref> [39] </ref>. Also, reciprocity can fail for polarized light in the presence of an external magnetic field [40, p.231].
Reference: [40] <author> VON HELMHOLTZ, </author> <title> H. </title> <journal> Helmholtz's Treatise on Physiological Optics, </journal> <volume> vol. 1. </volume> <publisher> Dover Publications, </publisher> <address> New York, </address> <year> 1962. </year> <editor> James P. C. Southall, Ed. </editor> <title> Original date of publication 1856. Translated from the third German edition. </title> <type> 18 </type>
Reference-contexts: The Helmholtz reciprocity principle can be found in his famous treatise on physiological optics, first published in 1856 <ref> [40, p.231] </ref>. <p> i ) 2 , so that radiance and importance are scaled differently when they are transmitted through the surface. 12 Helmholtz phrased this law in terms of quantities of light (flux) rather than brightness (radiance), because he was aware of the change in radiance due to the index of refraction <ref> [40, p.233] </ref>. 13 Helmholtz reciprocity is not universally valid. There are some situations where optical paths are not reversible, i.e. light flowing in the reverse direction follows a different path. This can happen when electromagnetic waves are transmitted into metals [39]. <p> There are some situations where optical paths are not reversible, i.e. light flowing in the reverse direction follows a different path. This can happen when electromagnetic waves are transmitted into metals [39]. Also, reciprocity can fail for polarized light in the presence of an external magnetic field <ref> [40, p.231] </ref>. Interestingly, Helmholtz did not provide a proof of his principle, because anybody who is at all familiar with the laws of optics can easily prove it for himself [40, p.231]. 14 The dependence of blackbody radiation on 2 is often falsely attributed to Clausius (cf. [11, p.504]). 3.1.2 Perfect <p> Also, reciprocity can fail for polarized light in the presence of an external magnetic field <ref> [40, p.231] </ref>. Interestingly, Helmholtz did not provide a proof of his principle, because anybody who is at all familiar with the laws of optics can easily prove it for himself [40, p.231]. 14 The dependence of blackbody radiation on 2 is often falsely attributed to Clausius (cf. [11, p.504]). 3.1.2 Perfect specular refraction. We show how these principles apply in the case of perfect specular refraction, where the interface between media is optically smooth. <p> If spectral radiance is parameterized by wavelength, then L = 3 is invariant [25, p.52], since wavelengths (unlike frequencies) are modified at the interface. 18 This was first derived (in a simpler linear form) by Smith in 1738 (cf. <ref> [40, p.74] </ref>). The linear invariant is called the Lagrange invariant or the Smith-Helmholtz invariant. 19 Another way to make the framework symmetric is to work with the quantities L= and W= (leaving the BSDF and inner product alone).
References-found: 40

