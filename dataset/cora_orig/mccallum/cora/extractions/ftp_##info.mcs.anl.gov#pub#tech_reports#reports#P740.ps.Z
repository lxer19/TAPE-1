URL: ftp://info.mcs.anl.gov/pub/tech_reports/reports/P740.ps.Z
Refering-URL: http://www.mcs.anl.gov/publications/abstracts/abstracts99.htm
Root-URL: http://www.mcs.anl.gov
Title: Advanced Computational Techniques for Laue Diffraction Analysis  
Author: Zhong Ren, Rongqin Sheng, and Stephen J. Wright 
Address: ARGONNE, IL 60439, USA.  
Affiliation: MATHEMATICS AND COMPUTER SCIENCE DIVISION, ARGONNE NA TIONAL LABORATORY,  
Note: PREPRINT ANL/MCS-P740-0199,  
Date: February 4, 1999  JANUARY, 1999,  
Abstract: We describe LaueView, a code for processing the measured intensity data in Laue X-ray diffraction experiments to obtain corrected structure amplitudes for each reflection that take account of the various distortion effects. The resulting corrected intensity data can then be used to recover the molecular structure by isomorphous refinement or by solution of the phase problem. We describe the key numerical techniques used in LaueView and outline the improvements we made to obtain a new, more efficient, and parallel version of the code. We conclude with some computational results obtained on a real data set that illustrate our improvements. The basic principles of the Laue method are described in an appendix, where we outline the distortions in the measured intensity data due to effects such as blurring, overlap of the spots, the nonuniform distribution of intensities in the incident X-ray beam, and absorption effects of various types. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> I. J. Clifton, E. M. H. Duke, S. Wakatsuki, and Z. Ren. </author> <title> Evaluation of Laue diffraction patterns. </title> <booktitle> Methods in Enzymology, </booktitle> <volume> 277 </volume> <pages> 448-467, </pages> <year> 1997. </year>
Reference-contexts: Another major advantage is that Laue diffraction is more suited to synchotron sources (such as the Advanced Photon Source at Argonne National Laboratory), which naturally produce bright X-rays with a spread of wavelengths. Moffatt [4] discusses the Laue technique, while Clifton et al. <ref> [1] </ref> describe the evaluation of Laue diffraction images. This crystal is in space group P 2 1 with cell constants a = 50:2 A, b = 82:2 A, and c = 38:0 A; and fi = 100:5 ffi . <p> In LaueView2.5, the curve is defined in terms of the Chebyshev basis functions cos (i arccos z), i = 1; 2; 3; : : :, for z 2 <ref> [1; 1] </ref>. <p> define a normalized frequency measure 0 by 0 = ( max min )=2 The curve (equivalently, the correction factor f ) is defined as f = 10 10 + exp i=1 c i (cos (i arccos 0 ) cos (i arccos 0 r )) ; (7) where 0 r 2 <ref> [1; 1] </ref> is a reference frequency that fixes the scale of f (through the relation f = 1 + 10 10 when 0 = 0 r ). <p> In a later version (LaueView3.0, which predates LaueView3.1), we replaced this technique by a more efficient, well known recurrence relation. Given z 2 <ref> [1; 1] </ref>, we define c 1 = cos (arccos z) = z; s 1 = sin (arccos z) = p and recur by using the formulae c i+1 c i c 1 s i s 1 ; s i+1 1 c 2 Global basis functions such as Chebyshev are not particularly <p> We then replace the definition (7) of f by " n X c i (p i ( 0 ) p i ( 0 # where 0 2 <ref> [1; 1] </ref> is the normalized frequency from (6), 0 r is the reference frequency, and p i ( 0 ) = &lt; ( 0 a i3 ) 2 =(6h 3 ) 0 2 [a i3 ; a i2 ]; ( 0 a i )=(6h 3 ) 0 2 [a i1 ;
Reference: [2] <author> U. K. Genick, G. E. O. Borgstahl, K. Ng, Z. Ren, C. Pradervand, P. M. Burke, V. Srajer, T.-Y. Teng, W. Schildkamp, D. E. McRee, K. Moffatt, and E. Getzoff. </author> <title> Structure of a protein photocycle intermediate by millisecond time-resolved crystallography. </title> <journal> Science, </journal> <volume> 275 </volume> <pages> 1471-1475, </pages> <month> March </month> <year> 1997. </year>
Reference-contexts: Despite the additional complications, however, the Laue technique is more suitable in situations in which data must be gathered quickly, such as when our intention is to observe reactions in progress (see, for example, Genick et al. <ref> [2] </ref>). Another major advantage is that Laue diffraction is more suited to synchotron sources (such as the Advanced Photon Source at Argonne National Laboratory), which naturally produce bright X-rays with a spread of wavelengths. <p> A fuller description of the code (from the viewpoint of the application) can be found in the papers of Ren and Moffat [8, 9]. It was used to produce the structures reported in Ren et al. [10] and Genick et al. <ref> [2] </ref> 3 Numerical Computing Issues LaueView uses numerous techniques from scientific computing, numerical analysis, and optimization, both in formulating its model of the diffraction process and in "solving" this model to obtain the corrected intensities. <p> makes it not worthwhile to parallelize them. 4 Computational Results In this section we report on the effects of our improvements to LaueView, as measured by its performance on a real data set from a crystal of photoactive yellow protein, for which structure results obtained with LaueView2.5 are presented in <ref> [2] </ref>.
Reference: [3] <author> J. P. Glusker and K. N. Trueblood. </author> <title> Crystal Structure Analysis: A Primer. </title> <publisher> Oxford University Press, </publisher> <address> second edition, </address> <year> 1985. </year>
Reference-contexts: alternative approach of deleting overlapping spots from the data set degrades the quality of the data set considerably.) Basic descriptions of X-ray diffraction appear in many books; we mention in particular those of Wilson [11] (from which some of the discussion of this section is drawn) and Glusker and True-blood <ref> [3] </ref>.
Reference: [4] <author> Keith Moffat. </author> <title> Laue diffraction. </title> <booktitle> Methods in Enzymology, </booktitle> <volume> 277 </volume> <pages> 433-447, </pages> <year> 1997. </year>
Reference-contexts: Another major advantage is that Laue diffraction is more suited to synchotron sources (such as the Advanced Photon Source at Argonne National Laboratory), which naturally produce bright X-rays with a spread of wavelengths. Moffatt <ref> [4] </ref> discusses the Laue technique, while Clifton et al. [1] describe the evaluation of Laue diffraction images. This crystal is in space group P 2 1 with cell constants a = 50:2 A, b = 82:2 A, and c = 38:0 A; and fi = 100:5 ffi .
Reference: [5] <author> Jorge J. </author> <title> More. The Levenberg-Marquardt algorithm: Implementation and theory. In G.A. </title> <editor> Watson, editor, </editor> <booktitle> Lecture Notes in Mathematics, No. 630-Numerical Analysis, </booktitle> <pages> pages 105-116. </pages> <publisher> Springer-Verlag, </publisher> <year> 1978. </year>
Reference-contexts: Even when the second term is not insignificant, the approximation J T J has the advantages of being positive semidefinite and of having similar scaling to the true Hessian. Our implementation of the Levenberg-Marquardt algorithm in LaueView3.1 follows that of More <ref> [5] </ref>. <p> A specialized root finding algorithm can be applied to R (fl) to find an approximately optimal fl (see More <ref> [5] </ref> for details). <p> The Jacobian J is large, "long and skinny," and not particularly sparse. Some implementations of Levenberg-Marquardt (for example, the one described by More <ref> [5] </ref>) store J explicitly, compute a QR factorization, and use the R factor in the subsequent calculations needed to identify fl (). In LaueView, J is too large to store explicitly.
Reference: [6] <author> Jorge J. </author> <title> More and D.C. Sorensen. Computing a trust region step. </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 4 </volume> <pages> 553-572, </pages> <year> 1983. </year>
Reference-contexts: be chosen so that the sensitivity of the function f to perturbations in the values of each scaled variable (Dx) i is roughly the same. (In LaueView3.1, we set D ii = max ((J T J ) ii ; 1).) It is well known (see, for example, More and Sorensen <ref> [6] </ref>) that the solution of (10) satisfies the equation [J T J + flD 2 ]ffi = J T r; (11) or, equivalently, [D 1 J T J D 1 + flI](Dffi) = D 1 J T r; (12) for some value fl &gt; 0.
Reference: [7] <author> W. H. Press, S. A. Teukolsky, and W. T. Vetterling. </author> <title> Numerical Recipes in Fortran: </title> <booktitle> The Art of Scientific Computing. </booktitle> <publisher> Cambridge University Press, </publisher> <address> second edition, </address> <year> 1992. </year>
Reference-contexts: We discuss this point further in Section 3.4. A variant of the Levenberg-Marquardt algorithm obtained from the book Numerical Recipes <ref> [7] </ref> was used in the earlier version of the code, LaueView2.5. This variant does not make use of a trust-region strategy but rather manipulates the parameter fl explicitly. This parameter is increased when the candidate step ffi is unsatisfactory, and decreased when a successful step is taken. <p> This parameter is increased when the candidate step ffi is unsatisfactory, and decreased when a successful step is taken. The alternative trust-region implementation that we described above allows more direct control over the length of the computed steps. A significant disadvantage of the algorithm described in <ref> [7] </ref> is that it always evaluates the first derivatives rr i whenever the residual values r i are evaluated. If the candidate iterate is subsequently rejected (when it does not lead to a significant decrease in the function value over the current iterate), this derivative evaluation is wasted.
Reference: [8] <author> Zhong Ren and Keith Moffat. </author> <title> Deconvolution of energy overlaps in Laue diffraction. </title> <journal> Journal of Applied Crystallography, </journal> <volume> 28 </volume> <pages> 482-493, </pages> <year> 1995. </year>
Reference-contexts: Scaling, in which the measured intensities are corrected to account for the distortion effects discussed above and are reduced to structure factor amplitudes. LaueView was written by one of the authors of this paper (Zhong Ren) and is described in detail by Ren and Moffat elsewhere <ref> [8, 9] </ref>. Our mission in the current project was to enhance the numerical and computational techniques used by LaueView to allow it to produce results of the same or better quality in less computing time. <p> We recount a few details of the scaling operation here and refer the interested reader to Ren and Moffat <ref> [8, 9] </ref> for further information. We seek a multiplicative scaling factor f to be applied to each measured intensity I, to obtain a corrected intensity fI. The factor f depends on the Miller indices (h; k; `) and an index i of the particular observation of this reflection. <p> LaueView was developed specifically for single-processor SGI workstations. It can be used to analyze even monochromatic data if the parameters are set appropriately. A fuller description of the code (from the viewpoint of the application) can be found in the papers of Ren and Moffat <ref> [8, 9] </ref>.
Reference: [9] <author> Zhong Ren and Keith Moffat. </author> <title> Quantitative analysis of synchotron Laue diffraction patterns in macromolecular crystallography. </title> <journal> Journal of Applied Crystallography, </journal> <volume> 28 </volume> <pages> 461-481, </pages> <year> 1995. </year> <month> 23 </month>
Reference-contexts: Scaling, in which the measured intensities are corrected to account for the distortion effects discussed above and are reduced to structure factor amplitudes. LaueView was written by one of the authors of this paper (Zhong Ren) and is described in detail by Ren and Moffat elsewhere <ref> [8, 9] </ref>. Our mission in the current project was to enhance the numerical and computational techniques used by LaueView to allow it to produce results of the same or better quality in less computing time. <p> This section presents a brief description of LaueView. For more details, see Ren and Moffat <ref> [9] </ref>. The first phase of LaueView involves indexing and prediction of the diffraction pattern, using knowledge of the lattice and symmetry information, and of various geometric parameters of the actual experiment, such as the location of the beam center and of the crystal-to-detector distance. <p> We recount a few details of the scaling operation here and refer the interested reader to Ren and Moffat <ref> [8, 9] </ref> for further information. We seek a multiplicative scaling factor f to be applied to each measured intensity I, to obtain a corrected intensity fI. The factor f depends on the Miller indices (h; k; `) and an index i of the particular observation of this reflection. <p> Redundant measurements at different wavelengths and knowledge of the symmetry are instrumental in reconstructing the curve. The curve is continuous, but may contain downward spikes at the absorption wavelengths of a beam-focusing mirror (see Ren and Moffat <ref> [9] </ref>). In LaueView2.5, the curve is defined in terms of the Chebyshev basis functions cos (i arccos z), i = 1; 2; 3; : : :, for z 2 [1; 1]. <p> LaueView was developed specifically for single-processor SGI workstations. It can be used to analyze even monochromatic data if the parameters are set appropriately. A fuller description of the code (from the viewpoint of the application) can be found in the papers of Ren and Moffat <ref> [8, 9] </ref>.
Reference: [10] <author> Zhong Ren, Kingman Ng, Gloria E. O. Borgstahl, Elizabeth D. Getzoff, and Keith Moffat. </author> <title> Quantitative analysis of time-resolved Laue diffraction patterns. </title> <journal> Journal of Applied Crystallography, </journal> <volume> 29 </volume> <pages> 246-260, </pages> <year> 1996. </year>
Reference-contexts: A fuller description of the code (from the viewpoint of the application) can be found in the papers of Ren and Moffat [8, 9]. It was used to produce the structures reported in Ren et al. <ref> [10] </ref> and Genick et al. [2] 3 Numerical Computing Issues LaueView uses numerous techniques from scientific computing, numerical analysis, and optimization, both in formulating its model of the diffraction process and in "solving" this model to obtain the corrected intensities.
Reference: [11] <author> A. J. C. Wilson. </author> <title> Elements of X-Ray Crystallography. </title> <publisher> Addison-Wesley, </publisher> <address> Reading, Mass., </address> <year> 1970. </year> <month> 24 </month>
Reference-contexts: necessary to do a "deconvolution" to determine the intensity associated with each component spot. (The simple alternative approach of deleting overlapping spots from the data set degrades the quality of the data set considerably.) Basic descriptions of X-ray diffraction appear in many books; we mention in particular those of Wilson <ref> [11] </ref> (from which some of the discussion of this section is drawn) and Glusker and True-blood [3].
References-found: 11

