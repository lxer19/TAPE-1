URL: ftp://markov.stats.ox.ac.uk/pub/clifford/met_poly.ps.Z
Refering-URL: http://www.stats.bris.ac.uk/MCMC/pages/list.html
Root-URL: http://www.aic.nrl.navy.mil/~aha/people.html
Email: clifford@stats.ox.ac.uk  
Title: A Metropolis Sampler for Polygonal Image Reconstruction  
Author: Peter Clifford and Geoff Nicholls 
Date: 22/12/1994  
Address: Oxford OX1 3TG, UK  
Affiliation: Department of Statistics Oxford University  
Abstract: We show how a stochastic model of polygonal objects can provide a Bayesian framework for the interpretation of colouring data in the plane. We describe a particular model and give a Markov Chain Monte Carlo (MCMC) algorithm for simulating the posterior distribution of the polygonal pattern. Two important observations arise from our implementation of the algorithm. First, it is computationally feasible to use MCMC to simulate the posterior distribution of a polygonal process for moderately large problems (ie, 10000 data points, with polygonal patterns involving around 120 edges). Our implementation, which we would describe as careful, but unsophisticated, produces satisfactory approximations to the mode of the posterior in about 5 minutes on a SUN Sparc 2. Independent samples from the posterior take a few seconds to generate. The second observation is that the Arak process, a particular type of polygonal process, makes a wonderful debugging tool for testing shape simulation software. This is no mundane observation. Given the usually very complicated nature of such software it is essential to demonstrate that samples genuinely do come from whichever shape distribution is proposed. The Arak process has the advantage that many of its properties can be expressed in precise analytic terms. Computer programmes designed to sample mosaics formed from polygonal shapes can thereby be tested on this process by comparing computer output with exact theoretical expectations. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> T. Arak, P. Clifford, and D. Surgailis. </author> <title> Point based Polygonal models for random graphs. </title> <booktitle> Advances in Applied Probability, </booktitle> <volume> 25 </volume> <pages> 348-372, </pages> <year> 1993. </year>
Reference-contexts: Also, although the dimension of the random state varies through the MCMC, the measure is purely atomic. These are just the restrictions we set out to remove. 2 The Model 2.1 The Arak Process The Arak process [2] was the first of the now fully enumerated consistent polygonal models <ref> [1] </ref> to be discovered. A typical realisation is shown in Figure 2. It is a model of polygons scattered in the plane. They are non-overlapping, though they need not be simply connected. No vertices coincide. Polygons are coloured uniformly black or white. <p> The expected number of intersections &lt; jfl " ^ej &gt; between the pattern, fl, and a test edge ^e, is Poisson, with mean and variance 2pj^ej, <ref> [1] </ref>. Results for boundary (lower) and interior (horizontal centred) test segments of length one are shown. 13 &lt; jE i j &gt; p theory measured 0.001 0:00401 0:00428 (23) 0.1 0:5257 0:5255 (40) 2.0 58:28 58:03 (25) 4.0 217:10 216:96 (27) Table 3: Comparison of theoretical and estimated expectations.
Reference: [2] <author> T. Arak. </author> <title> On Markovian random fields with a finite number of values. </title> <booktitle> In 4th USSR-Japan Symposium on Probability Theory and Mathematical Statistics: Abstracts of Communications. </booktitle> <address> Tiblisi, </address> <year> 1982. </year>
Reference-contexts: The first step in constructing a probability distribution on the state space is to specify a base measure. The next step is to suggest a density with respect to the measure and then to confirm that it is normalisable. This has been demonstrated for certain polygonal models <ref> [2] </ref>, a remarkable feat of mathematics, when we consider the complexity of the state space. One would like to build a sampler for polygonal random fields. <p> Also, although the dimension of the random state varies through the MCMC, the measure is purely atomic. These are just the restrictions we set out to remove. 2 The Model 2.1 The Arak Process The Arak process <ref> [2] </ref> was the first of the now fully enumerated consistent polygonal models [1] to be discovered. A typical realisation is shown in Figure 2. It is a model of polygons scattered in the plane. They are non-overlapping, though they need not be simply connected. No vertices coincide. <p> A sample from the Arak prior with p = 1 is given in Figure 2. 2.2 Properties of the Arak Process We have closed form expressions for a number of non-trivial expected values for the Arak process. First of all, we have the following interpretation <ref> [2] </ref> of the parameter p appearing in Equations (2) and (4). Any line l in &lt; 2 intersects some edges of fl. The intersection 4 points form a marked point process on l.
Reference: [3] <author> D. Frenkel. </author> <title> Advanced Monte Carlo techniques. </title> <editor> In MP Allen and DJ Tildesley, editors, </editor> <booktitle> Computer simulation in chemical physics, volume C397 of Nato ASI Series. </booktitle> <publisher> Kluwer Academic Publications, </publisher> <address> Dordrecht, </address> <year> 1993. </year>
Reference-contexts: Of course, this is part of the reason we are using MCMC in the first place. It is because the probability measure is hard to normalise in closed form. The same problems arise in simulating the grand canonical ensemble in physical chemistry <ref> [3, 4] </ref>. The Metropolis algorithm must deal with changes in the dimension of the sample space, using moves involving the destruction of molecules and the creation of new ones inserted with the correct energy configuration.
Reference: [4] <editor> MP Allen and DJ Tildesley. </editor> <booktitle> Computer simulation of liquids. </booktitle> <publisher> Clarendon Press, Oxford, </publisher> <year> 1987. </year>
Reference-contexts: Of course, this is part of the reason we are using MCMC in the first place. It is because the probability measure is hard to normalise in closed form. The same problems arise in simulating the grand canonical ensemble in physical chemistry <ref> [3, 4] </ref>. The Metropolis algorithm must deal with changes in the dimension of the sample space, using moves involving the destruction of molecules and the creation of new ones inserted with the correct energy configuration.
Reference: [5] <author> U. Grenander. </author> <title> General Pattern Theory. </title> <publisher> Oxford University Press, </publisher> <year> 1993. </year>
Reference-contexts: Finally, there are natural isotropic versions of these models so that artificial directional effects introduced by pixel grids can be eliminated completley in the specification of colouring patterns. 1.1 Background For a comprehensive introduction to the statistical analysis of spatial patterns, see Grenan-der <ref> [5] </ref>. For a useful reference to the measure theory we need, see [6]. There have been several recent papers [7, 8, 9], in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions. <p> One of the sub-triangles has two sides which are edges of the polygon <ref> [5] </ref>. If the vertex v, at which these two edges meet, is deleted, the generated state is in D . There is a positive probability to delete it if it lies close enough to the edge e that will be created by its death (see Move 8 and Figure 14).
Reference: [6] <author> D. Stoyan, W.S. Kendall, and J. Mecke. </author> <title> Stochastic Geometry and its Applications. </title> <publisher> Wiley, </publisher> <address> New York, </address> <year> 1987. </year>
Reference-contexts: For a useful reference to the measure theory we need, see <ref> [6] </ref>. There have been several recent papers [7, 8, 9], in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions.
Reference: [7] <author> U. Grenander and M. Miller. </author> <title> Representation of knowledge in complex systems. </title> <journal> J. R. Statist. Soc. B, </journal> <volume> 56(3), </volume> <year> 1993. </year>
Reference-contexts: For a useful reference to the measure theory we need, see [6]. There have been several recent papers <ref> [7, 8, 9] </ref>, in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process [10, 11]. <p> For a useful reference to the measure theory we need, see [6]. There have been several recent papers [7, 8, 9], in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In <ref> [7] </ref> complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process [10, 11].
Reference: [8] <author> A.J. Baddeley and M.N.M van Lieshout. </author> <title> Stochastic geometry models in high level vision. In K.V. Mardia and G.K. Kanji, editors, </title> <journal> Statistics and Images, </journal> <volume> Vol 1, </volume> <booktitle> volume 20 of J. Applied Statistics, </booktitle> <pages> pages 231-256. </pages> <year> 1993. </year>
Reference-contexts: For a useful reference to the measure theory we need, see [6]. There have been several recent papers <ref> [7, 8, 9] </ref>, in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process [10, 11]. <p> For a useful reference to the measure theory we need, see [6]. There have been several recent papers [7, 8, 9], in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions. In <ref> [8] </ref> planar patterns of identical objects are simulated by a spatial birth and death process [10, 11]. To use MCMC methods based on jump diffusions and spatial birth and death processes, it is necessary to normalise the transition density over the set of destination states at any given time.
Reference: [9] <author> G. Storvik. </author> <title> A Bayesian approach to dynamic contours through stochastic sampling and simulated annealing. </title> <journal> IEEE Pattern Analysis and Machine Intelligence, </journal> <volume> 16 </volume> <pages> 976-986, </pages> <year> 1994. </year>
Reference-contexts: For a useful reference to the measure theory we need, see [6]. There have been several recent papers <ref> [7, 8, 9] </ref>, in which stochastic models of shapes and shape patterns have been constructed, and analysed by MCMC methods. In [7] complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process [10, 11]. <p> The objective is to produce relatively simple, easily verified software for shape simulation, 2 even when the models get complex. Storvik <ref> [9] </ref> has described a Bayesian approach to contour modeling. He has shown [14] how to enlarge the usual class of Metropolis-Hastings MCMC algorithms to include a certain class of coupled non-reversible processes, which have tidy implementations.
Reference: [10] <author> B.D. Ripley and F.P.. Kelly. </author> <title> Markov point processes. </title> <journal> Journal of the Lond. Math. Soc., </journal> <volume> 15 </volume> <pages> 188-192, </pages> <year> 1977. </year>
Reference-contexts: In [7] complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process <ref> [10, 11] </ref>. To use MCMC methods based on jump diffusions and spatial birth and death processes, it is necessary to normalise the transition density over the set of destination states at any given time. If this can be done efficiently it may well be an effective approach.
Reference: [11] <author> C. Preston. </author> <title> Spatial Birth and Death processes. </title> <journal> Bull. Int. Statistical Inst., </journal> <volume> 46(2) </volume> <pages> 371-391, </pages> <year> 1976. </year>
Reference-contexts: In [7] complex spatial processes are simulated by a jump-diffusions. In [8] planar patterns of identical objects are simulated by a spatial birth and death process <ref> [10, 11] </ref>. To use MCMC methods based on jump diffusions and spatial birth and death processes, it is necessary to normalise the transition density over the set of destination states at any given time. If this can be done efficiently it may well be an effective approach.
Reference: [12] <author> C.J. Geyer and J. Moller. </author> <title> Simulation procedures and likelihood inference for spatial point processes. Research Report No. </title> <type> 260, </type> <institution> Department of Theoretical Statistics, Aarhus University, </institution> <note> to appear in Scand. J. </note> <institution> Stat., </institution> <year> 1993. </year>
Reference-contexts: The Metropolis-Hastings MCMC algorithm is generally straightforward to apply when a probability density is specified over a complex state space. The algorithm leads to simple and efficient implementations, which have been shown to coverge more rapidly than spatial birth and death samplers for some simple trial problems <ref> [12, 13] </ref>. Our longterm aim is to develop MCMC algorithms for more elaborate shape models than those described in this paper. <p> Because it is still unusual to define a discrete time Markov chain with a state of randomly variable dimension we spell these conditions out. Following work [18] by the physical chemists, <ref> [12, 19] </ref> have shown how detailed balance can hold in problems of this kind. <p> Thus the casting box should be of such a size that the expected number of vertices in it is some small number. However, we have more than enough move types to get Harris recurrence, and so we try and decide which are the key moves. In <ref> [12] </ref> the authors find, in a study of the Strauss process, 12 p n IACT (E i ) successful uncertainty CPU time updatesfi10 6 updates % updates % estimate hrs mins secs 0.001 6 76 (2) 0:5 5:4 k1m 22s 0.1 12 257 (9) 4 0:8 k2m 16s 2.0 40 15000
Reference: [13] <author> P. Clifford and G.K. </author> <title> Nicholls. Comparison of Birth-and-Death and Metropolis-Hastings Markov chain Monte Carlo for the Strauss process. </title> <institution> Statistics Department, </institution> <address> Oxford, OX1 3TG, </address> <month> June </month> <year> 1994. </year>
Reference-contexts: The Metropolis-Hastings MCMC algorithm is generally straightforward to apply when a probability density is specified over a complex state space. The algorithm leads to simple and efficient implementations, which have been shown to coverge more rapidly than spatial birth and death samplers for some simple trial problems <ref> [12, 13] </ref>. Our longterm aim is to develop MCMC algorithms for more elaborate shape models than those described in this paper.
Reference: [14] <author> G. Storvik. </author> <title> A Bayesian Approach to Dynamic Contours. </title> <type> PhD thesis, </type> <institution> Norwegian Computing Center, Oslo, </institution> <month> October </month> <year> 1992. </year> <note> Report No 860. </note>
Reference-contexts: The objective is to produce relatively simple, easily verified software for shape simulation, 2 even when the models get complex. Storvik [9] has described a Bayesian approach to contour modeling. He has shown <ref> [14] </ref> how to enlarge the usual class of Metropolis-Hastings MCMC algorithms to include a certain class of coupled non-reversible processes, which have tidy implementations. We would like to apply these processes to our simulation problem, as it is likely that there would be a gain in efficiency.
Reference: [15] <author> T.E. Harris. </author> <title> The existence of stationary measure for certain Markov processes. </title> <booktitle> In Proceedings III Berkeley Symposium on Statistics and Probability, </booktitle> <volume> volume 2, </volume> <pages> pages 113-115. </pages> <institution> University of California Press, Berkley, </institution> <year> 1956. </year>
Reference-contexts: For a state space formed from the union of a countable number of continuous subspaces, we must show that fX n g is Harris recurrent. From a theorem of Harris <ref> [15] </ref> we know that in this case a USM exists. If so, it remains to show that this USM is just Q (dfl). The usual strategy is to set up a transition measure satisfying detailed balance with respect to Q (dfl) in D . <p> Assertion 3.2 Harris <ref> [15] </ref> Suppose fX n g has a recurrence measure . Then fX n g has a unique stationary measure, which is stronger than . 9 stronger than means fSg &gt; 0 ) fSg &gt; 0, for S 2 B D .
Reference: [16] <author> N. Metropolis, A.W. Rosenbluth, M.N. Teller, and A.H. Teller. </author> <title> Equation of state calculations by fast computing machines. </title> <journal> Journal of Chemical Physics, </journal> <volume> 21 </volume> <pages> 1087-1092, </pages> <year> 1953. </year>
Reference-contexts: This is a sufficient condition for Q to be a stationary measure of fX n g, and by recurrence it is unique. However, sufficiency restricts us to considering reversible Markov processes. We use the Metropolis-Hastings prescription <ref> [16, 17] </ref> to get detailed balance. <p> In the acceptance step we let the state at time n + 1 be fl 0 with probability ff (fl ! fl 0 ), otherwise it remains unchanged at fl. If fl 0 is not in D then ff (fl ! fl 0 ) 0. Following Metropolis et al <ref> [16] </ref>, Hastings [17] showed how to define a large class of transition probability measures satisfying Equation (9).
Reference: [17] <author> W.K. Hastings. </author> <title> Monte Carlo sampling methods using Markov chains and their applications. </title> <journal> Biometrika, </journal> <volume> 57 </volume> <pages> 97-109, </pages> <year> 1970. </year>
Reference-contexts: This is a sufficient condition for Q to be a stationary measure of fX n g, and by recurrence it is unique. However, sufficiency restricts us to considering reversible Markov processes. We use the Metropolis-Hastings prescription <ref> [16, 17] </ref> to get detailed balance. <p> If fl 0 is not in D then ff (fl ! fl 0 ) 0. Following Metropolis et al [16], Hastings <ref> [17] </ref> showed how to define a large class of transition probability measures satisfying Equation (9).
Reference: [18] <author> G.E. Norman and V.S. Filinov. </author> <title> Investigations of phase transitions by a Monte Carlo method. </title> <journal> High Temperature, </journal> <volume> 7 </volume> <pages> 216-222, </pages> <year> 1969. </year> <note> Translation, Journal also known as High Temperature Research USSR. </note>
Reference-contexts: Because it is still unusual to define a discrete time Markov chain with a state of randomly variable dimension we spell these conditions out. Following work <ref> [18] </ref> by the physical chemists, [12, 19] have shown how detailed balance can hold in problems of this kind.
Reference: [19] <author> P.J. Green. </author> <title> Contribution to discussion of paper by Grenander and Miller. </title> <booktitle> RSS Meeting, </booktitle> <month> 20 October, </month> <year> 1993. </year>
Reference-contexts: Because it is still unusual to define a discrete time Markov chain with a state of randomly variable dimension we spell these conditions out. Following work [18] by the physical chemists, <ref> [12, 19] </ref> have shown how detailed balance can hold in problems of this kind.
Reference: [20] <author> M. Blum. </author> <title> Program checking. </title> <booktitle> In Lecture Notes In Computer Science, </booktitle> <volume> volume 560, </volume> <pages> pages 1-9. </pages> <publisher> Springer, </publisher> <year> 1991. </year>
Reference-contexts: As we built the data structures described in Appendix C we wrote checking functions for them. These visit each part of the data structure checking for consistency. These functions were gathered together in a grand checking function, which has been left in place <ref> [20] </ref>. It usually adds a small amount to the run time. Further details of internal checks for MCMC are given in Appendix D. In this section we describe the external checks we applied. We measure certain state functions at intervals through the run, and record their values. <p> However at no stage is colouring information for points other than data points needed. D Internal Checks for general MCMC To help ourselves find bugs in the building stage, we wrote several functions which check data structures for internal consistency. These should be left in place <ref> [20] </ref> as they usually 22 add a negligible amount to the run time. Thus we check that the polygons are consistent linked lists, that each vertex and edge is in exactly one polygon and that no pair of edges intersect.
Reference: [21] <author> C.J. </author> <title> Geyer. Practical Markov chain Monte Carlo. </title> <journal> Statistical Science, </journal> <volume> 7 </volume> <pages> 473-511, </pages> <year> 1992. </year>
Reference-contexts: We compare the values we obtain with the analytic results given in Section 2.2. We recommend vigorous testing at very small values of p, because it is at very low densities one stands a chance of detecting small departures from the measure. We used the output analysis described in <ref> [21] </ref>. This gives an automatic windowing procedure (the initial monotone sequence estimator) for computing standard errors from the autocorrelations of a Markov process.
Reference: [22] <author> A. Sokal. </author> <title> Monte Carlo methods in Statistical Mechanics. </title> <institution> In Cours de Troisieme Cycle de la Physique en Suisse Romande, Lausanne, </institution> <year> 1989. </year>
Reference-contexts: This gives an automatic windowing procedure (the initial monotone sequence estimator) for computing standard errors from the autocorrelations of a Markov process. We computed the integrated autocorrelation time (IACT, t ) of each state function, and estimated its standard error, in an approximation due to <ref> [22] </ref> and suitable if L &gt;> t , L the window size on the autocorrelation function. To check the consistency of our standard errors we compute the asymptotic standard deviation of each autocorrelation function, and plot the 2 confidence interval on top of the autocorrelation function. <p> Moreover, we hold off sampling for a time of length roughly ten times the IACT, using a rough estimate of the IACT obtained from short experimental runs. Note that this is not always enough, as the time to enter equilibrium is not the same as the IACT <ref> [22] </ref>. We were obliged to subsample our MCMC output, using the same rough IACT values to set the sample interval. Results are given in Tables 2 and 3. Standard errors are given in brackets. 0:023 (10) has estimated standard deviation 0:01. <p> So, as <ref> [22] </ref> explains, n=t f can be thought of as the number of effectively independent samples in a run of length n. <p> For a given computing machine, 1=t measures power: at what rate in seconds do estimated variances go down ? However, some functions of the state decorrelate much more slowly than others. These 11 are the physicists' slow modes <ref> [22] </ref>. If one function, f (fl) say, is particularly important to us, we look at t f . However we like to check on a handful of other fundamental IACT's.
Reference: [23] <author> K. Huang. </author> <title> Statistical Mechanics, </title> <booktitle> chapter 16, </booktitle> <pages> pages 406-411. </pages> <publisher> John Wiley & Sons, </publisher> <year> 1987. </year>
Reference-contexts: A similar near-trapping happens in the one dimensional Ising model, when the update scheme is single-site. The linear term in p in Equation (6) (corresponding to Goldstone modes <ref> [23] </ref> made up of highly corrugated objects) is a sign that there is a way out of the trap. It is interesting to experiment with different update sets. When we are not experimenting, we use an automatically chosen set of updates and update type selection probabilities. <p> The posterior Gibbs potential we minimise is the one defined by Equations (8) and (4). It is easy to see that this has a usable posterior mode, because large highly corrugated polygons (which we identify with the Goldstone modes of <ref> [23] </ref>) are penalised. In particular the empty state 0 (with two colourings of equal density) is the state maximising the prior density.
Reference: [24] <author> N.J. Lennes. </author> <title> Theorems on the simple finite polygon and polyhedron. </title> <journal> Am. J. Math., </journal> <volume> 33 </volume> <pages> 37-62, </pages> <year> 1911. </year>
Reference-contexts: This can be done, and in a finite number of moves, since the triangle is empty, and the set of paths leading to the set of small triangles has positive probability measure. (c) If the polygon has more than three vertices, it has a triangular decomposition <ref> [24] </ref>. One of the sub-triangles has two sides which are edges of the polygon [5]. If the vertex v, at which these two edges meet, is deleted, the generated state is in D .
Reference: [25] <author> S. Geman and D. Geman. </author> <title> Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images. </title> <journal> IEEE Pattern Analysis and Machine Intelligence, </journal> <volume> 6 </volume> <pages> 721-741, </pages> <year> 1984. </year>
Reference-contexts: To arrive at a state in 0 , we bring the system to equilibrium at large T = T max and gradually lower T to some very small value T = T min . The function T (t) is called the annealing schedule. Following <ref> [25] </ref>, Van Lieshout [26] has given a schedule and T max , for point processes, with the property that the probability measure of the state of the Markov chain at T min is equal to Q (dfl; T min ).

References-found: 25

