URL: http://www.tc.cornell.edu/~coleman/PAPERS/vol1.ps
Refering-URL: http://www.tc.cornell.edu/~coleman/finance.html
Root-URL: http://www.tc.cornell.edu
Title: RECONSTRUCTING THE UNKNOWN LOCAL VOLATILITY FUNCTION  
Author: THOMAS F. COLEMANy, YUYING LIy, AND ARUN VERMAy 
Note: This research was conducted using resources of the Cornell Theory Center, which is supported by Cornell University, New York State, the National Center for Research Resources at the National Institutes of Health, and members of the Corporate Partnership Program.  
Date: SEPTEMBER 22, 1998  
Abstract: Using market European option prices, a method for computing a smooth local volatility function in a 1-factor continuous diffusion model is proposed. Smoothness is introduced to facilitate accurate approximation of the true local volatility function from a finite set of observation data. It is emphasized that accurately approximating the true local volatility function is crucial in hedging even simple European options, and pricing exotic options. A spline functional approach is used: the local volatility function is represented by a spline whose values at chosen knots are determined by solving a constrained nonlinear optimization problem. The optimization formulation is amenable to various option evaluation methods; a partial differential equation implementation is discussed. Using a synthetic European call option example, we illustrate the capability of the proposed method in reconstructing the unknown local volatility function. Accuracy of pricing and hedging is also illustrated. Moreover, it is demonstrated that, using a different constant implied volatility for an option with different strike/maturity can produce erroneous hedge factors. In addition, real market European call option data on the S&P 500 stock index is used to compute the local volatility function; stability of the approach is demonstrated. y Computer Science Department and Cornell Theory Center, Cornell University, Ithaca, NY 14850. Research partially supported by the Applied Mathematical Sciences Research Program (KC-04-02) of the Office of Energy Research of the U.S. Department of Energy under grant DE-FG02-90ER25013.A000 and NSF through grant DMS-9505155 and ONR through grant N00014-96-1-0050. fl Presented at the first annual conference: Computational and Quantitative Finance '98, New York.
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> L. ANDERSEN AND R. BROTHERTON-RATCLIFFE, </author> <title> The equity option volatility smile: an implicit finite-difference approach, </title> <journal> The Journal of Computational Finance, </journal> <volume> 1 (1998), </volume> <pages> pp. 532. </pages>
Reference-contexts: Volatility is the only variable in this 1-factor model which is not directly observable in the market. Similar to the implied volatility in the constant volatility model, one possible idea is to imply this local volatility function from the market option price data. Indeed, it is established <ref> [17, 1] </ref> that the local volatility function can be uniquely determined from the European call options of all strikes and maturities, under the no arbitrage assumption of the observable European call option prices. Unfortunately, the market European option prices are typically limited to a relatively few different strikes and maturities. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. In <ref> [1] </ref> the local volatility is computed at each discretization nodal point with a PDE approach. The methods [2, 22] use a regularization approach to the ill-posed local volatility approximation problem. The closeness of the local volatility to a prior is used in [2] and smoothness is used in [22]. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective. <p> Let there be given observable arbitrage-free market European call prices v (K; T ) for all strikes K 2 [0; 1) and all maturities T 2 (0; t ]. From Proposition 1 in <ref> [1] </ref>, the local volatility function fl (s; t) of the diffusion process (1) that is consistent with the market is given uniquely by ( fl (K; T )) 2 = 2 @T + qv (K; T ) + K (r q) @v K 2 @ 2 v :(6) This formula suggests <p> Moreover, the dependence on the unknown volatility values is not uniform in the region R + fi [0; t ]. The option premium depends little on the volatility values with small t and s far from S init . It is convenient to view this as follows <ref> [1] </ref>: there exists a region centered around S init within which the volatility values are significant in pricing and hedging: we denote this region as D j for the option v j , see Fig. 1 for illustration of its typical shape. <p> We use the same parameter setting as in <ref> [1] </ref>: Let the initial stock index be S init = 100, the risk free interest rate r = 0:05 and the dividend rate q = 0:02. We consider, as market option data, 22 European call options on the underlying following the absolute diffusion process (12). <p> First, we let p = m and place the spline knots on the grid [0 : 20 : 200] fi <ref> [0; 1] </ref>. The initial volatility values at knots are specified as (0) i = 0:15; i = 1; ; 22. The resulting optimization problem is relatively easy to solve. <p> Fig. 2 demonstrates the accuracy of the local volatility reconstruction: the reconstructed spline surface c (s; t; fl ) very accurately approximates the the actual volatility surface fl (s; t) in the neighborhood of the region [75; 125] fi <ref> [0; 1] </ref>. To better observe accuracy of reconstruction, the three plots on the left in Fig. 3 display the local volatility curves for t = 0, 0:58 and 9 t = 1 respectively. <p> The three plots on the right of Fig. 3 display the local volatility curves reconstructed with eight spline knots placed on the mesh [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref>. We observe that the local volatility reconstruction remains excellent, with a slightly larger deviation when t is small and s is far from S init . FIG. 3. Left: Knots = [0 : 20 : 200] fi [0; 1], Right: Knots = [:4S init : :4S init : 1:6S <p> mesh [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref>. We observe that the local volatility reconstruction remains excellent, with a slightly larger deviation when t is small and s is far from S init . FIG. 3. Left: Knots = [0 : 20 : 200] fi [0; 1], Right: Knots = [:4S init : :4S init : 1:6S init ] fi [0; 1] To illustrate the accuracy of pricing using the reconstructed local volatility c (s; t; fl ) rather than the true local volatility fl (s; t), we compare prices and hedge factors of a number <p> FIG. 3. Left: Knots = [0 : 20 : 200] fi <ref> [0; 1] </ref>, Right: Knots = [:4S init : :4S init : 1:6S init ] fi [0; 1] To illustrate the accuracy of pricing using the reconstructed local volatility c (s; t; fl ) rather than the true local volatility fl (s; t), we compare prices and hedge factors of a number of European call options using both the true and reconstructed volatility surfaces. <p> We compare the local volatility reconstructions using the spline knots on the rectangular meshes [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref> (p = 8) and [0 : 2 : 200] fi [0; 1] (p = 202 &lt; M N ). The plots on the left in Fig. 4 illustrate the reconstructed local volatility curves using the rectangular mesh [:4S init : :4S init : 1:6S init ]fi [0; 1] for <p> We compare the local volatility reconstructions using the spline knots on the rectangular meshes [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref> (p = 8) and [0 : 2 : 200] fi [0; 1] (p = 202 &lt; M N ). The plots on the left in Fig. 4 illustrate the reconstructed local volatility curves using the rectangular mesh [:4S init : :4S init : 1:6S init ]fi [0; 1] for knots. <p> ] fi <ref> [0; 1] </ref> (p = 8) and [0 : 2 : 200] fi [0; 1] (p = 202 &lt; M N ). The plots on the left in Fig. 4 illustrate the reconstructed local volatility curves using the rectangular mesh [:4S init : :4S init : 1:6S init ]fi [0; 1] for knots. The plots on the right in Fig. 4 illustrate the reconstructed local volatility curves using the rectangular mesh [0 : 2 : 2S init ] fi [0; 1] for knots. <p> 4 illustrate the reconstructed local volatility curves using the rectangular mesh [:4S init : :4S init : 1:6S init ]fi <ref> [0; 1] </ref> for knots. The plots on the right in Fig. 4 illustrate the reconstructed local volatility curves using the rectangular mesh [0 : 2 : 2S init ] fi [0; 1] for knots. Although the available option prices are matched with very high accuracy (error about 10 6 ) using p = 202, the computed local volatility surface does not resemble the true local volatility surface fl (s; t). <p> Using eight knots on the rectangular mesh [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref>, on the other hand, yields a much more accurate volatility surface, even though the calibration error of the available options is larger (about 10 4 ). <p> The same initial underlying S init = 100 and the risk free interest rate r = 0:05 are used but the dividend rate q is set to zero. We consider European call options with strikes and maturities at the grid [80 : 4 : 120] fi <ref> [:25; :5; 1] </ref>. The spline knots are at the grid [0 : 20 : 2S init ] fi [:25; :5; 1]. Fig. 5 displays the price and hedge factors of options with maturity :25 year using the true volatility, reconstructed volatility, and constant implied volatility. <p> We consider European call options with strikes and maturities at the grid [80 : 4 : 120] fi <ref> [:25; :5; 1] </ref>. The spline knots are at the grid [0 : 20 : 2S init ] fi [:25; :5; 1]. Fig. 5 displays the price and hedge factors of options with maturity :25 year using the true volatility, reconstructed volatility, and constant implied volatility. <p> Using the constant implied volatility method, however, large errors exist in hedge factors (mostly noticeably in theta, delta, gamma and vega). 11 FIG. 4. Left: Knots = [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref>, Right: Knots = [0 : 2 : 200] fi [0; 1] 12 Maturity (in years) Strike (% of spot) 85% 90% 95% 100% 105% 110% 115% 120% 130% 140% .425 .177 .155 .138 .125 .109 .103 .100 .114 .130 .150 .94 .171 .159 .149 .137 .127 .113 .106 .103 <p> Using the constant implied volatility method, however, large errors exist in hedge factors (mostly noticeably in theta, delta, gamma and vega). 11 FIG. 4. Left: Knots = [:4S init : :4S init : 1:6S init ] fi <ref> [0; 1] </ref>, Right: Knots = [0 : 2 : 200] fi [0; 1] 12 Maturity (in years) Strike (% of spot) 85% 90% 95% 100% 105% 110% 115% 120% 130% 140% .425 .177 .155 .138 .125 .109 .103 .100 .114 .130 .150 .94 .171 .159 .149 .137 .127 .113 .106 .103 .100 .110 1.5 .169 .160 .151 .142 .133 .124 .119 .113 <p> A S&P 500 Example Illustrating Smoothness and Stability. We consider now a more realistic example of approximating the local volatility function fl (s; t) from the Euro-pean S&P 500 index call options. We use the same European call option data of October 1995 given in <ref> [1] </ref>. The market option price data (in the implied Black-Scholes constant volatility) is given in Table 2. Similar to [1], we use only the options with no more than two years maturity in our computation. The initial index, interest rate and dividend rate are set as in [1], S init = <p> We use the same European call option data of October 1995 given in <ref> [1] </ref>. The market option price data (in the implied Black-Scholes constant volatility) is given in Table 2. Similar to [1], we use only the options with no more than two years maturity in our computation. The initial index, interest rate and dividend rate are set as in [1], S init = $590; r = 0:06; and q = 0:0262: The discretization parameters in (11) are set N = 101; and <p> 1995 given in <ref> [1] </ref>. The market option price data (in the implied Black-Scholes constant volatility) is given in Table 2. Similar to [1], we use only the options with no more than two years maturity in our computation. The initial index, interest rate and dividend rate are set as in [1], S init = $590; r = 0:06; and q = 0:0262: The discretization parameters in (11) are set N = 101; and M = 101: In order to solve the proposed inverse spline volatility problem (7), we compute the market European call option prices with given strikes and maturities using <p> Moreover, since the market option data typically has bid-ask spreads, exact calibration of the option data (the average of the bid-ask spreads) is not necessary and can be harmful. Based on the formula (6) established in <ref> [17, 1] </ref>, the local volatility function fl (K; T ) 2 is smooth if the European call option value function v (K; T ) is sufficiently smooth. We use a spline functional approach to reconstruct the true local volatility function.
Reference: [2] <author> M. AVELLANEDA, C. FRIEDMAN, R. HOLEMES, AND D. SAMPERI, </author> <title> Calibrating volatility surfaces via relative entropy minimization, </title> <journal> Applied Mathematical Finance, </journal> <volume> 4 (1997), </volume> <pages> pp. 3764. </pages>
Reference-contexts: Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods <ref> [2, 22] </ref> use a regularization approach to the ill-posed local volatility approximation problem. The closeness of the local volatility to a prior is used in [2] and smoothness is used in [22]. <p> In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods [2, 22] use a regularization approach to the ill-posed local volatility approximation problem. The closeness of the local volatility to a prior is used in <ref> [2] </ref> and smoothness is used in [22]. The local volatility function approximation problem is ill-posed: there are typically an infinite number of solutions to the problem. It is not difficult to find a local volatility function (s; t) that matches the market option price data. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective.
Reference: [3] <author> G. BIRKHOFF AND C. R. DE BOOR, </author> <title> Piecewise polynomial interpolation and approximation, in Approximation of Functions, </title> <editor> H. L. Garabedian, ed., </editor> <address> Elsevier (New York), </address> <year> 1965, </year> <pages> pp. 164190. </pages>
Reference-contexts: For mechanical splines, this corresponds to minimize the elastic strain energy. For 2-dimensional surface fitting, the bicubic spline defined on a regular grid is twice continuously differentiable <ref> [3, 16] </ref>. The bicubic spline has a similar variational minimization 4 property. Advantages of spline interpolation include its fast convergence on many types of meshes, computational efficiency, and insensitivity to roundoff errors [3]. <p> For 2-dimensional surface fitting, the bicubic spline defined on a regular grid is twice continuously differentiable [3, 16]. The bicubic spline has a similar variational minimization 4 property. Advantages of spline interpolation include its fast convergence on many types of meshes, computational efficiency, and insensitivity to roundoff errors <ref> [3] </ref>. Approximating the local volatility function by a spline is particularly reasonable if the local volatility function is smooth. Is this a reasonable expectation for the local volatility function? Assume that the underlying follows the 1-factor diffusion process (1). <p> In our experiments, we often choose the number of knots equal to the number of observations. In order to construct and evaluate a spline efficiently, the spline knots can be placed in a rectangular mesh covering the region D and bicubic spline interpolation <ref> [3] </ref> can be used. FIG. 1.
Reference: [4] <author> F. BLACK AND M. SCHOLES, </author> <title> The pricing of options and corporate liabilities, </title> <journal> Journal of Political Economy, </journal> <volume> 81 (1973), </volume> <pages> pp. 637659. </pages>
Reference-contexts: 1. Introduction. An option pricing model establishes a relationship between the traded derivatives, the underlying asset and the market variables, e.g., volatility of the underlying asset <ref> [4, 24] </ref>. Option pricing models are used in practice to price derivative securities given knowledge of the volatility and other market variables. The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. <p> option pricing model establishes a relationship between the traded derivatives, the underlying asset and the market variables, e.g., volatility of the underlying asset <ref> [4, 24] </ref>. Option pricing models are used in practice to price derivative securities given knowledge of the volatility and other market variables. The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. This classical model assumes constant volatility; however, much recent evidence suggests that a constant volatility model is not adequate [27, 26].
Reference: [5] <author> I. BOUCHOUEV AND V. ISAKOV, </author> <title> The inverse problem of option pricing, Inverse Problems, </title> <booktitle> 13 (1997), </booktitle> <pages> pp. </pages> <month> L11L17. </month>
Reference-contexts: Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> Most of these methods [1, 5, 17, 13, 14, 21, 26] overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices <ref> [26, 13, 21, 5] </ref>. This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective.
Reference: [6] <author> M. A. BRANCH, T. F. COLEMAN, AND Y. LI, </author> <title> A subspace, interior and conjugate gradient method for large-scale bound-constrainedminimization, </title> <type> Tech. Report TR95-1525, </type> <institution> Computer Science Department, Cornell University, </institution> <year> 1995. </year>
Reference-contexts: Therefore (7) can be rewritten: min f () = 2 2 subject to l u:(9) Problem (9) is a box-constrained nonlinear least-squares problem in ; there are a variety of optimization methods available to enable its solution. In our implementation we use a trust region/interior method based on <ref> [7, 6] </ref>, in which a sequence of strictly interior points are generated: f (k) g 2 intfF g, where F = f 2 &lt; p : l ug.
Reference: [7] <author> T. F. COLEMAN AND Y. LI, </author> <title> An interior, trust region approach for nonlinear minimization subject to bounds, </title> <journal> SIAM Journal on Optimization, </journal> <volume> 6 (1996), </volume> <pages> pp. 418445. </pages>
Reference-contexts: Therefore (7) can be rewritten: min f () = 2 2 subject to l u:(9) Problem (9) is a box-constrained nonlinear least-squares problem in ; there are a variety of optimization methods available to enable its solution. In our implementation we use a trust region/interior method based on <ref> [7, 6] </ref>, in which a sequence of strictly interior points are generated: f (k) g 2 intfF g, where F = f 2 &lt; p : l ug.
Reference: [8] <author> T. F. COLEMAN AND A. VERMA, </author> <title> Structure and efficient Jacobian calculation, in Computational Differentiation: Techniques, Applications, and Tools, </title> <editor> M. Berz, C. Bischof, G. Corliss, and A. Griewank, eds., </editor> <publisher> SIAM, </publisher> <address> Philadelphia, Penn., </address> <year> 1996, </year> <pages> pp. 149159. </pages>
Reference-contexts: In this paper we explore two possibilities in the framework of our optimization approach: 1. Use of automatic differentiation <ref> [8] </ref> and/or finite-differencing to compute J (k) def = 2. Use of a secant update to approximate J (k) when p = m. 3.1. The Problem Structure.
Reference: [9] <author> J. C. COX AND S. A. ROSS, </author> <title> The valuation of options for alternative stochastic processes, </title> <journal> Journal of Financial Economics, </journal> <volume> 3 (1976), </volume> <pages> pp. 145166. </pages>
Reference-contexts: Thus the option strike and maturity vectors are given below K = [90; 92; ; 110; 90; 92; ; 110] 2 &lt; 22 ; For the absolute diffusion process (12), the analytic formula for pricing European options exists <ref> [9] </ref> and we set the market European option call price v j equal to this analytic value. The discretization parameters in (11) are set as M = 101 and N = 51. FIG. 2.
Reference: [10] <author> S. R. DAS AND R. K. SUNDARAM, </author> <title> Of smiles and smirks: A term-structure perspective, </title> <type> Tech. </type> <note> Report NBER working paper No. 5976, </note> <institution> Department of Finace, Harvard Business School, Harvard University, </institution> <address> Boston, MA 02163, </address> <year> 1997. </year>
Reference-contexts: A few different approaches have been proposed for modeling the volatility smile. One class of methods (Merton [25]) assumes a Poisson jump diffusion process for the underlying asset. Stochastic volatility models (Hull and White [20]) have also been used. Das and Sundaram <ref> [10] </ref> indicate that neither of these types of models sufficiently explains the implied volatility structure.
Reference: [11] <author> C. DE BOOR, </author> <title> Spline Toolbox for use with MATLAB, </title> <publisher> The Math Works Inc., </publisher> <year> 1997. </year>
Reference-contexts: Given any , the bicubic spline c (s; t; ) with the variational end condition (the second order derivative at the end is zero) is computed and evaluated using the functions in the Matlab spline toolbox <ref> [11] </ref>.
Reference: [12] <author> J. E. DENNIS AND R. B. SCHNABEL, </author> <title> Numerical Methods for Unconstrained Optimization, </title> <publisher> Prentice-Hall, </publisher> <year> 1983. </year>
Reference-contexts: The Jacobian of F with respect to is required: J () def = rF (). Note that J is an m fi p matrix. In the square case when p = m, it is possible to use a standard secant update to approximate J, e.g., <ref> [12] </ref>, which can significantly reduce the cost. Under reasonable assumptions a superlinear rate of convergence can be achieved.
Reference: [13] <author> E. DERMAN AND I. KANI, </author> <title> Riding on a smile, Risk, </title> <booktitle> 7 (1994), </booktitle> <pages> pp. </pages> <month> 3239. </month> <title> [14] , The local volatility surface: Unlocking the information in index option prices, </title> <journal> Financial Analysts Journal, </journal> <year> (1996), </year> <pages> pp. 2536. </pages>
Reference-contexts: Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> Most of these methods [1, 5, 17, 13, 14, 21, 26] overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices <ref> [26, 13, 21, 5] </ref>. This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective.
Reference: [15] <author> P. DIERCKX, </author> <title> An algorithm forsurface fitting with spline functions, </title> <journal> IMA Journal of Numerical Analysis, </journal> <volume> 1 (1981), </volume> <pages> pp. </pages> <month> 267283. </month> <title> [16] , Curve and Surface Fitting with Splines, </title> <publisher> Oxford Science Publications, </publisher> <year> 1993. </year>
Reference-contexts: If one decides to use more spline knots, additional regularization, e.g., min f () = 2 j=1 2 subject to l u;(8) is more appropriate: here &gt; 0 is a regularization parameter and ((s; t; )) is a smoothing norm for the tensor product splines <ref> [15] </ref>. In this paper, we focus on the formulation (7) and assume p is not greater than m.
Reference: [17] <author> B. DUPIRE, </author> <title> Pricing with a smile, Risk, </title> <booktitle> 7 (1994), </booktitle> <pages> pp. 1820. </pages>
Reference-contexts: The function fl (s; t) is called the local volatility function. The advantages of the 1-factor continuous diffusion model, compared to the jump or stochastic model, include that no non-traded source of risk such as the jump or stochastic volatility is introduced <ref> [17] </ref>. Consequently, the completeness of the model, i.e., the ability to hedge options with the underlying asset, is maintained. Completeness is ultimately important since it allows for arbitrage pricing and hedging [17]. <p> or stochastic model, include that no non-traded source of risk such as the jump or stochastic volatility is introduced <ref> [17] </ref>. Consequently, the completeness of the model, i.e., the ability to hedge options with the underlying asset, is maintained. Completeness is ultimately important since it allows for arbitrage pricing and hedging [17]. In order to price complex exotic options using a 1-factor diffusion model (1), the volatility function fl (s; t) needs to be approximated. Volatility is the only variable in this 1-factor model which is not directly observable in the market. <p> Volatility is the only variable in this 1-factor model which is not directly observable in the market. Similar to the implied volatility in the constant volatility model, one possible idea is to imply this local volatility function from the market option price data. Indeed, it is established <ref> [17, 1] </ref> that the local volatility function can be uniquely determined from the European call options of all strikes and maturities, under the no arbitrage assumption of the observable European call option prices. Unfortunately, the market European option prices are typically limited to a relatively few different strikes and maturities. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective. <p> Moreover, since the market option data typically has bid-ask spreads, exact calibration of the option data (the average of the bid-ask spreads) is not necessary and can be harmful. Based on the formula (6) established in <ref> [17, 1] </ref>, the local volatility function fl (K; T ) 2 is smooth if the European call option value function v (K; T ) is sufficiently smooth. We use a spline functional approach to reconstruct the true local volatility function.
Reference: [18] <author> A. GRIEWANK, </author> <title> Some bounds on the complexity of gradients, Jacobians, and Hessians, in Complexity in Nonlinear Optimization, </title> <editor> P. Pardalos, ed., </editor> <publisher> World Scientific Publishers, </publisher> <year> 1993, </year> <pages> pp. 128161. </pages>
Reference-contexts: In either case the work involved is O (p !(F )) where !(F ) is the work (flops) required to evaluate F . (In the finite-differencing case this is a tight bound whereas this bound can be undercut considerably if automatic differentiation is used <ref> [18] </ref>.) The gradient of f , with respect to , is simply J T F . Therefore if the function F and its Jacobian J have been computed as described above the gradient is given by a matrix-vector multiplication.
Reference: [19] <author> D. HEATH, R. JARROW, AND A. MORTON, </author> <title> Bond pricing and the term structure of interest rates: A new methodology for contingent claims valuation, </title> <journal> Econometrica, </journal> <volume> 60 (1992), </volume> <pages> pp. 77105. </pages>
Reference-contexts: (The conventional notion of positive volatility corresponds to p fl (s; t) 2 in our notation.) For simplicity, we assume that the instantaneous interest rate is a constant r &gt; 0 and the dividend rate is a constant q &gt; 0 (A general stochastic interest derivative pricing is described in <ref> [19] </ref>). Given S init , r and q, and under the no arbitrage assumption [24], an option with the volatility (s; t), strike price K, and maturity T has a unique price v ((s; t); K; T ).
Reference: [20] <author> J. HULL AND A. WHITE, </author> <title> The pricing of options on assets with stochastic volatilities, </title> <journal> Journal of Finance, </journal> <volume> 3 (1987), </volume> <pages> pp. 281300. </pages>
Reference-contexts: A few different approaches have been proposed for modeling the volatility smile. One class of methods (Merton [25]) assumes a Poisson jump diffusion process for the underlying asset. Stochastic volatility models (Hull and White <ref> [20] </ref>) have also been used. Das and Sundaram [10] indicate that neither of these types of models sufficiently explains the implied volatility structure.
Reference: [21] <author> J. JACKWERTH AND M. RUBINSTEIN, </author> <title> Recovering probability distributions from option prices, </title> <journal> The Journal of Finance, </journal> <volume> 51 (1996), </volume> <pages> pp. 16111631. </pages>
Reference-contexts: Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> Most of these methods [1, 5, 17, 13, 14, 21, 26] overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices <ref> [26, 13, 21, 5] </ref>. This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. <p> This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function <ref> [26, 21] </ref>. In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods [2, 22] use a regularization approach to the ill-posed local volatility approximation problem. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective.
Reference: [22] <author> R. LAGNADO AND S. OSHER, </author> <title> Reconciling differences, Risk, </title> <booktitle> 10 (1997), </booktitle> <pages> pp. 7983. </pages>
Reference-contexts: Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods <ref> [2, 22] </ref> use a regularization approach to the ill-posed local volatility approximation problem. The closeness of the local volatility to a prior is used in [2] and smoothness is used in [22]. <p> In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods [2, 22] use a regularization approach to the ill-posed local volatility approximation problem. The closeness of the local volatility to a prior is used in [2] and smoothness is used in <ref> [22] </ref>. The local volatility function approximation problem is ill-posed: there are typically an infinite number of solutions to the problem. It is not difficult to find a local volatility function (s; t) that matches the market option price data. <p> However, approximating the local volatility function from a finite set of option prices is more complex, compared to a standard function approximation problem, since the (observation) option price functional is nonlinear. Nevertheless, it is intuitive that smoothness regularization will play a similar role here. In <ref> [22] </ref> the lack of sufficient market option price data is overcome by regularizing with smoothness of the local volatility function. The local volatility is computed at each discretiza-tion point to match the given option prices with an additional objective of minimizing the change of the derivative r (s; t). <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> In addition, smoothness of the local volatility function can be important in computational option valuation schemes. Convergence of a PDE finite difference method, for example, depends on the smoothness of the function (s; t). In <ref> [22] </ref> it is proposed to use smoothness as a regularization condition to approximate the local volatility function. The regularized optimization problem min m X (v j ((s; t))) v j ) + kr (s; t)k 2 (5) is used in [22] where is a positive constant and k k 2 denotes <p> In <ref> [22] </ref> it is proposed to use smoothness as a regularization condition to approximate the local volatility function. The regularized optimization problem min m X (v j ((s; t))) v j ) + kr (s; t)k 2 (5) is used in [22] where is a positive constant and k k 2 denotes the L 2 norm. The change of the first order derivative is minimized depending on the regularization parameter for which determining a suitable value may not be easy. <p> A simple gradient descent algorithm is used in <ref> [22] </ref>. Since the optimization problem is (5) highly nonlinear, with such a method, the computed solution is typically inaccurate. <p> Reconstructing Local Volatility, Pricing and Hedging. In order to demonstrate the effectiveness of the proposed method in reconstructing the true local volatility surface and its accuracy in pricing and hedging, we consider a synthetic European call option example 8 used in <ref> [22] </ref>.
Reference: [23] <author> D. LAMBERTON AND B. LAPEYRE, </author> <title> Introduction to Stochastic Calculus Applied to Finance, </title> <publisher> Chapman & Hall, </publisher> <year> 1996. </year>
Reference-contexts: t)dW t ; t 2 [0; t ]; for some fixed time horizon [0; t ], W t is a Brownian motion, and (s; t), fl (s; t): &lt; + fi [0; t ] ! &lt; are deterministic functions sufficiently well behaved to guarantee that (1) has a unique solution <ref> [23] </ref>.
Reference: [24] <author> R. MERTON, </author> <title> The theory of rational option pricing, </title> <journal> Bell Journal of Economics and Management Science, </journal> <volume> 4 (1973), </volume> <pages> pp. </pages> <month> 141183. </month> <title> [25] , Option pricing when underlying stock returns are discontinuous, </title> <journal> Journal of Financial Economics, </journal> <volume> 3 (1976), </volume> <pages> pp. 124144. </pages>
Reference-contexts: 1. Introduction. An option pricing model establishes a relationship between the traded derivatives, the underlying asset and the market variables, e.g., volatility of the underlying asset <ref> [4, 24] </ref>. Option pricing models are used in practice to price derivative securities given knowledge of the volatility and other market variables. The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. <p> option pricing model establishes a relationship between the traded derivatives, the underlying asset and the market variables, e.g., volatility of the underlying asset <ref> [4, 24] </ref>. Option pricing models are used in practice to price derivative securities given knowledge of the volatility and other market variables. The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. This classical model assumes constant volatility; however, much recent evidence suggests that a constant volatility model is not adequate [27, 26]. <p> Given S init , r and q, and under the no arbitrage assumption <ref> [24] </ref>, an option with the volatility (s; t), strike price K, and maturity T has a unique price v ((s; t); K; T ). <p> Under the no arbitrage assumption, the option value satisfies the following generalized Black-Scholes equation <ref> [24] </ref> @V + (r q)s @s 1 (s; t) 2 s 2 @ 2 V The boundary conditions for the European call option are : lim @V (s; t) = e q (T t) ; t 2 [0; T ]; V (s; T ) = max (s K; 0): We use
Reference: [26] <author> M. RUBINSTEIN, </author> <title> Implied binomial trees, </title> <journal> The Journal of Finance, </journal> <volume> 49 (1994), </volume> <pages> pp. 771818. </pages>
Reference-contexts: The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. This classical model assumes constant volatility; however, much recent evidence suggests that a constant volatility model is not adequate <ref> [27, 26] </ref>. Indeed, numerically inverting the Black-Scholes formula on real data sets supports the notion of asymmetry with stock price (volatility skew), as well as dependence on time to expiration (volatility term structure). Collectively this dependence is often referred to as the volatility smile. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem <ref> [1, 2, 5, 17, 13, 14, 21, 22, 26] </ref>. <p> Due to insufficient market option price data, this is a well-known ill-posed problem. Computational methods have been proposed to solve this ill-posed problem [1, 2, 5, 17, 13, 14, 21, 22, 26]. Most of these methods <ref> [1, 5, 17, 13, 14, 21, 26] </ref> overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices [26, 13, 21, 5]. <p> Most of these methods [1, 5, 17, 13, 14, 21, 26] overcome the ill-posedness of the problem by assuming the existence of a complete spanning set of European call option 1 prices, which, in practice, requires use of extrapolation and interpolation of the available market option prices <ref> [26, 13, 21, 5] </ref>. This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function [26, 21]. <p> This can be problematic because potentially erroneous non-market information are introduced into the data. Rubinstein proposes to compute the implied probability without any exogenous assumption on the model for the local volatility function <ref> [26, 21] </ref>. In [1] the local volatility is computed at each discretization nodal point with a PDE approach. The methods [2, 22] use a regularization approach to the ill-posed local volatility approximation problem. <p> Since the observation data is finite, problems (2,3,4) are severely underdetermined: there are typically infinite number of solutions. It is easy to find a function (s; t) that matches the market option price data <ref> [2, 5, 17, 13, 14, 21, 22, 26] </ref>. The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. <p> The local volatility reconstruction problem (2,3,4) is a complicated nonstandard function approximation problem. The option price functional v ((s; t); K; T ) is nonlinear in the local volatility function (s; t). It is a nonlinear inverse function approximation problem. In most of the proposed methods <ref> [1, 2, 5, 17, 13, 14, 21, 26] </ref> matching the market option price data has been emphasized; it is often the only objective.
Reference: [27] <author> D. SHIMKO, </author> <title> Bounds of probability, Risk, </title> <booktitle> (1993), </booktitle> <pages> pp. 3337. </pages>
Reference-contexts: The celebrated constant-volatility Black-Scholes model [4, 24] is the most often used option pricing model in financial practice. This classical model assumes constant volatility; however, much recent evidence suggests that a constant volatility model is not adequate <ref> [27, 26] </ref>. Indeed, numerically inverting the Black-Scholes formula on real data sets supports the notion of asymmetry with stock price (volatility skew), as well as dependence on time to expiration (volatility term structure). Collectively this dependence is often referred to as the volatility smile.
Reference: [28] <author> A. N. TIKHONOV AND V. Y. ARSENIN, </author> <title> Solutions of Ill-posed Problems, </title> <editor> W. H. Winston, </editor> <address> Washington, D.C., </address> <year> 1977. </year>
Reference-contexts: Accurately approximating the true volatility function is especially important for computing hedge factors, even for simple European call/put options, see x4. Smoothness of the function has long been used as a regularization criterion for function approximation with a finite observation data <ref> [28, 29, 30] </ref>. Splines have known to possess good approximation theoretical properties for a model both when the function is fixed and smooth and when it is a sample function from a stochastic process [30]. <p> In other words, in addition to calibrating the market option price data sufficiently accurately, we would like to reconstruct the true local volatility function fl (s; t) of the diffusion model (1) as accurately as possible. Smoothness has long been used <ref> [28, 29, 30] </ref> as a regularization condition for a function approximation problem with a limited observation data. In addition, smoothness of the local volatility function can be important in computational option valuation schemes.
Reference: [29] <author> V. N. VAPNIK, </author> <title> Estimation of Dependences Based on Empirical Data, </title> <publisher> Springer-Verlag, </publisher> <address> Berlin, </address> <year> 1982. </year>
Reference-contexts: Accurately approximating the true volatility function is especially important for computing hedge factors, even for simple European call/put options, see x4. Smoothness of the function has long been used as a regularization criterion for function approximation with a finite observation data <ref> [28, 29, 30] </ref>. Splines have known to possess good approximation theoretical properties for a model both when the function is fixed and smooth and when it is a sample function from a stochastic process [30]. <p> In other words, in addition to calibrating the market option price data sufficiently accurately, we would like to reconstruct the true local volatility function fl (s; t) of the diffusion model (1) as accurately as possible. Smoothness has long been used <ref> [28, 29, 30] </ref> as a regularization condition for a function approximation problem with a limited observation data. In addition, smoothness of the local volatility function can be important in computational option valuation schemes.
Reference: [30] <author> G. WAHBA, </author> <title> Splines Models for Observational Data, </title> <booktitle> Series in Applied Mathematics, </booktitle> <volume> Vol. 56, </volume> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1990. </year>
Reference-contexts: Accurately approximating the true volatility function is especially important for computing hedge factors, even for simple European call/put options, see x4. Smoothness of the function has long been used as a regularization criterion for function approximation with a finite observation data <ref> [28, 29, 30] </ref>. Splines have known to possess good approximation theoretical properties for a model both when the function is fixed and smooth and when it is a sample function from a stochastic process [30]. <p> Splines have known to possess good approximation theoretical properties for a model both when the function is fixed and smooth and when it is a sample function from a stochastic process <ref> [30] </ref>. However, approximating the local volatility function from a finite set of option prices is more complex, compared to a standard function approximation problem, since the (observation) option price functional is nonlinear. Nevertheless, it is intuitive that smoothness regularization will play a similar role here. <p> In other words, in addition to calibrating the market option price data sufficiently accurately, we would like to reconstruct the true local volatility function fl (s; t) of the diffusion model (1) as accurately as possible. Smoothness has long been used <ref> [28, 29, 30] </ref> as a regularization condition for a function approximation problem with a limited observation data. In addition, smoothness of the local volatility function can be important in computational option valuation schemes. <p> Splines have long been used in approximating smooth curves and surfaces (see, e.g., [16]). They have also been used as a tool for regularizing ill-posedness of function approximations from finite observation data <ref> [30] </ref>. <p> The choice of the 1 If it is known that (s; t) is a function of s or t only, then one can use 1-dimensional spline. 5 number of knots and their placement in spline approximation is generally a complicated issue <ref> [16, 30] </ref>. The situation here is not typical for spline approximation due to the fact that the dependent option price function is not the function to be approximated. Rather, it depends on the values of the unknown volatility function in the region R + fi [0; t ].
Reference: [31] <author> R. ZVAN, K. VETZAL, AND P. FORSYTH, </author> <title> Swing high Swing low, Risk Magazine, </title> <booktitle> (1998), </booktitle> <pages> pp. 7174. 20 </pages>
Reference-contexts: Given a 2-dimensional grid the numerical solution of (10) is standard and discussed in several texts. Zvan et al <ref> [31] </ref> have a good discussion of complexity issues. It is possible to increase efficiency by employing a number of computing techniques such as vectorization and pipelining description of these implementation aspects goes beyond the scope of this paper. 7 3.2. Computing the Jacobian and the gradient.
References-found: 28

