URL: ftp://dimacs.rutgers.edu/pub/dimacs/TechnicalReports/TechReports/1997/97-72.ps.gz
Refering-URL: http://dimacs.rutgers.edu/TechnicalReports/1997.html
Root-URL: http://www.cs.rutgers.edu
Email: E-mail: elp@math-inst.hu  E-mail: m.steel@math.canterbury.ac.nz  E-mail: laszlo@math.sc.edu  E-mail: tandy@central.cis.upenn.edu  
Title: few logs suffice to build (almost) all trees (II)  
Author: by Peter L. Erd-os Michael A. Steel Laszlo A. Szekely Tandy J. Warnow 
Address: Budapest P.O.Box 127, Hungary-1364  Christchurch, New Zealand  Philadelphia PA  
Affiliation: Mathematical Institute of the Hungarian Academy of Sciences  Biomathematics Research Centre University of Canterbury  Department of Mathematics University of South Carolina Columbia, South Carolina  Department of Computer and Information Science University of Pennsylvania,  
Note: A  DIMACS is a partnership of Rutgers University, Princeton University, AT&T Labs-Research, Bell Labs and Bellcore. DIMACS is an NSF Science and Technology Center, funded under contract STC-91-19999; and also receives support from the New Jersey Commission on Science and Technology.  
Abstract: DIMACS Technical Report 97-72 October 1997 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> R. Agarwala, V. Bafna, M. Farach, B. Narayanan, M. Paterson, and M. </author> <title> Thorup, On the approximability of numerical taxonomy: fitting distances by tree metrics, </title> <booktitle> Proceedings of the 7th Annual ACM-SIAM Symposium on Discrete Algorithms, </booktitle> <year> 1996, </year> <pages> 365-372. </pages>
Reference-contexts: In addition to presenting the new method, we present a framework for a comparative analysis of different distance based methods, and use this framework to compare the convergence rate of several promising distance-based tree reconstruction methods: Neighbor Joining [38], the Agarwala et al. <ref> [1] </ref> approximation algorithm and its variant [20], and the Naive Quartet Method, which we describe in this paper. We show that all these distance-based methods may require sequences to grow exponentially in the diameter of the tree, and analyze the diameter of random trees under two distributions. <p> Many metrics have been considered, but all resultant optimization problems have been shown or are assumed to be NP-hard (see <ref> [1, 15, 22] </ref> for results on such problems). (VII) Specific tree construction algorithms. In this paper, we will be particularly interested in certain distance methods, the Four Point Method (FPM), the Naive Method, Neighbor Joining, and the Agarwala et al. algorithm. We now describe these methods. <p> The obvious optimization problem (find a maximum number of quartets which are simultaneously realizable) is of unknown computational complexity. The Agarwala et al. algorithm <ref> [1] </ref> is a 3-approximation algorithm for the nearest tree with respect to the L 1 -metric, where L 1 (A; B) = max ij jA ij B ij j. <p> log n):2 - 29 - 6.3 The performance of other distance methods under the Ney man 2-state model In this section we describe the convergence rate for the WAM and DCM method, and compare it briefly to the rates for two other distance-based methods, the Agarwala et al. 3-approximation algorithm <ref> [1] </ref> for the L 1 -nearest tree, and Neighbor Joining [38]. We make the natural assumption that all methods use the same corrected empirical distances from Neyman 2-state model trees. <p> The Agarwala et al. algorithm <ref> [1] </ref> is a distance-based method which provides a 3-approximation to the L 1 nearest tree problem, so that it is one of the few methods which provide a provable performance guarantee with respect to any relevant optimization criterion.
Reference: [2] <author> D. J. Aldous, </author> <title> Probability distributions on cladograms, in: Discrete Random Structures, </title> <editor> eds. D. J. Aldous and R. Permantle, Springer-Verlag, </editor> <booktitle> IMA Vol. in Mathematics and its Applications. </booktitle> <volume> Vol. 76, </volume> <year> 1995, </year> <pages> 1-18. </pages>
Reference-contexts: In order to understand the bound on the sequence length needed by these methods, we now turn to an analysis of the diameter of random trees. The models for random trees are the uniform model, in which each tree has the same probability, and the Yule-Harding model, studied in <ref> [2, 8, 26] </ref>. This distribution is based upon a simple model of speciation, and results in "bushier" trees than the uniform model. <p> Let diam (T ) denote the diameter of T . Then, we always have: h (T R ) diam (T ) 2h (T R ) 1: Now Aldous <ref> [2] </ref> shows that h (T R )= log n converges in distribution to a (nonzero) constant c.
Reference: [3] <author> N. Alon and J. H. Spencer, </author> <title> The Probabilistic Method, </title> <publisher> John Wiley and Sons, </publisher> <address> New York, </address> <year> 1992. </year>
Reference-contexts: Before we describe and analyze these search strategies, we begin with some results on the Four-Point Method, and on random trees. 5.1 Previous results Lemma 3 [Azuma-Hoeffding inequality, see <ref> [3] </ref>] Suppose X = (X 1 ; X 2 ; : : : ; X k ) are independent random variables taking values in any set S, and L : S k ! IR is any function that satisfies the condition: jL (u) L (v)j t whenever u and v differ
Reference: [4] <author> A. Ambainis, R. Desper, M. Farach, and S. Kannan. </author> <title> Nearly tight bounds on the learn-ability of evolution. To appear, </title> <booktitle> Proc. of the 1998 Foundations of Computer Science. </booktitle>
Reference-contexts: Finally we generalize our methods and results to more general Markov models, improving results of Ambainis et al. in <ref> [4] </ref>. The structure of the paper is as follows. In Section 2 we provide definitions and discuss tree reconstruction methods in general. <p> The use of the Agarwala et al. algorithm for inferring trees has been studied in two papers (see [21] for a study of its use for inferring trees under the Neyman model, and <ref> [4] </ref> for a study of its use for inferring trees under the general Markov model). However, both [21] and [4] consider the performance of the Agarwala et al. algorithm with respect to the variational distance metric. <p> of the Agarwala et al. algorithm for inferring trees has been studied in two papers (see [21] for a study of its use for inferring trees under the Neyman model, and <ref> [4] </ref> for a study of its use for inferring trees under the general Markov model). However, both [21] and [4] consider the performance of the Agarwala et al. algorithm with respect to the variational distance metric. Optimizing with respect to this metric is related to but distinct from estimating the tree T , since it is concerned as well with the mutational parameters p. <p> Even so, these techniques are essentially the same ones that have been used in other studies to obtain analytical results regarding convergence to the true tree (see also <ref> [4, 21] </ref>). - 10 - 4 The Witness-Antiwitness Tree Construction (WATC) 4.1 Introduction In this section we describe the Witness-Antiwitness Tree Construction algorithm (WATC). <p> This should be contrasted to the study of Ambainis et al. <ref> [4] </ref>.
Reference: [5] <author> K. Atteson. </author> <title> On the performance of neighbor-joining. </title> <note> To appear, Proc. of COCOON 1997. </note>
Reference-contexts: In <ref> [5] </ref>, Atteson proved the same result for Neighbor Joining though with a different constant. (The constant for Neighbor Joining is smaller than the constant for the Agarwala et al. algorithm, suggesting that Neighbor Joining can be guaranteed to be accurate from shorter sequences than Agarwala et al., on any tree in
Reference: [6] <author> H.-J. Bandelt and A. Dress, </author> <title> Reconstructing the shape of a tree from observed dissimilarity data, </title> <journal> Adv. App. Math., </journal> <volume> 7 (1986), </volume> <pages> 309-343. </pages>
Reference-contexts: The Naive Method uses the Four-Point Method to infer a split for every quartet i; j; k; l. Thus, if the the matrix is additive, the Four Point Method can be used to detect the valid quartet split on every quartet of vertices, and then standard algorithms <ref> [6, 14] </ref> can be used to reconstruct the tree from the set of splits.
Reference: [7] <author> V. Berry and O. Gascuel, </author> <title> Inferring evolutionary trees with strong combinatorial evidence, </title> <booktitle> Proc. </booktitle> <month> COCOON </month> <year> 1997. </year>
Reference-contexts: Note that the Naive Method is guaranteed to be accurate when the input distance matrix is additive, but it will also be accurate even from non-additive distance matrices under conditions which we will describe later (see Section 3). Most quartet-based methods (see, for example, <ref> [7, 45, 46] </ref>) begin in the same way, constructing a split for every quartet, and then accommodate possible inconsistencies using some technique specific to the method; the Naive Method, by contrast, only returns a tree if all inferred splits are consistent with that tree.
Reference: [8] <author> J. K. M. Brown, </author> <title> Probabilities of evolutionary trees, </title> <journal> Syst. Biol. </journal> <volume> 43 (1994), </volume> <pages> 78-91. - 43 </pages> - 
Reference-contexts: In order to understand the bound on the sequence length needed by these methods, we now turn to an analysis of the diameter of random trees. The models for random trees are the uniform model, in which each tree has the same probability, and the Yule-Harding model, studied in <ref> [2, 8, 26] </ref>. This distribution is based upon a simple model of speciation, and results in "bushier" trees than the uniform model.
Reference: [9] <author> D. J. Bryant and M. A. Steel, </author> <title> Extension operations on sets of leaf-labelled trees, </title> <journal> Adv. App. Math., </journal> <volume> 16 (1995), </volume> <pages> 425-453. </pages>
Reference: [10] <author> P. Buneman, </author> <title> The recovery of trees from measures of dissimilarity, in Mathematics in the Archaeological and Historical Sciences, </title> <editor> F. R. Hodson, D. G. Kendall, P. Tautu, eds.; </editor> <publisher> Edinburgh University Press, Edinburgh, </publisher> <year> 1971, </year> <pages> 387-395. </pages>
Reference-contexts: In <ref> [10] </ref>, Buneman showed that the following Four-Point Condition characterizes additive matrices (see also [40] and [57]): Theorem 1 (Four Point Condition) A matrix D is additive if and only if for all i; j; k; l (not necessarily distinct), the maximum of D ij + D kl ; D ik + <p> Now, h realizes the ij values on T . Thus, h fl also realizes the ij values, on T and since (as we show) the edge weighting is strictly positive, it follows, by classical results <ref> [10] </ref>, that this is the unique such edge weighting of T . Thus = h fl . Now for an edge e = (v; w) of T where w is a leaf, h (e) log det (M (e)) 0:5 log det (M (e)) as claimed.
Reference: [11] <author> M. Carter, M. Hendy, D. Penny, L. A. Szekely, and N. C. Wormald, </author> <title> On the distribution of lengths of evolutionary trees, </title> <journal> SIAM J. Disc. Math. </journal> <volume> 3 (1990), </volume> <pages> 38-47. </pages>
Reference-contexts: Proof. We begin by establishing (i). The result of Carter et al. <ref> [11] </ref> immediately implies that leaves a; b have distance m + 1 with probability exactly m!N (n 2; m)=(2n 5)!!. For * small, m * p n, this probability is fi ( m n ).
Reference: [12] <author> J. A. Cavender, </author> <title> Taxonomy with confidence, </title> <journal> Math. Biosci., </journal> <volume> 40 (1978), </volume> <pages> 271-280. </pages>
Reference-contexts: The simplest stochastic model is a symmetric model for binary characters due to Neyman [36], and was also developed independently by Cavender <ref> [12] </ref> and Farris [23]. Let f0; 1g denote the two states. The root is a fixed leaf, the distribution at the root is uniform. For each edge e of T we have an associated mutation probability, which lies strictly between 0 and 0:5.
Reference: [13] <author> J. T. Chang and J. A. Hartigan, </author> <title> Reconstruction of evolutionary trees from pairwise distributions on current species, </title> <booktitle> Computing science and statistics: Proceedings of the 23rd symposium on the interface (1991), </booktitle> <pages> 254-257. </pages>
Reference-contexts: This "identifiability" condition is violated under an extension of the i.i.d. Markov model when there is an unknown distribution of rates across sites as described by Steel et al. [44]. However, it is shown in Steel [42] (see also Chang <ref> [13] </ref>) that the identifiability condition holds for the i.i.d model under the weak conditions that the components of are not zero and the determinant det (M (e)) 6= 0; 1; 1, and in fact we can recover the underlying tree from the expected frequencies of patterns on just pairs of species.
Reference: [14] <author> H. Colonius and H. H. Schultze, </author> <title> Tree structure for proximity data, </title> <journal> Brit. J. Math. Stat. Psychol., </journal> <volume> 34 (1981), </volume> <pages> 167-180. </pages>
Reference-contexts: The Naive Method uses the Four-Point Method to infer a split for every quartet i; j; k; l. Thus, if the the matrix is additive, the Four Point Method can be used to detect the valid quartet split on every quartet of vertices, and then standard algorithms <ref> [6, 14] </ref> can be used to reconstruct the tree from the set of splits.
Reference: [15] <author> W.H.E. Day, </author> <title> Computational complexity of inferring phylogenies from dissimilarities matrices, </title> <journal> Information Processing Letters, </journal> <volume> 30 </volume> <pages> 215-220, </pages> <year> 1989. </year>
Reference-contexts: Many metrics have been considered, but all resultant optimization problems have been shown or are assumed to be NP-hard (see <ref> [1, 15, 22] </ref> for results on such problems). (VII) Specific tree construction algorithms. In this paper, we will be particularly interested in certain distance methods, the Four Point Method (FPM), the Naive Method, Neighbor Joining, and the Agarwala et al. algorithm. We now describe these methods.
Reference: [16] <author> P. L. Erd-os, K. Rice, M. Steel, L. Szekely, and T. Warnow, </author> <note> The Short Quartet Method. to appear, Mathematical Modelling and Scientific Computing, Principia Scientia. </note>
Reference-contexts: Therefore it is instructive to check the performance of our algorithm on caterpillars, the binary trees with depth one, since very large random trees, from the point of view of depth, are rather similar to caterpillars. In a joint paper with K. Rice <ref> [16] </ref>, we presented the results of a preliminary experimental performance analysis comparing a popular method Neighbor Joining [38] and a primitive version of WAM.
Reference: [17] <author> P. L. Erd-os, M. A. Steel, L. A. Szekely and T. Warnow, </author> <title> Local quartet splits of a binary tree infer all quartet splits via one dyadic inference rule. </title> <journal> Computers and Artificial Intelligence, </journal> <volume> Vol. 16, No. 2, pp.217-227, </volume> <year> 1997. </year>
Reference-contexts: For any w 2 R + , let Q w denote the set of quartet splits of width at most w, inferred using the Four-Point Method. 4.3 The Dyadic Closure Method The Dyadic Closure Method is based on the Dyadic Closure Tree Construction (DCTC) algorithm, which uses dyadic closure (see <ref> [19, 17] </ref>) to reconstruct a tree T consistent with - 12 - an input set Q of quartet splits.
Reference: [18] <author> P. L. Erd-os, M. A. Steel, L. A. Szekely and T. Warnow, </author> <title> Inferring big trees from short quartets. </title> <booktitle> Proceedings of ICALP 1997. </booktitle>
Reference: [19] <author> P. L. Erd-os, M. A. Steel, L. A. Szekely and T. Warnow, </author> <title> A few logs suffice to build (almost) all trees (I), Submitted, Random Structures and Algorithms. </title>
Reference-contexts: Determining bounds on that length and its growth with n has become more pressing since biologists have begun to reconstruct trees on increasingly larger numbers of species (often up to several hundred) from such sequences. In a previous paper <ref> [19] </ref>, we addressed this question for trees under the Neyman 2-state model of site evolution, and obtained the following results: 1. <p> Thus, the Dyadic Closure Method <ref> [19] </ref> has a very fast convergence rate, which on almost all trees is within a polynomial of our established lower bound of log n for any method. <p> The provable bounds on the running time of WAM depend heavily on the depth of the model tree. We introduced the "depth" - 2 - in <ref> [19] </ref> and showed that depth (T ) is bounded from above by log n for all binary trees T , and that random trees have depths bounded by O (log log n). <p> This procedure, which is the heart of our Witness-Antiwitness Method (WAM), solves certain restricted instances of the NP-complete Quartet Consistency Problem [41], and solves them faster than the Dyadic Closure Tree Construction algorithm (DCTC) that we used as a procedure previously in our Dyadic Closure Method (DCM) <ref> [19] </ref>. We therefore achieve an improvement with respect to computational requirements over DCM, and pay for it by requiring somewhat longer sequences. Let e be an edge in T . <p> We will say that Q is consistent if there exists a tree T with which Q is consistent, and otherwise Q is said to be inconsistent. In <ref> [19] </ref>, we proved: Theorem 3 Let T be a binary tree on [n]. If R T is consistent with a binary tree T 0 on [n], then T = T 0 . Therefore, if R T Q, then either Q is inconsistent, or Q is consistent with T . <p> For any w 2 R + , let Q w denote the set of quartet splits of width at most w, inferred using the Four-Point Method. 4.3 The Dyadic Closure Method The Dyadic Closure Method is based on the Dyadic Closure Tree Construction (DCTC) algorithm, which uses dyadic closure (see <ref> [19, 17] </ref>) to reconstruct a tree T consistent with - 12 - an input set Q of quartet splits. <p> The dyadic closure of a set Q is denoted by cl (Q), and consists of all splits that can be inferred by combining two splits at a time from Q, and from previously inferred quartet splits. In <ref> [19] </ref>, we showed that the dyadic closure cl (Q) could be computed in O (n 5 ) time, and that if Q contained all the representative quartet splits of a tree, and contained only valid quartet splits, (i.e. if R T Q Q (T )), then cl (Q) = Q (T <p> Consequently, DCTC can be used as part of a tree construction method, where splits of quartets (of some specified width w) are estimated using some specified method, and we search through the possible widths w using binary search. In <ref> [19] </ref>, we studied a specific variant of this approach, called the Dyadic Closure Method (DCM), in which quartet trees are estimated using the Four-Point Method (see Definition VII in Section 2). <p> Suppose T is a fixed binary tree, and Q is a set of quartet splits defined on the leaves of T . The problem of reconstructing T from Q is in general NP-hard [41], but in <ref> [19] </ref> we showed that if R T Q Q (T ) we can reconstruct T in O (n 5 ) time, and validate that T is the unique tree consistent with Q. <p> Thus, this is a significantly faster algorithm than the DCTC algorithm that we presented in <ref> [19] </ref>. Definition 4: T -forcing sets of quartet splits: A set Q of quartet splits is said to be T -forcing if there exists a binary tree T such that 1. R T Q Q (T ), and 2. Q has the antiwitness property for T . <p> Finally, note that the first condition R T Q Q (T ) was the requirement we made for the Dyadic Closure Tree Construction (DCTC) algorithm in <ref> [19] </ref>, and so T -forcing sets of quartet splits have to satisfy the assumptions of the DCTC algorithm, plus one additional assumption: having the antiwitness property. 4.5 WATC The algorithm we will now describe operates by constructing the tree from the outside in, via a sequence of iterations. <p> Then, IP [L (X) IE [L (X)] ] exp 2t 2 k ; 2 ! In <ref> [19] </ref>, we proved: Theorem 9 Assume that z is a lower bound for the transition probability of any edge of a tree T in the Neyman 2-state model, y max E ij is an upper bound on the compound changing probability over all ij paths in a quartet q of T <p> The probability that FPM fails to return the correct quartet split on q is at most 18 exp (1 1 2z) 2 (1 2y) 2 k=8) :2 (8) In <ref> [19] </ref> we also provided an upper bound on the growth of the depth of random trees under two distributions: - 21 - Theorem 10 (i) For a random semilabelled binary tree T with n leaves under the uniform model, depth (T ) (2 + o (1)) log 2 log 2 (2n) <p> The analysis of the sequence length requirement follows a similar analysis for DCM in <ref> [19] </ref>, but turns out to be more complicated, and results in constant times longer sequences. The analysis of the computational complexity of WAM is both in the worst case, and under the assumption that the tree topology is drawn from a random distribution. <p> Proof. Recall the definition of the corrected empirical distance, ^ ij . By analogy with the proof of Theorem 9 (also see Theorem 8 and Formula (17) from <ref> [19] </ref>), fi fi ij ^ ij fi is the same, as x tends to zero, as requiring the counterparts of [19], Formulae (19) and (20) for a fl &gt; 0: fi fidet (F ij ) det ( ^ F ij ) fi fi &lt; x (1 fl) det (F ij )=2: <p> Proof. Recall the definition of the corrected empirical distance, ^ ij . By analogy with the proof of Theorem 9 (also see Theorem 8 and Formula (17) from <ref> [19] </ref>), fi fi ij ^ ij fi is the same, as x tends to zero, as requiring the counterparts of [19], Formulae (19) and (20) for a fl &gt; 0: fi fidet (F ij ) det ( ^ F ij ) fi fi &lt; x (1 fl) det (F ij )=2: (45) (We return to [19], Formula (20) later.) To apply Lemma 3, we need to know how det ( ^ <p> ij fi is the same, as x tends to zero, as requiring the counterparts of <ref> [19] </ref>, Formulae (19) and (20) for a fl &gt; 0: fi fidet (F ij ) det ( ^ F ij ) fi fi &lt; x (1 fl) det (F ij )=2: (45) (We return to [19], Formula (20) later.) To apply Lemma 3, we need to know how det ( ^ F ij ) responds to the replacement at one site of a pattern by a different pattern. <p> A counterpart of the troublesome <ref> [19] </ref>, Formula (20) also can be established, with a slightly worse RHS than that of (48). <p> Hence, for any fixed quartet q of diameter diam (q), IP [FPM errs on q] exp Dx 2 (1 2x 0 ) 2diam (q) Thus we have an analogue of Theorem 9 (but also see Theorem 8 in <ref> [19] </ref>). Now we show how to generalize the proof of Theorem 11. To avoid needless repetitions, we give details for the proof of Assumption (9) only, and leave the proofs of Assumptions (10) and (11) to the Reader.
Reference: [20] <author> M. Farach, and J. Cohen, </author> <title> Numerical Taxonomy on Data: Experimental Results, </title> <booktitle> ACM-SIAM Symposium on Discrete Algorithms, </booktitle> <year> 1997. </year>
Reference-contexts: In addition to presenting the new method, we present a framework for a comparative analysis of different distance based methods, and use this framework to compare the convergence rate of several promising distance-based tree reconstruction methods: Neighbor Joining [38], the Agarwala et al. [1] approximation algorithm and its variant <ref> [20] </ref>, and the Naive Quartet Method, which we describe in this paper. We show that all these distance-based methods may require sequences to grow exponentially in the diameter of the tree, and analyze the diameter of random trees under two distributions.
Reference: [21] <author> M. Farach, and S. Kannan, </author> <title> Efficient algorithms for inverting evolution, </title> <booktitle> Proceedings of the ACM Symposium on the Foundations of Computer Science, </booktitle> <year> 1996, </year> <pages> 230-236. </pages>
Reference-contexts: The use of the Agarwala et al. algorithm for inferring trees has been studied in two papers (see <ref> [21] </ref> for a study of its use for inferring trees under the Neyman model, and [4] for a study of its use for inferring trees under the general Markov model). However, both [21] and [4] consider the performance of the Agarwala et al. algorithm with respect to the variational distance metric. <p> The use of the Agarwala et al. algorithm for inferring trees has been studied in two papers (see <ref> [21] </ref> for a study of its use for inferring trees under the Neyman model, and [4] for a study of its use for inferring trees under the general Markov model). However, both [21] and [4] consider the performance of the Agarwala et al. algorithm with respect to the variational distance metric. Optimizing with respect to this metric is related to but distinct from estimating the tree T , since it is concerned as well with the mutational parameters p. <p> Even so, these techniques are essentially the same ones that have been used in other studies to obtain analytical results regarding convergence to the true tree (see also <ref> [4, 21] </ref>). - 10 - 4 The Witness-Antiwitness Tree Construction (WATC) 4.1 Introduction In this section we describe the Witness-Antiwitness Tree Construction algorithm (WATC). <p> Thus, these two methods are two of the most promising distance-based methods against which to compare our method. All these methods use polynomial time. In <ref> [21] </ref>, Farach and Kannan analyzed the performance of the Agarwala et al. algorithm with respect to tree reconstruction in the Neyman 2-state model, and proved that the Agar-wala et al. algorithm converged quickly for the variational distance. Personal communication from S.
Reference: [22] <author> M. Farach, S. Kannan, and T. Warnow, </author> <title> A robust model for inferring optimal evolutionary trees, </title> <note> Algorithmica 13 (1995) 155-179. </note>
Reference-contexts: Many metrics have been considered, but all resultant optimization problems have been shown or are assumed to be NP-hard (see <ref> [1, 15, 22] </ref> for results on such problems). (VII) Specific tree construction algorithms. In this paper, we will be particularly interested in certain distance methods, the Four Point Method (FPM), the Naive Method, Neighbor Joining, and the Agarwala et al. algorithm. We now describe these methods.
Reference: [23] <author> J. S. Farris, </author> <title> A probability model for inferring evolutionary trees, </title> <journal> Syst. Zool., </journal> <volume> 22 (1973), </volume> <pages> 250-256. </pages>
Reference-contexts: The simplest stochastic model is a symmetric model for binary characters due to Neyman [36], and was also developed independently by Cavender [12] and Farris <ref> [23] </ref>. Let f0; 1g denote the two states. The root is a fixed leaf, the distribution at the root is uniform. For each edge e of T we have an associated mutation probability, which lies strictly between 0 and 0:5.
Reference: [24] <author> D. Feng and R. Doolittle, </author> <title> Progressive sequence alignment as a prerequisite to correct phylogenetic trees, </title> <journal> J. Mol. Evol. </journal> <volume> 25(1987), </volume> <pages> 351-360. - 44 </pages> - 
Reference: [25] <editor> Green Plant Phylogeny Research Coordination Group, </editor> <booktitle> Summary report of Workshop #1: Current Status of the Phylogeny of the Charophyte Green Algae and the Em-bryophytes. </booktitle> <institution> University and Jepson Herbaria, University of California, Berkeley, </institution> <month> June 24-28, </month> <year> 1995. </year> <month> 7 January, </month> <year> 1996. </year>
Reference-contexts: This may make significantly longer sequences available to the reconstruction effort of very large trees than can currently be accommodated using traditional methods. (See <ref> [25] </ref> for a discussion of this particular issue.) * Robustness to model violations. The stochastic models of sequence evolution we have discussed make the unrealistic assumption that the sites evolve identically and independently. Surprisingly, WAM may be robust to violations of these assumptions.
Reference: [26] <author> E. F. Harding, </author> <title> The probabilities of rooted tree shapes generated by random bifurcation, </title> <journal> Adv. Appl. Probab. </journal> <volume> 3 (1971), </volume> <pages> 44-77. </pages>
Reference-contexts: In order to understand the bound on the sequence length needed by these methods, we now turn to an analysis of the diameter of random trees. The models for random trees are the uniform model, in which each tree has the same probability, and the Yule-Harding model, studied in <ref> [2, 8, 26] </ref>. This distribution is based upon a simple model of speciation, and results in "bushier" trees than the uniform model.
Reference: [27] <author> J. Hein, </author> <title> A new method that simultaneously aligns and reconstructs ancestral sequences for any number of homologous sequences, when the phylogeny is given, Mol. </title> <journal> Biol. Evol. </journal> <volume> 6(1989), </volume> <pages> 649-668. </pages>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [28] <author> D. Hillis, </author> <title> Approaches for assessing phylogenetic accuracy, </title> <journal> Syst. Biol. </journal> <volume> 44 (1995), </volume> <pages> 3-16. </pages>
Reference-contexts: Some methods are based upon sequences, while others are based upon distances. According to the practice in systematic biology (see, for example, <ref> [28, 29, 47] </ref>), a method is considered to be accurate if it recovers the unrooted binary tree T , even if it does not provide any estimate of the mutation probabilities.
Reference: [29] <author> D. Hillis, </author> <title> Inferring complex phylogenies, </title> <note> Nature Vol 383 12 September, </note> <year> 1996, </year> <pages> 130-131. </pages>
Reference-contexts: Some methods are based upon sequences, while others are based upon distances. According to the practice in systematic biology (see, for example, <ref> [28, 29, 47] </ref>), a method is considered to be accurate if it recovers the unrooted binary tree T , even if it does not provide any estimate of the mutation probabilities.
Reference: [30] <author> P. Hogeweg and B. Hesper, </author> <title> The alignment of sets of sequences and the construction of phylogenetic trees, an integrated method, </title> <journal> J. Mol. Evol. </journal> <volume> 20(1984), </volume> <pages> 175-186. </pages>
Reference: [31] <author> Huelsenbeck, J.1995. </author> <title> Performance of phylogenetic methods in simulation. </title> <journal> Syst. Biol. </journal> <volume> 44 </volume> <pages> 17-48. </pages>
Reference-contexts: The Neighbor Joining method [38] is a method for reconstructing trees from distance matrices, which is based upon agglomerative clustering. It is possibly the most popular method among molecular biologists for reconstructing trees, and does surprisingly well in some experimental studies; see, for example, <ref> [31, 32] </ref>. <p> Section 3. (Again, note that this analysis is inherently pessimistic, and it is possible that the methods may obtain accurate reconstructions from shorter sequences than suffice by this analysis.) The Neighbor Joining method is perhaps the most popular distance-based method used in phylogenetic reconstruction, and in many simulation studies (see <ref> [31, 32, 39] </ref> for an entry into this literature) it seems to outperform other popular distance based methods.
Reference: [32] <author> Huelsenbeck, J.P. and D. Hillis. </author> <year> 1993. </year> <title> Success of phylogenetic methods in the four-taxon case. </title> <journal> Syst. Biol. </journal> <volume> 42 </volume> <pages> 247-264. </pages>
Reference-contexts: The Neighbor Joining method [38] is a method for reconstructing trees from distance matrices, which is based upon agglomerative clustering. It is possibly the most popular method among molecular biologists for reconstructing trees, and does surprisingly well in some experimental studies; see, for example, <ref> [31, 32] </ref>. <p> Section 3. (Again, note that this analysis is inherently pessimistic, and it is possible that the methods may obtain accurate reconstructions from shorter sequences than suffice by this analysis.) The Neighbor Joining method is perhaps the most popular distance-based method used in phylogenetic reconstruction, and in many simulation studies (see <ref> [31, 32, 39] </ref> for an entry into this literature) it seems to outperform other popular distance based methods.
Reference: [33] <author> T. Jiang, E. Lawler, and L. Wang, </author> <title> Aligning sequences via an evolutionary tree: complexity and approximation, </title> <booktitle> ACM STOC '94. </booktitle>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [34] <author> S. Kannan, </author> <type> personal communication. </type>
Reference: [35] <author> M. Kimura, </author> <title> Estimation of evolutionary distances between homologous nucleotide sequences. </title> <booktitle> Proc. </booktitle> <institution> Nat. Acad. Sci. USA, </institution> <month> 78: </month> <pages> 454-458, </pages> <year> 1981. </year>
Reference-contexts: T , and if T has a troublesome edge e corresponding to edges e 1 and e 2 in T , then (e) 0:5 log (det (M (e 1 )) det (M (e 2 ))) : 3 This condition certainly holds under the Neyman 2-state model, the Kimura 3-st model <ref> [35] </ref>, and much more general models (providing each state has positive probability of occurring at the root).
Reference: [36] <author> J. Neyman, </author> <title> Molecular studies of evolution: a source of novel statistical problems. in Statistical Decision Theory and Related Topics, </title> <editor> Gupta, S. S. and J. Yackel (eds), </editor> <address> New York, </address> <publisher> Academic Press, </publisher> <year> 1971, </year> <pages> 1-27. </pages>
Reference-contexts: The simplest stochastic model is a symmetric model for binary characters due to Neyman <ref> [36] </ref>, and was also developed independently by Cavender [12] and Farris [23]. Let f0; 1g denote the two states. The root is a fixed leaf, the distribution at the root is uniform.
Reference: [37] <author> K. Rice and T. Warnow, </author> <title> Parsimony is hard to beat!, </title> <booktitle> Proceedings, </booktitle> <month> COCOON </month> <year> 1997. </year>
Reference: [38] <author> Saitou, N., and M. Nei. </author> <year> 1987. </year> <title> The neighbor-joining method: A new method for reconstructing phylogenetic trees. Mol. </title> <journal> Biol. Evol. </journal> <volume> 4 </volume> <pages> 406-425. </pages>
Reference-contexts: In addition to presenting the new method, we present a framework for a comparative analysis of different distance based methods, and use this framework to compare the convergence rate of several promising distance-based tree reconstruction methods: Neighbor Joining <ref> [38] </ref>, the Agarwala et al. [1] approximation algorithm and its variant [20], and the Naive Quartet Method, which we describe in this paper. <p> Optimizing with respect to this metric is related to but distinct from estimating the tree T , since it is concerned as well with the mutational parameters p. The Neighbor Joining method <ref> [38] </ref> is a method for reconstructing trees from distance matrices, which is based upon agglomerative clustering. It is possibly the most popular method among molecular biologists for reconstructing trees, and does surprisingly well in some experimental studies; see, for example, [31, 32]. <p> distance methods under the Ney man 2-state model In this section we describe the convergence rate for the WAM and DCM method, and compare it briefly to the rates for two other distance-based methods, the Agarwala et al. 3-approximation algorithm [1] for the L 1 -nearest tree, and Neighbor Joining <ref> [38] </ref>. We make the natural assumption that all methods use the same corrected empirical distances from Neyman 2-state model trees. <p> In a joint paper with K. Rice [16], we presented the results of a preliminary experimental performance analysis comparing a popular method Neighbor Joining <ref> [38] </ref> and a primitive version of WAM.
Reference: [39] <author> Saitou, N. and T. Imanishi. </author> <year> 1989. </year> <title> Relative efficiencies of the Fitch-Margoliash, maximum parsimony, maximum likelihood, minimum evolution, and neighbor-joining methods of phylogenetic tree construction in obtaining the correct tree. Mol. </title> <journal> Biol. Evol. </journal> <volume> 6 </volume> <pages> 514-525. </pages>
Reference-contexts: Section 3. (Again, note that this analysis is inherently pessimistic, and it is possible that the methods may obtain accurate reconstructions from shorter sequences than suffice by this analysis.) The Neighbor Joining method is perhaps the most popular distance-based method used in phylogenetic reconstruction, and in many simulation studies (see <ref> [31, 32, 39] </ref> for an entry into this literature) it seems to outperform other popular distance based methods.
Reference: [40] <author> Y. A. Smolensky: </author> <title> A method for linear recording of graphs, </title> <institution> USSR Comput. Math. Phys., </institution> <month> 2 </month> <year> (1969), </year> <pages> 396-397. - 45 </pages> - 
Reference-contexts: In [10], Buneman showed that the following Four-Point Condition characterizes additive matrices (see also <ref> [40] </ref> and [57]): Theorem 1 (Four Point Condition) A matrix D is additive if and only if for all i; j; k; l (not necessarily distinct), the maximum of D ij + D kl ; D ik + D jl ; D il + D jk is not unique.
Reference: [41] <author> M. A. Steel, </author> <title> The complexity of reconstructing trees from qualitative characters and subtrees, </title> <journal> J. Classification, </journal> <volume> 9 (1992), </volume> <pages> 91-116. </pages>
Reference-contexts: This procedure, which is the heart of our Witness-Antiwitness Method (WAM), solves certain restricted instances of the NP-complete Quartet Consistency Problem <ref> [41] </ref>, and solves them faster than the Dyadic Closure Tree Construction algorithm (DCTC) that we used as a procedure previously in our Dyadic Closure Method (DCM) [19]. We therefore achieve an improvement with respect to computational requirements over DCM, and pay for it by requiring somewhat longer sequences. <p> Suppose T is a fixed binary tree, and Q is a set of quartet splits defined on the leaves of T . The problem of reconstructing T from Q is in general NP-hard <ref> [41] </ref>, but in [19] we showed that if R T Q Q (T ) we can reconstruct T in O (n 5 ) time, and validate that T is the unique tree consistent with Q.
Reference: [42] <author> M. A. Steel, </author> <title> Recovering a tree from the leaf colourations it generates under a Markov model, </title> <journal> Appl. Math. Lett., </journal> <volume> 7 (1994), </volume> <pages> 19-24. </pages>
Reference-contexts: In the most general stochastic model that we study the sequence sites evolve i.i.d. according to the general Markov model from the root <ref> [42] </ref>. We now briefly discuss this general Markov model. Since the i.i.d. condition is assumed, it is enough to consider the evolution of a single site in the sequences. <p> A similar phenomenon and hence a similar distance correction exists for the general stochastic model <ref> [42] </ref>, and is discussed in detail in Section 7. (VI) Tree reconstruction. <p> This "identifiability" condition is violated under an extension of the i.i.d. Markov model when there is an unknown distribution of rates across sites as described by Steel et al. [44]. However, it is shown in Steel <ref> [42] </ref> (see also Chang [13]) that the identifiability condition holds for the i.i.d model under the weak conditions that the components of are not zero and the determinant det (M (e)) 6= 0; 1; 1, and in fact we can recover the underlying tree from the expected frequencies of patterns on <p> Then (e) 0:5 log (det (M (e))) ffi (x) (42) for every edge e of T . Proof. The second inequality follows from the restriction we imposed above on det (M (e)). The first inequality in (42) follows from similar arguments to those appearing in Steel <ref> [42] </ref>; for the sake of completeness we give a proof. Let T be the unrooted version of T .
Reference: [43] <author> M. Steel, M. D. Hendy, D. Penny, </author> <title> Invertible models of sequence evolution, </title> <note> submitted to Mathematical Biosciences. </note>
Reference-contexts: Furthermore, d ij converges in probability to D ij as the sequence length tends to infinity. These mathematical facts also have significance for biology, since under certain continuous time Markov models <ref> [43] </ref>, which may be used to justify our models, l (e) and D ij are the expected number of back-and-forth state changes along edges and paths, respectively.
Reference: [44] <author> M. A. Steel, L. A. Szekely, and M. D. Hendy, </author> <title> Reconstructing trees when sequence sites evolve at variable rates, </title> <journal> Journal of Comput. Biol., </journal> <volume> 1 (1994), </volume> <pages> 153-163. </pages>
Reference-contexts: This "identifiability" condition is violated under an extension of the i.i.d. Markov model when there is an unknown distribution of rates across sites as described by Steel et al. <ref> [44] </ref>.
Reference: [45] <author> K. Strimmer and A. von Haeseler, Quartet Puzzling: </author> <title> a quartet Maximum Likelihood method for reconstructing tree topologies, Mol. </title> <journal> Biol. Evol., </journal> <volume> 13 (1996), </volume> <pages> 964-969. </pages>
Reference-contexts: Note that the Naive Method is guaranteed to be accurate when the input distance matrix is additive, but it will also be accurate even from non-additive distance matrices under conditions which we will describe later (see Section 3). Most quartet-based methods (see, for example, <ref> [7, 45, 46] </ref>) begin in the same way, constructing a split for every quartet, and then accommodate possible inconsistencies using some technique specific to the method; the Naive Method, by contrast, only returns a tree if all inferred splits are consistent with that tree.
Reference: [46] <author> K. Strimmer, N. Goldman, and A. von Haeseler, </author> <title> Bayesian probabilities and Quartet Puzzling, Mol. </title> <journal> Biol. Evol., </journal> <volume> 14 (1997), </volume> <pages> 210-211. </pages>
Reference-contexts: Note that the Naive Method is guaranteed to be accurate when the input distance matrix is additive, but it will also be accurate even from non-additive distance matrices under conditions which we will describe later (see Section 3). Most quartet-based methods (see, for example, <ref> [7, 45, 46] </ref>) begin in the same way, constructing a split for every quartet, and then accommodate possible inconsistencies using some technique specific to the method; the Naive Method, by contrast, only returns a tree if all inferred splits are consistent with that tree.
Reference: [47] <author> D. L Swofford, G. J. Olsen, P. J. Waddell, D. M. Hillis, </author> <title> Chapter 11: Phylogenetic inference, in: Molecular Systematics, </title> <editor> D. M. Hillis, C. Moritz, B. K. Mable, eds., </editor> <booktitle> 2nd edition, </booktitle> <publisher> Sinauer Associates, Inc., </publisher> <address> Sunderland, </address> <year> 1996, </year> <pages> 407-514. </pages>
Reference-contexts: Some methods are based upon sequences, while others are based upon distances. According to the practice in systematic biology (see, for example, <ref> [28, 29, 47] </ref>), a method is considered to be accurate if it recovers the unrooted binary tree T , even if it does not provide any estimate of the mutation probabilities.
Reference: [48] <author> D. Harel and R.E. Tarjan. </author> <title> Fast Algorithms for finding nearest common ancestors, </title> <journal> SIAM J. Computing, </journal> <volume> 13 (1984), </volume> <pages> 338-355. </pages>
Reference-contexts: Preprocessing T so that we can do lca queries in O (1) time per query can be done in O (n) time, using the algorithm of Harel and Tarjan <ref> [48] </ref>. Consequently, we have proven: Theorem 6 The second stage of WATC takes O (n 2 + jQj log jQj) time.
Reference: [49] <author> N. Takezaki and M. Nei, </author> <title> Inconsistency of the maximum parsimony method when the rate of nucleotide substitution is constant, </title> <journal> J. Mol. Evol., </journal> <volume> 39 (1994), </volume> <pages> 210-218. </pages>
Reference: [50] <author> L. Wang and D. Gusfield, </author> <title> Improved approximation algorithms for tree alignment, </title> <note> to appear in Journal of Algorithms, </note>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [51] <author> L. Wang and T. Jiang, </author> <title> On the complexity of multiple sequence alignment, </title> <journal> J. Comput. Biol. </journal> <volume> 1 (1994), </volume> <pages> 337-348. </pages>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [52] <author> L. Wang, T. Jiang and E. Lawler, </author> <title> Approximation algorithms for tree alignment with a given phylogeny, </title> <booktitle> Algorithmica 16 (1996), </booktitle> <pages> 302-315. </pages>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [53] <author> L. Wang, T. Jiang and D. Gusfield, </author> <title> A more efficient approximation scheme for tree alignment in Proc. </title> <booktitle> First Annual International Conference on Computational Molecular Biology, </booktitle> <address> Jan. 1997, Santa Fe, NM. </address>
Reference-contexts: We direct the interested reader to the following papers which discuss the multiple sequence alignment problem and present results about the computational complexity of the multiple sequence alignment prob lem <ref> [33, 52, 51, 53, 50, 27] </ref>. 8.2 Confidence in the output tree If we apply the Witness-Antiwitness Method (WAM) to a given set of sequences, we may succeed in recovering the tree correctly, or we may reconstruct a tree different from the true tree, or we may not return any tree
Reference: [54] <author> T. Warnow, </author> <title> Combinatorial algorithms for constructing phylogenetic trees, </title> <type> PhD thesis, </type> <institution> University of California-Berkeley, </institution> <year> 1991. </year>
Reference: [55] <author> M. S. Waterman, T. F. Smith, M. Singh, and W. A. Beyer, </author> <title> Additive evolutionary trees, </title> <journal> J. Theoret. Biol., </journal> <volume> 64 (1977), </volume> <pages> 199-213. </pages>
Reference: [56] <author> Allan C. Wilson, Rebecca L. Cann, </author> <title> The recent African genesis of humans, </title> <booktitle> Scientific American April 1992, </booktitle> <pages> 68-73. - 46 </pages> - 
Reference-contexts: Hence short quartet based methods seem utterly appropriate for problems like the Eve hypothesis, the evolution of the HIV virus, or the Tree of Life. The research project <ref> [56] </ref> used mitochondrial DNA, described as "fast ticking clock", to discover the phylogeny of modern humans, and concluded with the controversial "Eve hypothesis": an African female who lived about 200,000 years ago, was a common ancestor of all present humans. Their tree [56] on p. 69 has 182 leaves, and by <p> The research project <ref> [56] </ref> used mitochondrial DNA, described as "fast ticking clock", to discover the phylogeny of modern humans, and concluded with the controversial "Eve hypothesis": an African female who lived about 200,000 years ago, was a common ancestor of all present humans. Their tree [56] on p. 69 has 182 leaves, and by a hand investigation seems to have diameter 19 and depth 4. Even so, our predicted improvement in performance needs to be verified on real data.
Reference: [57] <author> K. A. Zaretsky, </author> <title> Reconstruction of a tree from the distances between its pendant vertices, </title> <journal> Uspekhi Math. Nauk (Russian Mathematical Surveys), </journal> <note> 20 (1965), 90-92 (in Russian). </note>
Reference-contexts: In [10], Buneman showed that the following Four-Point Condition characterizes additive matrices (see also [40] and <ref> [57] </ref>): Theorem 1 (Four Point Condition) A matrix D is additive if and only if for all i; j; k; l (not necessarily distinct), the maximum of D ij + D kl ; D ik + D jl ; D il + D jk is not unique.
References-found: 57

