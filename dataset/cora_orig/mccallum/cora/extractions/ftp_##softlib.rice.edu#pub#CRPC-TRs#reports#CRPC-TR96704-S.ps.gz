URL: ftp://softlib.rice.edu/pub/CRPC-TRs/reports/CRPC-TR96704-S.ps.gz
Refering-URL: http://www.crpc.rice.edu/CRPC/softlib/TRs_online.html
Root-URL: 
Title: Block-Partitioned Algorithms for Solving the Linear Least Squares Problem  
Author: Gregorio Quintana-Ort Enrique S. Quintana-Ort Antoine Petitet 
Keyword: Key words. linear least squares, complete orthogonal factorization, QR factorization with column pivoting, rank-revealing QR factorization, block algorithm.  
Affiliation: University of Tennessee at Knoxville  
Note: LAPACK Working Note 113.  
Pubnum: Technical Report CS-96-333  
Abstract: The linear least squares problem arises in many areas of sciences and engineerings. When the coefficient matrix has full rank, the solution can be obtained in a fast way by using QR factorization with BLAS-3. In contrast, when the matrix is rank-deficient, or the rank is unknown, other slower methods should be applied: the SVD or the complete orthogonal decompositions. The SVD gives more reliable determination of rank but is computationally more expensive. On the other hand, the complete orthogonal decomposition is faster and in practice works well. We present several new implementations for solving the linear least squares problem by means of the complete orthogonal decomposition that are faster than the algorithms currently included in LAPACK. Experimental comparison of our methods with the LAPACK implementations on a wide range of platforms (such as IBM RS/6000-370, SUN HyperSPARC, SGI R8000, DEC Alpha/AXP, HP 9000/715, etc.) show considerable performance improvements. Some of the new code has been already included in the latest release of LAPACK (3.0). In addition, for full-rank matrices the performances of the new methods are very close to the performance of the fast method based on QR factorization with BLAS-3, thus providing a valuable general tool for full-rank matrices and rank-deficient matrices, as well as those matrices with unknown rank. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> E. Anderson, Z. Bai, C. Bischof, J. Demmel, J. Dongarra, J. DuCroz, A. Greenbaum, S. Hammarling, A. McKenney, S. Ostrouchov, and D. Sorensen, </author> <title> LAPACK User's Guide Release 2.0, </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1994. </year>
Reference-contexts: In contrast, the complete orthogonal decomposition is based on a low-cost algorithm, the QR decomposition with column pivoting, hereafter QRP. It theoretically provides less reliable rank determination, yet it usually performs well in practice. The LAPACK library provides driver subroutines for both approaches <ref> [1] </ref>. In this paper we present several faster algorithms for solving the LLS problem. We have developed code that has been included in LAPACK release 3.0. The new methods are complete block-partitioned algorithms, that is, the main computations are block oriented and implemented by using BLAS-3.
Reference: [2] <author> Z. Bai and J. Demmel, </author> <title> Design of a parallel nonsymmetric eigenroutine toolbox, Part I, </title> <booktitle> in Proceedings of the Sixth SIAM Conference on Parallel Processing for Scientific Computing, </booktitle> <editor> R. F. S. et al, ed., </editor> <publisher> SIAM, </publisher> <year> 1993, </year> <pages> pp. 391-398. </pages>
Reference: [3] <author> C. H. Bischof, </author> <title> A block QR factorization algorithm using restricted pivot-ing, </title> <booktitle> in Proceedings SUPERCOMPUTING '89, </booktitle> <address> Baltimore, Md., 1989, </address> <publisher> ACM Press, </publisher> <pages> pp. </pages> <month> 248-256. </month> <title> [4] , A parallel QR factorization algorithm with controlled local pivoting, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 12 (1991), </volume> <pages> pp. </pages> <month> 3657. </month> <title> [5] , Incremental Condition Estimator, </title> <journal> SIAM Journal on Matrix Analysis and Applications, </journal> <volume> vol. 11 no. 2 (1990), </volume> <pages> pp. 312-322. </pages>
Reference: [6] <author> C. H. Bischof and P. T. P. Tang, </author> <title> A robust incremental condition scheme, </title> <type> Argonne preprint MCS-P225-0391, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1991. </year>
Reference-contexts: Matrices A and B are scaled (if necessary) to avoid overflow and underflow. 2. The QR factorization with column pivoting of the matrix A is computed: AP = QR: 3. From the triangular matrix R, the numerical rank r of A is obtained using the incremental condition estimator ICE <ref> [5, 6] </ref>. This value defines the following partition of R: R = R 11 R 12 where R 11 is an r fi r well-conditioned upper triangular matrix. 4. <p> Both algorithms consist of two stages: preprocessing and postprocessing. The first stage is an efficient block-oriented algorithm for computing an approximate RRQR factorization. Basically, it is a windowed version of the QRP, based on BLAS-3 and monitorized by Bischof's incremental condition estimation (ICE) <ref> [5, 6] </ref>. The second stage is an efficient implementation of RRQR algorithms well-suited for triangular matrices. Subroutine xGEQPX includes a variant of S. Chandrasekaran and I. Ipsen's algorithm [14] with improvements with respect to condition estimation, termination criteria and Givens update.
Reference: [7] <author> C. H. Bischof and P. C. Hansen, </author> <title> Structure-preserving and rankrevealing QR factorizations, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 12 (1991), </volume> <pages> pp. </pages> <month> 1332-1350. </month> <title> [8] , A block algorithm for computing rank-revealing QR factorizations, Numerical Algorithms, </title> <booktitle> 2 (1992), </booktitle> <pages> pp. 371-392. 14 </pages>
Reference: [9] <author> C. H. Bischof and G. M. Shroff, </author> <title> On updating signal subspaces, </title> <journal> IEEE Transactions on Signal Processing, </journal> <volume> 40 (1992), </volume> <pages> pp. 96-105. </pages>
Reference: [10] <author> C. H. Bischof and G. </author> <title> Quintana-Ort , Computing rank-revealing QR factorizations of dense matrices, </title> <type> Argonne preprint MCS-P559-0196, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1996. </year> <title> [11] , Codes for rank-revealing QR factorizations of dense matrices, </title> <type> Argonne preprint MCS-P560-0196, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1996. </year>
Reference-contexts: A theoretical study as well as the description of this postprocessing algorithm can be found in [35]. Subroutine xGEQPY includes a variant of C. T. Pan and P. T. P. Tang's algorithm [32] with similar improvements. The experimental study in <ref> [10] </ref> shows that the performances of the these two new algorithms are usually within 15% of the performance of QR factorization (LAPACK xGEQRF) but 2 to 3 times faster than the QR factorization with column pivoting (LAPACK xGEQPF). 3.3 New LLS solvers Using the above mentioned algorithms we have developed the
Reference: [12] <author> A. Bj ork, </author> <title> Numerical Methods for Least Squares Problems, </title> <publisher> SIAM, </publisher> <address> Philadelphia, PA, USA, </address> <year> 1996, </year> <note> ISBN: 0-89871-360-9. </note>
Reference-contexts: A more detailed description of the LLS problem and related issues about existence and uniqueness of solutions, sensitivity, etc., can be consulted in <ref> [12, 20,30,37] </ref>. Let us focus now on the existing LLS solvers. If A has full rank, a fast method based on the QR factorization with BLAS-3 can be applied to solve the problem. However, if A is rank-deficient or its rank is unknown, alternative methods must be applied.
Reference: [13] <author> T. F. Chan, </author> <title> Rank revealing QR factorizations, Linear Algebra and Its Applications, </title> <booktitle> 88/89 (1987), </booktitle> <pages> pp. 67-82. </pages>
Reference: [14] <author> S. Chandrasekaran and I. Ipsen, </author> <title> On rank-revealing QR factorizations, </title> <journal> SIAM Journal on Matrix Analysis and Applications, </journal> <month> 15 </month> <year> (1994). </year>
Reference-contexts: Basically, it is a windowed version of the QRP, based on BLAS-3 and monitorized by Bischof's incremental condition estimation (ICE) [5, 6]. The second stage is an efficient implementation of RRQR algorithms well-suited for triangular matrices. Subroutine xGEQPX includes a variant of S. Chandrasekaran and I. Ipsen's algorithm <ref> [14] </ref> with improvements with respect to condition estimation, termination criteria and Givens update. A theoretical study as well as the description of this postprocessing algorithm can be found in [35]. Subroutine xGEQPY includes a variant of C. T. Pan and P. T. P. Tang's algorithm [32] with similar improvements.
Reference: [15] <author> J. Dongarra, J. D. Croz, I. Duff, and S. Hammarling, </author> <title> A set of Level 3 Basic Linear Algebra Subprograms, </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> 16 (1990), </volume> <pages> pp. 1-17. </pages>
Reference: [16] <author> J. J. Dongarra, J. R. Bunch, C. B. Moler, and G. W. Stewart, </author> <title> LINPACK Users' Guide, </title> <publisher> SIAM Press, </publisher> <address> Philadelphia, </address> <year> 1979. </year>
Reference: [17] <author> J. J. Dongarra, J. D. Croz, S. Hammarling, and R. J. Hanson, </author> <title> An extended set of Fortran basic linear algebra subprograms, </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> 14 (1988), </volume> <pages> pp. 1-17. </pages>
Reference: [18] <author> L. Eld en and R. Schreiber, </author> <title> An application of systolic arrays to lin-ear discrete ill-posed problems, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 7 (1986), </volume> <pages> pp. 892-903. </pages>
Reference-contexts: and by the Spanish CICYT Proyect # TIC96-1062-C03-03. y Departamento de Informatica, Universidad Jaime I, Campus Penyeta Roja, 12071 Castellon, Spain, gquintan@inf.uji.es. z Same address as first author; quintana@inf.uji.es. x Department of Computer Science, University of Tennessee at Knoxville, Tennessee, USA, petitet@cs.utk.edu. 1 least-squares problems [31], solution of integral equations <ref> [18] </ref>, and calculation of splines [22]. Specifically, the LLS problem consists in finding the vector x that satisfies min kAx bk 2 (1) where A is an m fi n coefficient matrix and b is a vector of n components.
Reference: [19] <author> G. H. Golub, </author> <title> Numerical methods for solving linear least squares prob-lems, </title> <journal> Numerische Mathematik, </journal> <volume> 7, </volume> <pages> pp. 206-216, </pages> <year> 1965. </year>
Reference: [20] <author> G. H. Golub and C. F. Van Loan, </author> <title> Matrix Computations, </title> <publisher> The Johns Hopkins University Press, Baltimore, </publisher> <editor> 2nd ed., </editor> <year> 1989. </year>
Reference-contexts: Therefore, no general fast method is available unless the matrix has full rank and it is known a priori. Currently, the two widely accepted numerical tools for solving the rank-deficient LLS problem are the Singular Value Decomposition (SVD) and the complete orthogonal decomposition <ref> [20] </ref>. The former is considered as the most reliable algorithm for solving the LLS problem but it presents an important drawback: its higher computational cost. In contrast, the complete orthogonal decomposition is based on a low-cost algorithm, the QR decomposition with column pivoting, hereafter QRP.
Reference: [21] <author> G. H. Golub, P. Manneback, and P. L. Toint, </author> <title> A comparison be-tween some direct and iterative methods for certain large scale geodetic least-squares problem, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 7 (1986), </volume> <pages> pp. 799-816. 15 </pages>
Reference-contexts: 1 Introduction The Linear Least Squares (LLS) problem arises in many areas of science and engineering, for example, in geodesy <ref> [21] </ref>, computer-aided design [23], nonlinear fl The two first authors were partially supported by the European ESPRIT Project # 9072 <br>- GEPPCOM and by the Spanish CICYT Proyect # TIC96-1062-C03-03. y Departamento de Informatica, Universidad Jaime I, Campus Penyeta Roja, 12071 Castellon, Spain, gquintan@inf.uji.es. z Same address as first author; quintana@inf.uji.es.
Reference: [22] <author> T. A. Grandine, </author> <title> An iterative method for computing multivariate C 1 piece--wise polynomial interpolants, </title> <booktitle> Computer Aided Geometric Design, 4 (1987), </booktitle> <pages> pp. </pages> <month> 307-319. </month> <title> [23] , Rank deficient interpolation and optimal design: An example, </title> <type> Tech. Report SCA-TR-113, </type> <institution> Boeing Computer Services, Engineering and Scientific Services Division, </institution> <month> February </month> <year> 1989. </year>
Reference-contexts: Proyect # TIC96-1062-C03-03. y Departamento de Informatica, Universidad Jaime I, Campus Penyeta Roja, 12071 Castellon, Spain, gquintan@inf.uji.es. z Same address as first author; quintana@inf.uji.es. x Department of Computer Science, University of Tennessee at Knoxville, Tennessee, USA, petitet@cs.utk.edu. 1 least-squares problems [31], solution of integral equations [18], and calculation of splines <ref> [22] </ref>. Specifically, the LLS problem consists in finding the vector x that satisfies min kAx bk 2 (1) where A is an m fi n coefficient matrix and b is a vector of n components.
Reference: [24] <author> M. Gu and S. Eisenstat, </author> <title> An efficient algorithm for computing a strong rank-revealing factorization, </title> <type> Tech. Report YALEU/DCS/RR-967, </type> <institution> Yale University, Department of Computer Science, </institution> <year> 1994. </year>
Reference: [25] <author> P. C. Hansen, </author> <title> Truncated SVD solutions to discrete ill-posed problems with ill-determined numerical rank, </title> <journal> SIAM Journal on Matrix Analysis and Applications, </journal> <volume> 11 (1990), </volume> <pages> pp. 503-518. </pages>
Reference: [26] <author> P. C. Hansen, S. Takishi, and S. Hiromoto, </author> <title> The Modified Truncated SVD-Method for Regularization in General Form, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 13 (1991), </volume> <pages> pp. 1142-1150. </pages>
Reference: [27] <author> Y. P. Hong and C.-T. Pan, </author> <title> The rank-revealing QR decomposition and SVD, </title> <journal> Mathematics of Computation, </journal> <volume> 58 (1992), </volume> <pages> pp. 213-232. </pages>
Reference: [28] <author> S. F. Hsieh, K. J. R. Liu, and K. Yao, </author> <title> Comparisons of truncated QR and SVD methods for AR spectral estimations, in SVD and Signal Processing II, </title> <editor> R. J. Vaccaro, ed., </editor> <publisher> Elsevier Science Publishers, </publisher> <year> 1991, </year> <pages> pp. 403418. </pages>
Reference: [29] <author> C. L. Lawson, R. J. Hanson, R. J. Kincaid, and F. T. Krogh, </author> <title> Basic linear algebra subprograms for Fortran usage, </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> 5 (1979), </volume> <pages> pp. 308-323. </pages>
Reference: [30] <author> C. L. Lawson, R. J. Hanson, </author> <title> Solving Least Squares Problems, </title> <journal> Classics in Applied Mathematics, </journal> <volume> 15. </volume> <publisher> SIAM, </publisher> <address> Philadelphia, PA, USA, </address> <year> 1995, </year> <note> ISBN: 0-89871-356-0. </note>
Reference: [31] <author> J. Mor e, </author> <title> The Levenberg-Marquardt algorithm: </title> <booktitle> Implementation and the-ory, in Proceedings of the Dundee Conference on Numerical Analysis, </booktitle> <editor> G. A. Watson, ed., </editor> <address> Berlin, 1978, </address> <publisher> Springer-Verlag. </publisher>
Reference-contexts: Project # 9072 <br>- GEPPCOM and by the Spanish CICYT Proyect # TIC96-1062-C03-03. y Departamento de Informatica, Universidad Jaime I, Campus Penyeta Roja, 12071 Castellon, Spain, gquintan@inf.uji.es. z Same address as first author; quintana@inf.uji.es. x Department of Computer Science, University of Tennessee at Knoxville, Tennessee, USA, petitet@cs.utk.edu. 1 least-squares problems <ref> [31] </ref>, solution of integral equations [18], and calculation of splines [22]. Specifically, the LLS problem consists in finding the vector x that satisfies min kAx bk 2 (1) where A is an m fi n coefficient matrix and b is a vector of n components.
Reference: [32] <author> C.-T. Pan and P. T. P. Tang, </author> <title> Bounds on singular values revealed by QR factorizaton, </title> <type> Tech. Report MCS-P332-1092, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1992. </year>
Reference-contexts: Ipsen's algorithm [14] with improvements with respect to condition estimation, termination criteria and Givens update. A theoretical study as well as the description of this postprocessing algorithm can be found in [35]. Subroutine xGEQPY includes a variant of C. T. Pan and P. T. P. Tang's algorithm <ref> [32] </ref> with similar improvements.
Reference: [33] <author> D. Pierce and J. G. Lewis, </author> <title> Sparse rank-revealing QR factorization, </title> <type> Tech. Report MEA-TR-193, </type> <institution> Boeing Computer Services, Engineering and Scientific Services Division, </institution> <year> 1992. </year> <month> 16 </month>
Reference: [34] <author> G. Quintana-Ort , X. Sun, and C. H. Bischof, </author> <title> A BLAS-3 version of the QR factorizaton with column pivoting, </title> <type> Tech. Report MCS-P551-1295, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1995. </year>
Reference-contexts: Our new algorithms can be categorized into two different types. The first type is based on a new BLAS-3 implementation of the QRP developed by G. Quintana-Ort, X. Sun and C. H. Bischof <ref> [34] </ref>. The second type relies on 2 a windowed version of the QRP developed by C. H. Bischof and G. Quintana-- Ort [10,11]. <p> Then we outline the main advantages of our LLS solvers. 3.1 BLAS-3 QR factorization with column pivoting (xGEQP3) This algorithm, developed by G. Quintana-Ort, X. Sun and C. H. Bischof <ref> [34] </ref> and called xGEQP3, is a BLAS-3 version of QRP with considerable performance improvements over LINPACK subroutine xQRDC (based on BLAS-1) and LA- PACK subroutine xGEQPF (based on BLAS-2), while maintaining the same numerical behavior as those implementations.
Reference: [35] <author> G. Quintana-Ort and E. S. </author> <title> Quintana-Ort , Guaranteeing termina-tion of Chandrasekaran & Ipsen's algorithm for computing rank-revealing QR factorizations, </title> <type> Tech. Report MCS-P564-0196, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1996. </year>
Reference-contexts: Subroutine xGEQPX includes a variant of S. Chandrasekaran and I. Ipsen's algorithm [14] with improvements with respect to condition estimation, termination criteria and Givens update. A theoretical study as well as the description of this postprocessing algorithm can be found in <ref> [35] </ref>. Subroutine xGEQPY includes a variant of C. T. Pan and P. T. P. Tang's algorithm [32] with similar improvements.
Reference: [36] <author> R. Schreiber and C. F. Van Loan, </author> <title> A storage efficient WY representa-tion for products of Householder transformations, </title> <journal> SIAM Journal on Scientific and Statistical Computing, </journal> <volume> 10 (1989), </volume> <pages> pp. 53-57. </pages>
Reference: [37] <author> G. W. Stewart, </author> <title> Introduction to Matrix Computations, </title> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1973. </year>
Reference: [38] <author> B. </author> <title> Wald en, Using a Fast Signal Processor to Solve the Inverse Kinematic Problem with Special Emphasis on the Singularity Problem, </title> <type> Ph. D. thesis, </type> <institution> Linkoping University, Dept. of Mathematics, </institution> <year> 1991. </year> <month> 17 </month>
References-found: 33

