URL: ftp://info.mcs.anl.gov/pub/tech_reports/reports/P561.ps.Z
Refering-URL: http://www.mcs.anl.gov/publications/abstracts/abstracts96.htm
Root-URL: http://www.mcs.anl.gov
Title: APPLYING NEW OPTIMIZATION ALGORITHMS TO MODEL PREDICTIVE CONTROL  
Author: Stephen J. Wright 
Keyword: optimization, model predictive control, interior-point methods  
Address: Argonne, IL 60439  
Affiliation: Mathematics and Computer Science Division Argonne National Laboratory  
Abstract: The connections between optimization and control theory have been explored by many researchers, and optimization algorithms have been applied with success to optimal control. The rapid pace of developments in model predictive control has given rise to a host of new problems to which optimization has yet to be applied. Concurrently, developments in optimization, and especially in interior-point methods, have produced a new set of algorithms that may be especially helpful in this context. In this paper, we reexamine the relatively simple problem of control of linear processes subject to quadratic objectives and general linear constraints. We show how new algorithms for quadratic programming can be applied efficiently to this problem. The approach extends to several more general problems in straightforward ways. 
Abstract-found: 1
Intro-found: 1
Reference: <author> Anderson, E., Bai, Z., Bischof, C., Demmel, J., Dongarra, J., Du Croz, J., Greenbaum, A., Hammarling, S., McKenney, A., Ostrouchov, S. and Sorensen, D. </author> <year> (1992). </year> <note> LAPACK User's Guide, SIAM, Philadel-phia. </note>
Reference-contexts: As we see below, the problem (1) benefits dramatically from such a reordering, since the coefficient matrix in this case becomes a narrow-banded matrix, which is easily factored via existing linear algebra software such as LAPACK <ref> (Anderson et al., 1992) </ref>. "Soft" Constraints and Penalty Terms The cost of introducing slack variables and dummy variables into the formulation (15) is often surprisingly small when the quadratic program is solved by the technique outlined above, even though the total number of variables in the problem may increase appreciably. <p> The banded matrix is best factored by Gaussian elimination with row partial pivoting, as implemented in the LAPACK routine dgbtrf and its affiliated so lution routine dgbtrs <ref> (Anderson et al., 1992) </ref>. To the author's knowledge, there is no software that can exploit the fact that the matrix is symmetric in addition to being banded.
Reference: <author> Ashcraft, C., Grimes, R. L. and Lewis, J. G. </author> <year> (1995). </year> <title> Accurate symmetric indefinite linear equation solvers. </title> <note> in preparation. </note>
Reference-contexts: Standard software is available, at least in the dense case (Anderson, Bai, Bischof, Demmel, Dongarra, Du Croz, Greenbaum, Hammar-ling, McKenney, Ostrouchov and Sorensen, 1992). Algorithms for the sparse case have also received considerable attention recently <ref> (Ashcraft, Grimes and Lewis, 1995) </ref> and have been implemented in the context of interior-point methods by (Fourer and Mehro-tra, 1993).
Reference: <author> Bertsekas, D. P. </author> <year> (1982). </year> <title> Projected Newton methods for optimization problems with simple constraints, </title> <journal> SIAM Journal on Control and Optimization 20: </journal> <pages> 221-246. </pages>
Reference: <author> Dennis, J. E. and Schnabel, R. B. </author> <year> (1983). </year> <title> Numerical Methods for Unconstrained Optimization, </title> <publisher> Prentice-Hall, </publisher> <address> Englewood Cliffs, NJ. </address>
Reference-contexts: and all k. (Note that k repre sents the average values of the terms x k i s k (iii) We require sufficient decrease in , in the sense that the decrease actually obtained is at least a small fraction of the decrease predicted by the linear model (7). (See <ref> (Dennis and Schnabel, 1983) </ref> for a discussion of sufficient decrease conditions.) (iv) The chosen value of ff k should not be too much smaller than the largest possible value for which (i)-(iii) are satisfied. For details, see (Wright, 1993b; Wright, 1996).
Reference: <author> Dunn, J. C. and Bertsekas, D. P. </author> <year> (1989). </year> <title> Efficient dynamic programming implementations of Newton's method for unconstrained optimal control problems, </title> <journal> Journal of Optimization Theory and Applications 63: </journal> <pages> 23-38. </pages>
Reference-contexts: The Hessian for (2) with respect to (u 0 ; : : : ; u N1 ) is dense, so the code would require O (N 3 m 3 ) operations simply to compute the Newton step. The paper by <ref> (Dunn and Bert-sekas, 1989) </ref> shows how the same step can be obtained through a specialized calculation that takes advantage of the structure in (2) and requires only O (N (m 3 +n 3 )) operations.
Reference: <author> Fletcher, R. </author> <year> (1987). </year> <title> Practical Methods of Optimization, second edn, </title> <publisher> John Wiley and Sons, </publisher> <address> New York. </address>
Reference-contexts: Interior-Point Methods for Linear-Quadratic Problems In this section, we consider the linear-quadratic problem (1). It has frequently been noted that this problem is, in optimization terms, a convex quadratic program. Two successful methods for addressing this class of problems are the active set method described by <ref> (Fletcher, 1987) </ref> and the interior-point method described by (Wright, 1996). However, the special structure of (1) means that we must take care in applying either approach to this problem. <p> The details are different from (and somewhat more complicated than) the interior-point case. We start by sketching a single iterate of the active set approach. For a more complete description, see <ref> (Fletcher, 1987) </ref>. Active set methods for the general convex program (15) generate a sequence of feasible iterates. At each iterate, a certain subset of the constraints Gz g are active (that is, hold as equalities).
Reference: <author> Fourer, R. and Mehrotra, S. </author> <year> (1993). </year> <title> Solving symmetric indefinite systems in an interior-point method for linear programming, </title> <booktitle> Mathematical Programming 62: </booktitle> <pages> 15-39. </pages>
Reference-contexts: Algorithms for the sparse case have also received considerable attention recently (Ashcraft, Grimes and Lewis, 1995) and have been implemented in the context of interior-point methods by <ref> (Fourer and Mehro-tra, 1993) </ref>. In solving the linear systems (18) or (19), we are free to reorder the rows and columns of the coefficient 6 IMPACT OF COMPUTER SCIENCE matrix in any way we choose, before or during the factorization.
Reference: <author> Garner, J., Spanbauer, M., Benedek, R., Strandburg, K. J., Wright, S. J. and Plassmann, P. E. </author> <year> (1992). </year> <title> Critical fields of josephson-coupled superconducting multi-layers, </title> <journal> Physical Review B 45: </journal> <pages> 7973-7983. </pages>
Reference-contexts: It has found applications in operations research, industrial engineering, and economics; in experimental sciences and statistics (the problem of fitting observed data to models is an optimization problem (Seber and Wild, 1989)); and in the physical sciences (for example, meteorological data assimilation (National Research Council, 1991) and superconductor modeling <ref> (Garner, Spanbauer, Benedek, Strandburg, Wright and Plassmann, 1992) </ref>). Most researchers in optimization work with a set of standard paradigms, each of which is a mathematical formulation that is supposed to represent a large class of applications. Examples include linear programming, convex quadratic programming, unconstrained nonlinear optimization, and nonlinear programming.
Reference: <author> Gill, P. E., Murray, W., Saunders, M. A. and Wright, M. H. </author> <year> (1991). </year> <title> Inertia-controlling methods for general quadratic programming, </title> <journal> SIAM Review 33: </journal> <pages> 1-36. </pages>
Reference-contexts: However, the special structure of (1) means that we must take care in applying either approach to this problem. A naive application of a quadratic programming code based on the active-set method (for instance, QPOPT <ref> (Gill, Murray, Saunders and Wright, 1991) </ref>) will give poor results, typically requiring O (N 3 (m + n + m c ) 3 ) operations, where m c is the number of rows in the matrices G and J.
Reference: <author> Golub, G. H. and Van Loan, C. F. </author> <year> (1989). </year> <title> Matrix Computations, 2nd edn, </title> <publisher> The Johns Hopkins University Press, </publisher> <address> Baltimore. </address>
Reference-contexts: with positive diagonal elements, we can eliminate from (18) to obtain an even more compact form: H 0 z = r k g + k oe k k (T k ) 1 e] h : Factorizations of symmetric indefinite matrices have been studied extensively in the linear algebra literature; see <ref> (Golub and Van Loan, 1989) </ref> for references to the major algorithms. Standard software is available, at least in the dense case (Anderson, Bai, Bischof, Demmel, Dongarra, Du Croz, Greenbaum, Hammar-ling, McKenney, Ostrouchov and Sorensen, 1992). <p> 5 2 6 6 6 6 0 0 . . . 3 7 7 7 7 : The expression (24) shows that the product ^ L ^ U of two triangular matrices differs from ^ M by a rank-one matrix, which can be accounted for by using the Sherman-Morrison-Woodbury formula <ref> (Golub and Van Loan, 1989, page 51) </ref>.
Reference: <author> Jacobson, D. H. and Mayne, D. Q. </author> <year> (1970). </year> <title> Differential Dynamic Programming, </title> <publisher> American Elsevier, </publisher> <address> New York. </address>
Reference-contexts: Optimal control and model predictive control illustrate the latter point. Many problems in these areas fit into one of the standard optimization paradigms, but it is often unclear how the optimization algorithms can be applied efficiently. In some cases, special-purpose algorithms have been devised (for example, differential dynamic programming <ref> (Jacobson and Mayne, 1970) </ref>); in other cases, standard optimization algorithms such as Newton's method, the conjugate gradient method, and gradient projection algorithms have been adapted successfully to the optimal control setting (Polak, 1970; Bertsekas, 1982; Dunn and Bertsekas, 1989).
Reference: <author> Kall, P. and Wallace, S. W. </author> <year> (1994). </year> <title> Stochastic Programming, </title> <publisher> John Wiley and Sons. </publisher>
Reference: <author> Mehrotra, S. </author> <year> (1992). </year> <title> On the implementation of a primal-dual interior point method, </title> <journal> SIAM Journal on Optimization 2: </journal> <pages> 575-601. </pages> <booktitle> 10 IMPACT OF COMPUTER SCIENCE National Research Council (1991). Four-Dimensional Model Assimilation of Data, </booktitle> <publisher> National Academy Press. </publisher>
Reference-contexts: A set of heuristics in which the factorization is essentially re-used on alternate steps was proposed by <ref> (Mehrotra, 1992) </ref>. Mehro-tra's algorithm has proved to be successful in practice and is the basis for the vast majority of interior-point codes for linear programming.
Reference: <author> Polak, E. </author> <year> (1970). </year> <title> Computational Methods in Optimization, </title> <publisher> Academic Press, </publisher> <address> New York. </address>
Reference: <author> Rawlings, J. B., Meadows, E. S. and Muske, K. R. </author> <year> (1994). </year> <title> Nonlinear model predictive control: A tutorial and survey, </title> <booktitle> Proceedings of ADCHEM, </booktitle> <address> Tokyo, Japan. </address>
Reference-contexts: We close this section with the example of the classical discrete-time optimal control problem with Bolza objectives, a problem that arises frequently in the MPC literature <ref> (Rawlings, Meadows and Muske, 1994) </ref>. This problem provides a nice illustration of the potential impact of optimization on control. It shows, too, that naive application of optimization algorithms to control problems can lead to gross inefficiencies, which can be remedied by a little customization and adaptation.
Reference: <author> Rawlings, J. B. and Muske, K. R. </author> <year> (1993). </year> <title> The stability of constrained receding horizon control, </title> <journal> IEEE Transactions on Automatic Control 38(10): </journal> <pages> 1512-1516. </pages>
Reference-contexts: In MPC applications such as receding horizon control <ref> (Rawlings and Muske, 1993) </ref> and constrained linear quadratic regulation (Scokaert and Rawlings, 1995), controls are obtained by solving problems like (1) repeatedly.
Reference: <author> Scokaert, P. O. M. and Rawlings, J. B. </author> <year> (1995). </year> <title> Constrained linear quadratic regulation, </title> <type> Technical report, </type> <institution> Department of Chemical Engineering, University of Wisconsin-Madison. </institution>
Reference-contexts: In MPC applications such as receding horizon control (Rawlings and Muske, 1993) and constrained linear quadratic regulation <ref> (Scokaert and Rawlings, 1995) </ref>, controls are obtained by solving problems like (1) repeatedly.
Reference: <author> Scokaert, P. O. M. and Rawlings, J. B. </author> <year> (1996). </year> <title> On in-feasibilities in model predictive control, Chemical Process Control: CPC-V, CACHE. </title>
Reference-contexts: This comment is relevant when we are adding norm constraints or "soft" constraints to the problems (15) or (1), as in <ref> (Scokaert and Rawl-ings, 1996) </ref>.
Reference: <author> Seber, G. A. F. and Wild, C. J. </author> <year> (1989). </year> <title> Nonlinear Regression, </title> <publisher> John Wiley and Sons, </publisher> <address> New York. </address>
Reference-contexts: Today, research in optimization continues to give impetus to other areas of mathematics, such as nonsmooth analysis, linear algebra, and combinatorics. It has found applications in operations research, industrial engineering, and economics; in experimental sciences and statistics (the problem of fitting observed data to models is an optimization problem <ref> (Seber and Wild, 1989) </ref>); and in the physical sciences (for example, meteorological data assimilation (National Research Council, 1991) and superconductor modeling (Garner, Spanbauer, Benedek, Strandburg, Wright and Plassmann, 1992)).
Reference: <author> Vandenberghe, L. and Boyd, S. </author> <year> (1994). </year> <title> Semidefinite programming, </title> <type> Technical report, </type> <institution> Electrical Engineering Department, Stanford University, Stanford, </institution> <address> CA 94305. </address> <note> To appear in SIAM Review. </note>
Reference: <author> Wright, S. J. </author> <year> (1993a). </year> <title> Interior point methods for optimal control of discrete-time systems, </title> <journal> Journal of Optimization Theory and Applications 77: </journal> <pages> 161-187. </pages>
Reference-contexts: As mentioned above, we can maintain the banded structure when outputs y k = Cx k and other constraints are introduced into the model, provided that we continue to order the variables by stage. The techniques outlined above are quite similar to those described in <ref> (Wright, 1993a) </ref>. The difference lies in the use of infeasible-interior-point methods above, in contrast to the techniques of (Wright, 1993a) which combined feasible interior-point methods with an embedding of the original problem into an expanded problem for which a feasible initial point is easy to compute. <p> The techniques outlined above are quite similar to those described in <ref> (Wright, 1993a) </ref>. The difference lies in the use of infeasible-interior-point methods above, in contrast to the techniques of (Wright, 1993a) which combined feasible interior-point methods with an embedding of the original problem into an expanded problem for which a feasible initial point is easy to compute. The new approach is cleaner, more practical, and more efficient, while remaining theoretically rigorous.
Reference: <author> Wright, S. J. </author> <year> (1993b). </year> <title> A path-following interior-point algorithm for linear and quadratic optimization problems, </title> <type> Preprint MCS-P401-1293, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, Ill. </institution> <note> To appear in Annals of Operations Research. </note>
Reference: <author> Wright, S. J. </author> <year> (1996). </year> <note> Primal-Dual Interior-Point Methods. Book in preparation. See URL http://www.mcs.anl.gov/home/wright/ippd.html. </note>
Reference-contexts: It has frequently been noted that this problem is, in optimization terms, a convex quadratic program. Two successful methods for addressing this class of problems are the active set method described by (Fletcher, 1987) and the interior-point method described by <ref> (Wright, 1996) </ref>. However, the special structure of (1) means that we must take care in applying either approach to this problem.
References-found: 23

