URL: http://www.ai.mit.edu/people/leventon/Research/SM-Thesis/thesis.ps
Refering-URL: http://www.ai.mit.edu/people/leventon/Research/SM-Thesis/
Root-URL: 
Title: A Registration, Tracking, and Visualization System for Image-Guided Surgery  
Author: by Michael Emmanuel Leventon W. Eric L. Grimson Arthur C. Smith 
Degree: Submitted to the Department of Electrical Engineering and Computer Science in partial fulfillment of the requirements for the degree of Master of Science in Computer Science and Engineering at the  All rights reserved. Author  Certified by  Professor of Electrical Engineering and Computer Science Thesis Supervisor Accepted by  Chairman, Departmental Committee on Graduate Students  
Date: May 1997  May 9, 1997  
Affiliation: MASSACHUSETTS INSTITUTE OF TECHNOLOGY  c Massachusetts Institute of Technology 1997.  Department of Electrical Engineering and Computer Science  
Abstract-found: 0
Intro-found: 1
Reference: [1] <author> L. Adams, A. Knepper, D. Meyer-Ebrecht, R. Ruger, W. van der Brug. </author> <title> "An Optical Navigator for Brain Surgery". </title> <journal> IEEE Computer, </journal> <volume> 29(1) </volume> <pages> 48-54, </pages> <month> Jan. </month> <year> 1996. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2. <p> We have also collected the following TMS data: * C t o | position and orientation of TMS coil at time t, t 2 <ref> [1; T ] </ref>, in world coordinates. 79 The arrows correspond to the positions of stimulation and are color-coded by response.
Reference: [2] <author> V.E. Amassian, R.Q. Cracco, P.J. Maccabee, J.B. Cracco, A.P. Rudell, L. Eberle. </author> <title> "Unmasking human visual perception with the magnetic coil and its relationship to hemispheric asymmetry". </title> <journal> Brain Research, </journal> <volume> 605 </volume> <pages> 312-316, </pages> <year> 1993. </year>
Reference-contexts: Vitamin E capsules are placed on the reference points prior to scanning to transfer the grid positions to the MR coordinates. The visual suppression experiments that we have performed are similar to those of Amassian et al. <ref> [2] </ref>, but once again, their registration technique is based on a manually drawn grid. Our navigation system provides a more accurate registration of patient and MR coordinate systems and allows for real-time tracking of the TMS coil during the mapping procedure.
Reference: [3] <author> N. Ayache. </author> <title> "Medical Computer Vision, Virtual Reality and Robotics". </title> <journal> Image and Vision Computing, </journal> <volume> 13 </volume> <pages> 295-313, </pages> <year> 1995. </year>
Reference: [4] <author> M. Bajura, H. Fuchs, R. Ohbuchi, </author> <title> "Merging virtual objects with the real world: Seeing ultrasound imagery within the patient", </title> <journal> in Computer Graphics, </journal> <volume> 26 </volume> <pages> 203-210, </pages> <year> 1992. </year>
Reference-contexts: Although there has been an explosive development of investigation into VR applications in medicine, AR applications might have a far greater utility, but have received much less attention [60]. An early study described the superposition of ultrasound images on the abdomen, using a position-tracked, see-through head mounted display <ref> [4] </ref>. Recently, there has been great interest in neurosurgical applications of AR. Specifically, the intraoperative registration of CT, MR, and PET images on a living patient in the operating room may greatly facilitate surgical planning and execution [30, 22, 32].
Reference: [5] <author> G. Barnett, D. Kormos, C. </author> <title> Steiner. "Frameless Stereotaxy Using a Sonic Digitizing Wand: Development and Adaptation to the Picker ViStar Medical Imaging System". R.J. </title> <editor> Maciunas, ed., </editor> <title> Interactive Image-Guided Neurosurgery, </title> <journal> American Association of Neurological Surgeons, </journal> <year> 1993. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> This error lies in the difficulty of accurately localizing the fiducials in both the internal scan and on the patient on the operating table. Some systems use CT scans to register where the slice thickness can be as much as 3 4 mm <ref> [5, 74] </ref>. Even using subvoxel localization of these fiducials in the image may result in a millimeter or two of error for each measurement. Measurement error is also introduced when localizing the fiducials on the patient. These measurement errors can result in inaccuracies in the computed registration. <p> Two frameless stereotactic systems that use such digitizers are described in <ref> [5, 66] </ref>. Such localizers are very sensitive to environmental effects such as temperature, air flow, ultrasonic noise, and echoes. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [6] <author> S.F. Barrett, M.R. Jerath, H.G. Rylander, A.J. Welch, </author> <title> "Digital tracking and control of retinal images", </title> <booktitle> in Optical Engineering, </booktitle> <volume> 33 </volume> <pages> 150-159, </pages> <year> 1994. </year>
Reference-contexts: Specifically, images of the posterior fundus will be acquired and montaged into a single data set. Available angiographic data will be registered (off line, i.e. not in real time) with the montaged data set prior to biomicroscopic examination. Welch and coworkers <ref> [54, 6, 7] </ref> and Becker et al. [8] describe algorithms for real-time retinal tracking for automated laser therapy, however, the tracking algorithms require multiple templates to follow retinal vessels at several fundus locations, and therefore requires a large illumination area; tracked vessels must be visible at all times.
Reference: [7] <author> S.F. Barrett, C.H.G. Wright, M.R. Jerath, S. Lewis, B.C. Dillard, H.G. Rylander, A.J. Welch, </author> <title> "Computer-aided retinal photocoagulation system", </title> <journal> in J Biomedical Optics, </journal> <volume> 1 </volume> <pages> 83-91, </pages> <year> 1996. </year>
Reference-contexts: Specifically, images of the posterior fundus will be acquired and montaged into a single data set. Available angiographic data will be registered (off line, i.e. not in real time) with the montaged data set prior to biomicroscopic examination. Welch and coworkers <ref> [54, 6, 7] </ref> and Becker et al. [8] describe algorithms for real-time retinal tracking for automated laser therapy, however, the tracking algorithms require multiple templates to follow retinal vessels at several fundus locations, and therefore requires a large illumination area; tracked vessels must be visible at all times.
Reference: [8] <author> D.E. Becker, J.N. Turner, H. Tannenbaum, B. Roysam, </author> <title> "Real-time image processing algorithms for an automated retinal laser surgery system", </title> <booktitle> in Proc IEEE 2nd Int Conf Image Proc, </booktitle> <year> 1995, </year> <pages> p 426-429. </pages>
Reference-contexts: Specifically, images of the posterior fundus will be acquired and montaged into a single data set. Available angiographic data will be registered (off line, i.e. not in real time) with the montaged data set prior to biomicroscopic examination. Welch and coworkers [54, 6, 7] and Becker et al. <ref> [8] </ref> describe algorithms for real-time retinal tracking for automated laser therapy, however, the tracking algorithms require multiple templates to follow retinal vessels at several fundus locations, and therefore requires a large illumination area; tracked vessels must be visible at all times.
Reference: [9] <author> R.H. Belmaker, A. Fleischmann, </author> <title> "Transcranial Magnetic Stimulation: A potential new frontier in Psychiatry", </title> <journal> in Biol. </journal> <volume> Psychiatry 38 </volume> <pages> 419-412, </pages> <year> 1995. </year>
Reference-contexts: The ability to relate induced magnetic stimulation response to anatomical models potentially provides the ability to identify and isolate damage to cortical tissue in a non-invasive manner. * Therapy. Some work has already begun on the utility of TMS as a therapeutic tool <ref> [9] </ref>, in the treatment of depression, akinesia, and related areas. <p> Maps generated from these experience have the potential to assist in the planning and performing of surgeries where a tumor is located near the language area. In addition to using TMS as a mapping tool, some work has already begun on the utility of TMS as a therapeutic tool <ref> [9] </ref>, in the treatment of depression, akinesia, and related areas.
Reference: [10] <author> P. Besl, N. McKay, </author> <title> "A Method for Registration of 3D Shapes", </title> <journal> in IEEE Trans. PAMI, </journal> <volume> 14(2), </volume> <year> 1992. </year>
Reference-contexts: Thirion et al. [35, 75] 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include <ref> [10, 27, 71, 86] </ref>. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system. Of particular interest to us is the tracking of medical instruments and the patient's head.
Reference: [11] <author> J. Bowskill, J. Downie, </author> <title> "Extending the capabilities of the human visual system. An introduction to enhanced reality", </title> <journal> in Computer Graphics, </journal> <volume> 29 </volume> <pages> 61-65, </pages> <year> 1995. </year>
Reference-contexts: As described by [26], an AR system utilizes computer generated graphics, such that the virtual world is superimposed on, and enriches, the real world. Whereas virtual reality (VR) is the graphical construction of a synthetic environment, AR extracts information from the real world and augments it <ref> [11, 17] </ref>. Although there has been an explosive development of investigation into VR applications in medicine, AR applications might have a far greater utility, but have received much less attention [60].
Reference: [12] <author> J.P. Brasil-Neto, L.M. McShane, P. Fuhr, M. Hallett, L.G. Cohen. </author> <title> "Topographic mapping of the human motor cortex with magnetic stimulation: factors affecting accuracy and reproducibility". </title> <booktitle> Electroencephalography and Clinical Neurophysiology 85 </booktitle> <pages> 9-16, </pages> <year> 1992. </year> <month> 117 </month>
Reference-contexts: The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps [62, 72, 84]. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including <ref> [12, 49, 56, 79] </ref>. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. Levy et al. [49] draws grid points at 2cm intervals along and perpendicular to the mid-sagittal line to establish a patient coordinate system.
Reference: [13] <author> L.G. Brown. </author> <title> "A Survey of Image Registration Techniques". </title> <journal> ACM Computing Surveys, </journal> <volume> 24(4) </volume> <pages> 325-376, </pages> <month> December, </month> <year> 1992. </year>
Reference-contexts: Several other groups have reported registration methods similar to ours for various applications. Surveys of related registration techniques can be found in <ref> [13] </ref> and [76]. Lavallee and Szeliski [72] also perform a least-squares minimization of a distance function to match data sets. Here, the distance is weighted by an estimate of the inverse variance of the measurement noise, and a Levenberg-Marquardt method is used to find the minimum.
Reference: [14] <author> R.D. Bucholz, K.R. Smith. </author> <title> "A Comparison of Sonic Digitizers Versus Light Emitting Diode-Based Localization". R.J. </title> <editor> Maciunas, ed., </editor> <title> Interactive Image-Guided Neurosurgery, </title> <journal> American Association of Neurological Surgeons, </journal> <year> 1993. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> Such devices are generally perceived as the most accurate, efficient, and reliable localization system <ref> [14, 18] </ref>. <p> Two frameless stereotactic systems that use such digitizers are described in [5, 66]. Such localizers are very sensitive to environmental effects such as temperature, air flow, ultrasonic noise, and echoes. Bucholz <ref> [14] </ref> compared sonic and LED-based digitizers and found sub-millimeter accuracy for both systems under controlled environments, but found that the error in the sonic localizer increased to over 2 mm once ultrasonic noise and temperature variation were added. 2.3 Patient Tracking Tracking patient head motion is often necessary since the head <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [15] <author> R.D. Bucholz, D.D. Yah, J. Trobaugh, L.L. McDurmont, C.D. Sturm, C. Bau-mann, J.M. Henderson, A. Levy, P. Kessman. </author> <title> "The correction of Stereotactic Inaccuracy Caused by Brain Shift Using an Interoperative Ultrasound Device". </title> <booktitle> Proceedings First Joint CVRMED/MRCAS, </booktitle> <address> Grenoble France, </address> <month> March </month> <year> 1997. </year>
Reference-contexts: When the skull cap is opened, the brain tends to swell. Also, as a tumor is removed, other tissue may move around. Hill, et al. [38] investigate the nature and extent of this type of brain shift. Bucholz, et al. <ref> [15] </ref> measure the degree of brain shift and explore the process of correcting for the shift using an intraoperative ultrasound device. Intraoperative scanning devices such as an open configuration MRI system can account for these errors by re-acquiring images as the surgery progresses [44]. <p> For example, even disregarding possible errors in imaging, registration, and tracking, navigation systems based solely on preopera-tive scans cannot account for brain shift during a procedure, which can cause over 7 mm of brain tissue motion <ref> [15, 38] </ref>. Despite these limitations, in our experience, neurosurgeons still report the navigation system to be very useful during surgery.
Reference: [16] <author> J.F. Canny, </author> <title> "A computational approach to edge detection" in IEEE Trans. Pat. </title> <journal> Anal. Mach. Intel., </journal> <volume> 8 </volume> <pages> 34-43, </pages> <year> 1986. </year>
Reference-contexts: We have implemented a modified, bidirectional Hausdorff-distance-based [41, 67] approach for image montaging. Multiple, partially overlapping fundus images are acquired. The images are then smoothed and edge detected <ref> [16] </ref>. To match two images together, the maximum Hausdorff fraction over translation, rotation, and scale is found. Given that the fundus images only partially overlap, if all points in both images are used in the Hausdorff fraction calculation, then the resulting fraction will be very low.
Reference: [17] <author> T.P. Caudell, </author> <title> "Introduction to augmented and virtual reality", </title> <booktitle> in Proc SPIE (Telemanipulator and Telepresence Technologies), </booktitle> <volume> 2351 </volume> <pages> 272-281, </pages> <year> 1994. </year>
Reference-contexts: As described by [26], an AR system utilizes computer generated graphics, such that the virtual world is superimposed on, and enriches, the real world. Whereas virtual reality (VR) is the graphical construction of a synthetic environment, AR extracts information from the real world and augments it <ref> [11, 17] </ref>. Although there has been an explosive development of investigation into VR applications in medicine, AR applications might have a far greater utility, but have received much less attention [60].
Reference: [18] <author> P. Cinquin et al. </author> <title> "Computer Assisted Medical Interventions". </title> <journal> IEEE EMB, </journal> <volume> 254 263, </volume> <month> May/June </month> <year> 1995. </year>
Reference-contexts: Such devices are generally perceived as the most accurate, efficient, and reliable localization system <ref> [14, 18] </ref>.
Reference: [19] <author> A.C.F. Colchester, J. Zhao, K.S. Holton-Tainter, C.J. Henri, N. Maitland, P.T.E. Roberts, C.G. Harris, R.J. Evans, </author> <title> "Development and Preliminary Evaluation of VISLAN, a Surgical Planning and Guidance System Using Intra-Operative Video Imaging". </title> <journal> Medical Image Analysis, </journal> <volume> 1(1) </volume> <pages> 73-90, </pages> <year> 1996. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Even if the trackable probe has high accuracy, the registration points may in fact have errors of 1 3 mm due to the operator not probing exactly on the skin surface. There may be a tendency to push down or lift up slightly during the acquisition process. Colchester <ref> [19] </ref> uses an active stereo system to construct the scalp surface. This system, similar to our laser scanning system, benefits from its ability to quickly acquire dense surface information about the contour of the skin. <p> Such a system benefits from not requiring any type of umbilical or power cable attached to the instrument or object. Colchester's VISLAN system <ref> [19] </ref> tracks instruments using a passive illumination optical imaging system. The hand-held localizer has a certain pattern on it that is easily extracted from the two stereo images to accurately compute the position of the pointer tip. <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [20] <author> A. Collignon, D. Verndermeulen, P. Suetens, and G. Marchal. </author> <title> "3D multi-modality medical image registration using feature space clustering". </title> <booktitle> In Proceedings of the First Conference on Computer Vision, Virtual Reality and Robotics in Medicine. </booktitle> <publisher> Springer, </publisher> <year> 1995. </year>
Reference-contexts: technique is based solely on the intensities in the images rather than particular features and 32 does not require an a priori model of the relationships between the intensities of the different images, it has proven to be a general approach applicable to a wide range of multi-modality fusion applications <ref> [84, 20, 51] </ref>. 3.1.5 Model Generation We use surface rendering techniques to display the segmented MRI structures. This procedure consists of first extracting bounding surfaces from the segmented MRI volume using the marching cubes algorithm [50].
Reference: [21] <author> A.P. Dempster, N.M. Laird, and D.B. Rubin. </author> <title> Maximum Likelihood from Incomplete Data via the EM Algorithm. </title> <journal> J. Roy. Statist. Soc., </journal> <volume> 39:1 - 38, </volume> <year> 1977. </year>
Reference: [22] <author> P.J. Edwards, D.L.G. Hill, D.J. Hawkes, R. Spink, A.C.F. Colchester, A. Strong, M. Gleeson, </author> <booktitle> "Neurosurgical guidance using the stereo microscope" in Proc First Int Conf Computer Vision, Virtual Reality and Robotics in Medicine, </booktitle> <address> Nice, France, p 555-564. </address>
Reference-contexts: Recently, there has been great interest in neurosurgical applications of AR. Specifically, the intraoperative registration of CT, MR, and PET images on a living patient in the operating room may greatly facilitate surgical planning and execution <ref> [30, 22, 32] </ref>. Typically, registration of the patient with the radiographic data is accomplished by tracking fiducial markers placed on the skin surface and tracking the position of the operating microscope. Our application does not require fiducial markers or image tracking.
Reference: [23] <author> G.J. Ettinger, W.E.L. Grimson, T. Lozano-Perez, W.M. Wells III, S.J. White, R. Kikinis, </author> <title> "Automatic Registration for Multiple Sclerosis Change Detection", </title> <booktitle> IEEE Workshop Biomed. Image Anal., </booktitle> <address> Seattle WA, </address> <month> June </month> <year> 1994, </year> <pages> pp. 297-306. </pages>
Reference-contexts: The basis of the registration algorithm we use has been previously described in <ref> [23, 24, 31, 32] </ref>. In the first step, we refine the alignment of the two data sets by minimizing an evaluation function that measures the amount of mismatch between the two data sets.
Reference: [24] <author> G.J. Ettinger, W.E.L. Grimson, M.E. Leventon, R. Kikinis, V. Gugino, W. Cote, M. Karapelou, L. Aglio, M. Shenton, G. Potts, E. Alexander, </author> <title> "Non-invasive Functional Brain Mapping Using Registered Transcranial Magnetic Stimulation," </title> <booktitle> IEEE Workshop Math. Methods in Biomed. Image Anal., </booktitle> <address> San Francisco CA., </address> <month> June, </month> <year> 1996. </year>
Reference-contexts: The basis of the registration algorithm we use has been previously described in <ref> [23, 24, 31, 32] </ref>. In the first step, we refine the alignment of the two data sets by minimizing an evaluation function that measures the amount of mismatch between the two data sets.
Reference: [25] <author> G.J. Ettinger. </author> <title> "Hierarchical Three-Dimensional Medical Image Registration". </title> <type> MIT PhD Thesis. </type> <institution> Department of Electrical Engineering and Computer Science, </institution> <year> 1997. </year>
Reference-contexts: Figure 1-5 shows the cart set up in the operating room. During a procedure, a patient's internal scan is registered to his position in the world using a surface-based registration algorithm described in <ref> [25, 32] </ref>. The patient is then tracked throughout the procedure using affixed trackable LEDs, enabling an updating of the registration. A live image from an overhead video camera is blended with the registered internal structures to create an enhanced reality visualization. <p> Various registration techniques are highlighted and compared in the Related Work, Chapter 2. Our registration method performs a rigid surface registration between dense 3D laser data of the patient and the skin model segmented from the preoperative scan <ref> [31, 25] </ref>. The output of the registration process is the transformation T w!m that takes world coordinates into model coordinates. <p> Our experiments have included scanning a calibration block of known dimensions and correlating the 3D positions reported by the Flashpoint and the laser. 5.1.3 Registration Errors The registration process is the component of the system that is most difficult to prove correct, given its complexity. However, Ettinger, in <ref> [25] </ref>, has performed extensive studies on the robustness and convergence of the registration algorithm we use. These investigations highlight the conditions under which the registration will most likely succeed, and also the break-down point of the algorithm as a function of lack of salient structure or excessive measurement noise.
Reference: [26] <author> S. Feiner, M. Macintyre, D. Seligmann, </author> <title> "Knowledge based augmented reality" in Communications of the ACM, </title> <booktitle> 36 </booktitle> <pages> 53-61, </pages> <year> 1993. </year> <month> 118 </month>
Reference-contexts: Further, since our application is quasi-two-dimensional, computational demands are far less than in three-dimensional image registration tasks, potentially allowing for efficient real-time performance. Image registration has played a major role in facilitating augmented reality (AR) applications. As described by <ref> [26] </ref>, an AR system utilizes computer generated graphics, such that the virtual world is superimposed on, and enriches, the real world. Whereas virtual reality (VR) is the graphical construction of a synthetic environment, AR extracts information from the real world and augments it [11, 17].
Reference: [27] <author> J. Feldmar, N. Ayache. </author> <title> "Locally Affine Registration of Free-Form Surfaces". </title> <booktitle> Proceedings of IEEE Conference on Computer Vision and Pattern Recognition, </booktitle> <address> Seattle WA, </address> <month> June </month> <year> 1994. </year>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Thirion et al. [35, 75] 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include <ref> [10, 27, 71, 86] </ref>. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system. Of particular interest to us is the tracking of medical instruments and the patient's head.
Reference: [28] <author> R.L. Galloway. </author> <title> "Interactive Image Guided Neurosurgery". </title> <journal> IEEE Trans. Biomedical Engineering, </journal> <volume> 39 </volume> <pages> 1226-1231, </pages> <year> 1992. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> The Radionics System (Burlington, MA) as well as the systems described in <ref> [28, 80] </ref> use an articulated arm to relate world positions to the corresponding locations in an internal scan. Such devices, though, may be bulky in the often crowded surgical field of the operating room. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [29] <author> R. Galloway. </author> <title> "Stereotactic Frame Systems and Intraoperative Localization Devices". </title> <editor> R. Maciunas, ed., Interactive Image-Guided Neurosurgery, </editor> <publisher> Amer. Assoc. </publisher> <address> Neur. Surg., </address> <year> 1993. </year>
Reference-contexts: Finally, Chapter 6 suggests areas of future work, and Chapter 7 draws conclusions about the research discussed herein. 18 Chapter 2 Related Work Initial attempts to achieve image-guided neurosurgery consisted of stereotactic frames which directly provided the fiducials for registering the MRI or CT data to the patient <ref> [29] </ref>. Stereotactic frames, though, are not only uncomfortable for the patient, but are cumbersome for the surgeon. They are limited to guidance along fixed paths and prevent access to some parts of the head. <p> Although the brain may still move relative to the skull, especially after opening a craniotomy, the skull provides fixed bounds on such motion. Initial attempts to achieve image-guided neurosurgery consisted of stereotactic frames which directly provided the fiducials for registering the MRI or CT data to the patient <ref> [29] </ref>. Stereotactic frames, though, are not only uncomfortable for the patient, but are cumbersome for the surgeon. They are limited to guidance along fixed paths and prevent access to some parts of the head.
Reference: [30] <author> P.L. Gleason, R. Kikinis, D. Altobelli, W. Wells, E. Alexander, P. Black, F. Jolesz, </author> <title> "Video registration virtual reality for nonlinkage stereotactic surgery", </title> <journal> in Sterotactic Funct Neurosurgery, </journal> <volume> 63 </volume> <pages> 139-143, </pages> <year> 1994. </year>
Reference-contexts: Recently, there has been great interest in neurosurgical applications of AR. Specifically, the intraoperative registration of CT, MR, and PET images on a living patient in the operating room may greatly facilitate surgical planning and execution <ref> [30, 22, 32] </ref>. Typically, registration of the patient with the radiographic data is accomplished by tracking fiducial markers placed on the skin surface and tracking the position of the operating microscope. Our application does not require fiducial markers or image tracking.
Reference: [31] <author> W.E.L. Grimson, G.J. Ettinger, S.J. White, P.L. Gleason, T. Lozano-Perez, W.M. Wells III, R. Kikinis. </author> <title> "Evaluating and Validating an Automated Registration System for Enhanced Reality Visualization in Surgery". </title> <booktitle> Proceedings of First International Conference on Computer Vision, Virtual Reality and Robotics in Medicine, </booktitle> <address> Nice France, </address> <month> April </month> <year> 1995. </year>
Reference-contexts: Various registration techniques are highlighted and compared in the Related Work, Chapter 2. Our registration method performs a rigid surface registration between dense 3D laser data of the patient and the skin model segmented from the preoperative scan <ref> [31, 25] </ref>. The output of the registration process is the transformation T w!m that takes world coordinates into model coordinates. <p> The basis of the registration algorithm we use has been previously described in <ref> [23, 24, 31, 32] </ref>. In the first step, we refine the alignment of the two data sets by minimizing an evaluation function that measures the amount of mismatch between the two data sets.
Reference: [32] <author> W.E.L. Grimson, G.J. Ettinger, S.J. White, T. Lozano-Perez, W.M. Wells III, and R. Kikinis. </author> <title> "An Automatic Registration Method for Frameless Stereotaxy, Image Guided Surgery, and Enhanced Reality Visualization". </title> <journal> IEEE Transactions on Medical Imaging, </journal> <volume> 15(2), </volume> <month> April </month> <year> 1996. </year>
Reference-contexts: Such image-guided surgical tools allow the surgeon to directly visualize important structures, and plan and act accordingly. We explore two methods of visualization: (1) "enhanced reality visualization" <ref> [32] </ref>, in which rendered internal anatomical structures are overlaid on the surgeon's field-of-view (Figure 1-1), and (2) instrument tracking, in which medical instruments acting on the patient are localized in the 3D coordinate frame of the MR or CT imagery (Figure 1-2). <p> Figure 1-5 shows the cart set up in the operating room. During a procedure, a patient's internal scan is registered to his position in the world using a surface-based registration algorithm described in <ref> [25, 32] </ref>. The patient is then tracked throughout the procedure using affixed trackable LEDs, enabling an updating of the registration. A live image from an overhead video camera is blended with the registered internal structures to create an enhanced reality visualization. <p> The architecture of our image-guided surgery system is shown in Figure 3-1. The system is an extension of the registration system described in <ref> [32] </ref>, and has the following properties: * Frameless|no need to attach a stereotactic frame to the patient. <p> The basis of the registration algorithm we use has been previously described in <ref> [23, 24, 31, 32] </ref>. In the first step, we refine the alignment of the two data sets by minimizing an evaluation function that measures the amount of mismatch between the two data sets. <p> Recently, there has been great interest in neurosurgical applications of AR. Specifically, the intraoperative registration of CT, MR, and PET images on a living patient in the operating room may greatly facilitate surgical planning and execution <ref> [30, 22, 32] </ref>. Typically, registration of the patient with the radiographic data is accomplished by tracking fiducial markers placed on the skin surface and tracking the position of the operating microscope. Our application does not require fiducial markers or image tracking.
Reference: [33] <author> W.E.L. Grimson, G.J. Ettinger, T. Kapur, M.E. Leventon, W.M. Wells III, R. Kikinis. </author> <title> "Utilizing Segmented MRI Data in Image-Guided Surgery". </title> <address> IJPRAI, </address> <year> 1996. </year>
Reference-contexts: The strategy of this 29 depicts the final gray matter probability after the bias correction. The third image illustrates the extracted bias field, and the forth image shows the corrected grayscale image. Images are courtesy of <ref> [33] </ref>. method is to cycle between estimating the tissue type and the RF gain throughout the image. The result of this stage is an initial mapping of MRI voxels into tissue type.
Reference: [34] <author> A. Gueziec, N. Ayache. </author> <title> "Smoothing and Matching of 3-D Space Curves". </title> <booktitle> Proceedings of European Conference on Computer Vision, </booktitle> <month> May </month> <year> 1992. </year>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods.
Reference: [35] <author> A. Gueziec, N. Ayache, </author> <title> "New Developments on Geometric Hashing for Curve Matching", </title> <booktitle> in IEEE Computer Vision and Pattern Recognition Conference, </booktitle> <year> 1993. </year>
Reference-contexts: Once an initial solution is found, points with large errors are removed and the minimization is repeated to refine the pose. Thirion et al. <ref> [35, 75] </ref> 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include [10, 27, 71, 86]. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system.
Reference: [36] <author> B.L. Guthrie, R. Kaplan, P.J. Kelly. </author> <title> "Neurosurgical Stereotactic Operating Arm". </title> <journal> Stereotactic and Functional Neurosurgery, </journal> <volume> 54 </volume> <pages> 497-500, </pages> <year> 1995. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient.
Reference: [37] <author> M.P. Heilbrun, S. Koehler, P. McDonald, W. Peters, V. Sieminov, C. Wiker. </author> <title> "Implementation of a Machine Vision Method for Stereotactic Localization and Guidance". R.J. </title> <editor> Maciunas, ed., Interactive Image-Guided Neurosurgery, </editor> <publisher> Amer. Assoc. </publisher> <address> Neur. Surg., </address> <year> 1993. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [38] <author> D.L.G. Hill, C.R. Maurer Jr, M.Y. Wang, R.J. Maciunas, J.A. Barwise, J.M. Fitzpatrick. </author> <title> "Estimation of Intra-Operative Brain Surface Movement". </title> <booktitle> Proceedings First Joint CVRMED/MRCAS, </booktitle> <address> Grenoble France, </address> <month> March </month> <year> 1997. </year>
Reference-contexts: When the skull cap is opened, the brain tends to swell. Also, as a tumor is removed, other tissue may move around. Hill, et al. <ref> [38] </ref> investigate the nature and extent of this type of brain shift. Bucholz, et al. [15] measure the degree of brain shift and explore the process of correcting for the shift using an intraoperative ultrasound device. <p> For example, even disregarding possible errors in imaging, registration, and tracking, navigation systems based solely on preopera-tive scans cannot account for brain shift during a procedure, which can cause over 7 mm of brain tissue motion <ref> [15, 38] </ref>. Despite these limitations, in our experience, neurosurgeons still report the navigation system to be very useful during surgery.
Reference: [39] <author> B.K.P. Horn, </author> <title> "Closed-Form Solution of Absolute Orientation Using Unit Quater-nions", </title> <journal> Journal of the Optical Society of America A, </journal> <volume> 4, </volume> <month> April </month> <year> 1987, </year> <pages> pp. 629-642. </pages>
Reference-contexts: Three such correspondences are required to solve the absolute orientation problem, but if more are used, then the best transformation (in the least squares sense) can be found using <ref> [39] </ref>. Although this method is relatively simple, it suffers from some practical problems. Accuracy is a major concern with fiducial-based systems. Peters [64] reports fiducial accuracy about an order magnitude worse than frame-based methods. <p> We evaluate confidence of the head tracking by computing residual errors between 46 initial and current LED positions. The head tracking process computes a rigid trans-form from current head position to initial head position at the time of laser-to-MRI registration using a closed-form least-squares formulation <ref> [39] </ref>.
Reference: [40] <editor> K. Hohne et al. </editor> <title> A framework for the Generation of 3D Anatomical Atlases. </title> <booktitle> In SPIE Vol. 1808, Visualization in Biomedical Computing 1992, </booktitle> <year> 1992. </year>
Reference: [41] <author> D.P. Huttenlocher, G.A. Klanderman, W.J. Rucklidge, </author> <title> "Comparing images using the Hausdorff distance" in IEEE Trans Patt Anal Mach Intell, </title> <booktitle> 15 </booktitle> <pages> 850-863, </pages> <year> 1993. </year> <month> 119 </month>
Reference-contexts: With both the local and remote user in control of a pointer, and able to communicate by voice or text, interactivity is facilitated. An appropriate similarity metric for registration and montaging functions must 93 be chosen. The "Hausdorff distance" <ref> [41, 67] </ref> is well-suited for our purposes since it a) runs well for edge-detected images, b) tolerates errors as well as the presence of extra or missing data points between data sets, and c) operates on an arbitrary, user-defined transformation function. <p> We therefore use the partial Hausdorff distance measure: H K (A; B) = max (h K (A; B); h K (B; A)) a2A b2B An extension of the Hausdorff distance <ref> [41] </ref> defines a fraction of points in set A that lie within * of some point in B: F * (A; B) = min (f * (A; B); f * (B; A)) f * (A; B) = #(A) where B * is the point set B dilated by *, or the <p> Further, their tracking algorithms limit the search to a small area surrounding the previously tracked position, and is not tolerant of large changes in fundus position as might be encountered during a slit-lamp fundus, biomicroscopic examination. We have implemented a modified, bidirectional Hausdorff-distance-based <ref> [41, 67] </ref> approach for image montaging. Multiple, partially overlapping fundus images are acquired. The images are then smoothed and edge detected [16]. To match two images together, the maximum Hausdorff fraction over translation, rotation, and scale is found.
Reference: [42] <author> B. Jaramaz, C. Nikou, D.A. Simon, A.M. DiGioia III. </author> <title> "Range of Motion After Total Hip Arthroplasty: Experimental Verification of the Analytical Simulator". </title> <address> CVRMed/MRCAS, Grenoble, France, </address> <year> 1997. </year>
Reference-contexts: It is not yet clear how well the laser will be able to acquire points on the pelvic surface. However, the Flashpoint probe can be used to obtain registration points. Jaramaz, et. al. in <ref> [42] </ref> perform this type of surface registration for hip replacement surgeries. The registration surface exposed in this application is much smaller than the region of the face and head exposed before sterilizationin neurosurgery.
Reference: [43] <author> H. Jiang, R. Robb, K. Holton, </author> <title> "A New Approach to 3D Registration of Multi-modality Medical Images by Surface Matching", </title> <booktitle> Proceedings of Visualization in Biomedical Computing, </booktitle> <year> 1992. </year>
Reference: [44] <author> F. Jolesz, S. Silverman, R. Kikinis, W. Lorensen, H. Cline, J. Schenck. </author> <title> "Interactive image-guided interventions in an open configuration MRI system". </title> <type> Radiology, </type> <institution> 193(P):252, </institution> <month> November </month> <year> 1994. </year>
Reference-contexts: Bucholz, et al. [15] measure the degree of brain shift and explore the process of correcting for the shift using an intraoperative ultrasound device. Intraoperative scanning devices such as an open configuration MRI system can account for these errors by re-acquiring images as the surgery progresses <ref> [44] </ref>. However, open MRI systems are very costly.
Reference: [45] <author> T. Kapur, W.E.L. Grimson, R. Kikinis, </author> <title> "Segmentation of Brain Tissue from MR Images", </title> <booktitle> in First International Conference on Computer Vision, Virtual Reality and Robotics in Medicine, </booktitle> <address> Nice France, </address> <month> April </month> <year> 1995, </year> <pages> pp. 429-433. </pages>
Reference-contexts: The segmentation is performed using automated techniques and semi-automated techniques at Brigham & Women's Hospital. Automatic segmentation techniques include an automatic gain artifact suppression technique based on expectation-maximization [83] in association with a cortical volume isolation technique based on image morphology and active contours <ref> [45] </ref>. The segmented structures are processed by the Marching Cube algorithm [50] to construct isosurfaces and support surface rendering for visualization. An overview of the segmentation process is described below. 28 slices of the imaging cube. <p> The anatomical knowledge is necessary given that different tissue types may have similar intensities. Kapur, et al. <ref> [45] </ref> have developed automated techniques for 30 structures. The brain is labeled in yellow. The ventricles are outlined in blue. Some vessels are highlighted in red, and the tumor is shown in green. incorporating knowledge of anatomy into the segmentation process.
Reference: [46] <author> A. Kato, T. Yoshimine, T. Hayakawa, et al. </author> <title> "A frameless armless navigational system for computer-assisted neurosurgery". </title> <journal> J Neurosurg, </journal> <volume> 74 </volume> <pages> 845-849, </pages> <year> 1991. </year>
Reference-contexts: Other electro-magnetic digitizing systems include Fastrack (Polhemus, Inc., Colch-ester, VT) and Flock of Birds (Ascension Technology Corporation, Burlington, VT). Two navigational systems that use such technology are described in <ref> [46, 73] </ref>. The major drawback of such localizing systems is that they are very sensitive to metal nearby.
Reference: [47] <author> R. Kikinis, F.A. Jolesz, W.E. Lorensen, H.E. Cline, P.E Stieg, and P. McL. Black. </author> <title> 3D Reconstruction of Skull Base Tumors from MRI Data for Neurosurgical Planning. </title> <booktitle> Proceedings of the Society of Magnetic Resonance in Medicine Conference, </booktitle> <year> 1991. </year>
Reference: [48] <author> A. Lakshmi Ratan, W.E.L. Grimson, W.M. Wells III. </author> <title> "Object Localization by Dynamic Template Warping". </title> <booktitle> Submitted to International Conference on Computer Vision, </booktitle> <year> 1997. </year>
Reference-contexts: Once again, the position along the optical axis is very important. The motivation behind performing a mutual information registration 1 Lakshmiratan, et al. <ref> [48] </ref> are developing a method to quickly compute an initial rough estimate of the object's pose.
Reference: [49] <author> W.J. Levy, V.E. Amassian, U.D. Schmid, C. Jungreis. </author> <title> "Mapping of Motor Cotrex Gyral Sites Non-invasively by Transcranial Magnetic Stimulation in Normal Subjects and Patients". Magnetic Motor Stimulation: </title> <journal> Basic Prinicples and Clinical Experience (EEG Suppli. </journal> <volume> 43), </volume> <year> 1991. </year>
Reference-contexts: The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps [62, 72, 84]. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including <ref> [12, 49, 56, 79] </ref>. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. Levy et al. [49] draws grid points at 2cm intervals along and perpendicular to the mid-sagittal line to establish a patient coordinate system. <p> Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including [12, 49, 56, 79]. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. Levy et al. <ref> [49] </ref> draws grid points at 2cm intervals along and perpendicular to the mid-sagittal line to establish a patient coordinate system. Vitamin E capsules are placed on the reference points prior to scanning to transfer the grid positions to the MR coordinates.
Reference: [50] <author> W.E. Lorensen, H.E. Cline, </author> <title> "Marching Cube: A High Resolution 3-D Surface Construction Algorithm", </title> <booktitle> Computer Graphics 21(3), </booktitle> <year> 1987, </year> <pages> pp. 163-169. </pages>
Reference-contexts: Automatic segmentation techniques include an automatic gain artifact suppression technique based on expectation-maximization [83] in association with a cortical volume isolation technique based on image morphology and active contours [45]. The segmented structures are processed by the Marching Cube algorithm <ref> [50] </ref> to construct isosurfaces and support surface rendering for visualization. An overview of the segmentation process is described below. 28 slices of the imaging cube. <p> This procedure consists of first extracting bounding surfaces from the segmented MRI volume using the marching cubes algorithm <ref> [50] </ref>. This algorithm generates a set of connected triangles to represent the 3D surface for each segmented structure.
Reference: [51] <author> F. Maes, A. Collignon, D. Vandermeulen, G. Marchal, and P. Suetens. </author> <title> "Multi-modality image registration by maximization of mutual information", </title> <booktitle> in Proceedings of workshop on Mathematical Methods in Biomedical Image Analysis. </booktitle> <publisher> IEEE Computer Society Press, </publisher> <year> 1996. </year>
Reference-contexts: technique is based solely on the intensities in the images rather than particular features and 32 does not require an a priori model of the relationships between the intensities of the different images, it has proven to be a general approach applicable to a wide range of multi-modality fusion applications <ref> [84, 20, 51] </ref>. 3.1.5 Model Generation We use surface rendering techniques to display the segmented MRI structures. This procedure consists of first extracting bounding surfaces from the segmented MRI volume using the marching cubes algorithm [50].
Reference: [52] <author> Macular Photocoagulation Study Group, </author> <title> "The influence of treatment extent on the visual acuity of eyes treated with krypton laser for juxtafoveal choroidal neovascularization" in Arch Ophthalmol, </title> <booktitle> 113 </booktitle> <pages> 190-194, </pages> <year> 1995. </year>
Reference-contexts: with laser treatment that covered the foveal side of the lesion with a narrow (&lt; 100) treatment border suffered severe visual acuity loss, while ~ 25% of eyes with either some of the foveal side untreated, or a wide border of treatment on the foveal side suffered severe visual loss <ref> [52] </ref>. Similar results have been reported for AMD. Building on the recommendations proposed in Macular Photocoagulation Studies, clinicians generally attempt to 90 correlate angiographic data with biomicroscopic images using crude, time-consuming, potentially error-prone methods.
Reference: [53] <author> R. Maciunas, J. Fitzpatrick, R. Galloway, G. Allen. </author> <title> "Beyond Stereotaxy: Extreme Levels of Application Accuracy Are Provided by Implantable Fiducial Markers for Interactive Image-Guided Neurosurgery". R.J. </title> <editor> Maciunas, ed., Interactive Image-Guided Neurosurgery, </editor> <publisher> Amer. Assoc. </publisher> <address> Neur. Surg., </address> <year> 1993. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> Even using subvoxel localization of these fiducials in the image may result in a millimeter or two of error for each measurement. Measurement error is also introduced when localizing the fiducials on the patient. These measurement errors can result in inaccuracies in the computed registration. Maciunas <ref> [53] </ref>, however, reports high accuracy achieved with novel implantable fiducials. Fiducials can also be inconvenient, as the patient often must keep them attached between imaging and surgery. Typically, at Brigham and Women's Hospital, patients are scanned up to a week or two before their surgery. <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> Our system currently has the option of attaching LEDs to the clamp or to the skin. We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. 2.4 Transcranial Magnetic Stimulation The goal of Transcranial Magnetic Stimulation (TMS) is to actively map out functional regions of the brain. <p> We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. For preoperative procedures such as TMS functional mapping, we generally tape the LEDs to the patient's skin, as seen in figure 3-9. At the time of laser registration (when we assume that the patient remains momentarily stationary), we acquire the initial positions of the LEDs. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2. <p> Any motion of the skin relative to the skull will not be accounted for using this particular tracking method. We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. Bone screws will solve the problem of skin motion during the surgery. Furthermore, LEDs attached to screws will be very useful as we explore using this system in other types of surgical procedures, such as orthopedic surgery.
Reference: [54] <author> M.S. Markow, H.G. Rylander, A.J. Welch, </author> <title> "Real-time algorithm for retinal tracking", </title> <journal> in IEEE Trans Biomed Engineering, </journal> <volume> 40 </volume> <pages> 1269-1281, </pages> <year> 1993. </year>
Reference-contexts: Specifically, images of the posterior fundus will be acquired and montaged into a single data set. Available angiographic data will be registered (off line, i.e. not in real time) with the montaged data set prior to biomicroscopic examination. Welch and coworkers <ref> [54, 6, 7] </ref> and Becker et al. [8] describe algorithms for real-time retinal tracking for automated laser therapy, however, the tracking algorithms require multiple templates to follow retinal vessels at several fundus locations, and therefore requires a large illumination area; tracked vessels must be visible at all times.
Reference: [55] <author> J.P. Mellor, </author> <title> "Realtime Camera Calibration for Enhanced Reality Visualization", </title> <booktitle> Proceedings of First International Conference on Computer Vision, Virtual Reality and Robotics in Medicine, </booktitle> <address> Nice France, </address> <month> April </month> <year> 1995, </year> <pages> pp. 471-475. 120 </pages>
Reference-contexts: Colchester's VISLAN system [19] tracks instruments using a passive illumination optical imaging system. The hand-held localizer has a certain pattern on it that is easily extracted from the two stereo images to accurately compute the position of the pointer tip. Mellor <ref> [55] </ref> uses some simple circular visual markers placed on the objects of interest, which are then tracked reliably and rapidly by observation in a single video camera. 2.2.4 Electro-magnetic Localizers Both LED-based and passive vision-based localization systems require line of site between (at least some of) the landmarks or emitters and <p> If more than three LEDs are visible, the redundancy will highlight the offending LED which may be deactivated. We are also currently investigating the possibility of using more passive systems to track head position. One method, by Mellor <ref> [55] </ref> uses some simple visual markers placed on the objects of interest, which are then tracked reliably and rapidly by observation in a single video camera.
Reference: [56] <author> B. Meyer, R. Diehl, H. Steinmetz, T.C. Britton, R. Benecke. </author> <title> "Magnetic Stimuli Applied Over Motor and Visual Cortex: Influence of Coil Position and Field Polarity on Motor Responses, Phosphenes, and Eye Movements". Magnetic Motor Stimulation: </title> <journal> Basic Prinicples and Clinical Experience (EEG Suppli. </journal> <volume> 43), </volume> <year> 1991. </year>
Reference-contexts: The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps [62, 72, 84]. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including <ref> [12, 49, 56, 79] </ref>. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. Levy et al. [49] draws grid points at 2cm intervals along and perpendicular to the mid-sagittal line to establish a patient coordinate system.
Reference: [57] <author> Morgan, </author> <title> F.M. "Developing a New Medical Augmented Reality System". </title> <type> CMU Robotics Institute Technical Report - CMU-RI-TR-96-19, May 15th, </type> <year> 1996. </year>
Reference-contexts: If the head of the surgeon is tracked, then the virtual image on the display can be updated to account for the position of the surgeon <ref> [57] </ref>. The head-mounted display is another possible solution to the parallax problem. Once again, the surgeon's head can be tracked, and the view through the glasses can be updated to account for the position and orientation of the surgeon's head. <p> If the surgeon's view differs from that of the camera, then the position of the projected internal structures may be misleading. We would like to explore possible solutions to these limitations, including the use of a flat panel or head-mounted display, similar to the system described in <ref> [57] </ref>. A flat panel display can be placed over the patient with the virtual image projected onto it in the correct pose. With this system, the surgeon does not need to look at a monitor to experience the visualization, but the parallax issue is still a concern.
Reference: [58] <author> S. Nakajima, H. Atsumi, R. Kikinis, T.M. Moriarty, D.C. Metcalf, F.A. Jolesz, and P. Black. </author> <title> "Use of Cortical Surface Vessel Registration for Image-Guided Neurosurgery". </title> <type> SPL Technical Report #40, </type> <year> 1997. </year>
Reference-contexts: The method is completely passive, as it just uses the views from two video cameras. We are also considering the possibility of using mutual information to automatically register to other structures that may be visible during surgery, such as cortex and vessels. Nakajima et. al. <ref> [58] </ref> used these structures to manually perform a video registration. 45 3.3 Patient Tracking To account for the motion of the patient relative to our camera system, we track the LEDs that were attached to the patient reference frame as described in Section 3.2.1.
Reference: [59] <author> K.A. Neely, </author> <title> "How to be more successful in laser photocoagulation", in Ophthal Times, </title> <booktitle> 1996, </booktitle> <pages> pp 103-108. </pages>
Reference-contexts: Similar results have been reported for AMD. Building on the recommendations proposed in Macular Photocoagulation Studies, clinicians generally attempt to 90 correlate angiographic data with biomicroscopic images using crude, time-consuming, potentially error-prone methods. In a recent practical review <ref> [59] </ref>, the author suggests that ". . . to assist you in treatment (of neovascular AMD), project an early frame of the fluorescein angiogram onto a viewing screen. Use the retinal vessels overlying the CNV lesion as landmarks.
Reference: [60] <editor> R.V. O'Toole, </editor> <publisher> M.K. Blackwell, F.M. Morgan, </publisher> <editor> L. Gregor, D. Shefman, B. Jaramaz, DiGioia, T. </editor> <title> Kanade, "Image overlay for surgical enhancement and telemedicine", in Interactive Technology and the New Paradigm for Healthcare, </title> <editor> K. Morgan et al., eds, </editor> <publisher> IOS Press, </publisher> <year> 1995. </year>
Reference-contexts: The LEDs on the probe (highlighted by the circles) are collinear with the tip of the probe. mounted display. A flat panel display can be placed over the patient with the virtual image projected onto it in the correct pose <ref> [60] </ref>. With this system, the surgeon does not need to look at a monitor to experience the visualization, but the parallax issue is still a concern. <p> Although there has been an explosive development of investigation into VR applications in medicine, AR applications might have a far greater utility, but have received much less attention <ref> [60] </ref>. An early study described the superposition of ultrasound images on the abdomen, using a position-tracked, see-through head mounted display [4]. Recently, there has been great interest in neurosurgical applications of AR.
Reference: [61] <author> Athanasios Papoulis. </author> <title> Probability, Random Variables, and Stochastic Processes. </title> <publisher> McGraw-Hill, Inc., </publisher> <address> third edition, </address> <year> 1991. </year>
Reference-contexts: In the alignment algorithm described below, we will draw samples from x in order to approximate I and its derivatives. Mutual information is defined in terms of entropy in the following way <ref> [61] </ref> : I (u (x); v (T (x))) H () is the entropy of a random variable, and is defined as H (x) p (x) ln p (x)dx ; while the joint entropy of two random variables x and y is H (x; y) p (x; y) ln p (x; y)dxdy
Reference: [62] <author> C. Pelizzari, G. Chen, D. Spelbring, R. Weichselbaum, and C. Chen. </author> <title> "Accurate Three Dimensional Registration of CT, PET and/or MR Images of the Brain". </title> <journal> J. Comp. Assis. Tomogr., </journal> <volume> 13 </volume> <pages> 20-26, </pages> <year> 1989. </year>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps <ref> [62, 72, 84] </ref>. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including [12, 49, 56, 79]. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application.
Reference: [63] <author> C. Pelizzari, K. Tan, D. Levin, et al. </author> <title> "Interactive 3-D patient-image registration". Infor Proc in Med Imag., Colchester, Hawkes DJ, </title> <editor> eds, </editor> <address> Berlin, </address> <year> 1991, </year> <pages> pp. 132-141. </pages>
Reference: [64] <author> T. Peters, B. Davey, P. Munger, R. Comeau, A. Evans, A. Olivier. </author> <title> "Three-Dimensional Multimodal Image-Guidance for Neurosurgery". </title> <journal> IEEE TMI, </journal> <volume> 15(2) </volume> <pages> 121-128, </pages> <month> April </month> <year> 1996. </year>
Reference-contexts: Although this method is relatively simple, it suffers from some practical problems. Accuracy is a major concern with fiducial-based systems. Peters <ref> [64] </ref> reports fiducial accuracy about an order magnitude worse than frame-based methods. This error lies in the difficulty of accurately localizing the fiducials in both the internal scan and on the patient on the operating table.
Reference: [65] <author> W.H. Press, S.A. Teukolsky, S.T. Vetterling, </author> <title> B.P. Flannery, Numerical Recipes in C, The Art of Scientific Computing, Second Edition, </title> <publisher> Cambridge University Press, </publisher> <year> 1992. </year>
Reference-contexts: Given the N laser lines, we have 3N correspondences between world points and image points. From these correspondences, we calculate the camera position (in the gauge coordinate system) using Powell minimization <ref> [65] </ref>. 37 After the previous calibration steps, the camera position and the positions of the N scan planes are known in gauge coordinates. However, the world coordinates of our system are defined by the Flashpoint coordinate system, not the gauge coordinate system. <p> By starting with large we achieve a large region of convergence and by gradually decreasing the value of we lock in on the well-localized minimum. In order to minimize this evaluation function we use the Davidon-Fletcher-Powell (DFP) quasi-Newton method <ref> [65] </ref>. As a second step, we use a rectified least squares distance measure to ensure we have reached an optimal solution and to derive an easily interpreted error measure.
Reference: [66] <author> H.F. Reinhardt, G.A. Hortsmann, O. Gratzl. </author> <title> "Sonic Stereometry in Microsur-gical Procedures for Deep-Seated Brain Tumors and Vascular Malformations". </title> <journal> Neurosurgery, </journal> <volume> 32 </volume> <pages> 114-117, </pages> <year> 1993. </year>
Reference-contexts: Two frameless stereotactic systems that use such digitizers are described in <ref> [5, 66] </ref>. Such localizers are very sensitive to environmental effects such as temperature, air flow, ultrasonic noise, and echoes.
Reference: [67] <editor> W.J. Rucklidge, </editor> <booktitle> "Locating objects using the Hausdorff distance" in Proc IEEE Int Conf Computer Vision, </booktitle> <pages> p 457-464, </pages> <year> 1995. </year>
Reference-contexts: With both the local and remote user in control of a pointer, and able to communicate by voice or text, interactivity is facilitated. An appropriate similarity metric for registration and montaging functions must 93 be chosen. The "Hausdorff distance" <ref> [41, 67] </ref> is well-suited for our purposes since it a) runs well for edge-detected images, b) tolerates errors as well as the presence of extra or missing data points between data sets, and c) operates on an arbitrary, user-defined transformation function. <p> Further, their tracking algorithms limit the search to a small area surrounding the previously tracked position, and is not tolerant of large changes in fundus position as might be encountered during a slit-lamp fundus, biomicroscopic examination. We have implemented a modified, bidirectional Hausdorff-distance-based <ref> [41, 67] </ref> approach for image montaging. Multiple, partially overlapping fundus images are acquired. The images are then smoothed and edge detected [16]. To match two images together, the maximum Hausdorff fraction over translation, rotation, and scale is found.
Reference: [68] <author> M.J. Ryan, R.K. Erickson, D.N. Levin, C.A. Pelizzari, R.L. Macdonald, G.J. Dohrmann, </author> <title> "Frameless Stereotaxy with Real-Time Tracking of Patient Head Movement and Retrospective Patient-Image Registration". </title> <journal> J. Neurosurgery, </journal> <volume> 85 </volume> <pages> 287-292, </pages> <month> August </month> <year> 1996. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Surface-based techniques require a method of acquiring the location of points on the patient's scalp and an algorithm for computing the registration that best aligns those points to the MRI model skin surface. Various approaches to point acquisition and surface alignment are described below. Ryan <ref> [68] </ref> generates the patient's scalp surface by probing about 150 points with a trackable medical instrument. Even if the trackable probe has high accuracy, the registration points may in fact have errors of 1 3 mm due to the operator not probing exactly on the skin surface. <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> Our system currently has the option of attaching LEDs to the clamp or to the skin. We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. 2.4 Transcranial Magnetic Stimulation The goal of Transcranial Magnetic Stimulation (TMS) is to actively map out functional regions of the brain. <p> We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. For preoperative procedures such as TMS functional mapping, we generally tape the LEDs to the patient's skin, as seen in figure 3-9. At the time of laser registration (when we assume that the patient remains momentarily stationary), we acquire the initial positions of the LEDs. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2. <p> Any motion of the skin relative to the skull will not be accounted for using this particular tracking method. We are also developing LED sockets that can be mounted to screws which will be attached directly to the skull, similar to <ref> [53, 68] </ref>. Bone screws will solve the problem of skin motion during the surgery. Furthermore, LEDs attached to screws will be very useful as we explore using this system in other types of surgical procedures, such as orthopedic surgery.
Reference: [69] <author> W.J. Schroeder, K.M. Martin, </author> <title> W.E. Lorensen. "The Design and Implementation of an Object-Oriented Toolkit for 3D Graphics and Visualization". </title> <note> Submitted to Visualization, </note> <year> 1996. </year>
Reference-contexts: The joint between the arm and scanning bar has three degrees-of-freedom to allow easy placement of the bar in desired configurations. The majority of the computation is performed in C/C++, while the user interface written in Tcl/Tk. The Visualization Toolkit (VTk) <ref> [69] </ref> is used to manipulate the anatomical models and to generate the 3D displays. 3.1 Segmentation The anatomical structures that appear in an internal scan such as MR and CT must be explicitly extracted or segmented from the scan before they can be directly used for surface registration or for 3D <p> The majority of the computation is performed in C/C++, while the user interface written in Tcl/Tk. The Visualization Toolkit (VTk) <ref> [69] </ref> is used to manipulate the anatomical models and to generate the 3D displays. This section describes the various components of the interface. 3.5.1 Visualization Views An example screen dump of the system interface appears in figure 3-18. The screen consists of four visualization views and a control window.
Reference: [70] <author> J. Serra. </author> <title> Image Analysis and Mathematical Morphology. </title> <publisher> London Academic, </publisher> <year> 1982. </year> <month> 121 </month>
Reference: [71] <editor> D. Simon, et al. </editor> <title> "Techniques for Fast and Accurate Intrasurgical Registration", </title> <booktitle> in First International Symposium on Medical Robotics and Computer Assisted Surgery, </booktitle> <address> Pittsburgh PA, </address> <month> September </month> <year> 1994. </year>
Reference-contexts: Thirion et al. [35, 75] 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include <ref> [10, 27, 71, 86] </ref>. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system. Of particular interest to us is the tracking of medical instruments and the patient's head.
Reference: [72] <author> R. Szeliski and S. Lavallee. </author> <title> "Matching 3D Anatomical Surfaces with Non-Rigid Deformations Using Octree-Splines". </title> <booktitle> Proceedings of IEEE Workshop on Biomedical Image Analysis, </booktitle> <address> Seattle WA, </address> <month> June </month> <year> 1994. </year>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Several other groups have reported registration methods similar to ours for various applications. Surveys of related registration techniques can be found in [13] and [76]. Lavallee and Szeliski <ref> [72] </ref> also perform a least-squares minimization of a distance function to match data sets. Here, the distance is weighted by an estimate of the inverse variance of the measurement noise, and a Levenberg-Marquardt method is used to find the minimum. <p> The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps <ref> [62, 72, 84] </ref>. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including [12, 49, 56, 79]. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application.
Reference: [73] <author> K. Tan, R. Grzeszczuk, D. Levin, et al. </author> <title> "A frameless stereotactic approach to neurosurgical planning based on retrospective patient-image registration." </title> <address> J Neurosurg79:296-303, </address> <year> 1993. </year>
Reference-contexts: Other electro-magnetic digitizing systems include Fastrack (Polhemus, Inc., Colch-ester, VT) and Flock of Birds (Ascension Technology Corporation, Burlington, VT). Two navigational systems that use such technology are described in <ref> [46, 73] </ref>. The major drawback of such localizing systems is that they are very sensitive to metal nearby.
Reference: [74] <author> S. Tebo, D. Leopold, D. Long, S. Zinreich, D. Kennedy. </author> <title> "An Optical 3D Digitizer for Frameless Stereotactic Surgery". </title> <journal> IEEE Comp. Graph. Appl., </journal> <volume> 16(1) </volume> <pages> 55-64, </pages> <month> Jan. </month> <year> 1996. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> This error lies in the difficulty of accurately localizing the fiducials in both the internal scan and on the patient on the operating table. Some systems use CT scans to register where the slice thickness can be as much as 3 4 mm <ref> [5, 74] </ref>. Even using subvoxel localization of these fiducials in the image may result in a millimeter or two of error for each measurement. Measurement error is also introduced when localizing the fiducials on the patient. These measurement errors can result in inaccuracies in the computed registration. <p> Although not all image-guided surgery systems account for patient motion, the systems described in <ref> [1, 14, 19, 53, 68, 74] </ref> solve this problem by attaching trackable markers to the head or clamp. Attaching markers to the clamp is far less invasive than drilling markers into the skull, but relies on the clamp remaining fixed relative to the skull throughout the surgery. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [75] <author> J.P. Thirion. </author> <title> "Extremal Points: Definition and Application to 3D Image Registration". </title> <booktitle> Proceedings of IEEE Conference on Computer Vision and Pattern Recognition, </booktitle> <address> Seattle WA, </address> <month> June </month> <year> 1994. </year>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Once an initial solution is found, points with large errors are removed and the minimization is repeated to refine the pose. Thirion et al. <ref> [35, 75] </ref> 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include [10, 27, 71, 86]. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system.
Reference: [76] <editor> P.A. van den Elsen, E.D. </editor> <address> Pol, M.A. </address> <month> Viergever. </month> <title> "Medical Image Matching ARe-view with Classification" IEEE Engineering in Medicine and Biology, </title> <booktitle> 12(1) </booktitle> <pages> 26-39, </pages> <month> March </month> <year> 1993. </year>
Reference-contexts: Several other groups have reported registration methods similar to ours for various applications. Surveys of related registration techniques can be found in [13] and <ref> [76] </ref>. Lavallee and Szeliski [72] also perform a least-squares minimization of a distance function to match data sets. Here, the distance is weighted by an estimate of the inverse variance of the measurement noise, and a Levenberg-Marquardt method is used to find the minimum.
Reference: [77] <author> P.A. Viola, W.M. Wells III. </author> <title> "Alignment by Maximization of Mutual Information". </title> <booktitle> In International Conference on Computer Vision, </booktitle> <month> June </month> <year> 1995. </year>
Reference-contexts: Therefore, the problem of computing the registration from images is a challenging one. One of the advantages of a mutual information approach to registration is that it is robust to many of the unknowns that can occur in an image, including lighting conditions and occlusions. Viola and Wells in <ref> [77] </ref> used this approach to compute a very accurate registration of a 3D model of an object to that object's position in the image plane. <p> However, many objects have varying albedo and also shadow themselves, which will lead to many spurious edges in the image. 3.6.2 Mutual Information Registration This section highlights the technique of registering a 3D model to a single image using mutual information, as presented by Viola and Wells in <ref> [77] </ref>. The relationship between an object model (no matter how accurate) and the object's image is a complex one. The appearance of a small patch of a surface is a function of the surface properties, the patch's orientation, the position of the lights and the position of the observer. <p> The algorithm is very similar to that which is described in <ref> [77] </ref> and [78]. To apply the mutual information registration technique to multiple views, it performs a single-view registration "step" for each view in turn. The algorithm requires a point/normal model M of the object, and n images of that object I 1 ; : : : ; I n .
Reference: [78] <institution> P.A. </institution> <type> Viola. PhD thesis. </type> <institution> MIT Department Electrical Engineering and Computer Science, </institution> <address> Cambridge, Mass., </address> <year> 1995. </year>
Reference-contexts: The algorithm is very similar to that which is described in [77] and <ref> [78] </ref>. To apply the mutual information registration technique to multiple views, it performs a single-view registration "step" for each view in turn. The algorithm requires a point/normal model M of the object, and n images of that object I 1 ; : : : ; I n .
Reference: [79] <author> E.M. Wassermann, B. Wang, T.A. Zeffiro, N. Sadato, A. Pascual-Leone, C. Toro, M. Hallett. </author> <title> "Locating the Motor Cortex on the MRI with Transcranial Magnetic Stimulation and PET". </title> <journal> Neuroimage, </journal> <volume> 3(1) </volume> <pages> 1-9, </pages> <year> 1996. </year>
Reference-contexts: The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps [62, 72, 84]. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including <ref> [12, 49, 56, 79] </ref>. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. Levy et al. [49] draws grid points at 2cm intervals along and perpendicular to the mid-sagittal line to establish a patient coordinate system.
Reference: [80] <author> E. Watanabe. </author> <title> "A Potentiometer-Based Localization Arm System". R.J. </title> <editor> Maciu-nas, ed., </editor> <title> Interactive Image-Guided Neurosurgery, </title> <journal> American Association of Neurological Surgeons, </journal> <year> 1993. </year>
Reference-contexts: We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 36, 37, 53, 68, 74, 80] </ref>, and usually consist of two components: registration and tracking. 2.1 Patient-Scan Registration Registration is the process by which the MRI or CT data is transformed to the coordinate frame of the patient. <p> The two most common registration techniques for this application are fiducial-based and surface-based registration. A discussion of these methods follows below. 2.1.1 Fiducial-based Registration Systems The most common form of registration uses fiducials <ref> [1, 5, 28, 37, 53, 74, 80] </ref>: either markers attached to the skin or bone prior to imaging or anatomically salient features 19 on the head. <p> The Radionics System (Burlington, MA) as well as the systems described in <ref> [28, 80] </ref> use an articulated arm to relate world positions to the corresponding locations in an internal scan. Such devices, though, may be bulky in the often crowded surgical field of the operating room. <p> We would like to use a frameless system not only for its simplicity and generality, but also for its potential for use in other parts of the body. Frameless stereotaxy systems have been pursued by many groups <ref> [1, 5, 14, 19, 28, 37, 53, 68, 74, 80] </ref>. 4.1.1 Operating Room Procedure From the surgeon's perspective, using our system involves: 1. The patient is prepared for surgery as per usual procedure up to head steriliza tion process. The head is still visible. 2.
Reference: [81] <author> W.M. Wells, </author> <title> Statistical Object Recognition, </title> <type> MIT AI Technical Report 1398, </type> <month> Jan-uary </month> <year> 1993. </year>
Reference: [82] <author> W. Wells, R. Kikinis, E. Grimson, and F. Jolesz. </author> <title> "Statistical Intensity Correction and Segmentation of Magnetic Resonance Image Data". </title> <booktitle> Proceedings of the First Conference on Computer Vision, Virtual Reality and Robotics in Medicine. </booktitle> <publisher> Springer, </publisher> <year> 1995. </year>
Reference: [83] <author> W. Wells, R. Kikinis, E. Grimson, and F. Jolesz. </author> <title> "Adaptive Segmentation of MRI Data". </title> <journal> IEEE Transactions on Medical Imaging, </journal> <note> To Appear, </note> <year> 1996. </year>
Reference-contexts: This section describes the various steps in segmenting a scan and generating surface models of anatomical structures. The segmentation is performed using automated techniques and semi-automated techniques at Brigham & Women's Hospital. Automatic segmentation techniques include an automatic gain artifact suppression technique based on expectation-maximization <ref> [83] </ref> in association with a cortical volume isolation technique based on image morphology and active contours [45]. The segmented structures are processed by the Marching Cube algorithm [50] to construct isosurfaces and support surface rendering for visualization. <p> It is problematic, however, to determine either the gain or the tissue type without knowledge of the other. Wells in <ref> [83] </ref> describes a statistical method that uses knowledge of tissue properties and gain inhomogeneities to correct the gain artifact of MRI. The strategy of this 29 depicts the final gray matter probability after the bias correction.
Reference: [84] <author> W.M. Wells III, P. Viola, H. Atsumi, S. Nakajima, R. Kikinis. </author> <title> "Multi-Modal Volume Registration by Maximization of Mutual Information". </title> <journal> Medical Image Analysis, </journal> <volume> 1(1) </volume> <pages> 35-51, </pages> <year> 1996. </year>
Reference-contexts: The information from the functional scan can be fused with other internal scans by using a multi-modal 24 registration technique to obtain functional maps <ref> [62, 72, 84] </ref>. Other groups have investigated functional motor mapping by transcranial magnetic stimulation, including [12, 49, 56, 79]. Typically, drawing the correspondence between patient coordinates and internal scan coordinates has been done manually in this application. <p> In order to perform the multi-modality fusion, we register the different volumetric images to a single coordinate frame. The volumetric registration is performed by using an information-theoretic approach which maximizes a mutual information metric <ref> [84] </ref>. <p> technique is based solely on the intensities in the images rather than particular features and 32 does not require an a priori model of the relationships between the intensities of the different images, it has proven to be a general approach applicable to a wide range of multi-modality fusion applications <ref> [84, 20, 51] </ref>. 3.1.5 Model Generation We use surface rendering techniques to display the segmented MRI structures. This procedure consists of first extracting bounding surfaces from the segmented MRI volume using the marching cubes algorithm [50].
Reference: [85] <author> A. Witkin, M. Kass, and D. Terzopoulos. "Snakes: </author> <title> Active Contour Models". </title> <journal> International Journal of Computer Vision, </journal> <volume> 1(4) </volume> <pages> 321-331, </pages> <month> June </month> <year> 1988. </year> <month> 122 </month>
Reference: [86] <author> Z. Zhang. </author> <title> "Iterative Point Matching for Registration of Free-Form Curves and Surfaces". </title> <journal> IJCV, </journal> <volume> 13(2) </volume> <pages> 119-152, </pages> <year> 1994. </year> <month> 123 </month>
Reference-contexts: However, accurately repositioning the markers can be difficult. 2.1.2 Surface-based Registration Systems Another registration approach is surface alignment in which the MRI skin surface is aligned with the patient's scalp surface in the operating room. Related surface-based registration approaches include <ref> [19, 27, 34, 62, 68, 72, 75, 86] </ref>. Surface-based techniques, while perhaps more complicated, provide more flexibility and are potentially much more accurate than fiducial-based methods. <p> Thirion et al. [35, 75] 21 performs automatic rigid registration of 3D surfaces by matching ridge lines which track points of maximum curvature along the surface. Other related registration techniques include <ref> [10, 27, 71, 86] </ref>. 2.2 Tracking Tracking is the process by which objects are dynamically localized in the patient's coordinate system. Of particular interest to us is the tracking of medical instruments and the patient's head.
References-found: 86

