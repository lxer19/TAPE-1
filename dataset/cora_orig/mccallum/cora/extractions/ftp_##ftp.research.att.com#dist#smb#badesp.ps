URL: ftp://ftp.research.att.com/dist/smb/badesp.ps
Refering-URL: http://www.cs.arizona.edu/xkernel/www/ipsec/ipsec.html
Root-URL: http://www.aic.nrl.navy.mil/~aha/people.html
Email: smb@research.att.com  
Title: Problem Areas for the IP Security Protocols  
Author: Steven M. Bellovin 
Affiliation: AT&T Research  
Abstract: The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC). We describe a number of attacks against various versions of these protocols, including confidentiality failures and authentication failures. The implications of these attacks are troubling for the utility of this entire effort. 
Abstract-found: 1
Intro-found: 1
Reference: [AMP95] <author> Ashar Aziz, Tom Markson, and Hemma Prafullchandra. </author> <title> Simple key-management for Internet protocols (SKIP). Internet draft; work in progress, </title> <month> December 21, </month> <year> 1995. </year> <month> (draft-ietf-ipsec-skip-06.txt). </month>
Reference-contexts: For some ciphers, such as members of the FEAL family [Sch96, pp. 308-311], this may be quite sufficient to mount an attack. 4 Key Changes versus SKIP A central principle behind SKIP <ref> [AMP95] </ref> is that a long-lived master key exists implicitly between any two hosts. But this automatic keying makes it difficult for a host to delete a key unilaterally. Recent drafts have addressed this by creating a counter n. <p> If this is not feasible, keys should be changed reasonably frequently. For stream ciphers especially, it is necessary to do this based on time, data received, and too large a difference in the indicated sequence number. Recent versions of SKIP <ref> [AMP95] </ref> have the proper facilities for doing this; it is imperative that older ones not be used. Replay defenses are also a good idea.
Reference: [Atk95a] <author> R. Atkinson. </author> <title> IP authentication header. Request for Comments (Proposed Standard) RFC 1826, </title> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1995. </year>
Reference-contexts: 1 Introduction The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC) <ref> [Atk95c, Atk95a, Atk95b, MS95, MKS95a] </ref>. While these protocols should provide a marked increase in Internet security, they themselves have had a checkered history. <p> Whether or not you can restart at an arbitrary point or crank backwards depends on the details of the cipher design. 3 The Attacks For most of these attacks, we will assume that ESP encryption [Atk95b] is used, but that AH authentication <ref> [Atk95a] </ref> is not used. Host-pair keying is used. That is, a single key exists between each pair of communicating hosts. This is in distinction to user-oriented keying, or connection-oriented keying, where many keys can be used between two given machines.
Reference: [Atk95b] <author> R. Atkinson. </author> <title> IP encapsulating security payload (ESP). Request for Comments (Proposed Standard) RFC 1827, </title> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1995. </year>
Reference-contexts: 1 Introduction The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC) <ref> [Atk95c, Atk95a, Atk95b, MS95, MKS95a] </ref>. While these protocols should provide a marked increase in Internet security, they themselves have had a checkered history. <p> Whether or not you can restart at an arbitrary point or crank backwards depends on the details of the cipher design. 3 The Attacks For most of these attacks, we will assume that ESP encryption <ref> [Atk95b] </ref> is used, but that AH authentication [Atk95a] is not used. Host-pair keying is used. That is, a single key exists between each pair of communicating hosts. This is in distinction to user-oriented keying, or connection-oriented keying, where many keys can be used between two given machines.
Reference: [Atk95c] <author> R. Atkinson. </author> <title> Security architecture for the internet protocol. Request for Comments (Proposed Standard) RFC 1825, </title> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1995. </year>
Reference-contexts: 1 Introduction The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC) <ref> [Atk95c, Atk95a, Atk95b, MS95, MKS95a] </ref>. While these protocols should provide a marked increase in Internet security, they themselves have had a checkered history.
Reference: [Azi94] <author> Ashar Aziz. </author> <title> Simple key-management for Internet protocols (SKIP). Obsolete Internet draft, </title> <month> October 25, </month> <year> 1994. </year> <month> (draft-ietf-ipsec-aziz-skip-00.txt). </month>
Reference-contexts: First, we have block ciphers such as DES [NBS77] used in cipher block chaining mode (CBC). Second, the use of stream ciphers has been suggested, in early versions of the SKIP protocol <ref> [Azi94] </ref> and with the standard ESP header [CW96]; these are byte-at-a-time ciphers. For our purposes, both modes have some significant limitations. The discussion below focuses on aspects of interest to us. <p> A more general solution is to use tunnel mode for all fragmented packets [WB96]; the inclusion of the extra IP header will protect the fragmentation indicators on the inside. 3.4 Weaknesses of Stream Ciphers Early versions of the SKIP protocol <ref> [Azi94] </ref> suggested the use of RC4 [Sch96, pp. 397-398], a stream cipher. Packets included a 64-bit byte sequence number field; the decryptor's stream cipher engine would be cranked until it reached that point. This field also serves as a replay detection mechanism. Authentication was possible but not mandatory.
Reference: [BBJ92] <editor> D. Borman, R. Braden, and V. Jacob-son. </editor> <title> TCP extensions for high performance. Request for Comments (Proposed Standard) RFC 1323, </title> <institution> Internet Engineering Task Force, </institution> <month> May </month> <year> 1992. </year> <note> (Obsoletes RFC1185). </note>
Reference-contexts: While the attack is not universally applicable, it does work for the user-to-host data| including any typed passwords|in telnet sessions byte padding padding pad len=5 protocol when only one data byte is present. if either tunnel mode ESP or the TCP timestamp options <ref> [BBJ92] </ref> are used. Because DES is a block cipher, data shorter than the block length|64 bits|must be padded to the block length before encryption. <p> A standard TCP header is 20 bytes long, which is not a multiple of the DES block length. If tunnel mode is used, though, the 20-byte IP header is included, raising the total length to 40 bytes, or eight DES blocks. Similarly, the recommended format for the timestamp options <ref> [BBJ92, Appendix A] </ref>, occupies 12 bytes, bringing the total TCP header length to 32 bytes, which is also an integral number of DES blocks. In either of these cases, single keystrokes will be sent alone in a pad block.
Reference: [Bel89] <author> Steven M. Bellovin. </author> <title> Security problems in the TCP/IP protocol suite. </title> <journal> Computer Communications Review, </journal> <volume> 19(2) </volume> <pages> 32-48, </pages> <month> April </month> <year> 1989. </year>
Reference-contexts: most of the fields are effectively constant, save for the fragment-id which we don't care about in any event; for the latter, the port number fields can be recovered by seeing what ports are in use and the sequence number can be deduced by a modified sequence number guessing attack <ref> [Mor85, Bel89] </ref>.
Reference: [BS91] <author> Eli Biham and Adi Shamir. </author> <title> Differential cryptanalysis of DES-like cryptosystems. </title> <journal> Journal of Cryptology, </journal> <volume> 4(1) </volume> <pages> 3-72, </pages> <year> 1991. </year>
Reference-contexts: We know of several different implementations that will fall victim to one or both of these scenarios. Beyond their utility for the high-level attacks we have described here, chosen plaintext has cryptographic significance as well. Many cryptanalytic attacks, such as differential cryptanalysis <ref> [BS93b, BS91, BS93a] </ref>, depend on the attacker being able to choose the plaintext to be encrypted. While the quantities needed to attack DES are still out of reach, it appears to be quite feasible to trick local machines into encrypting tens of gigabytes of data.
Reference: [BS93a] <author> Eli Biham and Adi Shamir. </author> <title> Differential Cryptanalysis of the Data Encryption Standard. </title> <publisher> Springer-Verlag, </publisher> <address> Berlin, </address> <year> 1993. </year>
Reference-contexts: We know of several different implementations that will fall victim to one or both of these scenarios. Beyond their utility for the high-level attacks we have described here, chosen plaintext has cryptographic significance as well. Many cryptanalytic attacks, such as differential cryptanalysis <ref> [BS93b, BS91, BS93a] </ref>, depend on the attacker being able to choose the plaintext to be encrypted. While the quantities needed to attack DES are still out of reach, it appears to be quite feasible to trick local machines into encrypting tens of gigabytes of data.
Reference: [BS93b] <author> Eli Biham and Adi Shamir. </author> <title> Differential cryptanalysis of the full 16-round DES. </title> <booktitle> In Advances in Cryptology: Proceedings of CRYPTO '92, </booktitle> <pages> pages 487-496. </pages> <publisher> Springer-Verlag, </publisher> <year> 1993. </year>
Reference-contexts: We know of several different implementations that will fall victim to one or both of these scenarios. Beyond their utility for the high-level attacks we have described here, chosen plaintext has cryptographic significance as well. Many cryptanalytic attacks, such as differential cryptanalysis <ref> [BS93b, BS91, BS93a] </ref>, depend on the attacker being able to choose the plaintext to be encrypted. While the quantities needed to attack DES are still out of reach, it appears to be quite feasible to trick local machines into encrypting tens of gigabytes of data.
Reference: [CW96] <author> Germano Caronni and Marcel Waldvogel. </author> <title> The ESP stream transform. Internet draft; work in progress, </title> <month> April </month> <year> 1996. </year> <month> (draft-caronni-esp-stream-00.txt). </month>
Reference-contexts: First, we have block ciphers such as DES [NBS77] used in cipher block chaining mode (CBC). Second, the use of stream ciphers has been suggested, in early versions of the SKIP protocol [Azi94] and with the standard ESP header <ref> [CW96] </ref>; these are byte-at-a-time ciphers. For our purposes, both modes have some significant limitations. The discussion below focuses on aspects of interest to us. <p> Next, wrap the sequence number counter. Use the known plaintext to recover the key stream used to protect your text, and use it to encrypt a new message. A more recent proposal for use of stream ciphers <ref> [CW96] </ref> addresses some of these issues. For example, a maximum forward change ffi is defined, and sequence number wrapping is explicitly prohibited.
Reference: [EK96] <author> Donald E. Eastlake, 3rd and Charles W. Kaufman. </author> <title> Domain name system protocol security extensions. Internet draft; work in progress, </title> <month> January 30, </month> <year> 1996. </year> <month> (draft-ietf-dnssec-secext-09.txt). </month>
Reference-contexts: Probably, the right answer is to omit IPSEC entirely for DNS messages, and instead rely on authenticated DNS records <ref> [EK96] </ref>. 7 Acknowledgments Some of these specific attacks were first pointed out by others, including Ashar Aziz of Sun Microsystems and David A. Wagner of the University of California at Berkeley. Wagner, Ran Atkinson, Perry Metzger, and Hilarie Orman made many useful suggestions about draft versions of this paper.
Reference: [JMM85] <author> Robert R. Jueneman, Stephan M. Matyas, and Carl H. Meyer. </author> <title> Message authentication. </title> <journal> IEEE Communications, </journal> <volume> 23(9) </volume> <pages> 29-40, </pages> <month> September </month> <year> 1985. </year>
Reference-contexts: If the hash function is at the beginning of the packet and a secret IV is used, the mechanisms described above can be employed in conjunction with this scheme. Other attacks based on integrity-checking failures may be found in <ref> [JMM85, SG92a, SG92b, SG93] </ref>. 3.7 Proxy Encryption Hosts that will forward received packets that are not addressed to them may be victimized by a proxy encryption attack [WB96].
Reference: [MKS95a] <author> P. Metzger, P. Karn, and W. Simpson. </author> <title> The ESP DES-CBC transform. Request for Comments (Proposed Standard) RFC 1829, </title> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1995. </year>
Reference-contexts: 1 Introduction The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC) <ref> [Atk95c, Atk95a, Atk95b, MS95, MKS95a] </ref>. While these protocols should provide a marked increase in Internet security, they themselves have had a checkered history. <p> To be sure, AH failures can trigger alarms, but it isn't clear that this is useful; tearing down a session that received too many AH failures is an invitation to denial-of-service attacks. Second, the attack is aided because the DES-CBC specification <ref> [MKS95a] </ref> requires that received padding bytes be ignored. If they had some known fixed value, checked by the receiver, it would be much harder to generate the T k messages, since far too much known plaintext would be needed.
Reference: [MKS95b] <author> P. Metzger, P. Karn, and W. Simpson. </author> <title> The ESP triple DES-CBC transform. Request for Comments (Experimental) RFC 1851, </title> <institution> Internet Engineering Task Force, </institution> <month> Oc-tober </month> <year> 1995. </year>
Reference-contexts: It would seem to make little sense to combine MD5 [Riv92], with its O (2 64 ) strength against birthday attacks, with triple-DES <ref> [MKS95b] </ref>. These attacks and recommendations, taken in toto, leave us feeling very nervous about network layer encryption. It may be that its promise of transparent, ubiquitous security cannot be kept, at least in general.
Reference: [Mor85] <author> Robert T. Morris. </author> <title> A weakness in the 4.2BSD Unix TCP/IP software. </title> <type> Computing Science Technical Report 117, </type> <institution> AT&T Bell Laboratories, </institution> <address> Murray Hill, NJ, </address> <month> Febru-ary </month> <year> 1985. </year>
Reference-contexts: most of the fields are effectively constant, save for the fragment-id which we don't care about in any event; for the latter, the port number fields can be recovered by seeing what ports are in use and the sequence number can be deduced by a modified sequence number guessing attack <ref> [Mor85, Bel89] </ref>.
Reference: [MS95] <author> P. Metzger and W. Simpson. </author> <title> IP authentication using keyed MD5. Request for Comments (Proposed Standard) RFC 1828, </title> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1995. </year>
Reference-contexts: 1 Introduction The Internet Engineering Task Force (IETF) is in the process of adopting standards for IP-layer encryption and authentication (IPSEC) <ref> [Atk95c, Atk95a, Atk95b, MS95, MKS95a] </ref>. While these protocols should provide a marked increase in Internet security, they themselves have had a checkered history.
Reference: [NBS77] <author> NBS. </author> <title> Data encryption standard, </title> <month> January </month> <year> 1977. </year> <note> Federal Information Processing Standards Publication 46. </note>
Reference-contexts: Others have been been discussed elsewhere, such as on the IPSEC mailing list or in [WB96]. 2 Properties of Encryption Modes The ciphers of interest here fall into two broad categories. First, we have block ciphers such as DES <ref> [NBS77] </ref> used in cipher block chaining mode (CBC). Second, the use of stream ciphers has been suggested, in early versions of the SKIP protocol [Azi94] and with the standard ESP header [CW96]; these are byte-at-a-time ciphers. For our purposes, both modes have some significant limitations.
Reference: [NBS80] <author> NBS. </author> <title> DES modes of operation, </title> <note> Decem-ber 1980. Federal Information Processing Standards Publication 81. </note>
Reference-contexts: The corresponding decryption is written P i = K 1 [C i ]. The symbol denotes bitwise exclusive-OR. In showing transforms, the subscript K in ESP K denotes "ESP encryption using key K". 2.2 Cipher Block Chaining CBC encryption <ref> [NBS80] </ref> operates by encrypting the exclusive-OR of each plaintext block and the previous ciphertext block: C i = K [P i C i1 ]: To encrypt the first plaintext block, C 0 is set to the initializaton vector (IV).
Reference: [Pos80] <author> J. Postel. </author> <title> User datagram protocol. Request for Comments (Standard) STD 6, </title> <type> RFC 768, </type> <institution> Internet Engineering Task Force, </institution> <month> August </month> <year> 1980. </year>
Reference-contexts: IVs may be agreed upon in advance, transmitted encrypted, or transmitted in the clear. Using non-constant IVs is often rec-ommended, in order to disguise common prefixes. For our purposes, that does not matter much, as the first encrypted block will almost always be a TCP [Pos81c], UDP <ref> [Pos80] </ref>, or IP [Pos81b] header, and thus will almost always vary. Decryption is the inverse operation: P i = C i1 K 1 [C i ]: To encrypt data that is not a multiple of the underlying cipher's block size, some sort of padding and length information must be added.
Reference: [Pos81a] <author> J. Postel. </author> <title> Internet control message protocol. Request for Comments (Standard) STD 5, </title> <type> RFC 792, </type> <institution> Internet Engineering Task Force, </institution> <month> September </month> <year> 1981. </year> <note> (Obsoletes RFC0777). </note>
Reference-contexts: Other useful techniques involve exploiting weaknesses in the IPSEC implemenation. If, for example, a machine will respond to a plaintext ICMP <ref> [Pos81a] </ref> or UDP ECHO packet with an encrypted reply, an attacker can forge the initial message and monitor the response. An alternative technique that is often useful is to send an encrypted ECHO message and look for a plaintext response; depending on the local configuration, that may happen as well.
Reference: [Pos81b] <author> J. Postel. </author> <title> Internet protocol. Request for Comments (Standard) RFC 791, </title> <institution> Internet Engineering Task Force, </institution> <month> September </month> <year> 1981. </year> <note> (Obsoletes RFC0760). </note>
Reference-contexts: Using non-constant IVs is often rec-ommended, in order to disguise common prefixes. For our purposes, that does not matter much, as the first encrypted block will almost always be a TCP [Pos81c], UDP [Pos80], or IP <ref> [Pos81b] </ref> header, and thus will almost always vary. Decryption is the inverse operation: P i = C i1 K 1 [C i ]: To encrypt data that is not a multiple of the underlying cipher's block size, some sort of padding and length information must be added.
Reference: [Pos81c] <author> J. Postel. </author> <title> Transmission control protocol. Request for Comments (Standard) STD 7, </title> <type> RFC 793, </type> <institution> Internet Engineering Task Force, </institution> <month> September </month> <year> 1981. </year>
Reference-contexts: IVs may be agreed upon in advance, transmitted encrypted, or transmitted in the clear. Using non-constant IVs is often rec-ommended, in order to disguise common prefixes. For our purposes, that does not matter much, as the first encrypted block will almost always be a TCP <ref> [Pos81c] </ref>, UDP [Pos80], or IP [Pos81b] header, and thus will almost always vary. <p> This is true even if the packet represents an old duplicate; the replays will be ignored but will still generate an ACK, according to the TCP specification <ref> [Pos81c] </ref>. We now need ciphertext blocks with known values for these three bytes; this totals 2 24 blocks. These could either be generated by the chosen plaintext techniques discussed in Section 3.9, or it could be gleaned by observation.
Reference: [Riv92] <author> R. Rivest. </author> <title> The MD5 message-digest algorithm. Request for Comments (Informational) RFC 1321, </title> <institution> Internet Engineering Task Force, </institution> <month> April </month> <year> 1992. </year>
Reference-contexts: Furthermore, not all combinations are secure; given the way authentication failures can be used to compromise secrecy, the authentication transform must be at least as strong as the secrecy mechanism. It would seem to make little sense to combine MD5 <ref> [Riv92] </ref>, with its O (2 64 ) strength against birthday attacks, with triple-DES [MKS95b]. These attacks and recommendations, taken in toto, leave us feeling very nervous about network layer encryption. It may be that its promise of transparent, ubiquitous security cannot be kept, at least in general.
Reference: [Sch96] <author> Bruce Schneier. </author> <title> Applied Cryptography: Protocols, Algorithms, and Source Code in C. </title> <publisher> John Wiley & Sons, </publisher> <address> New York, </address> <note> second edition, </note> <year> 1996. </year>
Reference-contexts: For our purposes, both modes have some significant limitations. The discussion below focuses on aspects of interest to us. More detailed information on these and other cipher modes can be found in <ref> [Sch96] </ref>. 2.1 Notation We use C i = K [P i ] to mean "ciphertext C i results from the encryption of plaintext P i using key K. The corresponding decryption is written P i = K 1 [C i ]. The symbol denotes bitwise exclusive-OR. <p> A more general solution is to use tunnel mode for all fragmented packets [WB96]; the inclusion of the extra IP header will protect the fragmentation indicators on the inside. 3.4 Weaknesses of Stream Ciphers Early versions of the SKIP protocol [Azi94] suggested the use of RC4 <ref> [Sch96, pp. 397-398] </ref>, a stream cipher. Packets included a 64-bit byte sequence number field; the decryptor's stream cipher engine would be cranked until it reached that point. This field also serves as a replay detection mechanism. Authentication was possible but not mandatory. There are several problems with this scheme. <p> While the quantities needed to attack DES are still out of reach, it appears to be quite feasible to trick local machines into encrypting tens of gigabytes of data. For some ciphers, such as members of the FEAL family <ref> [Sch96, pp. 308-311] </ref>, this may be quite sufficient to mount an attack. 4 Key Changes versus SKIP A central principle behind SKIP [AMP95] is that a long-lived master key exists implicitly between any two hosts. But this automatic keying makes it difficult for a host to delete a key unilaterally.
Reference: [SG92a] <author> Stuart G. Stubblebine and Virgil D. Gligor. </author> <title> On message integrity in cryptographic protocols. </title> <booktitle> In Proc. IEEE Computer Society Symposium on Research in Security and Privacy, </booktitle> <pages> pages 85-104, </pages> <address> Oakland, CA, </address> <month> May </month> <year> 1992. </year>
Reference-contexts: If the hash function is at the beginning of the packet and a secret IV is used, the mechanisms described above can be employed in conjunction with this scheme. Other attacks based on integrity-checking failures may be found in <ref> [JMM85, SG92a, SG92b, SG93] </ref>. 3.7 Proxy Encryption Hosts that will forward received packets that are not addressed to them may be victimized by a proxy encryption attack [WB96].
Reference: [SG92b] <author> Stuart G. Stubblebine and Virgil D. Gligor. </author> <title> On message integrity in cryptographic protocols. </title> <institution> Computer Science Technical Report 2843, University of Maryland, College Park, MD, </institution> <month> February </month> <year> 1992. </year>
Reference-contexts: If the hash function is at the beginning of the packet and a secret IV is used, the mechanisms described above can be employed in conjunction with this scheme. Other attacks based on integrity-checking failures may be found in <ref> [JMM85, SG92a, SG92b, SG93] </ref>. 3.7 Proxy Encryption Hosts that will forward received packets that are not addressed to them may be victimized by a proxy encryption attack [WB96].
Reference: [SG93] <author> Stuart G. Stubblebine and Virgil D. Gligor. </author> <title> Protocol design for integrity protection. </title> <booktitle> In Proc. IEEE Computer Society Symposium on Research in Security and Privacy, </booktitle> <pages> pages 41-53, </pages> <address> Oakland, CA, </address> <month> May </month> <year> 1993. </year>
Reference-contexts: If the hash function is at the beginning of the packet and a secret IV is used, the mechanisms described above can be employed in conjunction with this scheme. Other attacks based on integrity-checking failures may be found in <ref> [JMM85, SG92a, SG92b, SG93] </ref>. 3.7 Proxy Encryption Hosts that will forward received packets that are not addressed to them may be victimized by a proxy encryption attack [WB96].
Reference: [VK83] <author> V. L. Voydock and S. T. Kent. </author> <title> Security mechanisms in high-level network protocols. </title> <journal> ACM Computing Surveys, </journal> <volume> 15(2) </volume> <pages> 135-171, </pages> <month> June </month> <year> 1983. </year>
Reference-contexts: Some other attacks on IVs are described in <ref> [VK83] </ref>; while not all of the scenarios described there are applicable to IPSEC, some are worrisome. But their suggestion that each security association use a separate, secret constant IV does not work well for us; it is too easy to recover most of the bits of the IV.
Reference: [WB96] <author> David A. Wagner and Steven M. Bellovin. </author> <title> A "bump in the stack" encryptor for MS-DOS systems. </title> <booktitle> In Proceedings of the Symposium on Network and Distributed System Security, </booktitle> <pages> pages 155-160, </pages> <address> San Diego, </address> <month> Febru-ary </month> <year> 1996. </year>
Reference-contexts: Regrettably, this is not the case. Some of the attacks discussed here were presented informally at the 32nd IETF meeting in Danvers, MA, in March of 1995. Others have been been discussed elsewhere, such as on the IPSEC mailing list or in <ref> [WB96] </ref>. 2 Properties of Encryption Modes The ciphers of interest here fall into two broad categories. First, we have block ciphers such as DES [NBS77] used in cipher block chaining mode (CBC). <p> This may change for IPv6, where intermediate routers are not allowed to fragment packets. But in that case, the AH header would have to cover the fragmentation header as well. A more general solution is to use tunnel mode for all fragmented packets <ref> [WB96] </ref>; the inclusion of the extra IP header will protect the fragmentation indicators on the inside. 3.4 Weaknesses of Stream Ciphers Early versions of the SKIP protocol [Azi94] suggested the use of RC4 [Sch96, pp. 397-398], a stream cipher. <p> Other attacks based on integrity-checking failures may be found in [JMM85, SG92a, SG92b, SG93]. 3.7 Proxy Encryption Hosts that will forward received packets that are not addressed to them may be victimized by a proxy encryption attack <ref> [WB96] </ref>. In this attack, the enemy builds a packet with the IP source address of the forwarder, and a target of some destination machine.
Reference: [ZRT95] <author> P. Ziemba, D. Reed, and P. Traina. </author> <title> Security considerations for IP fragment filtering. Request for Comments (Informational) RFC 1858, </title> <institution> Internet Engineering Task Force, </institution> <month> October </month> <year> 1995. </year>
Reference-contexts: IP has a checksum as well, the packet identification field|an arbitrary number|is in P 1 ; it seems possible to change it to compensate for changes to the the fragmentation control fields; that in turn might enable some of the attacks described in <ref> [ZRT95] </ref>. Some other attacks on IVs are described in [VK83]; while not all of the scenarios described there are applicable to IPSEC, some are worrisome.
References-found: 31

