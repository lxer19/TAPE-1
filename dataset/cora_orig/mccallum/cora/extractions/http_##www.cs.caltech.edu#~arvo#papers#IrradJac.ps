URL: http://www.cs.caltech.edu/~arvo/papers/IrradJac.ps
Refering-URL: http://www.cs.caltech.edu/~arvo/papers.html
Root-URL: http://www.cs.caltech.edu
Title: The Irradiance Jacobian for Partially Occluded Polyhedral Sources  
Author: James Arvo 
Keyword: CR Categories and Subject Descriptors: I.3.3 [Computer Graphics]: Picture/Image Generation, I.3.5 [Computational Geometry and Object Modeling]: Geometric Algorithms. Additional Key Words and Phrases: irradiance gradient, irradi-ance Jacobian, isolux contours, light field, mesh generation, vector irradiance.  
Affiliation: Program of Computer Graphics Cornell University  
Abstract: The irradiance at a point on a surface due to a polyhedral source of uniform brightness is given by a well-known analytic formula. In this paper we derive the corresponding analytic expression for the irradiance Jacobian, the derivative of the vector representation of irradiance. Although the result is elementary for unoccluded sources, within penumbrae the irradiance Jacobian must incorporate more information about blockers than either the irradiance or vector irradiance. The expression presented here holds for any number of polyhedral blockers and requires only a minor extension of standard polygon clipping to evaluate. To illustrate its use, three related applications are briefly described: direct computation of isolux contours, finding local irradiance extrema, and iso-meshing. Isolux contours are curves of constant irradiance across a surface that can be followed using a predictor-corrector method based on the irradiance Jacobian. Similarly, local extrema can be found using a descent method. Finally, iso-meshing is a new approach to surface mesh generation that incorporates families of isolux contours. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> ACTON, F. S. </author> <title> Numerical Methods that Work. </title> <publisher> Harper & Row, </publisher> <address> New York, </address> <year> 1970. </year>
Reference-contexts: When the matrix P is fixed, Milne's predictor is given by r k+1 r k3 + 3 where g k denotes the gradient at the point r k , and h is the step size <ref> [1] </ref>. Given the predicted value, a corrector is then invoked to find the nearest point on the curve. Because the contour is the zero set of the function (r) c, the correction can be performed very efficiently using Newton's method.
Reference: [2] <author> BAUM, D. R., RUSHMEIER, H. E., AND WINGET, J. M. </author> <title> Improving radiosity solutions through the use of analytically determined form-factors. </title> <booktitle> Computer Graphics 23, </booktitle> <month> 3 (July </month> <year> 1989), </year> <pages> 325-334. </pages>
Reference-contexts: In Section 2 we derive the irradiance Jacobian for polygonal sources of uniform brightness starting with an analytic expression for the vector irradiance. The same expression has been used in scalar form by Nishita and Nakamae [14] to accurately simulate polyhedral sources, and by Baum et al. <ref> [2] </ref> for the computation of form factors. Section 3 introduces a method for characterizing changes in the apparent shape of a source due to differential changes in the receiving point, which is the key to handling occlusions. <p> See fi k (r) = cos jj v k r jj v k+1 r and (v k r) fi (v k+1 r) , (6) where jj jj is the Euclidean norm and v n+1 v 1 . Equation (4) most commonly appears in scalar form <ref> [2, 6, 14] </ref>. With M = 1, the corresponding expression (r) n (r) is the form factor between a differential patch at r and the polygonal patch P. This scalar expression was first derived by Lambert in the 18 th century [18].
Reference: [3] <author> BERGER, M. </author> <title> Geometry, Volume II. </title> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1987. </year> <note> Translated by M. </note> <author> Cole and S. Levy. </author> <title> constrained Delaunay triangulation. </title>
Reference-contexts: In terms of radiance, the light field is given by (r) S 2 where S 2 is the unit sphere in IR 3 , and is the canonical measure on the sphere <ref> [3] </ref>. That is, (r) is the integral over all unit vectors through r weighted by the radiance in each direction. At each point in space (r) is a vector quantity known as the light vector [7] or the vector irradiance [17]; we adopt the latter terminology in this paper.
Reference: [4] <author> CONWAY, D. M., AND COTTINGHAM, M. S. </author> <title> The isoluminance contour model. </title> <booktitle> In Proceedings of Ausgraph `88 (Melbourne, </booktitle> <address> Australia, </address> <month> September </month> <year> 1988), </year> <pages> pp. 43-50. </pages>
Reference-contexts: Applications of isolux contours in computer graphics include visualizing irradiance distributions [21, 15] and simplifying shading <ref> [4] </ref> and sampling [5]. In computer vision isolux contours have been used to perform automatic image segmentation [10]. In this section we show how isolux contours can be computed directly.
Reference: [5] <author> DRETTAKIS, G., AND FIUME, E. L. </author> <title> Concrete computation of global illumination using structured sampling. </title> <booktitle> In Proceedings of the Third Eu-rographics Workshop on Rendering, </booktitle> <address> Bristol, United Kingdom (1992). </address>
Reference-contexts: Nishita and Nakamae [14, 15] located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. Ward and Heckbert [22] computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. Drettakis and Fiume <ref> [5] </ref> also estimated gradients from samples and used them to guide subsequent sampling. The present work introduces a new tool based on the concept of vector irradiance, a natural representation of irradiance defined at all points in space. <p> Applications of isolux contours in computer graphics include visualizing irradiance distributions [21, 15] and simplifying shading [4] and sampling <ref> [5] </ref>. In computer vision isolux contours have been used to perform automatic image segmentation [10]. In this section we show how isolux contours can be computed directly. <p> The irradiance Jacobian may also find other applications in global illumination. In approaches that do not employ an explicit mesh, gradients can be used to guide sampling in a spirit similar to previous approaches <ref> [22, 5] </ref>, but using analytically computed gradients. Alternatively, irradiance gradients can be used to define higher-order interpolants within the elements of an existing mesh. Acknowledgments The author owes many thanks to Ken Torrance for his advice and encouragement, and to Steve Westin for his invaluable suggestions.
Reference: [6] <author> FOK, V. A. </author> <title> The illumination from surfaces of arbitrary shape. </title> <journal> Transactions of the Optical Institute, </journal> <volume> Leningrad 28 (1924), </volume> <pages> 1-11. (Russian). </pages>
Reference-contexts: See fi k (r) = cos jj v k r jj v k+1 r and (v k r) fi (v k+1 r) , (6) where jj jj is the Euclidean norm and v n+1 v 1 . Equation (4) most commonly appears in scalar form <ref> [2, 6, 14] </ref>. With M = 1, the corresponding expression (r) n (r) is the form factor between a differential patch at r and the polygonal patch P. This scalar expression was first derived by Lambert in the 18 th century [18].
Reference: [7] <author> GERSHUN, A. </author> <title> The light field. </title> <journal> Journal of Mathematics and Physics 18, </journal> <month> 2 (May </month> <year> 1939), </year> <pages> 51-151. </pages> <note> Translated by P. </note> <author> Moon and G. </author> <note> Timoshenko. </note>
Reference-contexts: Central to the present work is a vector field : IR 3 ! IR 3 known written in closed-form. (b) The contribution due to edge k is the product of the angle fi k and the unit vector k . as the light field <ref> [7] </ref>. In terms of radiance, the light field is given by (r) S 2 where S 2 is the unit sphere in IR 3 , and is the canonical measure on the sphere [3]. <p> That is, (r) is the integral over all unit vectors through r weighted by the radiance in each direction. At each point in space (r) is a vector quantity known as the light vector <ref> [7] </ref> or the vector irradiance [17]; we adopt the latter terminology in this paper. From vector irradiance we can derive other radiometric quantities, such as the net flux [watts/m 2 ]. <p> Moreover, when the sources are polyhedral, the vector irradiance can be expressed in closed form. 1.2 Polyhedral Sources For sources of uniform brightness, can be expressed analytically for a number of simple geometries including spheres and infinite strips <ref> [7] </ref>. Polygonal sources are another important class with known closed-form expressions, and are the focus of this paper. Suppose P is a simple planar polygon in IR 3 with vertices v 1 , v 2 , . . . , v n .
Reference: [8] <author> HECKBERT, P. S. </author> <title> Simulating Global Illumination Using Adaptive Meshing. </title> <type> PhD thesis, </type> <institution> University of California, Berkeley, </institution> <month> June </month> <year> 1991. </year>
Reference-contexts: In previous work, Heckbert <ref> [8] </ref> and Lischinski et al. [12] identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae [14, 15] located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. <p> For example, isolux contours can be used to drive a meshing algorithm for global illumination. The idea is similar to that of discontinuity meshing <ref> [8, 13] </ref>, which can identify important discontinuities in the radiance function over diffuse surfaces.
Reference: [9] <author> HOPF, E. </author> <title> Mathematical Problems of Radiative Equilibrium. </title> <publisher> Cam-bridge University Press, </publisher> <address> New York, </address> <year> 1934. </year>
Reference-contexts: From vector irradiance we can derive other radiometric quantities, such as the net flux [watts/m 2 ]. At any point r on a hypothetical surface M, the net flux (r) is the net flow of radiant energy across M per unit area <ref> [9] </ref>. By definition, (r) S 2 where is the angle of incidence relative to the surface. It follows that and are related by (r) = (r) n (r), (3) where n (r) is the surface normal at the point r.
Reference: [10] <author> LIFSHITZ, L. M., AND PIZER, S. M. </author> <title> A multiresolution hierarchical approach to image segmentation based on intensity extrema. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence 12, </journal> <month> 6 (June </month> <year> 1990), </year> <pages> 529-540. </pages>
Reference-contexts: Applications of isolux contours in computer graphics include visualizing irradiance distributions [21, 15] and simplifying shading [4] and sampling [5]. In computer vision isolux contours have been used to perform automatic image segmentation <ref> [10] </ref>. In this section we show how isolux contours can be computed directly. Every isolux contour on a surface M can be represented by a function r : [0, 1) ! M that satisfies (r (s)) = (r (0)) (31) for all s 0.
Reference: [11] <author> LISCHINSKI, D., SMITS, B., AND GREENBERG, D. P. </author> <title> Bounds and error estimates for radiosity. </title> <booktitle> In Computer Graphics Proceedings (1994), Annual Conference Series, ACM SIGGRAPH. </booktitle>
Reference-contexts: above is a general-purpose tool with many applications, several of which are described in the remainder of this section. 5.1 Finding Local Extrema The first application we examine is that of locating irradiance extrema on surfaces, which can be used in computing bounds on the transfer of energy between surfaces <ref> [11] </ref>.
Reference: [12] <author> LISCHINSKI, D., TAMPIERI, F., AND GREENBERG, D. P. </author> <title> Discontinuity meshing for accurate radiosity. </title> <journal> IEEE Computer Graphics and Applications 12, </journal> <month> 6 (November </month> <year> 1992), </year> <pages> 25-39. </pages>
Reference-contexts: In previous work, Heckbert [8] and Lischinski et al. <ref> [12] </ref> identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae [14, 15] located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. Ward and Heckbert [22] computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. <p> In the absence of contact occlusions, the variation of is not only continuous but differentiable everywhere except along lines where edges appear to coincide; that is, points at which a source or blocker edge appears to align with another blocker edge <ref> [12] </ref>. For instance, when both blockers are present simultaneously in Figure 2, the irradiance curve coincides with curve B to the left of r, and with curve A to the right. Therefore, the irradiance at r has a discontinuity in the first derivative.
Reference: [13] <author> LISCHINSKI, D., TAMPIERI, F., AND GREENBERG, D. P. </author> <title> Combining hierarchical radiosity and discontinuity meshing. </title> <booktitle> In Computer Graphics Proceedings (1993), Annual Conference Series, ACM SIGGRAPH, </booktitle> <pages> pp. 199-208. </pages>
Reference-contexts: For example, isolux contours can be used to drive a meshing algorithm for global illumination. The idea is similar to that of discontinuity meshing <ref> [8, 13] </ref>, which can identify important discontinuities in the radiance function over diffuse surfaces. <p> Isolux contours provide additional information about radiance functions, and can be employed for mesh generation either in a preprocessing step for modeling direct illumination, or as part of a radiosity post-process to create a high-quality mesh for rendering a final image <ref> [13] </ref>. To best exploit the information in the contours, the mesh elements of an iso-mesh should follow the contours. To generate a mesh with this property from isolux contours, we have applied the constrained Delaunay triangulation algorithm used earlier by Lischinski et al. [13] for discontinuity meshing. <p> high-quality mesh for rendering a final image <ref> [13] </ref>. To best exploit the information in the contours, the mesh elements of an iso-mesh should follow the contours. To generate a mesh with this property from isolux contours, we have applied the constrained Delaunay triangulation algorithm used earlier by Lischinski et al. [13] for discontinuity meshing. This approach forces the edges of the mesh elements to align with the isolux contours rather than crossing them. It also creates triangles with good aspect ratios. Figure 13 shows the result of applying this algorithm to the families of isolux contours shown in Figure 12.
Reference: [14] <author> NISHITA, T., AND NAKAMAE, E. </author> <title> Half-tone representation of 3-D objects illuminated by area sources or polyhedron sources. </title> <booktitle> In Proceedings of the IEEE Computer Software and Applications Conference (Chicago, </booktitle> <month> November </month> <year> 1983), </year> <pages> pp. 237-242. </pages>
Reference-contexts: In previous work, Heckbert [8] and Lischinski et al. [12] identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae <ref> [14, 15] </ref> located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. Ward and Heckbert [22] computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. Drettakis and Fiume [5] also estimated gradients from samples and used them to guide subsequent sampling. <p> In Section 2 we derive the irradiance Jacobian for polygonal sources of uniform brightness starting with an analytic expression for the vector irradiance. The same expression has been used in scalar form by Nishita and Nakamae <ref> [14] </ref> to accurately simulate polyhedral sources, and by Baum et al. [2] for the computation of form factors. Section 3 introduces a method for characterizing changes in the apparent shape of a source due to differential changes in the receiving point, which is the key to handling occlusions. <p> See fi k (r) = cos jj v k r jj v k+1 r and (v k r) fi (v k+1 r) , (6) where jj jj is the Euclidean norm and v n+1 v 1 . Equation (4) most commonly appears in scalar form <ref> [2, 6, 14] </ref>. With M = 1, the corresponding expression (r) n (r) is the form factor between a differential patch at r and the polygonal patch P. This scalar expression was first derived by Lambert in the 18 th century [18]. <p> Thus, polyhedral sources can be handled by applying equation (4) to each face and summing the resulting vectors. Alternatively, when the faces have equal brightness, equation (4) can be applied to the outer contour of the polyhedron as seen from the point r <ref> [14] </ref>. Partially occluded sources are handled similarly by summing the contributions of all the visible portions. Determining the visible portions of the sources in polyhedral environments is analogous to clipping polygons for hidden surface removal [23].
Reference: [15] <author> NISHITA, T., AND NAKAMAE, E. </author> <title> Continuous tone representation of 3-D objects taking account of shadows and interreflection. </title> <booktitle> Computer Graphics 19, </booktitle> <month> 3 (July </month> <year> 1985), </year> <pages> 23-30. </pages>
Reference-contexts: In previous work, Heckbert [8] and Lischinski et al. [12] identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae <ref> [14, 15] </ref> located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. Ward and Heckbert [22] computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. Drettakis and Fiume [5] also estimated gradients from samples and used them to guide subsequent sampling. <p> Applications of isolux contours in computer graphics include visualizing irradiance distributions <ref> [21, 15] </ref> and simplifying shading [4] and sampling [5]. In computer vision isolux contours have been used to perform automatic image segmentation [10]. In this section we show how isolux contours can be computed directly.
Reference: [16] <author> PLANTINGA, H., AND DYER, C. R. </author> <title> Visibility, occlusion, and the aspect graph. </title> <journal> International Journal of Computer Vision 5, </journal> <volume> 2 (1990), </volume> <pages> 137-160. </pages>
Reference-contexts: Differentiability follows from the smoothness of the Euclidean norm and the fact that the apparent point of intersection of two skew lines varies quadratically in r along each of the lines <ref> [16] </ref>. From this it is evident that the vertex Jacobian exists whenever the real or apparent intersection of two edges exists and is unique.
Reference: [17] <author> PREISENDORFER, R. W. </author> <title> Hydrologic Optics, </title> <booktitle> Volume II. Foundations. National Oceanic & Atmospheric Administration, </booktitle> <address> Honolulu, Hawaii, </address> <year> 1976. </year> <note> (Available as NTIS PB-259 794). </note>
Reference-contexts: That is, (r) is the integral over all unit vectors through r weighted by the radiance in each direction. At each point in space (r) is a vector quantity known as the light vector [7] or the vector irradiance <ref> [17] </ref>; we adopt the latter terminology in this paper. From vector irradiance we can derive other radiometric quantities, such as the net flux [watts/m 2 ].
Reference: [18] <author> SCHR ODER, P., AND HANRAHAN, P. </author> <title> On the form factor between two polygons. </title> <booktitle> In Computer Graphics Proceedings (1993), Annual Conference Series, ACM SIGGRAPH, </booktitle> <pages> pp. 163-164. </pages>
Reference-contexts: Equation (4) most commonly appears in scalar form [2, 6, 14]. With M = 1, the corresponding expression (r) n (r) is the form factor between a differential patch at r and the polygonal patch P. This scalar expression was first derived by Lambert in the 18 th century <ref> [18] </ref>. Because the light field is a true vector field, the vector irradiance due to multiple sources may be obtained by summing the contributions from each source individually. Thus, polyhedral sources can be handled by applying equation (4) to each face and summing the resulting vectors.
Reference: [19] <author> TELLER, S. </author> <title> Computing the antipenumbra of an area light source. </title> <booktitle> Computer Graphics 26, </booktitle> <month> 2 (July </month> <year> 1992), </year> <pages> 139-148. </pages>
Reference-contexts: In previous work, Heckbert [8] and Lischinski et al. [12] identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae [14, 15] located penumbrae in polyhedral environments, while Teller <ref> [19] </ref> computed antipenumbrae for sequences of portals. Ward and Heckbert [22] computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. Drettakis and Fiume [5] also estimated gradients from samples and used them to guide subsequent sampling.
Reference: [20] <author> TROTTER, A. P. </author> <title> Illumination: Its Distribution and Measurement. </title> <publisher> The Macmillan Company, </publisher> <address> London, </address> <year> 1911. </year>
Reference-contexts: In the absence of a global method for locating all extrema, seed points near each of the relevant extrema must be supplied. 5.2 Direct Computation of Isolux Contours Curves of constant irradiance over surfaces are known as isolux contours <ref> [20] </ref>. Applications of isolux contours in computer graphics include visualizing irradiance distributions [21, 15] and simplifying shading [4] and sampling [5]. In computer vision isolux contours have been used to perform automatic image segmentation [10]. In this section we show how isolux contours can be computed directly.
Reference: [21] <author> VERBECK, C. P., AND GREENBERG, D. P. </author> <title> A comprehensive light-source description for computer graphics. </title> <journal> IEEE Computer Graphics and Applications 4, </journal> <month> 7 (July </month> <year> 1984), </year> <pages> 66-75. </pages>
Reference-contexts: Applications of isolux contours in computer graphics include visualizing irradiance distributions <ref> [21, 15] </ref> and simplifying shading [4] and sampling [5]. In computer vision isolux contours have been used to perform automatic image segmentation [10]. In this section we show how isolux contours can be computed directly.
Reference: [22] <author> WARD, G. J., AND HECKBERT, P. S. </author> <title> Irradiance gradients. </title> <booktitle> In Proceedings of the Third Eurographics Workshop on Rendering, </booktitle> <address> Bristol, United Kingdom (May 1992). </address>
Reference-contexts: In previous work, Heckbert [8] and Lischinski et al. [12] identified derivative discontinuities to produce efficient surface meshes. Nishita and Nakamae [14, 15] located penumbrae in polyhedral environments, while Teller [19] computed antipenumbrae for sequences of portals. Ward and Heckbert <ref> [22] </ref> computed irradiance gradients from random samples of the environment to accurately interpolate irradiance functions. Drettakis and Fiume [5] also estimated gradients from samples and used them to guide subsequent sampling. <p> The irradiance Jacobian may also find other applications in global illumination. In approaches that do not employ an explicit mesh, gradients can be used to guide sampling in a spirit similar to previous approaches <ref> [22, 5] </ref>, but using analytically computed gradients. Alternatively, irradiance gradients can be used to define higher-order interpolants within the elements of an existing mesh. Acknowledgments The author owes many thanks to Ken Torrance for his advice and encouragement, and to Steve Westin for his invaluable suggestions.
Reference: [23] <author> WEILER, K., AND ATHERTON, P. </author> <title> Hidden surface removal using polygon area sorting. </title> <booktitle> Computer Graphics 11, 3 (1977), </booktitle> <pages> 214-222. </pages>
Reference-contexts: Partially occluded sources are handled similarly by summing the contributions of all the visible portions. Determining the visible portions of the sources in polyhedral environments is analogous to clipping polygons for hidden surface removal <ref> [23] </ref>. The closed-form expression for vector irradiance in equation (4) provides an effective means of computing related expressions, such as derivatives.
References-found: 23

