URL: http://www.cs.panam.edu/~meng/unix-home/UNIX/paper.ps.Z
Refering-URL: http://www.cs.panam.edu/~meng/unix-home/UNIX/
Root-URL: http://www.cs.panam.edu
Phone: (415) 326-6200 g FAX: (415) 326-5512 g Telex: 334486  
Title: IMPROVING THE SECURITY OF YOUR UNIX SYSTEM  
Author: David A. Curry, 
Address: ITSTD-721-FR-90-21  333 Ravenswood Avenue g Menlo Park, CA 94025-3493 g  
Affiliation: Systems Programmer Information and Telecommunications Sciences and Technology Division  SRI International  
Abstract: Approved: Paul K. Hyder, Manager Computer Facility Boyd C. Fair, General Manager Division Operations Section Michael S. Frankel, Vice President Information and Telecommunications Sciences and Technology Division Final Report g April 1990 
Abstract-found: 1
Intro-found: 1
Reference: [Eich89] <author> Eichin, Mark W., and Jon A. Rochlis. </author> <title> With Microscope and Tweezers: An Analysis of the Internet Virus of November 1988 . Massachusetts Institute of Technology. </title> <month> February </month> <year> 1989. </year>
Reference-contexts: VAX is a trademark of Digital Equipment Corporation. Sun-3 and NFS are trademarks of Sun Microsystems. Annex is a trademark of Xylogics, Inc. 1 1.2 THE INTERNET WORM On the evening of November 2, 1988, a self-replicating program, called a worm , was released on the Internet <ref> [Seel88, Spaf88, Eich89] </ref>. Overnight, this program had copied itself from machine to machine, causing the machines it infected to labor under huge loads, and denying service to the users of those machines. <p> S. Army Ballistic Research Laboratory, disconnected themselves from the Internet to avoid recontamination. In addition, the Defense Communications Agency ordered the connections between the MILNET and ARPANET shut down, and kept them down for nearly 24 hours <ref> [Eich89, Elme88] </ref>. Ironically, this was perhaps the worst thing to do, since the first fixes to combat the worm were distributed via the network [Eich89]. This incident was perhaps the most widely described computer security problem ever. <p> In addition, the Defense Communications Agency ordered the connections between the MILNET and ARPANET shut down, and kept them down for nearly 24 hours [Eich89, Elme88]. Ironically, this was perhaps the worst thing to do, since the first fixes to combat the worm were distributed via the network <ref> [Eich89] </ref>. This incident was perhaps the most widely described computer security problem ever.
Reference: [Elme88] <author> Elmer-DeWitt, Philip. </author> `` <title> `The Kid Put Us Out of Action.' '' Time , 132 (20): </title> <type> 76, </type> <month> November 14, </month> <year> 1988. </year>
Reference-contexts: S. Army Ballistic Research Laboratory, disconnected themselves from the Internet to avoid recontamination. In addition, the Defense Communications Agency ordered the connections between the MILNET and ARPANET shut down, and kept them down for nearly 24 hours <ref> [Eich89, Elme88] </ref>. Ironically, this was perhaps the worst thing to do, since the first fixes to combat the worm were distributed via the network [Eich89]. This incident was perhaps the most widely described computer security problem ever.
Reference: [Gram84] <author> Grammp, F. T., and R. H. Morris. </author> <title> ``UNIX Operating System Security.'' </title> <journal> AT&T Bell Laboratories Technical Journal , 63 (8): </journal> <pages> 1649-1672, </pages> <month> October </month> <year> 1984. </year>
Reference-contexts: In [Morr78], the authors describe experiments conducted to determine typical users' habits in the choice of passwords. In a collection of 3,289 passwords, 16% of them contained three characters or less, and an astonishing 86% were what could generally be described as insecure. Additional experiments in <ref> [Gram84] </ref> show that by trying three simple guesses on each account the login name, the login name in reverse, and the two concatenated together a cracker can expect to obtain access to between 8 and 30 percent of the accounts on a typical system. <p> One of 7 the unfortunate truisms of password security is that, ``left to their own ways, some people will still use cute doggie names as passwords'' <ref> [Gram84] </ref>. The best way to check the security of the passwords on your system is to use a password-cracking program much like a real cracker would use. If you succeed in cracking any passwords, those passwords should be changed immediately.
Reference: [Hind83] <author> Hinden, R., J. Haverty, and A. Sheltzer. </author> <title> ``The DARPA Internet: Interconnecting Heterogeneous Computer Networks with Gateways.'' </title> <journal> IEEE Computer Magazine , 16 (9): </journal> <pages> 33-48, </pages> <month> September </month> <year> 1983. </year>
Reference-contexts: Most of these regional networks are also interconnected, forming the Internet <ref> [Hind83, Quar86] </ref>. This means that the users of your machine can access other hosts and communicate with other users around the world. Unfortunately, it also means that other hosts and users from around the world can access your machine, and attempt to break into it.
Reference: [McLe87] <author> McLellan, Vin. </author> <title> ``NASA Hackers: There's More to the Story.'' Digital Review , November 23, 1987, </title> <editor> p. </editor> <volume> 80. </volume>
Reference-contexts: The last of the intruders, Hans Hu .. bner (``Pengo''), still faces trial in Berlin. 1.4 OTHER BREAK-INS Numerous other computer security problems have occurred in recent years, with varying levels of publicity. Some of the more widely known incidents include break-ins on NASA's SPAN network <ref> [McLe87] </ref>, the IBM ``Christmas Virus'' [Risk87], a virus at Mitre Corp. that caused the MILNET to be temporarily isolated from other networks [Risk88], a worm that penetrated DECNET networks [Risk89a], break-ins on U.
Reference: [Morr78] <author> Morris, Robert, and Ken Thompson. </author> <title> ``Password Security: A Case History.'' </title> <booktitle> Communications of the ACM , 22 (11): </booktitle> <pages> 594-597, </pages> <month> November </month> <year> 1979. </year> <title> Reprinted in UNIX System Manager's Manual , 4.3 Berkeley Software Distribution. </title> <institution> University of California, Berkeley. </institution> <month> April </month> <year> 1986. </year>
Reference-contexts: No checks for obviously insecure passwords (see below) are performed. Thus, it is incumbent upon the system administrator to ensure that the passwords in use on the system are secure. In <ref> [Morr78] </ref>, the authors describe experiments conducted to determine typical users' habits in the choice of passwords. In a collection of 3,289 passwords, 16% of them contained three characters or less, and an astonishing 86% were what could generally be described as insecure.
Reference: [NCSC85] <institution> National Computer Security Center. Department of Defense Trusted Computer System Evaluation Criteria , Department of Defense Standard DOD 5200.28-STD, </institution> <month> December, </month> <year> 1985. </year>
Reference-contexts: These features can be installed as one of the options when installing the system from the distribution tapes. The hhhhhhhhhhhhhhh * C2 is one of several security classifications defined by the National Computer Security Center, and is described in <ref> [NCSC85] </ref>, the ``orange book.'' 38 security features added by this option include g Audit trails that record all login and logout times, the execution of administrative commands, and the execution of privileged (setuid) operations. g A more secure password file mechanism (``shadow password file'') that prevents crackers from obtaining a list
Reference: [Quar86] <author> Quarterman, J. S., and J. C. Hoskins. </author> <booktitle> ``Notable Computer Networks.'' Communications of the ACM , 29 (10): </booktitle> <pages> 932-971, </pages> <month> October </month> <year> 1986. </year>
Reference-contexts: Most of these regional networks are also interconnected, forming the Internet <ref> [Hind83, Quar86] </ref>. This means that the users of your machine can access other hosts and communicate with other users around the world. Unfortunately, it also means that other hosts and users from around the world can access your machine, and attempt to break into it.
Reference: [Reed84] <author> Reeds, J. A., and P. J. Weinberger. </author> <title> ``File Security and the UNIX System Crypt Command.'' </title> <journal> AT&T Bell Laboratories Technical Journal , 63 (8): </journal> <pages> 1673-1683, </pages> <month> October </month> <year> 1984. </year>
Reference-contexts: Crypt implements a one-rotor machine along the lines of the German Enigma (broken in World War II). The methods of attack on such a machine are well known, and a sufficiently large file can usually be decrypted in a few hours even without knowledge of what the file contains <ref> [Reed84] </ref>. In fact, publicly available packages of programs designed to ``break'' files encrypted with crypt have been around for several years. There are software implementations of another algorithm, the Data Encryption Standard (DES), available on some systems.
Reference: [Risk87] <institution> Forum on Risks to the Public in Computers and Related Systems . ACM Committee on Computers and Public Policy, Peter G. Neumann, Moderator. Internet mailing list. </institution> <note> Issue 5.73, December 13, </note> <year> 1987. </year>
Reference-contexts: Some of the more widely known incidents include break-ins on NASA's SPAN network [McLe87], the IBM ``Christmas Virus'' <ref> [Risk87] </ref>, a virus at Mitre Corp. that caused the MILNET to be temporarily isolated from other networks [Risk88], a worm that penetrated DECNET networks [Risk89a], break-ins on U.
Reference: [Risk88] <institution> Forum on Risks to the Public in Computers and Related Systems . ACM Committee on Computers and Public Policy, Peter G. Neumann, Moderator. Internet mailing list. </institution> <note> Issue 7.85, December 1, </note> <year> 1988. </year>
Reference-contexts: Some of the more widely known incidents include break-ins on NASA's SPAN network [McLe87], the IBM ``Christmas Virus'' [Risk87], a virus at Mitre Corp. that caused the MILNET to be temporarily isolated from other networks <ref> [Risk88] </ref>, a worm that penetrated DECNET networks [Risk89a], break-ins on U. S. banking networks [Risk89b], and a multitude of viruses, worms, and trojan horses affecting personal computer users. 1.5 SECURITY IS IMPORTANT As the previous stories demonstrate, computer security is an important topic.
Reference: [Risk89a] <institution> Forum on Risks to the Public in Computers and Related Systems . ACM Committee on Computers and Public Policy, Peter G. Neumann, Moderator. Internet mailing list. </institution> <note> Issue 8.2, January 4, </note> <year> 1989. </year>
Reference-contexts: Some of the more widely known incidents include break-ins on NASA's SPAN network [McLe87], the IBM ``Christmas Virus'' [Risk87], a virus at Mitre Corp. that caused the MILNET to be temporarily isolated from other networks [Risk88], a worm that penetrated DECNET networks <ref> [Risk89a] </ref>, break-ins on U. S. banking networks [Risk89b], and a multitude of viruses, worms, and trojan horses affecting personal computer users. 1.5 SECURITY IS IMPORTANT As the previous stories demonstrate, computer security is an important topic.
Reference: [Risk89b] <institution> Forum on Risks to the Public in Computers and Related Systems . ACM Committee on Computers and Public Policy, Peter G. Neumann, Moderator. Internet mailing list. </institution> <note> Issue 8.9, January 17, </note> <year> 1989. </year>
Reference-contexts: Some of the more widely known incidents include break-ins on NASA's SPAN network [McLe87], the IBM ``Christmas Virus'' [Risk87], a virus at Mitre Corp. that caused the MILNET to be temporarily isolated from other networks [Risk88], a worm that penetrated DECNET networks [Risk89a], break-ins on U. S. banking networks <ref> [Risk89b] </ref>, and a multitude of viruses, worms, and trojan horses affecting personal computer users. 1.5 SECURITY IS IMPORTANT As the previous stories demonstrate, computer security is an important topic. This document describes the security features provided by the UNIX operating system, and how they should be used.
Reference: [Risk90] <institution> Forum on Risks to the Public in Computers and Related Systems . ACM Committee on Computers and Public Policy, Peter G. Neumann, Moderator. Internet mailing list. </institution> <note> Issue 9.69, February 20, 1990. 49 </note>
Reference-contexts: No suicide note was found [Stol89]. In February 1990, three of the intruders (Markus Hess, Dirk Bresinsky, and Peter Carl) were convicted of espionage in a German court and sentenced to prison terms, fines, and the loss of their rights to participate in elections <ref> [Risk90] </ref>. The last of the intruders, Hans Hu .. bner (``Pengo''), still faces trial in Berlin. 1.4 OTHER BREAK-INS Numerous other computer security problems have occurred in recent years, with varying levels of publicity.
Reference: [Ritc75] <author> Ritchie, Dennis M. </author> <title> ``On the Security of UNIX.'' </title> <month> May </month> <year> 1975. </year> <title> Reprinted in UNIX System Manager's Manual , 4.3 Berkeley Software Distribution. </title> <institution> University of California, Berkeley. </institution> <month> April </month> <year> 1986. </year>
Reference-contexts: INTRODUCTION 1.1 UNIX SECURITY The UNIX operating system, although now in widespread use in environments concerned about security, was not really designed with security in mind <ref> [Ritc75] </ref>. This does not mean that UNIX does not provide any security mechanisms; indeed, several very good ones are available.
Reference: [Schu90] <author> Schuman, Evan. </author> <note> ``Bid to Unhook Worm.'' UNIX Today! , February 5, 1990, p. 1. </note>
Reference-contexts: In January 1990, a United States District Court jury found Robert Tappan Morris, the author of the worm, guilty of charges brought against him under a 1986 federal computer fraud and abuse law. Morris faces up to five years in prison and a $250,000 fine <ref> [Schu90] </ref>. Sentencing is scheduled for May 4, 1990. 1.3 SPIES AND ESPIONAGE In August 1986, the Lawrence Berkeley Laboratory, an unclassified research laboratory at the University of California at Berkeley, was attacked by an unauthorized computer intruder [Stol88, Stol89].
Reference: [Seel88] <institution> Seeley, Donn. A Tour of the Worm . Department of Computer Science, University of Utah. </institution> <month> December </month> <year> 1988. </year>
Reference-contexts: VAX is a trademark of Digital Equipment Corporation. Sun-3 and NFS are trademarks of Sun Microsystems. Annex is a trademark of Xylogics, Inc. 1 1.2 THE INTERNET WORM On the evening of November 2, 1988, a self-replicating program, called a worm , was released on the Internet <ref> [Seel88, Spaf88, Eich89] </ref>. Overnight, this program had copied itself from machine to machine, causing the machines it infected to labor under huge loads, and denying service to the users of those machines. <p> The worm itself did not destroy any files, steal any information (other than account passwords), intercept private mail, or plant other destructive software <ref> [Seel88] </ref>. However, it did manage to severely disrupt the operation of the network. Several sites, including parts of MIT, NASA's Ames Research Center and Goddard Space Flight Center, the Jet Propulsion Laboratory, and the U. S. Army Ballistic Research Laboratory, disconnected themselves from the Internet to avoid recontamination. <p> Unfortunately, for the same reason, the concept of a trusted host is also extremely insecure. The Internet worm made extensive use of the trusted host concept to spread itself throughout the network <ref> [Seel88] </ref>. Many sites that had already disallowed trusted hosts did fairly well against the worm compared with those sites that did allow trusted hosts. Even though it is a security hole, there are some valid uses for the trusted host concept. <p> As with the FTP software, older versions of sendmail have several bugs that allow security violations. One of these bugs was used with great success by the Internet worm <ref> [Seel88, Spaf88] </ref>. The current version of sendmail from Berkeley is version 5.61, of January 1989. Sun is, as of this writing, still shipping version 5.59, which has a known security problem. They have, however, made a fixed version available. Section 4 details how to obtain these newer versions. <p> The fingerd program [Sun88a, 1625] allows users on remote hosts to obtain this information. A bug in fingerd was also exercised with success by the Internet worm <ref> [Seel88, Spaf88] </ref>. If your version of fingerd * is older than November 5, 1988, it should be replaced with a newer version.
Reference: [Spaf88] <author> Spafford, Eugene H. </author> <title> The Internet Worm Program: An Analysis . Technical Report CSD-TR-823. </title> <institution> Department of Computer Science, Purdue University. </institution> <month> November </month> <year> 1988. </year>
Reference-contexts: VAX is a trademark of Digital Equipment Corporation. Sun-3 and NFS are trademarks of Sun Microsystems. Annex is a trademark of Xylogics, Inc. 1 1.2 THE INTERNET WORM On the evening of November 2, 1988, a self-replicating program, called a worm , was released on the Internet <ref> [Seel88, Spaf88, Eich89] </ref>. Overnight, this program had copied itself from machine to machine, causing the machines it infected to labor under huge loads, and denying service to the users of those machines. <p> Next, the worm tried each word present in an internal dictionary of 432 words (presumably Morris considered these words to be ``good'' words to try). If all else failed, the worm tried going through the system dictionary, /usr/dict/words , trying each word <ref> [Spaf88] </ref>. The password selection rules above successfully guard against all three of these strategies. 2.1.1.2 Password Policies Although asking users to select secure passwords will help improve security, by itself it is not enough. <p> As with the FTP software, older versions of sendmail have several bugs that allow security violations. One of these bugs was used with great success by the Internet worm <ref> [Seel88, Spaf88] </ref>. The current version of sendmail from Berkeley is version 5.61, of January 1989. Sun is, as of this writing, still shipping version 5.59, which has a known security problem. They have, however, made a fixed version available. Section 4 details how to obtain these newer versions. <p> The fingerd program [Sun88a, 1625] allows users on remote hosts to obtain this information. A bug in fingerd was also exercised with success by the Internet worm <ref> [Seel88, Spaf88] </ref>. If your version of fingerd * is older than November 5, 1988, it should be replaced with a newer version.
Reference: [Stee88] <author> Steele, Guy L. Jr., Donald R. Woods, Raphael A. Finkel, Mark R. Crispin, Richard M. Stallman, and Geoffrey S. Goodfellow. </author> <title> The Hacker's Dictionary . New York: </title> <publisher> Harper and Row, </publisher> <year> 1988. </year>
Reference-contexts: cracker to penetrate. hhhhhhhhhhhhhhh * The term ``hacker,'' as applied to computer users, originally had an honorable connotation: ``a person who enjoys learning the details of programming systems and how to stretch their capabilities as opposed to most users of computers, who prefer to learn only the minimum amount necessary'' <ref> [Stee88] </ref>. Unfortunately, the media has distorted this definition and given it a dishonorable meaning. In deference to the true hackers, we will use the term ``cracker'' throughout this document. 3 4 SECTION 2 IMPROVING SECURITY UNIX system security can be divided into three main areas of concern.
Reference: [Stei88] <author> Stein, Jennifer G., Clifford Neuman, and Jeffrey L. Schiller. </author> <title> ``Kerberos: An Authentication Service for Open Network Systems.'' </title> <booktitle> USENIX Conference Proceedings , Dallas, </booktitle> <address> Texas, </address> <month> Winter </month> <year> 1988, </year> <pages> pp. 203-211. </pages>
Reference-contexts: These security features are described in detail in [Sun88c]. 4.5 KERBEROS Kerberos <ref> [Stei88] </ref> is an authentication system developed by the Athena Project at the Mas-sachusetts Institute of Technology. Kerberos is a third-party authentication service, which is trusted by other network services.
Reference: [Stol88] <author> Stoll, Clifford. </author> <title> ``Stalking the Wily Hacker.'' </title> <booktitle> Communications of the ACM , 31 (5): </booktitle> <pages> 484-497, </pages> <month> May </month> <year> 1988. </year>
Reference-contexts: Morris faces up to five years in prison and a $250,000 fine [Schu90]. Sentencing is scheduled for May 4, 1990. 1.3 SPIES AND ESPIONAGE In August 1986, the Lawrence Berkeley Laboratory, an unclassified research laboratory at the University of California at Berkeley, was attacked by an unauthorized computer intruder <ref> [Stol88, Stol89] </ref>. Instead of immediately closing the holes the intruder was using, the system administrator, Clifford Stoll, elected to watch the intruder and document the weaknesses he exploited. Over the next 10 months, Stoll watched the intruder attack over 400 computers around the world, and successfully enter about 30. <p> Over the next 10 months, Stoll watched the intruder attack over 400 computers around the world, and successfully enter about 30. The computers broken into were located at universities, military bases, and defense contractors <ref> [Stol88] </ref>. hhhhhhhhhhhhhhh * Sun-3 systems from Sun Microsystems and VAX systems from Digital Equipment Corp., both running variants of 4.x BSD UNIX from the University of California at Berkeley. 2 Unlike many intruders seen on the Internet, who typically enter systems and browse around to see what they can, this intruder <p> Although it is unlikely that the intruder would have found any truly classified information (the Internet is an unclassified network), it was highly probable that he could find a wealth of sensitive material <ref> [Stol88] </ref>. After a year of tracking the intruder (eventually involving the FBI, CIA, National Security Agency, Air Force Intelligence, and authorities in West Germany), five men in Hann-over, West Germany were arrested.
Reference: [Stol89] <author> Stoll, </author> <title> Clifford. </title> <address> The Cuckoo's Egg . New York: </address> <publisher> Doubleday, </publisher> <year> 1989. </year>
Reference-contexts: Morris faces up to five years in prison and a $250,000 fine [Schu90]. Sentencing is scheduled for May 4, 1990. 1.3 SPIES AND ESPIONAGE In August 1986, the Lawrence Berkeley Laboratory, an unclassified research laboratory at the University of California at Berkeley, was attacked by an unauthorized computer intruder <ref> [Stol88, Stol89] </ref>. Instead of immediately closing the holes the intruder was using, the system administrator, Clifford Stoll, elected to watch the intruder and document the weaknesses he exploited. Over the next 10 months, Stoll watched the intruder attack over 400 computers around the world, and successfully enter about 30. <p> In March 1989, the five were charged with espionage: they had been selling the material they found during their exploits to the KGB. One of the men, Karl Koch (``Hagbard''), was later found burned to death in an isolated forest outside Hannover. No suicide note was found <ref> [Stol89] </ref>. In February 1990, three of the intruders (Markus Hess, Dirk Bresinsky, and Peter Carl) were convicted of espionage in a German court and sentenced to prison terms, fines, and the loss of their rights to participate in elections [Risk90].
Reference: [Sun88a] <author> Sun Microsystems. </author> <title> SunOS Reference Manual , Part Number 800-1751-10, </title> <month> May </month> <year> 1988. </year>
Reference-contexts: If the password obtained is that of the super-user, the problem is more serious: the cracker will have read and write access to every file on the system. For this reason, choosing secure passwords is extremely important. The UNIX passwd program <ref> [Sun88a, 379] </ref> places very few restrictions on what may be used as a password. Generally, it requires that passwords contain five or more lowercase letters, or four characters if a nonalphabetic or uppercase letter is included. <p> The proper way to allow users to share information, rather than giving them a group account to use, is to place these users into a group. This is done by editing the group file, /etc/group <ref> [Sun88a, 1390; Sun88b, 66] </ref>, and creating a new group with the users who wish to collaborate listed as members. A line in the group file looks like groupname:password:groupid:user1,user2,user3,... The groupname is the name assigned to the group, much like a login name. <p> own password, thus protecting the security of the system. 9 For example, to change Huey's ``programs'' directory to be owned by the new group and properly set up the permissions so that all members of the group may access it, the chgrp and chmod commands would be used as follows <ref> [Sun88a, 63-66] </ref>: # chgrp hackers huey/programs # chmod -R g+rw huey/programs 2.1.6 Yellow Pages The Sun Yellow Pages system [Sun88b, 349-374] allows many hosts to share password files, group files, and other files via the network, while the files are stored on only a single host. <p> Even though it is a security hole, there are some valid uses for the trusted host concept. This section describes how to properly implement the trusted hosts facility while preserving as much security as possible. 2.2.1.1 The hosts.equiv File The file /etc/hosts.equiv <ref> [Sun88a, 1397] </ref> can be used by the system administrator to indicate trusted hosts. Each trusted host is listed in the file, one host per line. <p> When installing a new system from Sun distribution tapes, you should be sure to either replace the Sun default hosts.equiv with a correctly configured one, or delete the file altogether. 2.2.1.2 The .rhosts File The .rhosts file <ref> [Sun88a, 1397] </ref> is similar in concept and format to the hosts.equiv file, but allows trusted access only to specific host-user combinations, rather than to hosts in general.* Each user may create a .rhosts file in his home directory, and allow access to her account without a password. <p> Simply put, the super-user (``root'') may not log in on a nonsecure terminal, even with a password. (Authorized users may still use the su command to become super-user, however.) The file /etc/ttytab <ref> [Sun88a, 1478] </ref> is used to control which terminals are con sidered secure. A short excerpt from this file is shown below. hhhhhhhhhhhhhhh * Actually, hosts.equiv may be used to specify host-user combinations as well, but this is rarely done. <p> Secure NFS, introduced in SunOS Release 4.0, takes security one step further, using public-key encryption techniques to ensure author ized access. Discussion of secure NFS is deferred until Section 4. 2.2.3.1 The exports File The file /etc/exports <ref> [Sun88a, 1377] </ref> is perhaps one of the most important parts of NFS configuration. This file lists which file systems are exported (made available for mounting) 13 to other systems. <p> Netgroups are described in the next section. After making any changes to the exports file, you should run the command # exportfs -a in order to make the changes take effect. 2.2.3.2 The netgroup File The file /etc/netgroup <ref> [Sun88a, 1407] </ref> is used to define netgroups. This file is controlled by Yellow Pages, and must be rebuilt in the Yellow Pages maps whenever it is modified. <p> Untrusted hosts should never be given ``root'' access to NFS file systems. 2.2.4 FTP The File Transfer Protocol, implemented by the ftp and ftpd programs <ref> [Sun88a, 195-201, 1632-1634] </ref>, allows users to connect to remote systems and transfer files back and forth. Unfortunately, older versions of these programs also had several bugs in them that allowed crackers to break into a system. These bugs have been fixed by Berkeley, and new versions are available. <p> In particular, versions of SunOS prior to release 4.0 are known to have this problem. 2.2.5 Mail Electronic mail is one of the main reasons for connecting to outside networks. On most versions of Berkeley-derived UNIX systems, including those from Sun, the sendmail program <ref> [Sun88a, 1758-1760; Sun88b, 441-488] </ref> is used to enable the receipt and delivery of mail. As with the FTP software, older versions of sendmail have several bugs that allow security violations. One of these bugs was used with great success by the Internet worm [Seel88, Spaf88]. <p> By following the procedures above, you can be sure that your mail system is secure. 2.2.6 Finger The ``finger'' service, provided by the finger program <ref> [Sun88a, 186-187] </ref>, allows you to obtain information about a user such as her full name, home directory, last login time, and in some cases when she last received mail and/or read her mail. The fingerd program [Sun88a, 1625] allows users on remote hosts to obtain this information. <p> The fingerd program <ref> [Sun88a, 1625] </ref> allows users on remote hosts to obtain this information. A bug in fingerd was also exercised with success by the Internet worm [Seel88, Spaf88]. If your version of fingerd * is older than November 5, 1988, it should be replaced with a newer version. <p> Since this is rarely desirable (you don't want other users to be able to write your files), the umask value is used to modify the set of permissions a file is created with. Simply put, while the chmod command <ref> [Sun88a, 65-66] </ref> specifies what bits should be turned on , the umask value specifies what bits should be turned off . For example, the default umask on most systems is 022. This means that write permission for the group and world should be turned off whenever a file is created. <p> The umask value is specified in the .cshrc or .profile files read by the shell using the umask command <ref> [Sun88a, 108, 459] </ref>. The ``root'' account should have the line 22 umask 022 in its /.cshrc file, in order to prevent the accidental creation of world-writable files owned by the super-user. 2.3.5 Encrypting Files The standard UNIX crypt command [Sun88a, 95] is not at all secure. <p> The ``root'' account should have the line 22 umask 022 in its /.cshrc file, in order to prevent the accidental creation of world-writable files owned by the super-user. 2.3.5 Encrypting Files The standard UNIX crypt command <ref> [Sun88a, 95] </ref> is not at all secure. Although it is reasonable to expect that crypt will keep the casual ``browser'' from reading a file, it will present nothing more than a minor inconvenience to a determined cracker. <p> The commands described in this section can be used to obtain this information from the system. 3.1.1 The lastlog File The file /usr/adm/lastlog <ref> [Sun88a, 1485] </ref> records the most recent login time for each user of the system. The message printed each time you log in, e.g., Last login: Sat Mar 10 10:50:48 from spam.itstd.sri.c uses the time stored in the lastlog file. <p> This is an easy way to detect account break-ins, since each user should remember the last time she logged into the system. 3.1.2 The utmp and wtmp Files The file /etc/utmp <ref> [Sun88a, 1485] </ref> is used to record who is currently logged into the system. <p> This file can be displayed using the who command <ref> [Sun88a, 597] </ref>: % who hendra tty0c Mar 13 12:31 heidari tty14 Mar 13 13:54 welgem tty36 Mar 13 12:15 reagin ttyp0 Mar 13 08:54 (aaifs.itstd.sri.) ghg ttyp1 Mar 9 07:03 (hydra.riacs.edu) compion ttyp2 Mar 1 03:01 (ei.ecn.purdue.ed) For each user, the login name, terminal being used, login time, and remote host <p> Mar 13 12:15 reagin ttyp0 Mar 13 08:54 (aaifs.itstd.sri.) ghg ttyp1 Mar 9 07:03 (hydra.riacs.edu) compion ttyp2 Mar 1 03:01 (ei.ecn.purdue.ed) For each user, the login name, terminal being used, login time, and remote host (if the user is logged in via the network) are displayed. 25 The file /usr/adm/wtmp <ref> [Sun88a, 1485] </ref> records each login and logout time for every user. <p> The wtmp file may also be examined using the last command <ref> [Sun88a, 248] </ref>. This command sorts out the entries in the file, matching up login and logout times. With no arguments, last displays all information in the file. <p> Additionally, the times of all system shutdowns and reboots (generated by the shutdown and reboot commands <ref> [Sun88a, 1727, 1765] </ref>) are recorded. Unfortunately, system crashes are not recorded. <p> Unfortunately, system crashes are not recorded. In newer versions of the operating system, pseudo logins such as those via the ftp command are also recorded; an example of this is shown in the last line of the sample output, above. 3.1.3 The acct File The file /usr/adm/acct <ref> [Sun88a, 1344-1345] </ref> records each execution of a command on the system, who executed it, when, and how long it took. <p> This information is logged each time a command completes, but only if your kernel was compiled with the SYSACCT option enabled (the option is enabled in some GENERIC kernels, but is usually disabled by default). The acct file can be displayed using the lastcomm command <ref> [Sun88a, 249] </ref>. With no arguments, all the information in the file is displayed. However, by giving a command name, user 26 name, or terminal name as an argument, the output can be restricted to information about the given command, user, or terminal. <p> However, there are some programs available to aid you in this task. These are described in this section. 3.2.1 The syslog Facility The syslog facility <ref> [Sun88a, 1773] </ref> is a mechanism that enables any command to log error messages and informational messages to the system console, as well as to a log file. <p> These messages can be used to check for users sharing their passwords, as well as for a cracker who has penetrated one account and is trying to penetrate others. 3.2.2 The showmount Command The showmount command <ref> [Sun88a, 1764] </ref> can be used on an NFS file server to display the names of all hosts that currently have something mounted from the server. With no options, the program simply displays a list of all the hosts. With the -a and -d options, the output is somewhat more useful. <p> It is also important to be able to detect unauthorized modifications to the file system, and to recover from these modifications when they are made. 3.3.1 The find Command The find command <ref> [Sun88a, 183-185] </ref> is a general-purpose command for searching the file system. Using various arguments, complex matching patterns based on a file's name, type, mode, owner, modification time, and other characteristics, can be constructed. <p> There are several utilities that implement checklists available from public software sites (see Section 4). However, a simple utility can be constructed using only the standard UNIX ls and diff commands. First, use the ls command <ref> [Sun88a, 285] </ref> to generate a master list. This is best done immediately after installing the operating system, but can be done at any time provided you're confident about the correctness of the files on the disk. <p> To search for changes in the file system, run the above ls command again, saving the output in some other file, say CurrentList . Now use the diff command <ref> [Sun88a, 150] </ref> to compare the two files: # diff MasterChecklist CurrentList Lines that are only in the master checklist will be printed preceded by a ``&lt;,'' and lines that are only in the current list will be preceded by a ``&gt;.'' If there is one line for a file, preceded by <p> A good backup strategy will dump the entire system at level zero (a ``full'' dump) at least once a month. Partial (or ``incremental'') dumps should be done at least twice a week, and ideally they should be done daily. The dump command <ref> [Sun88a, 1612-1614] </ref> is recommended over other programs such as tar and cpio . This is because only dump is capable of creating a backup that can be used to restore a disk to the exact state it was in when it was dumped. <p> By being familiar with the processes normally running on your system, the times different users typically log in, and so on, you can easily detect when something is out of the ordinary. 3.4.1 The ps Command The ps command <ref> [Sun88a, 399-402] </ref> displays a list of the processes running on your system. Ps has numerous options, too many to list here. <p> By running this periodically, you can learn at what times during the day various users log in. Then, when you see someone logged in at a different time, you can investigate and make sure that it's legitimate. The w command <ref> [Sun88a, 588] </ref> is somewhat of a cross between who and ps . <p> This section describes some of the larger repositories. 4.1.1 Sun Fixes on UUNET Sun Microsystems has contracted with UUNET Communications Services, Inc. to make fixes for bugs in Sun software available via anonymous FTP. You can access these fixes by using the ftp command <ref> [Sun88a, 195-201] </ref> to connect to the host ftp.uu.net . Then change into the directory sun-fixes , and obtain a directory listing, as shown in the example on the following page. 35 % ftp ftp.uu.net Connected to uunet.UU.NET. 220 uunet FTP server (Version 5.93 Tue Mar 20 11:01:52 EST 1990) ready. <p> The Berkeley fixes are available for anonymous FTP from the host ucbarpa.berkeley.edu in the directory 4.3/ucb-fixes . The file INDEX in this directory describes what each file contains. Berkeley also distributes new versions of sendmail and named <ref> [Sun88a, 1758-1760, 1691 1692] </ref> from this machine. <p> services include Sun Microsystems (see above), Digital Equipment Corp., the University of California at Berkeley (see above), and Apple Computer. 4.2 THE NPASSWD COMMAND The npasswd command, developed by Clyde Hoover at the University of Texas at Austin, is intended to be a replacement for the standard UNIX passwd command <ref> [Sun88a, 379] </ref>, as well as the Sun yppasswd command [Sun88a, 611]. npasswd makes passwords more secure by refusing to allow users to select insecure passwords. <p> the University of California at Berkeley (see above), and Apple Computer. 4.2 THE NPASSWD COMMAND The npasswd command, developed by Clyde Hoover at the University of Texas at Austin, is intended to be a replacement for the standard UNIX passwd command [Sun88a, 379], as well as the Sun yppasswd command <ref> [Sun88a, 611] </ref>. npasswd makes passwords more secure by refusing to allow users to select insecure passwords. <p> user ids, invalid fields in the password file, etc. g Checks for duplicate group ids, invalid fields in the group file, etc. g Checks all users' home directories and their .cshrc , .login , .profile , and .rhosts files for security problems. g Checks all commands in the /etc/rc files <ref> [Sun88a, 1724-1725] </ref> and cron files [Sun88a, 1606-1607] for world writability. g Checks for bad ``root'' paths, NFS file system exported to the world, etc. g Includes an expert system that checks to see if a given user (usually ``root'') can be compromised, given that certain rules are true. g Checks for <p> the password file, etc. g Checks for duplicate group ids, invalid fields in the group file, etc. g Checks all users' home directories and their .cshrc , .login , .profile , and .rhosts files for security problems. g Checks all commands in the /etc/rc files [Sun88a, 1724-1725] and cron files <ref> [Sun88a, 1606-1607] </ref> for world writability. g Checks for bad ``root'' paths, NFS file system exported to the world, etc. g Includes an expert system that checks to see if a given user (usually ``root'') can be compromised, given that certain rules are true. g Checks for changes in the setuid status <p> When a user logs in, Kerberos authenticates that user (using a password), and provides the user with a way to prove her identity to other servers and hosts scattered around the network. This authentication is then used by programs such as rlogin <ref> [Sun88a, 418-419] </ref> to allow the user to log in to other hosts without a password (in place of the .rhosts file).
Reference: [Sun88b] <author> Sun Microsystems. </author> <title> System and Network Administration , Part Number 800-1733-10, </title> <month> May </month> <year> 1988. </year>
Reference-contexts: The proper way to allow users to share information, rather than giving them a group account to use, is to place these users into a group. This is done by editing the group file, /etc/group <ref> [Sun88a, 1390; Sun88b, 66] </ref>, and creating a new group with the users who wish to collaborate listed as members. A line in the group file looks like groupname:password:groupid:user1,user2,user3,... The groupname is the name assigned to the group, much like a login name. <p> owned by the new group and properly set up the permissions so that all members of the group may access it, the chgrp and chmod commands would be used as follows [Sun88a, 63-66]: # chgrp hackers huey/programs # chmod -R g+rw huey/programs 2.1.6 Yellow Pages The Sun Yellow Pages system <ref> [Sun88b, 349-374] </ref> allows many hosts to share password files, group files, and other files via the network, while the files are stored on only a single host. Unfortunately, Yellow Pages also contains a few potential security holes. <p> In particular, versions of SunOS prior to release 4.0 are known to have this problem. 2.2.5 Mail Electronic mail is one of the main reasons for connecting to outside networks. On most versions of Berkeley-derived UNIX systems, including those from Sun, the sendmail program <ref> [Sun88a, 1758-1760; Sun88b, 441-488] </ref> is used to enable the receipt and delivery of mail. As with the FTP software, older versions of sendmail have several bugs that allow security violations. One of these bugs was used with great success by the Internet worm [Seel88, Spaf88].
Reference: [Sun88c] <author> Sun Microsystems. </author> <title> Security Features Guide , Part Number 800-1735-10, </title> <month> May </month> <year> 1988. </year>
Reference-contexts: These security features are described in detail in <ref> [Sun88c] </ref>. 4.5 KERBEROS Kerberos [Stei88] is an authentication system developed by the Athena Project at the Mas-sachusetts Institute of Technology. Kerberos is a third-party authentication service, which is trusted by other network services.

References-found: 25

