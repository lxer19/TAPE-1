URL: http://www.cs.nyu.edu/cs/faculty/mallat/papiers/MallatFalzon.ps.gz
Refering-URL: http://www.cs.nyu.edu/cs/faculty/mallat/biblio.html
Root-URL: http://www.cs.nyu.edu
Title: Analysis of Low Bit Rate Image Transform Coding  
Author: Stephane Mallat and Frederic Falzon 
Date: April 1998  
Note: To appear in IEEE Transactions on Signal Processing  
Abstract: Calculations based on high resolution quantizations prove that the distortion rate D( R) of an image transform coding is proportional to 2 2 R when R is large enough. In wavelet and block cosine bases, we show that if R &lt; 1 bit/pixel then D( R) varies like R 12fl , where fl remains of the order of 1 for most natural images. The improved performance of embedded codings in wavelet bases is analyzed. At low bit rates, we show that the compression performance of an orthonormal basis depends mostly on its ability to approximate images with a few non-zero vectors. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> A. Cohen, I. Daubechies, O. Guleryuz, and M. Orchard. </author> <title> On the importance of combining wavelet-based non-linear approximation with coding strategies, 1997. </title> <type> Preprint. </type>
Reference-contexts: This also defines a function x (z) for any z 2 <ref> [0; 1] </ref>, which interpolates the values x ( k N ). To estimate the decay of D 0 (z) when z increases, a standard approximation theory approach computes the rational decay of the sorted coefficients, and hence compares x (z) with z fl for some fl &gt; 0. <p> In wavelet bases, this is in accordance with asymptotic image models based on Besov spaces introduced for compression by DeVore, Jawerth and Lucier [3], and further studied in <ref> [1] </ref>. Let f 2 L 2 [0; N ] 2 . <p> For finite images k N , which is why we renormalize z = k N and compare the decay of x (z) with z fl when z increases in <ref> [0; 1] </ref>. Theorem 2 does not require that fl is a constant but (19) assumes that it varies slowly as a function of log 2 z. <p> For the three other images, the variations of fl M can not be neglected over the whole compression range R 2 <ref> [2 6 ; 1] </ref> and Figure 8 shows that P SNR (D) has a slope which varies slowly with log 2 R. Theorem 3 gives an analytical expression which computes = T that minimizes the distortion D.
Reference: [2] <author> G. M. Davis. </author> <title> A wavelet-based analysis of fractal image compression. </title> <journal> IEEE Trans. Image Proc., </journal> <year> 1997. </year>
Reference-contexts: This is the case for the histograms of wavelet coefficients shown in Figure 3. If is large then p (x) has important variations in the zero bin <ref> [ 2 ; 2 ] </ref> where coefficients are quantized to zero. Hence the high resolution quantization hypothesis does not apply in this zero bin. This explains why log 2 D ( R) shown in Figure 2 decays like 2 R only for R 1. <p> These zero-trees take advantage of a partial self-similarity of the image <ref> [2] </ref>. Shapiro [13] used this zero-tree structure to encode the embedded significance maps of wavelet coefficients. Numerical experiments were performed with Said and Pearlman's software [12], which improves Shapiro's zero-tree coder with a set partitioning technique. A cubic spline orthogonal wavelet basis was used.
Reference: [3] <author> R. A. DeVore, B. Jawerth, and B. J. Lucier. </author> <title> Image compression through wavelet transform coding. </title> <journal> IEEE Trans. Info. Theory, </journal> <volume> 38(2) </volume> <pages> 719-746, </pages> <month> March </month> <year> 1992. </year>
Reference-contexts: Clearly D 0 decays when M increases, but how fast? This issue is a central question that is studied in approximation theory in relation to particular functional spaces <ref> [3, 11] </ref>. Let us sort the inner products a [m] by their amplitude. <p> For functions f 2 [0; N ] 2 decomposed in a wavelet orthonormal basis, the exponent fl characterizes particular functional spaces called Besov spaces <ref> [3] </ref>. To suppose that x (z) = C z fl would clearly be too restrictive to model interesting classes of signals. We shall rather suppose that this exponent is slowly varying and define fl (z) = d log 2 z coefficients of the test images. <p> In some cases, we know how to find bases that minimize the maximum error D 0 ( M N ) over a whole signal class. For example, wavelet bases are optimal in this min-max sense for piece-wise regular signals that belong to Besov spaces <ref> [3] </ref>. To optimize the quantization, the size of the zero bin [T; T ] must be adjusted with respect to the other quantization bins of size . <p> The central assumption of Theorem 2 is that the sorted decomposition coefficients x (z) of f in the basis B have a rational decay. In wavelet bases, this is in accordance with asymptotic image models based on Besov spaces introduced for compression by DeVore, Jawerth and Lucier <ref> [3] </ref>, and further studied in [1]. Let f 2 L 2 [0; N ] 2 .
Reference: [4] <author> N. Farvardin and J. Modestino. </author> <title> Optimum quantizer performances for a class of non-gaussian memoryless sources. </title> <journal> IEEE Trans. Info. Theory, </journal> <volume> 30(3) </volume> <pages> 485-497, </pages> <month> May </month> <year> 1984. </year>
Reference-contexts: the minimum average bit rate R X = H ( ^ X) is therefore achieved by a uniform quantizer and R X = H d (X) log 2 : (2) The distortion rate is obtained by taking the inverse of (1): D (R X ) = 12 Farvardin and Modestino <ref> [4] </ref> proved that even though the high resolution quantization hypothesis may not hold, for a large class of probability distribution including generalized Gaussians, the uniform quantizer yields a distortion rate that is close to the optimal quantizer if the number of quantization bins K is large enough. 2.2 Distortion Rate Let
Reference: [5] <author> A. Gersho and R. M. Gray. </author> <title> Vector Quantization and Signal Compression. </title> <publisher> Kluwer Academic Publishers, </publisher> <address> Boston, </address> <year> 1992. </year> <note> Chapter 2. 32 </note>
Reference-contexts: If x 2 (y k1 ; y k ] then Q (x) = x k . We denote p k = PrfX 2 (y k1 ; y k ]g = Prf ^ X = x k g: The Shannon theorem <ref> [5] </ref> proves that the entropy H ( ^ X) = k=1 is a lower bound of the average number of bits per symbol used to encode the values of ^ X. <p> This is the case if the sizes k are sufficiently small relative to the rate of variation of p (x). The following theorem <ref> [5] </ref> proves that uniform quantizers are optimal among high resolution quantizers. It is equivalent to the result of Girsh and Pierce [6], which proves the asymptotic optimality of uniform quantizers when the sizes of the quantization bins tend to zero. <p> d A [m] = log 2 m + log 2 2e: Inserting this expression in (4) yields D ( R) = N 6 m=0 m 2 2 R : (5) One can prove that Q N1 m is minimum if and only if B is a Karhunen-Loeve basis of Y <ref> [5] </ref>, which means that B diagonalizes the covariance matrix of Y . The transform coding of a Gaussian process is thus optimized in a Karhunen-Loeve basis. When Y is not Gaussian, the Karhunen-Loeve 4 basis is a priori not optimal anymore. <p> This problem is difficult because the M basis vectors are selected depending upon each realization f of Y . They are the ones which have the largest inner products with f . The energy compaction theorem <ref> [5] </ref> proves that the Karhunen-Loeve basis is optimal for approximating Y from M vectors chosen once and for all, but it has no optimality property in this non-linear setting where the vectors depend upon each realization.
Reference: [6] <author> H. Gish and J. N. Pierce. </author> <title> Asymptotically efficient quantizing. </title> <journal> IEEE Trans. Info. Theory, </journal> <volume> 14 </volume> <pages> 676-683, </pages> <month> September </month> <year> 1968. </year>
Reference-contexts: This is the case if the sizes k are sufficiently small relative to the rate of variation of p (x). The following theorem [5] proves that uniform quantizers are optimal among high resolution quantizers. It is equivalent to the result of Girsh and Pierce <ref> [6] </ref>, which proves the asymptotic optimality of uniform quantizers when the sizes of the quantization bins tend to zero.
Reference: [7] <author> N. J. Jayant and P. Noll. </author> <title> Digital Coding of Waveforms. </title> <publisher> Prentice-Hall, </publisher> <address> Englewood-Cliffs, NJ, </address> <year> 1984. </year>
Reference-contexts: Let R = R N be the average number of bit per sample. With Lagrange multipliers we verify that R is minimum if all D m are equal <ref> [7] </ref>, in which case D ( R) = 12 where H d is the averaged differential entropy H d = N m=0 A mean-square error D is not always a good measurement of visual degradations in images.
Reference: [8] <editor> E. LePennec. Modelisation d'images par ondelettes, </editor> <month> December </month> <year> 1997. </year> <institution> Memoire de DEA, CMAP, Ecole Polytechnique, Paris, France. </institution>
Reference-contexts: Such histograms are well modeled by generalized Gaussian distributions [10], which have an exponential decay and a variance which increases with the scale 2 j . It is the aggregation of these histograms that yield a global histogram p (x) which has a rational decay for x sufficiently large <ref> [8] </ref>. However, the finite image resolution implies that wavelet coefficients are zero for j &lt; 0. One can verify that the "border effect" created by the absence of finer scale wavelet coefficients implies that p (x) p 1 (x) for x small.
Reference: [9] <author> A. S. Lewis and G. Knowles. </author> <title> Image compression using the 2-D wavelet transform. </title> <journal> IEEE Trans. Image Proc., </journal> <volume> 1(2) </volume> <pages> 244-250, </pages> <month> April </month> <year> 1992. </year>
Reference-contexts: More efficient zero-tree encoding techniques may also be used for wavelet significance maps <ref> [9] </ref>. Let R 0 be the total number of bits required to encode the significance map. Let M be the number of significant coefficients. There is a proportion p = M N of indices m such that b [m] = 1. <p> Such oscillatory patterns are not often encountered in images although they do appear as thin lines in the Barbara image. 23 Wavelet zero-trees, introduced by Lewis and Knowles <ref> [9] </ref>, take advantage of the decay of wavelet coefficients by relating these coefficients across scales with quad-trees. These zero-trees take advantage of a partial self-similarity of the image [2]. Shapiro [13] used this zero-tree structure to encode the embedded significance maps of wavelet coefficients.
Reference: [10] <author> S. Mallat. </author> <title> A theory for multiresolution signal decomposition: the wavelet representation. </title> <journal> IEEE Trans. Patt. Recog. and Mach. Intell., </journal> <volume> 11(7) </volume> <pages> 674-693, </pages> <month> July </month> <year> 1989. </year>
Reference-contexts: This is the case for images which cannot be considered as realizations of a Gaussian process. Let us describe a simple wavelet transform coder for images. Separable wavelet bases of images include three wavelets with horizontal, vertical or diagonal orientations <ref> [10] </ref>, indexed by 1 k 3. At an orientation k and scale 2 j , the wavelet vector g m = k j;p;q is approximately centered at (2 j p; 2 j q), with a square support whose size is proportional to 2 j . <p> In the same scanning order, the amplitude of the non-zero quantized coefficients are also entropy encoded with a Huffman or an Arithmetic coding. Lena Barbara Mandrill Aerial 5 shown in Figure 1. These numerical experiments are performed with an orthogonal cubic spline Battle-Lemarie wavelet <ref> [10] </ref>. The distortion rate formula (4) predicts that log 2 D ( R) = 2H d + log 2 ( 12 where H d is the average differential entropy of the wavelet coefficients at all scales and positions. <p> However, looking at the normalized histograms p j (x) of the wavelet coefficients hf; k j;p;q i at a fixed scale 2 j , for all positions 0 p; q 2 j N and orientations 1 k 3. Such histograms are well modeled by generalized Gaussian distributions <ref> [10] </ref>, which have an exponential decay and a variance which increases with the scale 2 j . It is the aggregation of these histograms that yield a global histogram p (x) which has a rational decay for x sufficiently large [8].
Reference: [11] <author> S. Mallat. </author> <title> A Wavelet Tour of Signal Processing. </title> <publisher> Academic Press, </publisher> <address> New York, </address> <year> 1998. </year>
Reference-contexts: Clearly D 0 decays when M increases, but how fast? This issue is a central question that is studied in approximation theory in relation to particular functional spaces <ref> [3, 11] </ref>. Let us sort the inner products a [m] by their amplitude. <p> If M * then the optimal zero bin ratio is = r 1 + r 0 12 1 + O (*) : (30) 3.2 Wavelet Transform Coding Wavelet bases are known to efficiently approximate piece-wise regular functions with a small number of non-zero wavelet coefficients <ref> [11] </ref>. Since images often include piecewise regular structures, wavelet bases are good candidates for building efficient image transform coders. The central assumption of Theorem 2 is that the sorted decomposition coefficients x (z) of f in the basis B have a rational decay. <p> This image has discontinuities along the borders 13 of the i , which have a finite length. One can then prove <ref> [11] </ref> that the sorted wavelet coefficients decay like C k fl , with fl = 1. The discontinuities create large amplitude wavelet coefficient which are responsible for this decay exponent. <p> This essentially depends on the support size and the number of vanishing moments of the wavelets <ref> [11] </ref>. The optimization of the wavelet basis may depend upon the particular class of images to be encoded. 16 Lena Barbara Mandrill Aerial 1 R 17 3.3 JPEG Image Coding The JPEG image standard decomposes an image in a block cosine basis B. <p> A wavelet coefficient hf; k j;p;q i has a large amplitude where the signal has sharp transitions. If an image f is Lipschitz ff in the neighborhood of (x 0 ; y 0 ), then for wavelets k j;p;q located in this neighborhood one can prove <ref> [11] </ref> that there exists A 0 such that jhf; k The worst singularities are often discontinuities which means that ff 0. In the neighborhood of singularities without oscillations, the amplitudes of wavelet coefficients thus decrease when the scale 2 j decreases. This property is not valid for oscillatory patterns.
Reference: [12] <author> A. Said and W. A. Pearlman. </author> <title> A new, fast, and efficient image codec based on set partitioning in hierarchical trees. </title> <journal> IEEE Trans. Circ. and Syst. for Video Tech., </journal> <volume> 6(3) </volume> <pages> 243-250, </pages> <month> June </month> <year> 1996. </year>
Reference-contexts: Afterwards, the code stores the bit n of all amplitudes jQ (a [m])j for m 2 S k with k &gt; n. If necessary, the coding precision is improved by decreasing n and continuing the encoding. The different steps of the algorithm can be summarized as follows <ref> [12] </ref>: 1. Store the index n of the first non-empty set S n , where n = j k 2. Store the significance map b n [m] and the sign of a [m] for m 2 S n . 3. <p> In the following, we omit the corrective terms to simplify the notation. This theorem proves that R e M is well approximated by r e 1 1 : (38) R e M 1 calculated numerically with the embedded wavelet coding software of Said and Pearlman <ref> [12] </ref> is close to the estimate r e 1 1 calculated by computing fl M from amplitudes of the significant coefficients but store their values in the significance maps. <p> These zero-trees take advantage of a partial self-similarity of the image [2]. Shapiro [13] used this zero-tree structure to encode the embedded significance maps of wavelet coefficients. Numerical experiments were performed with Said and Pearlman's software <ref> [12] </ref>, which improves Shapiro's zero-tree coder with a set partitioning technique. A cubic spline orthogonal wavelet basis was used. Figure 13 displays the value of R M = r e 1 as a function of log 2 M N for the four test images.
Reference: [13] <author> J. M. Shapiro. </author> <title> Embedded image coding using zerotrees of wavelet coefficients. </title> <journal> IEEE Trans. Signal Proc., </journal> <volume> 41(12) </volume> <pages> 3445-3462, </pages> <month> December </month> <year> 1993. </year>
Reference-contexts: Stephane Mallat is with Ecole Polytechnique, 91128 Palaiseau, France and with the Courant Institute, New York University, NY 10012. Frederic Falzon was at the INRIA, Sophia Antipolis, France, and is now at Alcatel Alsthom Recherche, 91460 Marcoussis, France. 1 <ref> [13] </ref>. Embedded coders outperform classical transform coders when there is some prior information on which basis vectors produce large, average or small decomposition coefficients for typical signals. This article begins with a brief review of entropy constrained scalar quantizers and high bit rate transform coding. <p> Such prior 19 Lena Barbara Mandrill Aerial 2 ) D 0 ( 5:5 ). information is available for natural images decomposed in wavelet bases. As a result, an imple-mentation with zero-trees designed by Shapiro <ref> [13] </ref> yields better compression rates than classical wavelet transform coders. <p> The inequality (39) is satisfied for embedded transform codings implemented in wavelet bases <ref> [13] </ref> and in a block cosine basis [17], by taking advantage of prior knowledge of the location of large versus small coefficients using zero-trees. R e M 1 with the theoretical estimate r e 1 1 = 1 1 fl M 1 for the embedded coding of Lena. <p> These zero-trees take advantage of a partial self-similarity of the image [2]. Shapiro <ref> [13] </ref> used this zero-tree structure to encode the embedded significance maps of wavelet coefficients. Numerical experiments were performed with Said and Pearlman's software [12], which improves Shapiro's zero-tree coder with a set partitioning technique. A cubic spline orthogonal wavelet basis was used.
Reference: [14] <author> G. Sullivan. </author> <title> Efficient scalar quantization of exponential and laplacian random variables. </title> <journal> IEEE Trans. Info. Theory, </journal> <volume> 42(5) </volume> <pages> 1365-1374, </pages> <month> September </month> <year> 1996. </year>
Reference-contexts: Hence the high resolution quantization hypothesis does not apply in this zero bin. This explains why log 2 D ( R) shown in Figure 2 decays like 2 R only for R 1. If p (x) is a laplacian distribution p (x) = 1 2 e then Sullivan <ref> [14] </ref> proved that the optimal entropy constrained scalar quantizer in a nearly uniform quantizer. All the non-zero quantization bins have the same size but the zero bin [T; T ] is larger, with a ratio = T that can be calculated.
Reference: [15] <author> G. K. Wallace. </author> <title> The JPEG still picture compression standard. </title> <journal> Communications of the ACM, </journal> <volume> 34(4) </volume> <pages> 30-44, </pages> <month> April </month> <year> 1991. </year>
Reference-contexts: D 0 with the theoretical estimate K = 2 fl M 1 12 2 , for the JPEG coding of Lena. JPEG uses a mixed format that encodes the run-length coding for significant coefficients and 18 the amplitude of these significant coefficients together <ref> [15] </ref>. It is therefore not possible to compute R 0 and R 1 separately. Figure 10 displays R M = r 0 + r 1 as a function of log 2 M N for the four test images.
Reference: [16] <author> I. Witten, R. Neal, and J. Cleary. </author> <title> Arithmetic coding for data compression. </title> <journal> Comm. of the ACM, </journal> <volume> 30(6) </volume> <pages> 519-540, </pages> <year> 1987. </year>
Reference-contexts: Arithmetic entropy coding <ref> [16] </ref> achieve an average bit rate that can be arbitrarily close to the entropy 2 lower bound, so we shall consider that this lower bound is reached.
Reference: [17] <author> Z. X. Xiong, O. Guleryuz, and M. T. Orchard. </author> <title> Embedded image coding based on DCT. </title> <booktitle> In VCIP in Europeen Image Proc. Conf., </booktitle> <year> 1997. </year> <month> 33 </month>
Reference-contexts: The inequality (39) is satisfied for embedded transform codings implemented in wavelet bases [13] and in a block cosine basis <ref> [17] </ref>, by taking advantage of prior knowledge of the location of large versus small coefficients using zero-trees. R e M 1 with the theoretical estimate r e 1 1 = 1 1 fl M 1 for the embedded coding of Lena.
References-found: 17

