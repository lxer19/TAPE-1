URL: http://www.cs.indiana.edu/pub/max/max.ps
Refering-URL: http://www.cs.indiana.edu/pub/max/
Root-URL: http://www.cs.indiana.edu
Title: Efficient Light Propagation for Multiple Anisotropic Volume Scattering  
Author: Nelson Max 
Affiliation: University of California, Davis, and Lawrence Livermore National Laboratory  
Abstract: Realistic rendering of participating media like clouds requires multiple anisotropic light scattering. This paper presents a propagation approximation for light scattered into M direction bins, which reduces the "ray effect" problem in the traditional "discrete ordinates" method. For a regular grid volume of n 3 elements, it takes O(M n 3 log n + M 2 n 3 ) time and O(M n 3 + M 2 ) space. 
Abstract-found: 1
Intro-found: 1
Reference: [Bhat92] <author> N. Bhate and A. Tokuta, </author> <title> "Photorealistic Volume Rendering of Media with Directional Scattering", </title> <booktitle> Third Eurographics Conference on Rendering (May 1992) Consolidation Express, Bristol England, </booktitle> <pages> pp. 227-245 16 Nelson Max </pages>
Reference-contexts: He points out that this requires integrals over only one 3-D position, reducing the number of integration variables by 3. This simplification has been misinterpreted by Siegel and Howell [Sie92], who incorrectly claimed that the method is O (N ). Bhata <ref> [Bhat92] </ref> has applied this method to computer rendering, but could deal with only a small number of voxels, due to the O (n 7 + M 2 n 6 ) cost.
Reference: [Bhat93] <author> Neeta Bhate, </author> <title> "Application of Rapid Hierarchical Radiosity to Participation Media," in "ATARV-93: Advanced Techniques in Animation, Rendering, </title> <editor> and Visualization" (B. Ozgu~c and V. </editor> <title> Akman, eds.), </title> <note> Bilkent University (July 1993) pp. 43 - 53 </note>
Reference-contexts: This cost can be reduced somewhat by grouping adjacent elements into larger interaction pairs, in the style of Hanrahan, Salzman, and Aupperle [Hanr91], as was done by Bhata <ref> [Bhat93] </ref>. Rushmeier [Rush88] also considers anisotropic scattering, but only in the single scattering case. Zhiquiang Tan [Tan89] applied the ideas of finite element analysis to the solution for the spherical harmonic coefficients in the case of multiple anisotropic scattering. <p> The number of layers remaining after this consolidation is O (log n). It is actually possible to reduce the O (log n) factor to O (1) by consolidating the voxels within a layer, as well as between adjacent layers, in the manner of [Hanr91] and <ref> [Bhat93] </ref>. The additional errors would not be large, because the occlusion effects at large 12 Nelson Max distances become fuzzy, as shown in figure 5. <p> S. Department of Energy by Lawrence Livermore National Laboratory under contract W-7405-ENG-48. I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of [Patm93], [Lang93] and <ref> [Bhat93] </ref>, respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references [Blas93], [Sak93], and [Kan90], and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [Blas93] <author> P. Blasi et al. </author> <title> "A Rendering Algorithm for Discrete Volume Density Objects," </title> <journal> Euro-graphics '93, Computer Graphics Forum Vol. </journal> <volume> 12 No. </volume> <pages> 3 (1993) pp. </pages> <address> C-202 - 210 </address>
Reference-contexts: This method can accurately model all the physics of scattering, but may take an impractical number of random trials to converge to a useful solution. Blasi et al. <ref> [Blas93] </ref> have used the Monte Carlo method to render volume densities of anisotropically scattering material. The other was the zonal method for isotropic scattering only, which divides the volume into a number of finite elements which are assumed to have constant radiosity. <p> I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of [Patm93], [Lang93] and [Bhat93], respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references <ref> [Blas93] </ref>, [Sak93], and [Kan90], and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [CIE73] <author> CIE Technical Committee 4.2: </author> <title> Standardization of Luminance Distribution on Clear Skies, </title> <note> CIE Publication 22, Commission International de l'Eclairage, Paris (1973) p. 7 </note>
Reference-contexts: This image took twice as long for the two passes. For the sky illumination, I used the CIE standard clear sky directional luminance function <ref> [CIE73] </ref> to initialize the unshot array on an extra shell of cells on the top and sides of the volume. sun, and a blue point source for the sky. 10 Future Work This method should be applicable to thermal engineering computations if black body emission is included in the flux propagation,
Reference: [Chan50] <author> Subrahmanyan Chandrasekhar, </author> <title> "Radiative Transfer," </title> <publisher> The Clarendon Press, Oxford, (1950) (or Dover Press, </publisher> <address> New York, </address> <year> 1960) </year>
Reference-contexts: Kajiya's second method was an application of the multiple scattering ideas of Chan-drasekhar <ref> [Chan50] </ref>, which use spherical harmonics to expand, at each point, the light intensity as a function of direction. The scattering phase function is also expanded in Legendre polynomials, resulting in a set of coupled partial differential equations for the spherical harmonic coefficients of intensity as functions of the spatial coordinates. <p> Sparse matrix solution methods are then available, as in Immel et al.[Imm86]. In the discrete ordinates method in radiation transfer, <ref> [Sie92, Chan50] </ref>, the M direction bins are represented by M discrete directions, chosen to give optimal Gaussian quadrature in the integrals over a solid angle.
Reference: [Coh88] <author> Michael Cohen, Shenchang Eric Chen, John Wallace, and Donald Greenberg, </author> <title> "A Progressive Refinement Approach to Fast Radiosity Image Generation," </title> <journal> Computer Graphics Vol. </journal> <note> 22 No. 4 (August 1988) pp. 75 - 84 </note>
Reference-contexts: The current paper presents an approximation to the discrete ordinates method, which reduces the ray effect by shooting radiosity into the whole solid angle bin, instead of in a discrete representative direction. As a shooting method, it is similar to the progressive ra-diosity method of Cohen et al. <ref> [Coh88] </ref>, and can be shown to converge for albedo less than one. (See [Gort93] and section 6 below.) Patmore [Patm93] has used a discrete ordinates shooting algorithm (subject to ray effects) for a multiple-scattering rendering of clouds, and his paper inspired the current one. <p> Using these form factors, one can write the usual system of linear equations for the unknown fluxes through [k][l]. I have developed an approximate solution method which accumulates opacity on the fly, as the flux is propagated in a shooting procedure. As in progressive radiosity for surface illumination <ref> [Coh88] </ref>, I use an auxiliary array unshot [k][l] of size M N = M n 3 , to store the flux waiting to be propagated, and need not store the M 2 N 2 = M 2 n 6 form factors.
Reference: [Fell68] <author> William Feller, </author> <title> "An Introduction to Probability Theory and its Applications, Volume I, Third Edition," </title> <publisher> John Wiley & Sons, Inc., </publisher> <address> New York (1968) </address>
Reference-contexts: To do so, I assume exactly forward scattering, a fairly good approximation for water droplets, in order to calculate the probability of higher order scattering. The multiple scattering events are then governed by a Poisson distribution <ref> [Fell68] </ref>. Let l be the average length of the intersection of a ray in the incoming direction bin with a volume element cube of extinction coefficient k t , and let = k t l.
Reference: [Gard84] <author> Geoffrey Gardner, </author> <title> "Simulation of Natural Scenes using Textured Quadric Surfaces," </title> <journal> Computer Graphics Vol. </journal> <note> 18 No. 3 (July 1984) pp. 11 - 20 </note>
Reference-contexts: Kajiya and Von Herzen [Kaj84] computed this density with a meteorological simulation. Instead, for the purposes of test rendering, I used a variant of the visual cloud model of Gardner <ref> [Gard84] </ref>. Gardner rendered the surfaces of ellipsoids with a 3-D transparency texture based on a pseudo-fractal trigonometric series. I wanted an analogous 3-D density function.
Reference: [Gort93] <author> Steven Gortler, Michael Cohen, and Philipp Slusallek, </author> <title> "Radiosity and Relaxation Methods: Progressive Radiosity is Southwell Relaxation," </title> <type> Technical Report, </type> <institution> Computer Science Dept., </institution> <note> Princeton University (shortened version to appear in IEEE CG&A, </note> <year> 1994) </year>
Reference-contexts: As a shooting method, it is similar to the progressive ra-diosity method of Cohen et al. [Coh88], and can be shown to converge for albedo less than one. (See <ref> [Gort93] </ref> and section 6 below.) Patmore [Patm93] has used a discrete ordinates shooting algorithm (subject to ray effects) for a multiple-scattering rendering of clouds, and his paper inspired the current one.
Reference: [Hanr91] <author> Pat Hanrahan, David Salzman, and Larry Aupperle, </author> <title> "A Rapid Hierarchical Radiosity Algorithm," </title> <journal> Computer Graphics Vol. </journal> <note> 25 No. 4 (July 1991) pp. 197 - 206 </note>
Reference-contexts: Using an iterative method for solving the resulting matrix equation which converges in O (1) iterations, the total computational cost is O (n 7 ). This cost can be reduced somewhat by grouping adjacent elements into larger interaction pairs, in the style of Hanrahan, Salzman, and Aupperle <ref> [Hanr91] </ref>, as was done by Bhata [Bhat93]. Rushmeier [Rush88] also considers anisotropic scattering, but only in the single scattering case. Zhiquiang Tan [Tan89] applied the ideas of finite element analysis to the solution for the spherical harmonic coefficients in the case of multiple anisotropic scattering. <p> The number of layers remaining after this consolidation is O (log n). It is actually possible to reduce the O (log n) factor to O (1) by consolidating the voxels within a layer, as well as between adjacent layers, in the manner of <ref> [Hanr91] </ref> and [Bhat93]. The additional errors would not be large, because the occlusion effects at large 12 Nelson Max distances become fuzzy, as shown in figure 5.
Reference: [Hanr93] <author> Pat Hanrahan and Wolfgang Krueger, </author> <title> "Reflection from Layered Surfaces due to Subsurface Scattering," </title> <booktitle> Computer Graphics Proceedings, Annual Conference Series (1993) pp. </booktitle> <volume> 165 - 174 </volume>
Reference-contexts: For the images in the results section, I used B = 12 terms. This approximation was checked by comparison with the Monte Carlo simulation described by Hanrahan and Krueger <ref> [Hanr93] </ref>, and agreed well even when the scattering was not forward. (The box on page 170 of [Hanr93] giving the Monte Carlo simulation has three errors, confirmed by the authors. <p> For the images in the results section, I used B = 12 terms. This approximation was checked by comparison with the Monte Carlo simulation described by Hanrahan and Krueger <ref> [Hanr93] </ref>, and agreed well even when the scattering was not forward. (The box on page 170 of [Hanr93] giving the Monte Carlo simulation has three errors, confirmed by the authors.
Reference: [Heny40] <author> G. L. Henyey and J. L. Greenstein, </author> <note> "Diffuse Radiation in the Galaxy," Astrophysical Journal Vol. 88 (1940) pp. 70 - 73 </note>
Reference-contexts: Fig. 1. Paths connecting two pixels. 6 Nelson Max For my test images, I used the Henyey-Greenstein phase function <ref> [Heny40] </ref> f (! 0 ; !) = f (!; ! 0 ) = 4 (1 + g 2 2gx) 3=2 where x is the dot product of the two unit direction vectors ! and ! 0 , and g is an adjustable parameter between -1 and 1, which is positive for
Reference: [Imm86] <author> David Immel, Michael Cohen, and Donald Greenberg, </author> <title> "A Radiosity Method for Non-Diffuse Environments"' Computer Graphics Vol. </title> <note> 20 No. 4 (1986) pp. 133 - 142 </note>
Reference: [Inak89] <author> M. Inakage, </author> <title> "An Illumination Model for Atmospheric Environments" in "New Advances in Computer Graphics: </title> <booktitle> Proceedings of C. G. International '89," </booktitle> <editor> (R. A. Earn-shsaw and B. Wyvill, eds.) </editor> <publisher> Springer Verlag, </publisher> <address> Tokyo (1989) pp. 533 - 548 </address>
Reference-contexts: Voss [Voss83] used a similar method to produce fractal clouds in terrain scenes. Nishita, Miyakawa, and Nakamae [Nish87] have considered anisotropic single scattering in fog, and Inakage <ref> [Inak89] </ref> has included cases where the density and phase function of the scattering material varies from point to point.
Reference: [Kaj84] <author> James Kajiya and Brian Von Herzen, </author> <title> "Ray Tracing Volume Densities", </title> <journal> Computer Graphics Vol. </journal> <note> 18 No. 3 (July 1984) pp. 165 - 174 </note>
Reference-contexts: In addition, to produce the bright edges surrounding a cloud when the sun is behind it, one must account for the anisotropic, mainly forward, scattering of light from the water droplets. In 1984, Jim Kajiya and Brian Von Herzen <ref> [Kaj84] </ref> proposed two methods for rendering clouds. The first was the two-pass "slab" method, which accounted only for single scattering. The first pass deposited flux from the light source into the cloud voxels one horizontal layer at a time, taking into account the attenuation by the opacity in each layer. <p> Kajiya 2 Nelson Max attempted to solve these equations for the case of isotropic scattering, but it is unclear whether he succeeded, since all the pictures in <ref> [Kaj84] </ref> were produced by the simpler "slab" method. The transport equations Kajiya used, described in the next section, have a long history in radiation heat transfer in mechanical engineering, and in particle transport in nuclear engineering. Siegel and Howell [Sie92] give a good summary of solution techniques. <p> For this single scattering contribution, the phase function is evaluated using the exact directions of both the viewing and the direct illumination rays. 8 Cloud Model The geometry of the cloud is determined by the density array kt. Kajiya and Von Herzen <ref> [Kaj84] </ref> computed this density with a meteorological simulation. Instead, for the purposes of test rendering, I used a variant of the visual cloud model of Gardner [Gard84]. Gardner rendered the surfaces of ellipsoids with a 3-D transparency texture based on a pseudo-fractal trigonometric series. <p> Rushmeier [Rush88] and Kajiya <ref> [Kaj84] </ref> have pointed out that after a number of scattering events, even a narrow forward phase function becomes more isotropic. This means that the later scattering passes through the volume could use a smaller number of direction bins, for greater speed, and still maintain accuracy.
Reference: [Kan90] <author> Kazufumi Kaneda, Takashi Okamoto, Eihachiro Nakamae and Tomoyuki Nishita, </author> <title> "Highly Realistic Visual Simulation of Outdoor Scenes under Various Atmospheric Conditions," CG International '90, </title> <editor> (T. S. Chua and T. L. Kunii, eds.) </editor> <publisher> Springer-Verlag, </publisher> <address> Tokyo (1990) pp. 117 - 131 </address>
Reference-contexts: Voss [Voss83] used a similar method to produce fractal clouds in terrain scenes. Nishita, Miyakawa, and Nakamae [Nish87] have considered anisotropic single scattering in fog, and Inakage [Inak89] has included cases where the density and phase function of the scattering material varies from point to point. Kaneda et al. <ref> [Kan90] </ref> also simulate anisotropic scattering in clouds and fog, including one case of double scattering: first Raleigh and Mie scattering to determine a fixed sky illumination, and then one more scattering of this illumination within a fog. <p> I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of [Patm93], [Lang93] and [Bhat93], respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references [Blas93], [Sak93], and <ref> [Kan90] </ref>, and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [Kauf87] <author> Arie Kaufman, </author> <title> "Efficient Algorithms for 3D Scan-Conversion of Parametric Curves, Surfaces, and Volumes," </title> <journal> Computer Graphics Vol. </journal> <note> 21 No. 4 (July 1987) pp. 171 - 179 </note>
Reference: [Lang93] <author> Michael Langer, Pierre Breton, and Steven Zucker, </author> <title> "Parallel Radiosity without Form Factors," </title> <type> report TR-CIM-93-22, </type> <institution> McGill Research Center for Intelligent Machines, McGill University, </institution> <address> Montreal, Quebec, Canada (December 1993) </address>
Reference-contexts: Langer et al. <ref> [Lang93] </ref> have implemented the discrete ordinates method on a massively parallel SIMD machine, and included surface reflections. (See section 10 below.) My chief enhancement is to spread the shot radiosity throughout the direction bin in an efficient way which handles a whole plane of source elements simultaneously, while reducing the ray <p> In this straightforward case, a directional pass through the volume begins with the unshot flux leaving a shooting surface, as described above for the sky illumination, and the flux exiting the sides or left over at the end is deposited on the appropriate receiving surface. Langer et al. <ref> [Lang93] </ref> have applied the discrete ordinates method to general surface geometries, using "surface nodes" with a bidirectional reflection distribution function at voxels containing surfaces. Langunou et al. [Lang94] combine discrete ordinate methods on volumes with traditional radiosity on surfaces external to the participating medium, as in the previous paragraph. <p> S. Department of Energy by Lawrence Livermore National Laboratory under contract W-7405-ENG-48. I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of [Patm93], <ref> [Lang93] </ref> and [Bhat93], respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references [Blas93], [Sak93], and [Kan90], and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [Lang94] <author> Eric Langunou, Kadi Bauatouch, and Michel Chelle, </author> <title> "Global Illumination in Presence of Participating Media with General Properties," </title> <booktitle> in this volume. </booktitle>
Reference-contexts: Langer et al. [Lang93] have applied the discrete ordinates method to general surface geometries, using "surface nodes" with a bidirectional reflection distribution function at voxels containing surfaces. Langunou et al. <ref> [Lang94] </ref> combine discrete ordinate methods on volumes with traditional radiosity on surfaces external to the participating medium, as in the previous paragraph. These two groups can thus include anisotropic surface reflections, as well as isotropic volume scattering and absorption.
Reference: [Lath68] <author> K. D. Lathrop, </author> <title> "Ray Effects in Discrete Ordinates Equations," </title> <journal> Nuclear Science and Engineering Vol. </journal> <note> 32 (1968) pp. 357 - 368 </note>
Reference-contexts: Sparse matrix solution methods are then available, as in Immel et al.[Imm86]. In the discrete ordinates method in radiation transfer, [Sie92, Chan50], the M direction bins are represented by M discrete directions, chosen to give optimal Gaussian quadrature in the integrals over a solid angle. Lathrop <ref> [Lath68] </ref> points out that this process produces ray effects, because it is equivalent to shooting the energy from an element Efficient Light Propagation for Multiple Anisotropic Volume Scattering 3 in narrow beams along the discrete directions, missing the regions between them.
Reference: [Mie09] <author> Gustav Mie, </author> <title> "Optics of Turbid Media," </title> <journal> Ann. </journal> <volume> Physik Vol. 25 No. </volume> <month> 3 </month> <year> (1908) </year> <month> pp. </month> <title> 377 - 445 Efficient Light Propagation for Multiple Anisotropic Volume Scattering 17 </title>
Reference-contexts: For an appropriate choice of g, this is a good approximation to the exact Mie scattering <ref> [Mie09] </ref> from spherical water droplets. Except for the first bounce from the light source, and the last bounce to the viewpoint, which use one exact direction each, all intermediate bounces are via the array bintobin, so any phase function can be used efficiently. Fig. 2.
Reference: [Nish87] <author> Tomoyuki Nishita, Yasuhiro Miyakawa, and Eihachiro Nakamae, </author> <title> "A Shading Model for Atmospheric Scattering Considering Luminous Intensity Distribution of Light Sources," </title> <journal> Computer Graphics Vol. </journal> <note> 21 No. 4 (July 1987) pp. 303 - 310 </note>
Reference-contexts: The second pass gathered the scattered flux along each viewing ray, taking into account the attenuation between the scattering event and the viewpoint. Voss [Voss83] used a similar method to produce fractal clouds in terrain scenes. Nishita, Miyakawa, and Nakamae <ref> [Nish87] </ref> have considered anisotropic single scattering in fog, and Inakage [Inak89] has included cases where the density and phase function of the scattering material varies from point to point.
Reference: [Patm93] <author> Chris Patmore, </author> <title> "Simulated Multiple Scattering for Cloud Rendering" in "Graphics, Design, and Visualization: </title> <booktitle> Proceedings of the International Conference on Computer Graphics -ICCG93" (S. </booktitle> <editor> P. Mudur and S. N. Pattaniak, eds.) </editor> <publisher> Elsevier Science Publishers (1993) pp. </publisher> <pages> 29-40 </pages>
Reference-contexts: As a shooting method, it is similar to the progressive ra-diosity method of Cohen et al. [Coh88], and can be shown to converge for albedo less than one. (See [Gort93] and section 6 below.) Patmore <ref> [Patm93] </ref> has used a discrete ordinates shooting algorithm (subject to ray effects) for a multiple-scattering rendering of clouds, and his paper inspired the current one. <p> S. Department of Energy by Lawrence Livermore National Laboratory under contract W-7405-ENG-48. I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of <ref> [Patm93] </ref>, [Lang93] and [Bhat93], respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references [Blas93], [Sak93], and [Kan90], and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [Perl85] <author> Ken Perlin, </author> <title> "An Image Synthesizer," </title> <journal> Computer Graphics Vol. </journal> <note> 19 No. 3 (July 1985) pp. 287 - 296 </note>
Reference-contexts: I took quadratic polynomials of the form d a 2 b 2 c 2 whose contours are ellipsoids, and used the maximum of several such ellipsoidal functions with different parameters to define the union of ellipsoidal clouds. I then added on a version of Ken Perlin's 1=f noise function <ref> [Perl85] </ref>, to roughen and randomize the edges. Like Gardner, when the volume function was negative, I let kt = 0, giving complete transparency. More sophisticated cloud turbulence models are given in [Sak93] and the references therein. 9 Results the sun behind it, rendered with multiple anisotropic scattering.
Reference: [Rush87] <author> Holly Rushmeier and Kenneth Torrance, </author> <title> "The Zonal Method for Calculating Light Intensities in the Presence of Participating Media," </title> <journal> Computer Graphics Vol. </journal> <note> 21 No. 4 (July 1987) pp. 293 - 302 </note>
Reference-contexts: The transport equations Kajiya used, described in the next section, have a long history in radiation heat transfer in mechanical engineering, and in particle transport in nuclear engineering. Siegel and Howell [Sie92] give a good summary of solution techniques. Holly Rushmeier <ref> [Rush87, Rush88] </ref> applied two of these solution techniques to computer rendering of participating (i.e. absorbing, emitting, and scattering) media. One was the Monte Carlo method, where a random collection of photons or flux packets are traced through the volume, undergoing random scattering and absorption. <p> This means that the later scattering passes through the volume could use a smaller number of direction bins, for greater speed, and still maintain accuracy. Rushmeier <ref> [Rush87, Rush88] </ref> handles surface and volume radiosity in a unified framework. I currently do not handle surface radiosity, but it should be possible to include surface elements in this method. In a common engineering application, the only surfaces are on the enclosure of the participating medium.
Reference: [Rush88] <author> Holly Rushmeier, </author> <title> "Realistic Image Synthesis for Scenes with Radiatively Participating Media," </title> <type> Ph.D. Thesis, </type> <institution> Cornell University (May 1988) </institution>
Reference-contexts: The transport equations Kajiya used, described in the next section, have a long history in radiation heat transfer in mechanical engineering, and in particle transport in nuclear engineering. Siegel and Howell [Sie92] give a good summary of solution techniques. Holly Rushmeier <ref> [Rush87, Rush88] </ref> applied two of these solution techniques to computer rendering of participating (i.e. absorbing, emitting, and scattering) media. One was the Monte Carlo method, where a random collection of photons or flux packets are traced through the volume, undergoing random scattering and absorption. <p> This cost can be reduced somewhat by grouping adjacent elements into larger interaction pairs, in the style of Hanrahan, Salzman, and Aupperle [Hanr91], as was done by Bhata [Bhat93]. Rushmeier <ref> [Rush88] </ref> also considers anisotropic scattering, but only in the single scattering case. Zhiquiang Tan [Tan89] applied the ideas of finite element analysis to the solution for the spherical harmonic coefficients in the case of multiple anisotropic scattering. <p> This effect is usually not important in rendering, and I will neglect it below for simplicity, and deal only with absorption and scattering. More complete discussions are available from [Sie92] and <ref> [Rush88] </ref>. Let I (x; !) be the intensity at position x flowing in direction !, and let k t (x) be the extinction coefficient of the participating medium. <p> 0 in the 4 unit sphere. (This is the source function [Sie92] in the absence of 4 Nelson Max volume emission.) The integro-differential equation for I (x; !) is thus dI (x; !) = k t (x)I (x; !) + ak t (x) 4 Using an integrating factor (see [Sie92], <ref> [Rush88] </ref>, or [Will92]), this can be integrated along a path x 0 (s) = x s!, from x = x 0 (0) to x 0 = x 0 (s 0 ) at the edge of the medium, to give the integral form I (x; !) = I (x 0 ; !) <p> Suppose, for simplicity, that all rays from x to cell V k lie in angle bin j. (The algorithm described in the following sections takes special account of interactions involving two or more bins.) Geometric arguments (see <ref> [Rush88] </ref>) show that Geom ijk = Z d! n (s)=k Volume (V k ) r 2 (3) where r ik is the distance between the centers of cells i and k. <p> Rushmeier <ref> [Rush88] </ref> and Kajiya [Kaj84] have pointed out that after a number of scattering events, even a narrow forward phase function becomes more isotropic. This means that the later scattering passes through the volume could use a smaller number of direction bins, for greater speed, and still maintain accuracy. <p> This means that the later scattering passes through the volume could use a smaller number of direction bins, for greater speed, and still maintain accuracy. Rushmeier <ref> [Rush87, Rush88] </ref> handles surface and volume radiosity in a unified framework. I currently do not handle surface radiosity, but it should be possible to include surface elements in this method. In a common engineering application, the only surfaces are on the enclosure of the participating medium.
Reference: [Sak93] <author> Georgios Sakas, </author> <title> "Modeling and Animating Turbulent Gaseous Phenomena using Spectral Synthesis," The Visual Computer Vol. </title> <note> 9 No. 4 (January 1993) pp. 200 - 212 </note>
Reference-contexts: I then added on a version of Ken Perlin's 1=f noise function [Perl85], to roughen and randomize the edges. Like Gardner, when the volume function was negative, I let kt = 0, giving complete transparency. More sophisticated cloud turbulence models are given in <ref> [Sak93] </ref> and the references therein. 9 Results the sun behind it, rendered with multiple anisotropic scattering. Note that the cloud edges are brightest near the direction of the sun. Figure 8 shows the same cloud from a different direction, with the green "grass" background color added for orientation. <p> I would like to thank Holly Rushmeier, John Howell, Roger Crawfis, and Charles Grant for helpful conversations, Chris Patmore, Steven Zucker, and Neeta Bhate for preprints of [Patm93], [Lang93] and [Bhat93], respectively, anonymous Siggraph and Eurographics reviewers for suggesting improvements and pointing out references [Blas93], <ref> [Sak93] </ref>, and [Kan90], and Peter Shirley and Kurt Zimmerman for reformatting this paper from Framemaker into LaTeX.
Reference: [Sie92] <author> Robert Siegel and John Howell, </author> <title> "Thermal Radiation Heat Transfer, Third Edition," </title> <publisher> Hemisphere Publishing Corp., </publisher> <address> Washington (1992) </address>
Reference-contexts: The transport equations Kajiya used, described in the next section, have a long history in radiation heat transfer in mechanical engineering, and in particle transport in nuclear engineering. Siegel and Howell <ref> [Sie92] </ref> give a good summary of solution techniques. Holly Rushmeier [Rush87, Rush88] applied two of these solution techniques to computer rendering of participating (i.e. absorbing, emitting, and scattering) media. <p> Tan uses the point allocation (or point collocation) method, which allows the representation of nonconstant basis functions. He points out that this requires integrals over only one 3-D position, reducing the number of integration variables by 3. This simplification has been misinterpreted by Siegel and Howell <ref> [Sie92] </ref>, who incorrectly claimed that the method is O (N ). Bhata [Bhat92] has applied this method to computer rendering, but could deal with only a small number of voxels, due to the O (n 7 + M 2 n 6 ) cost. <p> Sparse matrix solution methods are then available, as in Immel et al.[Imm86]. In the discrete ordinates method in radiation transfer, <ref> [Sie92, Chan50] </ref>, the M direction bins are represented by M discrete directions, chosen to give optimal Gaussian quadrature in the integrals over a solid angle. <p> This effect is usually not important in rendering, and I will neglect it below for simplicity, and deal only with absorption and scattering. More complete discussions are available from <ref> [Sie92] </ref> and [Rush88]. Let I (x; !) be the intensity at position x flowing in direction !, and let k t (x) be the extinction coefficient of the participating medium. <p> Then ak t (x)ds 4 is the intensity scattered into the direction ! along the ray segment ds from other directions ! 0 in the 4 unit sphere. (This is the source function <ref> [Sie92] </ref> in the absence of 4 Nelson Max volume emission.) The integro-differential equation for I (x; !) is thus dI (x; !) = k t (x)I (x; !) + ak t (x) 4 Using an integrating factor (see [Sie92], [Rush88], or [Will92]), this can be integrated along a path x 0 <p> ! 0 in the 4 unit sphere. (This is the source function <ref> [Sie92] </ref> in the absence of 4 Nelson Max volume emission.) The integro-differential equation for I (x; !) is thus dI (x; !) = k t (x)I (x; !) + ak t (x) 4 Using an integrating factor (see [Sie92], [Rush88], or [Will92]), this can be integrated along a path x 0 (s) = x s!, from x = x 0 (0) to x 0 = x 0 (s 0 ) at the edge of the medium, to give the integral form I (x; !) = I (x 0 ;
Reference: [Tan89] <author> Zhiqiang Tan, </author> <title> "Radiative Heat Transfer in Multidimensional Emitting, Absorbing, and Scattering Media Mathematical Formulation and Numerical Method," </title> <journal> Journal of Heat Transfer Vol. </journal> <note> 111 (February 1989) pp. 141 - 147 </note>
Reference-contexts: This cost can be reduced somewhat by grouping adjacent elements into larger interaction pairs, in the style of Hanrahan, Salzman, and Aupperle [Hanr91], as was done by Bhata [Bhat93]. Rushmeier [Rush88] also considers anisotropic scattering, but only in the single scattering case. Zhiquiang Tan <ref> [Tan89] </ref> applied the ideas of finite element analysis to the solution for the spherical harmonic coefficients in the case of multiple anisotropic scattering. If there are M terms in the expansion, this results in a matrix of size M 2 N 2 .
Reference: [Voss83] <author> Richard Voss, </author> <title> "Fourier Synthesis of Gaussian Fractals: 1=f Noises, Landscapes, and Flakes," Tutorial on State of the Art Image Synthesis, </title> <booktitle> ACM Siggraph Course Notes (1983) </booktitle>
Reference-contexts: The second pass gathered the scattered flux along each viewing ray, taking into account the attenuation between the scattering event and the viewpoint. Voss <ref> [Voss83] </ref> used a similar method to produce fractal clouds in terrain scenes. Nishita, Miyakawa, and Nakamae [Nish87] have considered anisotropic single scattering in fog, and Inakage [Inak89] has included cases where the density and phase function of the scattering material varies from point to point.
Reference: [Will92] <author> Peter Williams and Nelson Max, </author> <title> "A Volume Density Optical Model," </title> <booktitle> Proceedings, 1992 Workshop on Volume Visualization, </booktitle> <publisher> ACM Press, </publisher> <address> New York (1992) pp. 61 - 68 </address>
Reference-contexts: the 4 unit sphere. (This is the source function [Sie92] in the absence of 4 Nelson Max volume emission.) The integro-differential equation for I (x; !) is thus dI (x; !) = k t (x)I (x; !) + ak t (x) 4 Using an integrating factor (see [Sie92], [Rush88], or <ref> [Will92] </ref>), this can be integrated along a path x 0 (s) = x s!, from x = x 0 (0) to x 0 = x 0 (s 0 ) at the edge of the medium, to give the integral form I (x; !) = I (x 0 ; !) exp 0
References-found: 31

