URL: http://www.cs.mtu.edu/~asandu/Deposit/auto_diff.ps.gz
Refering-URL: http://www.cs.mtu.edu/~asandu/publications.html
Root-URL: http://www.cs.mtu.edu
Title: SENSITIVITY ANALYSIS FOR ATMOSPHERIC CHEMISTRY MODELS VIA AUTOMATIC DIFFERENTIATION  
Author: A. SANDU G. R. CARMICHAEL AND F. A. POTRA 
Keyword: Key words. Atmospheric chemistry, Automatic Differentiation.  
Abstract: REPORT ON COMPUTATIONAL MATHEMATICS 73/1995, DEPARTMENT OF MATHEMATICS, THE UNIVERSITY OF IOWA Abstract. Automatic differentiation techniques are used in the sensitivity analysis of a comprehensive atmospheric chemical mechanism. Specifically, ADIFOR software is used to calculate the sensitivity of ozone with respect to all initial concentrations (of 84 species) and all reaction rate constants (178 chemical reactions) for six different chemical regions. Numerical aspects of the application of ADIFOR are also presented. Automatic differentiation is shown to be a powerful tool for sensitivity analysis. 
Abstract-found: 1
Intro-found: 1
Reference: [ABC + 89] <author> R.D. Atkinson, D.L. Baulch, R.A. Cox, R.F.JR. Hampson, J.A. Kerr, and J. Troe. </author> <title> Evaluated kinetic and photochemical data for atmospheric chemistry. </title> <journal> International Journal of Chemical Kinetics, </journal> <volume> 21 </volume> <pages> 115-190, </pages> <year> 1989. </year>
Reference: [Ama90] <author> H. Amann. </author> <title> Ordinary Differential Equations: An Introduction to Nonlinear Analysis. </title> <publisher> Walter de Gruyter, </publisher> <year> 1990. </year>
Reference-contexts: with respect to the vector of parameters we obtain the variational equations: d rc i (t) = rP i (c) rD i (c) c i D i rc i ; i = 1; :::; n (4) The fact that the sensitivities satisfy (4) can be proved rigorously, see for example <ref> [Ama90] </ref>. The notation rA stands for the sensitivity coefficients vector @A @ff , and " = " represents a vector (element-by-element) assignment. To obtain rc i (t), one has to numerically integrate the large system obtained by appending together (1) and (4).
Reference: [BBH89] <author> P.N. Brown, G.D. Byrne, and A.C. Hindmarsh. VODE: </author> <title> A Variable Step ODE Solver. </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 10 </volume> <pages> 1038-1051, </pages> <year> 1989. </year>
Reference-contexts: Accuracy of different methods: numerical comparisons. In this subsection we display some numerical results obtained by integrating variational equations with Plain QSSA, Extrapolated QSSA and Symmetric QSSA methods (as described in [JSPC95]). We have employed VODE (see <ref> [BBH89] </ref>) to accurately solve the system of ordinary differential equations, as well as the corresponding variational system. We consider the "exact" solution to be that obtained by integrating the variational system 5 with VODE, rtol=10 6 , atol=10 18 . Fig. 2.
Reference: [BCC + 92] <author> Ch. Bischof, A. Carle, G. Corliss, A. Griewank, and P. Hovland. </author> <title> ADIFOR generating derivative codes from FORTRAN programs. </title> <type> Technical report, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, Illinois, </institution> <year> 1992. </year>
Reference-contexts: SANDU,G. R. CARMICHAEL, AND F. A. POTRA [BCKM94], <ref> [BCC + 92] </ref>). A promising new implementation developed at Argonne National Laboratory and Rice University over the last couple of years and which has recently been awarded the 1995 Wilkinson Prize for Numerical Software is the package ADIFOR (Automatic Differentiation in FORTRAN, see [BCKM94]). <p> According to how the chain rule is used to propagate derivatives through the computation, one can distinguish two approaches to AD: the "forward" and the reverse "modes" (see <ref> [BCC + 92] </ref>, [BCKM94] for a detailed discussion). * The Forward Mode. Is similar to the way in which the chain rule of differential calculus is usually taught. At each computational stage derivatives of the intermediate variables with respect to input variables are computed.
Reference: [BCKM94] <author> Ch. Bischof, A. Carle, P. Khademi, and A. Mauer. </author> <title> The ADIFOR2.0 system for the automatic differentiation of FORTRAN77 programs. </title> <type> Technical report, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, Illinois, </institution> <year> 1994. </year>
Reference-contexts: SANDU,G. R. CARMICHAEL, AND F. A. POTRA <ref> [BCKM94] </ref>, [BCC + 92]). A promising new implementation developed at Argonne National Laboratory and Rice University over the last couple of years and which has recently been awarded the 1995 Wilkinson Prize for Numerical Software is the package ADIFOR (Automatic Differentiation in FORTRAN, see [BCKM94]). <p> CARMICHAEL, AND F. A. POTRA <ref> [BCKM94] </ref>, [BCC + 92]). A promising new implementation developed at Argonne National Laboratory and Rice University over the last couple of years and which has recently been awarded the 1995 Wilkinson Prize for Numerical Software is the package ADIFOR (Automatic Differentiation in FORTRAN, see [BCKM94]). It adopts a hybrid approach to computing derivatives that is generally based on the forward mode, but uses the reverse mode to compute the derivatives of assignment statements containing complicated expressions. The forward mode acts similarly to the usual application of the chain rule in calculus. <p> According to how the chain rule is used to propagate derivatives through the computation, one can distinguish two approaches to AD: the "forward" and the reverse "modes" (see [BCC + 92], <ref> [BCKM94] </ref> for a detailed discussion). * The Forward Mode. Is similar to the way in which the chain rule of differential calculus is usually taught. At each computational stage derivatives of the intermediate variables with respect to input variables are computed. These derivatives are propagated forward through the computational stages.
Reference: [Cac81] <author> D. G. Cacuci. </author> <title> Sensitivity theory for nonlinear systems. I. Nonlinear functional analysis approach. II. Extensions to additional classes of responses. </title> <journal> J. Math. Phys., </journal> <volume> 22 </volume> <pages> 2794-2812, </pages> <year> 1981. </year>
Reference-contexts: It turns out that this approach is related to the adjoint sensitivity analysis used in such various fields as nuclear engineering (see <ref> [Cac81] </ref>), weather forecast (see [NM70]) and neural networks (see [Wer82]). Because assignment statements compute generally one dependent variable in terms of several dependent variables, the reverse mode is very efficient and can be implemented as in-line code.
Reference: [Cho86] <author> Y. S. Cho. </author> <type> Ph.d. thesis. </type> <institution> The University of Iowa, </institution> <year> 1986. </year>
Reference-contexts: Most sensitivity analysis applied to air pollution modeling studies has focused on the calculation of the local sensitivities (first order derivatives of output variables with respect to model parameters) in box model studies of gas phase chemistry (see <ref> [Cho86] </ref>). The most common form of sensitivity studies with comprehensive atmospheric chemistry/transport models has been done using the so-called "brute force" method, i.e., a number of input parameters are selected to be varied and the simulation results are then compared. <p> This method becomes less viable as the model becomes more comprehensive. A variety of alternative techniques are available including Green's function analysis (see <ref> [Cho86] </ref>), adjoint models and several variations of the direct decoupled methods ( see [Dun84]). A recently developed technique for sensitivity study is automatic differentiation technology. Automatic differentiation is implemented by pre compilers that analyze the code written for evaluating a function of several variables. <p> sensitivity coefficients over the selected time horizon: L (ff j ) = t 2 t 1 Z t 2 L (ff j ) dt (18) If the mean sensitivities: S j = N are far less then one, the system is considered stable with respect to the initial conditions (see <ref> [Cho86] </ref>). Numerical experiments with the test problem showed that lumped sensitivities are dominated by ozone sensitivity. This may happen because O 3 concentration is larger than other variable species.
Reference: [CPK86] <author> G.R. Carmichael, L.K. Peters, and T. Kitada. </author> <title> A second generation model for regional-scale transport/ chemistry/ deposition. </title> <journal> Atmospheric environment, </journal> <volume> 20 </volume> <pages> 173-188, </pages> <year> 1986. </year>
Reference-contexts: Application of FAD to a comprehensive atmospheric chemical mechanism. The chemical mechanism used in this study is that presently used in the STEM-II regional scale transport/ chemistry/ removal model (see <ref> [CPK86] </ref>). This mechanism consists of 86 chemical species and 178 gas phase reactions. The mechanism, based on the work of Lurmann et al. ([LLA86]) and Atkinson et al. ([ABC + 89]) is representative of those presently being used in the study of chemically perturbed environments.
Reference: [Dun84] <author> A. M. Dunker. </author> <title> The decoupled direct method for calculating sensitivity coefficients in chemical kinetics. </title> <journal> J. Chemical Physics, </journal> <volume> 81:2385, </volume> <year> 1984. </year>
Reference-contexts: This method becomes less viable as the model becomes more comprehensive. A variety of alternative techniques are available including Green's function analysis (see [Cho86]), adjoint models and several variations of the direct decoupled methods ( see <ref> [Dun84] </ref>). A recently developed technique for sensitivity study is automatic differentiation technology. Automatic differentiation is implemented by pre compilers that analyze the code written for evaluating a function of several variables. <p> the obtained value for c n+1 is then used in (9b), this becomes a linear system in rc n+1 ; hence the sensitivities can be obtained with only one matrix decomposition (of I h c n+1 for all ff i ) and without any iterations (the Direct Decoupled Method from <ref> [Dun84] </ref>). Thus, we may conclude that black box FAD is equivalent to the direct (coupled) method, with which it shares the disadvantage of extra computational effort. The convergence of the sensitivity iterations adds to the problems mentioned above. <p> Thus, we can extend the direct decoupled method of <ref> [Dun84] </ref> to dedicated integrators.
Reference: [ea95] <author> M. Prather et. al. </author> <title> Intercomparison of tropospheric chemistry/ transport models. Scientific assesment of ozone depletion, World meteorological organization, </title> <year> 1995. </year>
Reference-contexts: Automatic differentiation is then used to calculate first order sensitivities with respect to initial conditions and chemical reaction rate constants for a wide range of chemical conditions corresponding to the IPCC 1 Chemistry Intercomparison study (see <ref> [ea95] </ref>). 2. Preliminaries. <p> Further details are presented in Chapter 7 of the current WMO Ozone Assesment (see <ref> [ea95] </ref>). ADIFOR was used to calculate sensitivities of ozone with respect to initial conditions and reaction rate parameters. In the simulations of these cases the QSSA method with a fixed stepsize of 10 seconds was used.
Reference: [GBC + 93] <author> A. Griewank, C. Bischof, G. Corliss, A. Carle, and K. Williamson. Derivative conver 22 A. SANDU,G. R. CARMICHAEL, AND F. A. </author> <title> POTRA gence for iterative equation solvers. </title> <journal> Optimization methods and software, </journal> <volume> 2 </volume> <pages> 321-355, </pages> <year> 1993. </year>
Reference-contexts: Thus, we may conclude that black box FAD is equivalent to the direct (coupled) method, with which it shares the disadvantage of extra computational effort. The convergence of the sensitivity iterations adds to the problems mentioned above. The aspects of derivative convergence are thoroughly examined in <ref> [GBC + 93] </ref>; it is shown that, if the concentration iterations are convergent, under natural hypothesis, the new sensitivity iterations are also convergent. 4.1.3. One step methods. <p> For the conditions under which these iterations converge we refer again to <ref> [GBC + 93] </ref>. 12 A. SANDU,G. R. CARMICHAEL, AND F. A. POTRA 4.2.2. Conclusions for automatically differentiated QSSA. Black box application of forward automatic differentiation on a fixed step-size QSSA algorithm (11) is equivalent to solving the variational equations (4) with the first order method given by the formula (13b).
Reference: [HHI78] <author> E. Hesstvedt, O. Hov, and I. Isaacsen. </author> <title> Quasi-steady-state-approximation in air pollution modelling: comparison of two numerical schemes for oxidant prediction. </title> <journal> Int. J. Chem. Kinet., </journal> <volume> 10 </volume> <pages> 971-994, </pages> <year> 1978. </year>
Reference-contexts: SANDU,G. R. CARMICHAEL, AND F. A. POTRA 4.2. Black box forward automatic differentiation of the QSSA method. As an illustration, we consider in detail the integration of (2) using the Quasi Steady State- Approximation (QSSA) technique (see <ref> [HHI78] </ref>).
Reference: [JSPC95] <author> L.O. Jay, A. Sandu, F.A. Potra, and G.R. </author> <title> Carmichael. Improved QSSA methods for atmospheric chemistry integration. </title> <type> Technical report 67, </type> <institution> The University of Iowa, Department of Mathematics, Iowa City, </institution> <month> February </month> <year> 1995. </year>
Reference-contexts: Accuracy of different methods: numerical comparisons. In this subsection we display some numerical results obtained by integrating variational equations with Plain QSSA, Extrapolated QSSA and Symmetric QSSA methods (as described in <ref> [JSPC95] </ref>). We have employed VODE (see [BBH89]) to accurately solve the system of ordinary differential equations, as well as the corresponding variational system. We consider the "exact" solution to be that obtained by integrating the variational system 5 with VODE, rtol=10 6 , atol=10 18 . Fig. 2.
Reference: [LLA86] <author> F.W. Lurmann, A.C. Loyd, and R. Atkinson. </author> <title> A chemical mechanism for use in long-range transport/acid deposition computer modeling. </title> <journal> Journal of Geophysical Research, </journal> <volume> 91:10,905-10,936, </volume> <year> 1986. </year>
Reference: [LTL88] <author> X. Lin, M. Trainer, and S. Liu. </author> <title> On the nonlinearity of tropospheric ozone production. </title> <journal> Journal of Geophysical Research, </journal> <volume> 93:15,879-15,888, </volume> <year> 1988. </year>
Reference-contexts: A net ozone production efficiency e N has been defined by Lin et. al. (see <ref> [LTL88] </ref>): e N = @N O y where e N represents the net number of ozone molecules produced per molecule of N O y consumed.
Reference: [NM70] <author> I.M. Navon and U. Muller. </author> <title> FESW A finite element FORTRAN IV program for solving the shallow water equations. </title> <booktitle> Advances in ehngineering software, </booktitle> <volume> 1 </volume> <pages> 77-84, </pages> <year> 1970. </year>
Reference-contexts: It turns out that this approach is related to the adjoint sensitivity analysis used in such various fields as nuclear engineering (see [Cac81]), weather forecast (see <ref> [NM70] </ref>) and neural networks (see [Wer82]). Because assignment statements compute generally one dependent variable in terms of several dependent variables, the reverse mode is very efficient and can be implemented as in-line code.
Reference: [OBSM94] <author> K. Olszyna, E. Bailey, R. Simonaites, and J. Meagher. </author> <title> O 3 and N O y relationships at a rural site. </title> <journal> Journal of Geophysical Research, </journal> <volume> 99:14,557-14,563, </volume> <year> 1994. </year>
Reference-contexts: O x T P AN + R 3 N 2 + RAN 1 + RAN 2 + N 2 O 5 + HN O 4 + and is a metric which reduces variations arising from differences in the age of the air masses being compared ( see [PHT + 93], <ref> [OBSM94] </ref>). This ozone production efficiency is simply a local sensitivity. This efficiency was calculated using ADIFOR for each of the studied cases. The results are shown in by the land, bio and free conditions. For these cases e N ranges from 5 to 10.
Reference: [PHT + 93] <author> D. Parrish, J. Holloway, M. Trainer, P. Murphy, G. Forbes, and F. Fehsenfeld. </author> <title> Export of north american ozone pollution to the north atlantic ocean. </title> <journal> Science, </journal> <volume> 259 </volume> <pages> 1436-1439, </pages> <year> 1993. </year>
Reference-contexts: O y N O x T P AN + R 3 N 2 + RAN 1 + RAN 2 + N 2 O 5 + HN O 4 + and is a metric which reduces variations arising from differences in the age of the air masses being compared ( see <ref> [PHT + 93] </ref>, [OBSM94]). This ozone production efficiency is simply a local sensitivity. This efficiency was calculated using ADIFOR for each of the studied cases. The results are shown in by the land, bio and free conditions. For these cases e N ranges from 5 to 10.
Reference: [VS94] <author> J. Verwer and D. Simpson. </author> <title> Explicit Methods for Stiff Odes from Atmospheric Chemistry. </title> <type> Technical Report CWI Report NM-R9409, </type> <institution> Center for Mathematics and Computer Science, CWI, </institution> <address> P.O. Box 94079, 1090 GB Amsterdam, The Netherlands, </address> <year> 1994. </year>
Reference-contexts: Direct decoupled method with dedicated algorithms. Dedicated algorithms are explicit methods for the numerical solution of the rate equations (1) which make use of their special (production-destruction) form; examples of dedicated methods are QSSA, Young and Boris and Two-Step (see <ref> [VS94] </ref>).

References-found: 19

