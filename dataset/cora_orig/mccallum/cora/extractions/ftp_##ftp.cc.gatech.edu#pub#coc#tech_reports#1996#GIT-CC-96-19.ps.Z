URL: ftp://ftp.cc.gatech.edu/pub/coc/tech_reports/1996/GIT-CC-96-19.ps.Z
Refering-URL: http://www.cs.gatech.edu/tech_reports/index.96.html
Root-URL: 
Email: emily@cc.gatech.edu schwan@cc.gatech.edu  sudha@ee.gatech.edu  
Title: Optimistic Parallel Computation: An Example from Computational Chemistry  
Author: Emily Angerer Crawford Karsten Schwan Sudhakar Yalamanchili 
Address: Atlanta, GA 30332  
Affiliation: School of Elec. and Comp. Engineering College of Computing  School of Elec. and Comp. Engineering Georgia Institute of Technology,  
Abstract: Performance penalties due to synchronization are a common concern in parallel programming. This paper describes a technique for avoiding such penalties when they occur in shared data structures. This technique may be used with a segment of code in which two updates are required for any element of a shared array and the values stored in the array are known a priori. Traditional approaches enforce the correct ordering of write operations using locks, but this can be time-consuming and drastically reduce the benefits of using a parallel machine. Instead, we propose using an optimistic approach where the solution is calculated without any locks, during which statistics on memory writes are kept. These statistics can then be used to determine whether the calculation resulted in a correct answer or if the answer should be recalculated due to incorrect ordering of write operations. This scheme is tested on an implementation of the Mtller-Plesset perturbation theory energy calculation for closed-shell molecules and significant speedups are shown, as demonstrated on an SGI PowerChallenge.
Abstract-found: 1
Intro-found: 1
Reference: [CCD + 84] <author> E. Clementi, G. Corongiu, J. H. Detrich, H. Khanmohammadbaigi, S. Chin, L. Domingo, A. Laaksonen, and H. L. Nguyen. </author> <title> Parallelism in computational chemistry: Applications in quantum and statistical mechanics. </title> <editor> In E. Clementi, G. Corongiu, M. H. Sarma, and R. H. </editor> <title> 16 Sarma, editors, Structure and Motion: Membranes, </title> <journal> Nucleic Acids, and Proteins, </journal> <pages> pages 49-85. </pages> <publisher> Adenine Press, </publisher> <address> New York, </address> <year> 1984. </year>
Reference-contexts: Watts and Dupuis examined the same application as part of the HONDO quantum chemistry program in 1988 [WD88] using the Loosely Coupled Array of Processors (LCAP) systems <ref> [Cle85, CCD + 84] </ref> at IBM in the mid-1980s. Their implementation also used shared memory and they reported a modest speedup; however, the implementation was only useful for the native system and was limited in its ability to be scaled to larger machines.
Reference: [Cle85] <author> Enrico Clementi. </author> <title> Ab initio computational chemistry. </title> <journal> Journal of Physical Chemistry, </journal> 1985 4426-4436, 1985. 
Reference-contexts: Watts and Dupuis examined the same application as part of the HONDO quantum chemistry program in 1988 [WD88] using the Loosely Coupled Array of Processors (LCAP) systems <ref> [Cle85, CCD + 84] </ref> at IBM in the mid-1980s. Their implementation also used shared memory and they reported a modest speedup; however, the implementation was only useful for the native system and was limited in its ability to be scaled to larger machines.
Reference: [Cot90] <author> Albert F. Cotton. </author> <title> Chemical Applications of Group Theory. </title> <publisher> John Wiley and Sons, </publisher> <address> New York, third edition, </address> <year> 1990. </year>
Reference-contexts: The initial structure of rdtwo is as shown in Figure 2. Each iteration performs a computation of time complexity O (h 2 m 3 ), where h is the number of irreducible representations and m is the number of orbitals per irreducible representation <ref> [Cot90] </ref>. h and m are generally small numbers; h is a maximum of 8, and m is on the order of 10 1 to 10 2 , with a maximum of approximately 200.
Reference: [Dun71] <author> Thom H. Dunning. </author> <title> Gaussian basis functions for use in molecular calculations. III. Contraction of (10s6p) atomic basis sets for the first-row atoms. </title> <journal> Journal of Chemical Physics, </journal> <volume> 55:716, </volume> <year> 1971. </year>
Reference-contexts: In this study, we used five basis sets for timing the sequential and parallel versions. These are illustrated in Table 2: i) a triple-zeta plus two sets of polarization functions on all atoms, TZ2P <ref> [Huz65, Dun71] </ref>, ii) a TZ2P plus a single set of f-type functions on the oxygen atom and a single set of d-type functions on the hydrogen atoms, TZ2P+f [Huz65, Dun71], iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, <p> These are illustrated in Table 2: i) a triple-zeta plus two sets of polarization functions on all atoms, TZ2P <ref> [Huz65, Dun71] </ref>, ii) a TZ2P plus a single set of f-type functions on the oxygen atom and a single set of d-type functions on the hydrogen atoms, TZ2P+f [Huz65, Dun71], iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, cc-pVQZ, which we call cc-pV1 [Dun89], iv) a cc-pV triple-zeta basis set, cc-pVTZ on the hydrogen atoms with a cc-pVQZ basis set on the oxygen, which we call
Reference: [Dun89] <author> Thom H. Dunning. </author> <title> Gaussian basis sets for use in correlated molecular calculations. I. the atoms boron through neon and hydrogen. </title> <journal> Journal of Chemical Physics, </journal> <volume> 90:1007, </volume> <year> 1989. </year>
Reference-contexts: a single set of f-type functions on the oxygen atom and a single set of d-type functions on the hydrogen atoms, TZ2P+f [Huz65, Dun71], iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, cc-pVQZ, which we call cc-pV1 <ref> [Dun89] </ref>, iv) a cc-pV triple-zeta basis set, cc-pVTZ on the hydrogen atoms with a cc-pVQZ basis set on the oxygen, which we call cc-pV2 [Dun89], and v) a cc-pV 5-zeta basis set, cc-pV5Z on the oxygen atom with a double-zeta plus a single set of d-type functions on the hydrogen atoms, <p> iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, cc-pVQZ, which we call cc-pV1 <ref> [Dun89] </ref>, iv) a cc-pV triple-zeta basis set, cc-pVTZ on the hydrogen atoms with a cc-pVQZ basis set on the oxygen, which we call cc-pV2 [Dun89], and v) a cc-pV 5-zeta basis set, cc-pV5Z on the oxygen atom with a double-zeta plus a single set of d-type functions on the hydrogen atoms, which 9 Number of Size of Basis Set Functions T F M TZ2P 44 490,545 cc-pV1 80 5,250,420 cc-pV3 115 22,247,785 Table 2: Characteristics <p> TZ2P TZ2P+f cc-pV1 cc-pV2 cc-pV3 Sequential 0.1250 0.623 1.324 3.095 5.181 Parallel 0.0964 0.468 1.043 2.444 4.291 Table 3: Memory allocation and initialization times in seconds for trans two. we call cc-pV3 <ref> [Dun89] </ref>. These basis sets were chosen strictly for their representative sizes. The most significant memory demand came from T F M , as described above.
Reference: [GBD + 94] <author> Al Geist, Adam Beguelin, Jack Dongarra, Weicheng Jiang, Robert Manchek, and Vaidy Sun-deram. </author> <title> PVM 3 User's Guide and Reference Manual. </title> <institution> Oak Ridge National Laboratory, Oak Ridge, Tennesssee, </institution> <year> 1994. </year>
Reference-contexts: In a recent paper, Marquez and Dupuis [MD95] published the current efforts with MP2 in the HONDO program, which includes an implementation with the Parallel Virtual Machine (PVM) <ref> [GBD + 94] </ref> programming environment. They parallelized a greater portion of the MP2 problem than presented here, but did not eliminate the communications bottleneck generated by the domain decomposition.
Reference: [HB84] <author> Kai Hwang and Faye A. Briggs. </author> <title> Computer Architecture and Parallel Processing. </title> <publisher> McGraw-Hill Book Company, </publisher> <address> New York, </address> <year> 1984. </year>
Reference-contexts: The cache access is prevented from completing and a cache miss is generated if the access checks indicate that the required cache line is actually not present <ref> [HB84] </ref>. A simple strategy for branch prediction in pipelined processors is to assume that branches are not taken (or taken) and to continue fetching instructions. If the branch decision is subsequently found to be in error, the instructions in the pipeline are flushed and prevented from completing.
Reference: [Huz65] <author> Sigeru Huzinaga. </author> <title> Gaussian-type functions for polyatomic systems. I. </title> <journal> Journal of Chemical Physics, </journal> <volume> 42:1293, </volume> <year> 1965. </year>
Reference-contexts: In this study, we used five basis sets for timing the sequential and parallel versions. These are illustrated in Table 2: i) a triple-zeta plus two sets of polarization functions on all atoms, TZ2P <ref> [Huz65, Dun71] </ref>, ii) a TZ2P plus a single set of f-type functions on the oxygen atom and a single set of d-type functions on the hydrogen atoms, TZ2P+f [Huz65, Dun71], iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, <p> These are illustrated in Table 2: i) a triple-zeta plus two sets of polarization functions on all atoms, TZ2P <ref> [Huz65, Dun71] </ref>, ii) a TZ2P plus a single set of f-type functions on the oxygen atom and a single set of d-type functions on the hydrogen atoms, TZ2P+f [Huz65, Dun71], iii) a correlation-consistent polarized-valence double-zeta basis set, cc-pVDZ on the hydrogen atoms with a cc-pV quadruple-zeta basis set on the oxygen, cc-pVQZ, which we call cc-pV1 [Dun89], iv) a cc-pV triple-zeta basis set, cc-pVTZ on the hydrogen atoms with a cc-pVQZ basis set on the oxygen, which we call
Reference: [JSS + 94] <author> C. L. Janssen, E. T. Seidl, G. E. Scuseria, T. P. Hamilton, Y. Yamaguchi, R. Remington, Y. Xie, G. Vacek, C. D. Sherrill, T. D. Crawford, J. T. Fermann, W. D. Allen, B. R. Brooks, G. B. Fitzgerald, D. J. Fox, J. F. Gaw, N. C. Handy, W. D. Laidig, T. J. Lee, R. M. Pitzer, J. E. Rice, P. Saxe, A. C. Scheiner, and H. F. Schaefer. </author> <title> PSI 2.0.8. </title> <publisher> PSITECH, Inc., </publisher> <address> Watkinsville, GA 30677, U.S.A, </address> <year> 1994. </year>
Reference-contexts: Our implementation platform was an SGI PowerChallenge 12-processor shared memory machine. The initial code was based on the Psi 2.0 suite of computational quantum chemistry programs <ref> [JSS + 94] </ref>. Both trans and mbpt are structured such that parallelization can be achieved via data decomposition. 3.1 Parallelization of trans The basic structure of trans before parallelization is based on the Saunders-van Lenthe algorithm [SvL83].
Reference: [MD95] <author> Antonio M. Marquez and Michel Dupuis. </author> <title> Parallel computation of the MP2 energy on distributed memory computers. </title> <journal> Journal of Computational Chemistry, </journal> <volume> 16 </volume> <pages> 395-404, </pages> <year> 1995. </year>
Reference-contexts: However, exploiting this parallelism is a significant challenge due to heavy demands on memory resources and unpredictable memory reference patterns. Due to these irregular access patterns, a shared memory solution appears preferable, although message passing implementations have been studied <ref> [MD95] </ref>. 2 There have been some previous attempts to study the parallelization of similar electronic structure theory calculations. <p> Further, the LCAP system never evolved beyond the experimental stages, so the parallel application was of limited use to the general scientific community. In a recent paper, Marquez and Dupuis <ref> [MD95] </ref> published the current efforts with MP2 in the HONDO program, which includes an implementation with the Parallel Virtual Machine (PVM) [GBD + 94] programming environment. They parallelized a greater portion of the MP2 problem than presented here, but did not eliminate the communications bottleneck generated by the domain decomposition.
Reference: [MEG94] <author> Bodhisattwa Mukherjee, Greg Eisenhauer, and Kaushik Ghosh. </author> <title> A machine independent interface for lightweight threads. </title> <booktitle> Operating Systems Review of the ACM Special Interest Group in Operating Systems, </booktitle> <pages> page 33, </pages> <year> 1994. </year>
Reference-contexts: The function mbpt is of time complexity O (N 2 n 2 ), where N is the number of doubly-occupied MO's and n is the number of unoccupied MO's. 4 3 Parallelization Approach: Optimistic Computation The functions trans and mbpt are implemented using a multiprocessor threads package, Cthreads <ref> [MEG94] </ref>, which supports thread-based parallelism and provides portability between a variety of shared-memory multiprocessor and uniprocessor platforms. Our implementation platform was an SGI PowerChallenge 12-processor shared memory machine. The initial code was based on the Psi 2.0 suite of computational quantum chemistry programs [JSS + 94].
Reference: [MP34] <author> C. Mtller and M. S. Plesset. </author> <title> Note on an approximation treatement for many-electron systems. </title> <journal> Physical Review, </journal> <volume> 46:618, </volume> <year> 1934. </year>
Reference-contexts: However, the SCF approach fails to consider the correlation of electronic motion. Thus, one of the first steps beyond SCF is the calculation of the second-order Mtller-Plesset perturbation theory energy (MP2) <ref> [MP34] </ref>, which does include electronic correlation. However, it is well-known in the field of electronic structure theory that the calculation of this MP2 correlation energy can be extremely computationally demanding, requiring significant CPU time and memory. This motivates the search for parallel formulation.
Reference: [Roo51] <author> C. C. J. Roothaan. </author> <title> New developments in molecular orbital theory. Reviews in Modern Physics, </title> <address> 23(2):69, </address> <year> 1951. </year>
Reference-contexts: with a final description of the future directions of this work. 2 An Example from Computational Chemistry 2.1 Overview: The Second-Order Mtller-Plesset Perturbation Theory Energy Calcu lation for Closed-Shell Molecules In the quantum mechanical study of a molecule, it is generally necessary to begin with the Hartree-Fock self-consistent-field (SCF) method <ref> [Roo51] </ref>. However, the SCF approach fails to consider the correlation of electronic motion. Thus, one of the first steps beyond SCF is the calculation of the second-order Mtller-Plesset perturbation theory energy (MP2) [MP34], which does include electronic correlation.
Reference: [SO89] <author> Attila Szabo and Neil S. Ostlund. </author> <title> Modern Quantum Chemistry: Introduction to Advanced Electronic Structure Theory. </title> <publisher> McGraw-Hill, </publisher> <address> New York, </address> <year> 1989. </year>
Reference-contexts: for a given molecule. (There are no singly-occupied orbitals for this calculation, as we are working with only closed-shell molecules.) The notation (iajjb) represents a two-electron integral over spatial orbitals, in Mulliken notation, for a particular i, j, a, and b, and * k is the energy of orbital k <ref> [SO89] </ref>, [Wil87]. 2.3 Structural Description of the Computation 3 The computation proceeds in two primary stages (see Figure 1).
Reference: [SvL83] <author> V. R. Saunders and J. H. van Lenthe. </author> <title> The direct CI method. a detailed analysis. Molecular Physics, </title> <address> 48:923, </address> <year> 1983. </year>
Reference-contexts: Both trans and mbpt are structured such that parallelization can be achieved via data decomposition. 3.1 Parallelization of trans The basic structure of trans before parallelization is based on the Saunders-van Lenthe algorithm <ref> [SvL83] </ref>. The function trans is composed of two segments, input processing (rdtwo) and the two-electron integral transformation (trans two). The structure of trans two is illustrated in Figure 3.
Reference: [WD88] <author> John D. Watts and Michel Dupuis. </author> <title> Parallel computation of the Mtller-Plesset second-order contribution to the electronic correlation energy. </title> <journal> Journal of Computational Chemistry, </journal> <volume> 9 </volume> <pages> 158-170, </pages> <year> 1988. </year>
Reference-contexts: Watts and Dupuis examined the same application as part of the HONDO quantum chemistry program in 1988 <ref> [WD88] </ref> using the Loosely Coupled Array of Processors (LCAP) systems [Cle85, CCD + 84] at IBM in the mid-1980s.
Reference: [Wil87] <author> S. Wilson. </author> <title> Four-index transformations. </title> <booktitle> In Methods in Computational Chemistry, </booktitle> <volume> volume 1. </volume> <publisher> Plenum Press, </publisher> <year> 1987. </year> <month> 18 </month>
Reference-contexts: a given molecule. (There are no singly-occupied orbitals for this calculation, as we are working with only closed-shell molecules.) The notation (iajjb) represents a two-electron integral over spatial orbitals, in Mulliken notation, for a particular i, j, a, and b, and * k is the energy of orbital k [SO89], <ref> [Wil87] </ref>. 2.3 Structural Description of the Computation 3 The computation proceeds in two primary stages (see Figure 1).
References-found: 17

