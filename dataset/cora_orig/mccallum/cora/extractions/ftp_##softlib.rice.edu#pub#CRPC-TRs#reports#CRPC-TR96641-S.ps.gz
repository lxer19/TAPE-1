URL: ftp://softlib.rice.edu/pub/CRPC-TRs/reports/CRPC-TR96641-S.ps.gz
Refering-URL: http://www.crpc.rice.edu/CRPC/softlib/TRs_online.html
Root-URL: 
Title: TWO-STAGE PRECONDITIONERS FOR INEXACT NEWTON METHODS IN MULTI-PHASE RESERVOIR SIMULATION  
Author: H ECTOR KL IE MARCELO RAM E AND MARY F. WHEELER 
Keyword: Two-stage methods, preconditioners, Krylov iterative solvers, block methods, coupled nonlinear partial differential equations, inexact Newton methods, multi-phase flow and transport, reservoir simulation.  
Note: AMS(MOS) subject classification: 3504, 35Q35, 35M10  
Abstract: Two-stage procedures refers to a family of convergent nested or inner-outer iterations. This paper addresses their use as preconditioners in the context of systems of coupled nonlinear partial differential equations, specifically those modeling underground multiphase flow phenomena. The linear systems arising after the discretization and the Newton linearization are highly nonsymmetric and indefinite but coefficient blocks associated with a particular type of unknown possess properties that can be exploited to enhance the overall conditioning of the coupled system. We show that decoupling strategies combined with two-stage preconditioners provide an efficient device to accelerate Krylov subspace methods such as GMRES and BiCGSTAB. Theoretical discussion and numerical experiments reveal the suitability of this approach and contrast it to fairly robust, standard ones which "blindly" precondition the entire coupled linear system. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> J. Aarden and K. Karlsson, </author> <title> Preconditioned cg-type methods for solving coupled system of fundamental semiconductor equations, </title> <journal> BIT, </journal> <volume> 29 (1989), </volume> <pages> pp. 916-937. </pages>
Reference-contexts: Finally, we stress that this presentation can be easily extended to more unknowns sharing a given gridpoint (e.g., three phases and multi components systems.) 4.2. Properties of the partially decoupled blocks. In general, it is a difficult task (and in fact, an open problem in many related fields <ref> [1, 6, 12, 29, 40] </ref>) to characterize properties associated with the entire coupled Jacobian matrix and even more so if it has been affected by some of the operators described above.
Reference: [2] <author> M. Allen, G. Behie, and J. Trangenstein, </author> <title> Multiphase flow in porous media, </title> <booktitle> in Lectures Notes in Engineering, </booktitle> <publisher> Springer Verlag, </publisher> <address> Berlin, </address> <year> 1988. </year>
Reference-contexts: An algebraic analysis of the coupled Jacobian matrix. The presence of slight compressibility ensures invertibility of the Jacobian matrix (further discussion about this issue is given in [5].) In general, in system (9), the block coefficients J pp ; J ps and J sp the following properties (see e.g., <ref> [2, 5] </ref> for further physical insights and [3, 10] for mathematical definitions and related theoretical results): * Diagonal dominance, * Positive diagonal entries and negative off-diagonal entries (i.e they are Z matrices), and * Irreducibility.
Reference: [3] <author> O. Axelsson, </author> <title> Iterative Solution Methods, </title> <publisher> Cambridge University Press, </publisher> <year> 1994. </year>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> The presence of slight compressibility ensures invertibility of the Jacobian matrix (further discussion about this issue is given in [5].) In general, in system (9), the block coefficients J pp ; J ps and J sp the following properties (see e.g., [2, 5] for further physical insights and <ref> [3, 10] </ref> for mathematical definitions and related theoretical results): * Diagonal dominance, * Positive diagonal entries and negative off-diagonal entries (i.e they are Z matrices), and * Irreducibility. <p> Proof. We prove separately that J D pp and J D ss are Z-matrices and strictly diagonally dominant matrices. Then by <ref> [3, Lemma 6.3, page 204] </ref> it immediately follows that they TWO-STAGE PRECONDITIONERS 15 are M-matrices. We only show that J D pp is a M-matrix. The proof for J D ss proceeds similarly. <p> Corollary 4.1. The diagonal blocks J D pp and J D ss are positive stable. Proof. This is just the result stated in <ref> [3, Theorem 6.12,page 211] </ref>. In Fig. 4 we show the spectrum of the resulting Jacobian matrix after applying the decoupling operators D 1 and f W . Interestingly enough, the Jacobian spectrum has been significantly compressed and shifted to the right half of the complex plane with D 1 . <p> In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations [22, 28, 32]. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners <ref> [3, 4, 43] </ref>. They have been also subject of study in parallel computing settings (e.g. see [18] and further references therein.) However, in the context of large-scale systems of coupled equations they strangely seem to have been overlooked. <p> In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. <ref> [3, 43, 49, 50] </ref>. In this work, we use right preconditioning. It is well known that this form is preferable over left preconditioning for comparing different preconditioners since it makes the relative residual norms measured within the iterative solver invariant. <p> Note that according to Theorem 4.1, the convergence of any point-, line- or block-type stationary iterative method is guarantee for the resulting decoupled blocks via D 1 . This result comes from the fact that from any M-matrix we can produce a convergent weak regular splitting (see <ref> [3] </ref> for further details.). Further efficiency enhancements may be realized in the use of inexact methods applied to individual steps of the two-stage preconditioners.
Reference: [4] <author> O. Axelsson and P. Vassilevski, </author> <title> A black box generalized conjugate gradient solver with inner iterations and variable-step preconditioning, </title> <journal> SIAM J. Matrix Anal. Appl., </journal> <volume> 12 (1991), </volume> <pages> pp. 625-644. </pages>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations [22, 28, 32]. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners <ref> [3, 4, 43] </ref>. They have been also subject of study in parallel computing settings (e.g. see [18] and further references therein.) However, in the context of large-scale systems of coupled equations they strangely seem to have been overlooked.
Reference: [5] <author> K. Aziz and A. Sethari, </author> <title> Petroleum Reservoir Simulation, </title> <booktitle> Applied Science Publisher, </booktitle> <year> 1983. </year>
Reference-contexts: Sequential solution methods can be regarded as strategies to decouple the system by means of operator splitting or time-lagging some of the variables present in the physical model. Along this trend, we have the well known IMPES (IMplicit Pressures-Explicit Saturations) formulation in reservoir simulation (see, e.g., <ref> [5] </ref>) and, for Navier-Stokes problems, the segregated methods in CFD [34, 35]. Such strategies can certainly be inspiring to generate preconditioners for coupled linear systems already treated under the fully implicit scheme. This geneal idea motivates the work we present in this paper. <p> However, for simplicity, we limit the presentation to a wetting (i.e., water) and a non-wetting (i.e., oil) phase, denoted by subscripts w and n, respectively. A more thorough description of the model can be found in <ref> [5] </ref> and [39]. <p> The resulting (possibly) rank deficient linear system is solved by choosing the bottom hole pressure at a given reservoir location.) Frequently, the primary unknowns in the preceding system of parabolic equations are pressures and saturations of one phase or two different phases (see the discussion of <ref> [5] </ref> about other possible formulations.) The primary unknowns in our simulator are P n and S n . All other variables can then be computed explicitly based on these two. <p> Discretization. Nowadays, reservoir simulators rely on a variety of dis-cretization schemes in time, ranging from the IMPES to the fully implicit formulations (see <ref> [5] </ref> and [39] for detailed discussions.) In between these two extremes, semi-implicit [42] and adaptive implicit discretizations have been proposed [30]. However, the fully implicit formulation offers the highest robustness among these possible alternatives in long term simulation. <p> The above procedure follows the description by Wheeler and Smith [55] on developing a parallel black-oil simulator. Further insights about discretization of these equations can be found in <ref> [5] </ref> and [25]. 6 RAME, KLIE AND WHEELER 2.3. Newton formulation. The fully implicit formulation for the numerical solution of systems of nonlinear parabolic equations leads us to solving the following nonlinear problem for each time step F (u) = 0; where F : IR n ! IR n . <p> However, the absent values in the upper part are added positively to the main diagonal of that block. 3.2. An algebraic analysis of the coupled Jacobian matrix. The presence of slight compressibility ensures invertibility of the Jacobian matrix (further discussion about this issue is given in <ref> [5] </ref>.) In general, in system (9), the block coefficients J pp ; J ps and J sp the following properties (see e.g., [2, 5] for further physical insights and [3, 10] for mathematical definitions and related theoretical results): * Diagonal dominance, * Positive diagonal entries and negative off-diagonal entries (i.e they <p> An algebraic analysis of the coupled Jacobian matrix. The presence of slight compressibility ensures invertibility of the Jacobian matrix (further discussion about this issue is given in [5].) In general, in system (9), the block coefficients J pp ; J ps and J sp the following properties (see e.g., <ref> [2, 5] </ref> for further physical insights and [3, 10] for mathematical definitions and related theoretical results): * Diagonal dominance, * Positive diagonal entries and negative off-diagonal entries (i.e they are Z matrices), and * Irreducibility.
Reference: [6] <author> R. Bank, T. Chan, W. Coughran, and K. Smith, </author> <title> The alternate-block-factorization procedure for systems of partial differential equations, </title> <journal> BIT, </journal> <volume> 29 (1989), </volume> <pages> pp. 938-954. </pages>
Reference-contexts: Although, we stress that our experiences are applicable to more general settings where systems of coupled equations arises such in device circuit simulation <ref> [6] </ref>, CFD and control problems. This paper is organized as follows. We begin Section 2 with a presentation of the equations governing the multiphase flow in porous media. We then describe their discretization and the linearization by the Newton method. <p> Unfortunately, this is no longer true under large changes in saturations likely occurring at high flow rates or at larger time steps. Bank et al. <ref> [6] </ref>, with their alternate-block factorization (ABF) method, propose a simple way to weaken the coupling of system drift-diffusion equations that occur in semiconductor device modeling. Under the light of highly simplifying assumptions, however, they analyze the viability of the decoupling process for preconditioning linear systems. <p> Conversely, the main diagonal entries of the offdiagonal blocks are all equal to zero. In fact, we can expect that the degree of coupling of the off-diagonal blocks of J has been reduced to some extent. Bank et. al. <ref> [6] </ref> observe that this operation weakens the coupling between the partial differential equations which turns out to be in our particular case, the equation for each phase. <p> Finally, we stress that this presentation can be easily extended to more unknowns sharing a given gridpoint (e.g., three phases and multi components systems.) 4.2. Properties of the partially decoupled blocks. In general, it is a difficult task (and in fact, an open problem in many related fields <ref> [1, 6, 12, 29, 40] </ref>) to characterize properties associated with the entire coupled Jacobian matrix and even more so if it has been affected by some of the operators described above.
Reference: [7] <author> R. Barrett, M. Berry, T. Chan, J. Demmel, J. Dunato, J. Dongarra, V. Eikkhout, R. Pozo, C. Romine, and H. van der Vorst, </author> <title> Templates for the solution of linear systems: building blocks for iterative methods, </title> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1994. </year>
Reference-contexts: Further description and several pointers into the literature of Krylov subspace iterative methods can be found in <ref> [7, 31] </ref>. Here, we just state some of the highlights of GMRES and BiCGSTAB. <p> Some improvements to the algorithm are discussed and referred to in <ref> [7] </ref>. 3. The algebraic coupled linear system framework. We now provide general description of the linear systems (i.e., Newton equation) arising in Step 2.2 of Algorithm 2.1.
Reference: [8] <author> G. Behie and P. Forsyth, </author> <title> Incomplete factorization methods for fully implicit simulation of enhanced oil recovery, </title> <journal> SIAM J. Sci. Statist. Comput., </journal> <volume> 5 (1984), </volume> <pages> pp. 543-561. </pages>
Reference-contexts: However, Behie and Vinsome [9] appear to be the first to consider combinative preconditioners as a form of decoupled preconditioners in reservoir engineering. A minor change to the idea but seeking to incorporate saturation information was later proposed by Behie and Forsyth <ref> [8] </ref>. Wallis refined the original algebraic presentation of these authors and proposed the iterative solution of the pressures in order to tackle larger reservoir simulation problems [52].
Reference: [9] <author> G. Behie and P. Vinsome, </author> <title> Block iterative methods for fully implicit reservoir simulation, </title> <journal> Soc. of Pet. Eng. J., </journal> <year> (1982), </year> <pages> pp. 658-668. </pages>
Reference-contexts: We do not pursue this idea further here, though. We rather center our attention on those two-stage algorithms that arise naturally in block type of preconditioning: block Jacobi, block Gauss-Seidel and Schur complement based. We include in our analysis a combinative preconditioner originally proposed in <ref> [9] </ref> and later restated as an inexact procedure in [52]. The combinative method relies primarily upon the solution of a reduced pressure based system. In order to strengthen its robustness we propose an additive and multiplicative extension of this combinative preconditioner in terms of pressure and saturation residuals. <p> In fact, Behie and Vinsome <ref> [9] </ref> comment about the possibility of decoupling more equations in their combinative method but only with respect pressure coefficients. They did not forsee the positive effect, as we shall see here, that a full decoupling of the gridblock has in conditioning the system. <p> From top to bottom, they correspond to the (1,1), (1,2), (2,1) and (2,2) blocks TWO-STAGE PRECONDITIONERS 17 5.1. Background. Efforts to develop general and efficient solvers for systems coupled elliptic and parabolic equations have started to emerge strongly in the last years. However, Behie and Vinsome <ref> [9] </ref> appear to be the first to consider combinative preconditioners as a form of decoupled preconditioners in reservoir engineering. A minor change to the idea but seeking to incorporate saturation information was later proposed by Behie and Forsyth [8]. <p> We finally remark that M p is an exact left inverse of e J on the subspace spanned by the columns of R p . That is, p This is the preconditioner as stated by Wallis [52]. In contrast to the combinative method of Behie and Vinsome <ref> [9] </ref>, he proposes to solve the pressure system iteratively and formalizes the form of the operators f W p and R p .
Reference: [10] <author> A. Berman and R. Plemmons, </author> <title> Nonnegative matrices in the mathematical sciences, </title> <booktitle> in Classics in Applied Mathematics, </booktitle> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1994. </year>
Reference-contexts: The presence of slight compressibility ensures invertibility of the Jacobian matrix (further discussion about this issue is given in [5].) In general, in system (9), the block coefficients J pp ; J ps and J sp the following properties (see e.g., [2, 5] for further physical insights and <ref> [3, 10] </ref> for mathematical definitions and related theoretical results): * Diagonal dominance, * Positive diagonal entries and negative off-diagonal entries (i.e they are Z matrices), and * Irreducibility.
Reference: [11] <author> R. Bhogeswara and J. E. Killough, </author> <title> Domain decomposition and multigrid solvers for flow simulation in porous media on distributed memory parallel processors, </title> <journal> Journal of Scientific Computing, </journal> <volume> 7 (1992), </volume> <pages> pp. 127-162. </pages>
Reference-contexts: Meanwhile, developments on the concatenation or combination of inexact preconditioning stages have been proposed for general symmetric and nonsymmetric problems [51], but specially in the context of domain decomposition <ref> [11, 13, 36] </ref> for flow in porous media. These works, however, do not address the the topic of specialized preconditioners for coupled equations. In CFD the idea of using decoupled matrix blocks for the construction of precon-ditioners for iterative methods and for the implementation of solvers has been around longer.
Reference: [12] <author> P. Bjorstad, W. C. Jr., and E. Grosse, </author> <title> Parallel domain decomposition applied to coupled transport equations, in Seventh International Conference on Domain Decomposition Methods for Scientific Computing, </title> <editor> D. Keyes and J. Xu, eds., </editor> <address> Como, Italy, 1993, </address> <publisher> American Mathematical Society. </publisher>
Reference-contexts: Finally, we stress that this presentation can be easily extended to more unknowns sharing a given gridpoint (e.g., three phases and multi components systems.) 4.2. Properties of the partially decoupled blocks. In general, it is a difficult task (and in fact, an open problem in many related fields <ref> [1, 6, 12, 29, 40] </ref>) to characterize properties associated with the entire coupled Jacobian matrix and even more so if it has been affected by some of the operators described above.
Reference: [13] <author> P. Bjtrstad and T. K -arstad, </author> <title> Domain decomposition, parallel computinng and petroleum engineering, in Domain-based parallelism and problem decomposition methods in computational science and engineering, </title> <editor> D. Keyes, Y. Saad, and D. Truhlar, eds., </editor> <publisher> SIAM, </publisher> <year> 1995, </year> <pages> pp. 39-56. </pages>
Reference-contexts: Meanwhile, developments on the concatenation or combination of inexact preconditioning stages have been proposed for general symmetric and nonsymmetric problems [51], but specially in the context of domain decomposition <ref> [11, 13, 36] </ref> for flow in porous media. These works, however, do not address the the topic of specialized preconditioners for coupled equations. In CFD the idea of using decoupled matrix blocks for the construction of precon-ditioners for iterative methods and for the implementation of solvers has been around longer.
Reference: [14] <author> J. Bramble, J. Pasciak, and A. Vassilev, </author> <title> Analysis of the inexact Uzawa algorithm for saddle point problems, </title> <booktitle> in Copper Mountain Conference on Multgrid Methods, </booktitle> <year> 1995. </year>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> Recent developments in Krylov-subspace methods have also contributed to the renewed interest in this area. For example, the Uzawa algorithm has been around for more than 35 years and it was recently that some researchers formalized the inexact version of this algorithm <ref> [14, 28] </ref>. In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. [3, 43, 49, 50]. In this work, we use right preconditioning.
Reference: [15] <author> P. Brown and Y. Saad, </author> <title> Hybrid Krylov methods for nonlinear systems of equations, </title> <journal> SIAM J. Sci. Statist. Comput., </journal> <volume> 11 (1990), </volume> <pages> pp. 450-481. </pages>
Reference-contexts: Lately, Krylov subspace methods like BiCGSTAB, Chebyshev iterations TWO-STAGE PRECONDITIONERS 7 and GMRES have been employed as inner solvers for inexact Newton methods (see e.g., [33] and references therein.) The use of Krylov subspace methods as inexact solvers within the Newton method was consolidated in <ref> [15] </ref>. Since then, extensions to the theory have been rapidly appearing in the literature and bringing insight about the capabilities of Krylov subspace methods (mainly GMRES) in the developing of globalization strategies [17, 19, 27].
Reference: [16] <author> P. N. Brown, A. Hindmarsh, and L. Petzold, </author> <title> Using Krylov methods in the solution of large-scale differential-algebraic systems, </title> <journal> SIAM J. Sci. Comput., </journal> <volume> 15 (1994), </volume> <pages> pp. 1467-1488. </pages>
Reference-contexts: Moreover, this step can be also regarded as a scaling step for the coupled variables of the nonlinear function in a given Newton step. This incidentally improves the robustness of the whole Newton method. Further discussion on scaling within the Newton method can be seen in [24] and <ref> [16] </ref>. 5.2. Combinative two-stage preconditioner. Consider the two-step precon-ditioner M expressed as the solution of the preconditioned residual equation M p v = r. Also, denote e J W p f W p e J .
Reference: [17] <author> P. N. Brown and Y. Saad, </author> <title> Convergence theory of nonlinear Netwon-Krylov algorithms, </title> <journal> SIAM J. Optim., </journal> <volume> 4 (1994), </volume> <pages> pp. 297-330. REFERENCES 35 </pages>
Reference-contexts: Since then, extensions to the theory have been rapidly appearing in the literature and bringing insight about the capabilities of Krylov subspace methods (mainly GMRES) in the developing of globalization strategies <ref> [17, 19, 27] </ref>. Further description and several pointers into the literature of Krylov subspace iterative methods can be found in [7, 31]. Here, we just state some of the highlights of GMRES and BiCGSTAB.
Reference: [18] <author> R. Bru, V. Migallon, J. Penades, and D. Szyld, </author> <title> Parallel, synchronous and asynchronous two-stage multisplitting methods, </title> <journal> ETNA, Electronic Transactions on Numerical Analysis, </journal> <volume> 3 (1995), </volume> <pages> pp. 24-38. </pages>
Reference-contexts: We call these devices decoupling operators and use them as a preprocessing step to facilitate the effectiveness of two-stage preconditioners. We remark that different solvers or preconditioning strategies can be used as intermediate steps within this two-stage preconditioners. In fact, the idea can be generalized to multi-stage methods <ref> [18] </ref>. We do not pursue this idea further here, though. We rather center our attention on those two-stage algorithms that arise naturally in block type of preconditioning: block Jacobi, block Gauss-Seidel and Schur complement based. <p> They are also known as inner-outer or inexact iterations [22, 28, 32]. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners [3, 4, 43]. They have been also subject of study in parallel computing settings (e.g. see <ref> [18] </ref> and further references therein.) However, in the context of large-scale systems of coupled equations they strangely seem to have been overlooked. The renewed interest in using two-stage methods obeys primarily to the computational cost associated with solving large inner linear systems.
Reference: [19] <author> X.-C. Cai, W. Gropp, D. Keyes, and M. Tidriri, </author> <title> Newton-Krylov-Schwarz methods in CFD, in International Workshop on the Navier-Stokes Equations, </title> <editor> R. Rannacher, ed., Braun-schwieg, </editor> <booktitle> 1994, Notes in Numerical Fluid Mechanics, </booktitle> <publisher> Vieweg Verlag. </publisher>
Reference-contexts: Since then, extensions to the theory have been rapidly appearing in the literature and bringing insight about the capabilities of Krylov subspace methods (mainly GMRES) in the developing of globalization strategies <ref> [17, 19, 27] </ref>. Further description and several pointers into the literature of Krylov subspace iterative methods can be found in [7, 31]. Here, we just state some of the highlights of GMRES and BiCGSTAB.
Reference: [20] <author> T. F. Chan and T. Mathew, </author> <title> Domain decomposition algorithms, </title> <booktitle> in Acta Numerica, </booktitle> <publisher> Cambridge University Press, </publisher> <address> New York, </address> <year> 1994, </year> <pages> pp. 61-143. </pages>
Reference-contexts: 237 680.00 13.50 52 384 1678.13 13.50 80 16 2-S Mult. 103 305.63 13.50 52 90 392.75 13.50 79 fi 2-S BJ 52 58.66 0.09 52 37 61.77 0.09 80 2-S DP 21 49.91 0.13 63 17 52.27 0.13 85 for systems involving parabolic convection-difusion with moderate convective component (see <ref> [20] </ref> for detailed theory on the subject). Results like this are applicable in the algebraic setting of nonsymmetric M-matrices which are diagonally dominant. Additionally, convergence properties of overlapping schemes are better in 2-D than in 3-D, making them very appealing to solve the 2-D problems arising from the line-correction method.
Reference: [21] <author> C. Dawson, H. Kl ie, C. S. Soucie, and M. Wheeler, </author> <title> The numerical solution of two-phase flow problem in parallel. </title> <note> In preparation, </note> <year> 1995. </year>
Reference-contexts: In a similar way, y i+1=2 and z i+1=2 are defined. Higher degree of discretization has been considered in the context of IMPES formulations [45]. Dawson et al. <ref> [21] </ref> consider a 19-point stencil in space within a fully implicit parallel reservoir simulator to handle underground heterogeneities. They use a full permeability tensor implementation together with general boundary condition specifications within each subdomain. <p> Practical experiences of their work in the context of reservoir simulation are reported in <ref> [21] </ref>. 2.4. Iterative Method Framework. The typical problem sizes encountered in large-scale reservoir simulation rule out the use of direct methods to solve the linear systems arising in the Newton iteration. Consequently, inexact Newton methods are preferred.
Reference: [22] <author> R. Dembo, S. Eisenstat, and T. Steihaug, </author> <title> Inexact Newton methods, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 19 (1982), </volume> <pages> pp. 400-408. </pages>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> such case, we can assure that there is a 0 such that f (u k + s k ) &lt; f (u k ) for all 0 &lt; &lt; 0 : In practice, the final residual given by the iterative linear solver is acceptable whenever the Dembo-Eisenstat-Steihaug condition is met <ref> [22] </ref>, i.e., kr k k = kF (u k ) + J (u k ) s k k &lt; kF (u k )k ; 0 &lt; &lt; 1:(6) Heuristics to select the linear tolerances or forcing terms, k , in Step 2.1 have been subject to extensively detailed research by Eisenstat <p> Iterative Method Framework. The typical problem sizes encountered in large-scale reservoir simulation rule out the use of direct methods to solve the linear systems arising in the Newton iteration. Consequently, inexact Newton methods are preferred. Although the theory of inexact Newton solvers is relatively recent <ref> [22] </ref>, iterative methods such as SIP, SOR, CGS and ORTHOMIN have been of common practice in reservoir engineering for a number of years (see [39] for a general overview.) These four algorithms (and some others) have lost popularity over time on account of their lack of robustness in dealing with physical <p> The use of two-stage methods is not new (see e.g., [41] and references cited there). In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations <ref> [22, 28, 32] </ref>. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners [3, 4, 43].
Reference: [23] <author> J. Dendy, </author> <title> Multigrid methods for three dimensional petroleum reservoir simulation, in Tenth SPE Symposium on Reservoir Simulation, SPE paper no. </title> <type> 18409, </type> <institution> Houston, Texas, </institution> <year> 1989. </year>
Reference-contexts: Multigrid has been also investigated <ref> [23, 46] </ref> but its effectivity has only been shown for moderate rock heterogeneity and 2-D problems.
Reference: [24] <author> J. E. Dennis and R. B. Schnabel, </author> <title> Numerical methods for unconstrained optimization and nonlinear equations, </title> <publisher> Prentice-Hall, </publisher> <address> Englewood Cliffs, New Jersey, </address> <year> 1983. </year>
Reference-contexts: Here, the vector u represents unknowns in pressures and saturations of one particular phase. The composition of Newton with a Krylov iterative solver (such as GMRES or BiCGSTAB) with a criterion for defining linear tolerances dynamically, and a line-search backtracking strategy <ref> [24] </ref> is the basis of our inexact Newton algorithm. This algorithm is described as follows: Algorithm 2.1. 1. Let u 0 be an initial guess. 2. <p> Moreover, this step can be also regarded as a scaling step for the coupled variables of the nonlinear function in a given Newton step. This incidentally improves the robustness of the whole Newton method. Further discussion on scaling within the Newton method can be seen in <ref> [24] </ref> and [16]. 5.2. Combinative two-stage preconditioner. Consider the two-step precon-ditioner M expressed as the solution of the preconditioned residual equation M p v = r. Also, denote e J W p f W p e J .
Reference: [25] <author> R. Edwing, </author> <title> The mathematics of reservoir simulation, </title> <booktitle> in Frontiers in Applied Mathematics, </booktitle> <publisher> SIAM, </publisher> <address> Philadelphia, </address> <year> 1983. </year>
Reference-contexts: All other variables can then be computed explicitly based on these two. In the case of slight compressibility, it can be shown that the system is of mixed parabolic-hyperbolic character, with one nonlinear parabolic equation in terms of pressure and one nonlinear convection-diffusion equation in terms of saturation <ref> [25] </ref>. In this model, there are weak nonlinearities related to those variables that depend upon pressures of one phase (e.g., densities) and their effect depends on the degree of pressure change. <p> The above procedure follows the description by Wheeler and Smith [55] on developing a parallel black-oil simulator. Further insights about discretization of these equations can be found in [5] and <ref> [25] </ref>. 6 RAME, KLIE AND WHEELER 2.3. Newton formulation. The fully implicit formulation for the numerical solution of systems of nonlinear parabolic equations leads us to solving the following nonlinear problem for each time step F (u) = 0; where F : IR n ! IR n .
Reference: [26] <author> S. Eisenstat and H. Walker, </author> <title> Choosing the forcing terms in an inexact Newton method, </title> <type> Tech. Rep. </type> <institution> TR94-25, Dept. of Computational and Applied Mathematics, Rice University, </institution> <year> 1994. </year> <title> [27] , Globally convergent inexact Newton methods, </title> <journal> SIAM J. Optimization, </journal> <volume> 4 (1994), </volume> <pages> pp. 393-422. </pages>
Reference-contexts: k k = kF (u k ) + J (u k ) s k k &lt; kF (u k )k ; 0 &lt; &lt; 1:(6) Heuristics to select the linear tolerances or forcing terms, k , in Step 2.1 have been subject to extensively detailed research by Eisenstat and Walker <ref> [26, 27] </ref>. Practical experiences of their work in the context of reservoir simulation are reported in [21]. 2.4. Iterative Method Framework. The typical problem sizes encountered in large-scale reservoir simulation rule out the use of direct methods to solve the linear systems arising in the Newton iteration.
Reference: [28] <author> H. Elman and G. H. Golub, </author> <title> Inexact and preconditioned Uzawa algorithms for saddle point problems, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 31 (1994), </volume> <pages> pp. 1645-1661. </pages>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> The use of two-stage methods is not new (see e.g., [41] and references cited there). In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations <ref> [22, 28, 32] </ref>. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners [3, 4, 43]. <p> Recent developments in Krylov-subspace methods have also contributed to the renewed interest in this area. For example, the Uzawa algorithm has been around for more than 35 years and it was recently that some researchers formalized the inexact version of this algorithm <ref> [14, 28] </ref>. In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. [3, 43, 49, 50]. In this work, we use right preconditioning.
Reference: [29] <author> L. Elsner and V. Mehrmann, </author> <title> Convergence of block iterative methods for linear systems arising in the numerical solution of Euler equations, </title> <journal> Numer. Math., </journal> <volume> 59 (1991), </volume> <pages> pp. 541-559. </pages>
Reference-contexts: Finally, we stress that this presentation can be easily extended to more unknowns sharing a given gridpoint (e.g., three phases and multi components systems.) 4.2. Properties of the partially decoupled blocks. In general, it is a difficult task (and in fact, an open problem in many related fields <ref> [1, 6, 12, 29, 40] </ref>) to characterize properties associated with the entire coupled Jacobian matrix and even more so if it has been affected by some of the operators described above.
Reference: [30] <author> P. Forsyth and P. Sammon, </author> <title> Practical considerations for adaptive implicit methods in reservoir simulation, </title> <journal> J. of Comp. Physics, </journal> <volume> 62 (1986), </volume> <pages> pp. 265-281. </pages>
Reference-contexts: Discretization. Nowadays, reservoir simulators rely on a variety of dis-cretization schemes in time, ranging from the IMPES to the fully implicit formulations (see [5] and [39] for detailed discussions.) In between these two extremes, semi-implicit [42] and adaptive implicit discretizations have been proposed <ref> [30] </ref>. However, the fully implicit formulation offers the highest robustness among these possible alternatives in long term simulation. The main drawback of fully implicit methods resides in the solution of a large nonlinear system of equations.
Reference: [31] <author> R. Freund, G. Golub, and N. M. Nachtigal, </author> <title> Iterative solution of linear systems, </title> <booktitle> in Acta Numerica, </booktitle> <publisher> Cambridge University Press, </publisher> <address> New York, </address> <year> 1991, </year> <pages> pp. 57-100. </pages>
Reference-contexts: Further description and several pointers into the literature of Krylov subspace iterative methods can be found in <ref> [7, 31] </ref>. Here, we just state some of the highlights of GMRES and BiCGSTAB.
Reference: [32] <author> G. Golub and M. Overton, </author> <title> The convergence of inexact Chebyshev and Richardson iterative methods for solving linear systems, </title> <journal> Numer. Math., </journal> <volume> 53 (1988), </volume> <pages> pp. 571-593. </pages>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> The use of two-stage methods is not new (see e.g., [41] and references cited there). In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations <ref> [22, 28, 32] </ref>. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners [3, 4, 43].
Reference: [33] <author> S. Gomez and J. Morales, </author> <title> Performance of Chebyshev iterative method, GMRES and OR-THOMIN on a set of oil reservoir simulation problems, in Mathematics for Large Scale Computing, In J.C. Diaz, </title> <address> New York, Basel, </address> <year> 1989, </year> <pages> pp. 265-295. </pages>
Reference-contexts: Multigrid has been also investigated [23, 46] but its effectivity has only been shown for moderate rock heterogeneity and 2-D problems. Lately, Krylov subspace methods like BiCGSTAB, Chebyshev iterations TWO-STAGE PRECONDITIONERS 7 and GMRES have been employed as inner solvers for inexact Newton methods (see e.g., <ref> [33] </ref> and references therein.) The use of Krylov subspace methods as inexact solvers within the Newton method was consolidated in [15].
Reference: [34] <author> R. Hanby, D. Sylvester, and J. Chew, </author> <title> A comparison of coupled and segregated iterative solution techniques for incompressible swirling flow, </title> <type> Tech. Rep. </type> <institution> TR94-246, University of Manchester, </institution> <year> 1994. </year>
Reference-contexts: Along this trend, we have the well known IMPES (IMplicit Pressures-Explicit Saturations) formulation in reservoir simulation (see, e.g., [5]) and, for Navier-Stokes problems, the segregated methods in CFD <ref> [34, 35] </ref>. Such strategies can certainly be inspiring to generate preconditioners for coupled linear systems already treated under the fully implicit scheme. This geneal idea motivates the work we present in this paper.
Reference: [35] <author> V. Haroutunian, M. Engelman, and I. Hasbani, </author> <title> Segregated finite element algorithms for the numerical solution of large-scale incompressible flow problems, I. </title> <journal> J. for Numer. Meth. in Fluids., </journal> <volume> 17 (1993), </volume> <pages> pp. 323-348. </pages>
Reference-contexts: Along this trend, we have the well known IMPES (IMplicit Pressures-Explicit Saturations) formulation in reservoir simulation (see, e.g., [5]) and, for Navier-Stokes problems, the segregated methods in CFD <ref> [34, 35] </ref>. Such strategies can certainly be inspiring to generate preconditioners for coupled linear systems already treated under the fully implicit scheme. This geneal idea motivates the work we present in this paper. <p> In CFD the idea of using decoupled matrix blocks for the construction of precon-ditioners for iterative methods and for the implementation of solvers has been around longer. Segregated algorithms have been successfully applied for solving Navier-Stokes equations (see e.g., <ref> [35, 47] </ref> and references therein.) These methods rely upon the alternate solution of pressures and velocities or in the exhaustive solution of one of them to get a good overall solution of the problem. <p> In contrast to flow in porous media applications, the global discretized equation is never assembled and solved in its entirety for fully implicit formulations. Many variations are possible (see <ref> [35] </ref>) ranging from solving separately for each nodal unknown to solving simultaneously for all the degrees of freedom associated with one or more (but not all) of the primary unknowns.
Reference: [36] <author> J. Killough and M. Wheeler, </author> <title> Parallel iterative linear equation solvers: An investigation of domain decomposition solvers for reservoir simulation, </title> <booktitle> in Ninth SPE Symposium on Reservoir Simulation, </booktitle> <volume> SPE paper no. </volume> <pages> 16021, </pages> <address> San Antonio, Texas, </address> <year> 1987. </year>
Reference-contexts: Meanwhile, developments on the concatenation or combination of inexact preconditioning stages have been proposed for general symmetric and nonsymmetric problems [51], but specially in the context of domain decomposition <ref> [11, 13, 36] </ref> for flow in porous media. These works, however, do not address the the topic of specialized preconditioners for coupled equations. In CFD the idea of using decoupled matrix blocks for the construction of precon-ditioners for iterative methods and for the implementation of solvers has been around longer.
Reference: [37] <author> H. Kl ie, L. Pavarino, M. Ram e, C. S. Soucie, C. Dawson, and M. Wheeler, </author> <title> Precon-ditioners for Newton-Krylov methods for multiphase flows, </title> <booktitle> in Subsurface Modeling Group Industrial Affiliates Meeting, </booktitle> <month> August </month> <year> 1994. </year>
Reference-contexts: This residual is next improved by saturation solutions. Preliminary computational insights of these preconditioners were presented in <ref> [37] </ref>. In Fig. 7 and Fig. 8 we can observe the job that these preconditioners do in clustering the spectrum around the point (1; 0) of the complex plane.
Reference: [38] <author> H. Kl ie, M. Ram e, and M. Wheeler, </author> <title> Krylov-secant methods for solving systems of nonlinear equations, </title> <type> Tech. Rep. </type> <institution> TR95-27, Dept. of Computational and Applied Mathematics, Rice University, </institution> <year> 1995. </year>
Reference-contexts: This geneal idea motivates the work we present in this paper. The authors have recently formulated and evaluated a Hybrid Krylov Secant (HKS) method for solving nonlinear sets of equations <ref> [38] </ref>. The method represents a blend of a inexact Newton and a secant method but the key point in HKS that motivates the present work is as follows.
Reference: [39] <author> C. Mattax and R. Dalton, </author> <title> Reservoir Simulation, </title> <booktitle> vol. 13, SPE-Monograph Series, </booktitle> <address> Richardson, TX, </address> <year> 1990. </year>
Reference-contexts: However, for simplicity, we limit the presentation to a wetting (i.e., water) and a non-wetting (i.e., oil) phase, denoted by subscripts w and n, respectively. A more thorough description of the model can be found in [5] and <ref> [39] </ref>. <p> Discretization. Nowadays, reservoir simulators rely on a variety of dis-cretization schemes in time, ranging from the IMPES to the fully implicit formulations (see [5] and <ref> [39] </ref> for detailed discussions.) In between these two extremes, semi-implicit [42] and adaptive implicit discretizations have been proposed [30]. However, the fully implicit formulation offers the highest robustness among these possible alternatives in long term simulation. <p> Consequently, inexact Newton methods are preferred. Although the theory of inexact Newton solvers is relatively recent [22], iterative methods such as SIP, SOR, CGS and ORTHOMIN have been of common practice in reservoir engineering for a number of years (see <ref> [39] </ref> for a general overview.) These four algorithms (and some others) have lost popularity over time on account of their lack of robustness in dealing with physical conditions common in reservoir engineering applications of current interest.
Reference: [40] <author> R. Nabben, </author> <title> A new application for generalized M-matrices, in Numerical Linear Algebra, </title> <booktitle> proceedings of the conference in Linear Algebra and Scientific Computing, </booktitle> <editor> L. Reichel, A. Ruttan, and R. Varga, eds., </editor> <publisher> Walter de Gruyter, </publisher> <year> 1993. </year>
Reference-contexts: Finally, we stress that this presentation can be easily extended to more unknowns sharing a given gridpoint (e.g., three phases and multi components systems.) 4.2. Properties of the partially decoupled blocks. In general, it is a difficult task (and in fact, an open problem in many related fields <ref> [1, 6, 12, 29, 40] </ref>) to characterize properties associated with the entire coupled Jacobian matrix and even more so if it has been affected by some of the operators described above.
Reference: [41] <author> N. Nichols, </author> <title> On the convergence of two-stage iterative processes for solving linear equations, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 10 (1973), </volume> <pages> pp. 460-469. </pages>
Reference-contexts: Similar type of ideas has been developed in sequential formulations at the level of time discretization rather on the level of linear solvers or preconditioners for fully implicit formulation. The use of two-stage methods is not new (see e.g., <ref> [41] </ref> and references cited there). In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations [22, 28, 32].
Reference: [42] <author> J. Nolen and D. Berry, </author> <title> Test on the stability and time-step sensitivity of semi-implicit reservoir simulation techniques, </title> <journal> Trans. SPE of AIME, </journal> <volume> 253 (1973), </volume> <pages> pp. 253-266. 36 REFERENCES </pages>
Reference-contexts: Discretization. Nowadays, reservoir simulators rely on a variety of dis-cretization schemes in time, ranging from the IMPES to the fully implicit formulations (see [5] and [39] for detailed discussions.) In between these two extremes, semi-implicit <ref> [42] </ref> and adaptive implicit discretizations have been proposed [30]. However, the fully implicit formulation offers the highest robustness among these possible alternatives in long term simulation. The main drawback of fully implicit methods resides in the solution of a large nonlinear system of equations.
Reference: [43] <author> Y. Saad, </author> <title> A flexible inner-outer preconditioned GMRES algorithm, </title> <journal> SIAM J. Sci. Comput., </journal> <volume> 14 (1993), </volume> <pages> pp. 461-469. </pages>
Reference-contexts: Major challenges arise in connection to solving coupled sets of nonlinear equations as obtained by a fully implicit discretization of multi-phase models. In this work we focus our attention on two-stage procedures which are also known in the literature as nested or inner-outer procedures; see e.g., <ref> [3, 4, 14, 22, 28, 32, 43] </ref>. <p> In fact, these methods are known under different names and are scattered throughout the literature. They are also known as inner-outer or inexact iterations [22, 28, 32]. In the context of preconditioning they have been referred to as nonlinear, variable or inner-outer preconditioners <ref> [3, 4, 43] </ref>. They have been also subject of study in parallel computing settings (e.g. see [18] and further references therein.) However, in the context of large-scale systems of coupled equations they strangely seem to have been overlooked. <p> In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. <ref> [3, 43, 49, 50] </ref>. In this work, we use right preconditioning. It is well known that this form is preferable over left preconditioning for comparing different preconditioners since it makes the relative residual norms measured within the iterative solver invariant.
Reference: [44] <author> Y. Saad and M. Schultz, </author> <title> GMRES: A generalized minimal residual algorithm for solving nonsymmetric linear systems, </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 7 (1986), </volume> <pages> pp. 856-869. </pages>
Reference-contexts: Here, kk denotes the Euclidean norm. The GMRES algorithm works under the philosophy suggested by (7) whereas BiCGSTAB follows (8). We now proceed to briefly describe each one. 2.4.1. GMRES. The GMRES algorithm <ref> [44] </ref> generates a basis for the Krylov space through the Arnoldi process.
Reference: [45] <author> I. Taggart and W. Pinczewski, </author> <title> The use of higher-order differencing techniques in reservoir simulation, </title> <journal> SPE Reservoir Engineering, </journal> <month> (August </month> <year> 1987), </year> <pages> pp. 360-372. </pages>
Reference-contexts: In a similar way, y i+1=2 and z i+1=2 are defined. Higher degree of discretization has been considered in the context of IMPES formulations <ref> [45] </ref>. Dawson et al. [21] consider a 19-point stencil in space within a fully implicit parallel reservoir simulator to handle underground heterogeneities. They use a full permeability tensor implementation together with general boundary condition specifications within each subdomain.
Reference: [46] <author> R. Teigland and G. Fladmark, </author> <title> Cell centered multigrid methods in porous media flow, </title> <booktitle> in Multigrid methods III : proceedings of the 3rd European Multigrid Conference, </booktitle> <publisher> Birkhauser Verlag, </publisher> <year> 1991. </year>
Reference-contexts: Multigrid has been also investigated <ref> [23, 46] </ref> but its effectivity has only been shown for moderate rock heterogeneity and 2-D problems.
Reference: [47] <author> S. Turek, </author> <title> On discrete projection methods for the incompressible Navier-Stokes equations. </title> <note> In preparation, </note> <year> 1994. </year>
Reference-contexts: In CFD the idea of using decoupled matrix blocks for the construction of precon-ditioners for iterative methods and for the implementation of solvers has been around longer. Segregated algorithms have been successfully applied for solving Navier-Stokes equations (see e.g., <ref> [35, 47] </ref> and references therein.) These methods rely upon the alternate solution of pressures and velocities or in the exhaustive solution of one of them to get a good overall solution of the problem. <p> Among the several variants, we construct a third preconditioner inspired by the discrete projection method proposed by Turek <ref> [47] </ref> to solve saddle point formulations arising from the discretization of Navier-Stokes equations for the incompressible flow. <p> Thus, in agreement to the IMPES method we consider Algorithm 5.4 to give a more sound physical and numerical alternative. From now on, we refer to this preconditioner as discrete-projection two-stage preconditioner. The operator e J 1 ss is chosen to be computationally cheap. Turek <ref> [47] </ref> suggests e J 1 ss to be the inverse of the diagonal part of J ss (i.e. Jacobi preconditioner.) Fig. 10. Spectra of the Jacobian right-preconditioned by the exact version of the two-stage block Gauss-Seidel operator. 5.5. Relation between alternate and consecutive forms.
Reference: [48] <author> H. van der Vorst, </author> <title> BICGSTAB: a fast and smoothly convergent variant of BI-CG for the solution of nonsymmetric linear systems, </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 13 (1992), </volume> <pages> pp. 631-644. </pages>
Reference-contexts: Restarting GMRES after m steps (with m t n ) alleviates the problem but sacrifices its nice convergence properties. However, the restarted version of GMRES works well in practice specially with good preconditioning strategies. 2.4.2. Bi-CGSTAB. The BiCGSTAB algorithm <ref> [48] </ref> was developed to overcome the erratic converging behavior shown by the Conjugate Gradient Squared method (CGS) and the Bi-Conjugate Gradient method (Bi-CG.) In the Bi-CGSTAB algorithm the iterates are constructed in such a way that the residual r i is orthogonal with respect to a sequence of vectors f e
Reference: [49] <author> H. van der Vorst and C. Vuik, GMRESR: </author> <title> A Family of Nested GMRES Methods, </title> <type> Tech. Rep. </type> <institution> TR91-80, Technological University of Delft, </institution> <year> 1991. </year>
Reference-contexts: In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. <ref> [3, 43, 49, 50] </ref>. In this work, we use right preconditioning. It is well known that this form is preferable over left preconditioning for comparing different preconditioners since it makes the relative residual norms measured within the iterative solver invariant.
Reference: [50] <author> C. Vuik, </author> <title> Further experiences with GMRESR, </title> <type> Tech. Rep. </type> <institution> TR92-12, Technological University of Delft, </institution> <year> 1992. </year>
Reference-contexts: In same fashion, intensive work has been devoted to extending current nonsymmetric iterative solvers to be able to accommodate the inexactness or variability of the preconditioner from iteration to iteration; e.g. <ref> [3, 43, 49, 50] </ref>. In this work, we use right preconditioning. It is well known that this form is preferable over left preconditioning for comparing different preconditioners since it makes the relative residual norms measured within the iterative solver invariant.
Reference: [51] <author> J. Wallis, </author> <title> Constrained residual acceleration of conjugate residual methods, in Eigth SPE Symposium on Reservoir Simulation, SPE paper no. </title> <type> 13536, </type> <institution> Dallas, Texas, </institution> <year> 1985. </year> <title> [52] , Two-step preconditioning. </title> <type> Private Communication, </type> <year> 1993. </year>
Reference-contexts: Wallis refined the original algebraic presentation of these authors and proposed the iterative solution of the pressures in order to tackle larger reservoir simulation problems [52]. Meanwhile, developments on the concatenation or combination of inexact preconditioning stages have been proposed for general symmetric and nonsymmetric problems <ref> [51] </ref>, but specially in the context of domain decomposition [11, 13, 36] for flow in porous media. These works, however, do not address the the topic of specialized preconditioners for coupled equations.
Reference: [53] <author> J. Watts, </author> <title> A method of improving line succesive overrelaxation in anisotropic problems-a theoretical analysis, </title> <journal> Soc. of Pet. Eng. J., </journal> <year> (1973), </year> <pages> pp. 105-118. </pages>
Reference-contexts: In order to decrease the computational requirements of our preconditioners we can use the old but still effective method of line correction. This concept was first introduced in reservoir engineering by Watts <ref> [53] </ref>. The basic idea is to add the residuals in a given direction (collapsing) and then solve the reduced problem in a lower dimension. The solution should force the sum of the residuals in the collapsed direction to be zero.
Reference: [54] <author> A. Weiser and M. Wheeler, </author> <title> On convergence of block-centered finite differences for elliptic problems, </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 25 (1988), </volume> <pages> pp. 351-375. </pages>
Reference-contexts: We address their use as preconditioners for the several large sparse linear systems arising from the cell-centered finite difference or, equivalently, lowest-order mixed finite element discretization (with an appropiate quadrature rule; see <ref> [54] </ref>) and the subsequent Newton linearization of the coupled algebraic system of nonlinear equations. These linear systems (i.e., instances of Newton equations) are highly nonsymmetric and indefinite.
Reference: [55] <author> J. Wheeler and R. Smith, </author> <title> Reservoir simulation on a hypercube, </title> <booktitle> in 64th Annual Technical Conference and Exhibition of the Society of Petroleum Engineers, SPE paper no. </booktitle> <address> 19804, San Antonio, Texas, </address> <year> 1989. </year>
Reference-contexts: Some direct and indirect simplifications are performed, without affecting the validity of the numerical approximation, as result of small compressibility coefficients accompanying the linearized terms. The above procedure follows the description by Wheeler and Smith <ref> [55] </ref> on developing a parallel black-oil simulator. Further insights about discretization of these equations can be found in [5] and [25]. 6 RAME, KLIE AND WHEELER 2.3. Newton formulation.
References-found: 53

