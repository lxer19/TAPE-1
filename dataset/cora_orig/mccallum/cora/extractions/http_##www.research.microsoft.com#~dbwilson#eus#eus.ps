URL: http://www.research.microsoft.com/~dbwilson/eus/eus.ps
Refering-URL: http://www.research.microsoft.com/~dbwilson/eus/
Root-URL: http://www.research.microsoft.com
Email: propp@math.mit.edu  dbwilson@mit.edu  
Title: Exact Sampling with Coupled Markov Chains and Applications to Statistical Mechanics  
Author: James Gary Propp David Bruce Wilson 
Date: July 16, 1996  
Address: Cambridge, Massachusetts 02139  
Affiliation: Department of Mathematics Massachusetts Institute of Technology  
Abstract: For many applications it is useful to sample from a finite set of objects in accordance with some particular distribution. One approach is to run an ergodic (i.e., irreducible aperiodic) Markov chain whose stationary distribution is the desired distribution on this set; after the Markov chain has run for M steps, with M sufficiently large, the distribution governing the state of the chain approximates the desired distribution. Unfortunately it can be difficult to determine how large M needs to be. We describe a simple variant of this method that determines on its own when to stop, and that outputs samples in exact accordance with the desired distribution. The method uses couplings, which have also played a role in other sampling schemes; however, rather than running the coupled chains from the present into the future, one runs from a distant point in the past up until the present, where the distance into the past that one needs to go is determined during the running of the algorithm itself. If the state space has a partial order that is preserved under the moves of the Markov chain, then the coupling is often particularly efficient. Using our approach one can sample from the Gibbs distributions associated with various statistical mechanics models (including Ising, random-cluster, ice, and dimer) or choose uniformly at random from the elements of a finite distributive lattice. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> David Aldous. </author> <title> On simulating a Markov chain stationary distribution when transition probabilities are unknown, 1994. </title> <type> Preprint. </type>
Reference-contexts: It has not escaped our notice that the method of coupling from the past can be applied to the problem (also considered in [7], <ref> [1] </ref>, [44], and [3]) of randomly sampling from the steady state of a Markov chain whose transition-probabilities are unknown but whose transitions can be simulated or observed. This problem will be treated in two companion papers [61], [60]. 2. General Theory 2.1. <p> Note that this framework includes the case of full independence discussed earlier, since for example one could let the U t 's be i.i.d. variables taking their values in the n-cube <ref> [0; 1] </ref> n with uniform distribution, and let (i; u) be the smallest j such that p i;1 + p i;2 + + p i;j exceeds the ith component of the vector u. <p> One may concretely realize this update rule by putting f t (; u t ) = # if u t &lt; ( # )=(( # ) + ( " )) where t is the time, u t is some random variable distributed uniformly in <ref> [0; 1] </ref> (with all the u t 's independent of each other), and is some configuration of the system. If is attractive, then this realization of gives rise to a coupling-scheme that preserves the ordering (just use the same u t 's in all copies of the chain).
Reference: [2] <author> David Aldous and Persi Diaconis. </author> <title> Strong uniform times and finite random walks. </title> <booktitle> Advances in Applied Mathematics, </booktitle> <volume> 8(1) </volume> <pages> 69-97, </pages> <year> 1987. </year>
Reference-contexts: The mixing time threshold T mix is defined to be the smallest k for which d (k) 1=e [5]. Let l be the length of the longest chain in the partially ordered state space. Since d (k) is submultiplicative (see <ref> [2] </ref>), after k = T mix (1 + ln l) steps, d (k) 1=el, so Prob [T fl &gt; k] 1=e by Theorem 5, and by Lemma 7, Exp [T fl ] k=(1 1=e) &lt; 2k = 2T mix (1 + ln l): It has been noted [18] that many Markov
Reference: [3] <author> David Aldous, Laszlo Lovasz, and Peter Winkler. </author> <title> Fast mixing in a Markov chain, </title> <note> 1995. In preparation. </note>
Reference-contexts: It has not escaped our notice that the method of coupling from the past can be applied to the problem (also considered in [7], [1], [44], and <ref> [3] </ref>) of randomly sampling from the steady state of a Markov chain whose transition-probabilities are unknown but whose transitions can be simulated or observed. This problem will be treated in two companion papers [61], [60]. 2. General Theory 2.1.
Reference: [4] <author> David J. Aldous. </author> <title> A random walk construction of uniform spanning trees and uniform labelled trees. </title> <journal> SIAM Journal of Discrete Mathematics, </journal> <volume> 3(4) </volume> <pages> 450-465, </pages> <year> 1990. </year>
Reference-contexts: The first is the method for generating random spanning trees of finite graphs due to Broder [15] and Aldous <ref> [4] </ref> in conversations with Persi Diaconis. In this method one does a primary random walk on the graph and "shadows" it with a secondary random walk on the set of spanning trees.
Reference: [5] <author> David J. Aldous and James A. Fill. </author> <title> Reversible Markov Chains and Random Walks on Graphs. </title> <note> Book in preparation. </note>
Reference-contexts: steps is defined as the total variation distance k M k, i.e., as 1 2 i j M (i) (i)j, or equivalently as the maximum of j M (E) (E)j over all measurable events E; for more background on this and other basic facts about Markov chains, see [18] or <ref> [5] </ref>. <p> These two models are dual to one another, in the sense that each can be obtained from the other by simply reversing the direction of time (see <ref> [5] </ref>). As a corollary of the work above, the probability that voter i ends up as the leader is just the steady-state probability of state i in the original Markov chain. 2.2. <p> The mixing time threshold T mix is defined to be the smallest k for which d (k) 1=e <ref> [5] </ref>. Let l be the length of the longest chain in the partially ordered state space.
Reference: [6] <author> Noga Alon and Joel H. Spencer. </author> <title> The Probabilistic Method. </title> <publisher> John Wiley & Sons, Inc., </publisher> <year> 1992. </year> <title> With appendix by Paul Erd-os. </title>
Reference-contexts: In the case where all the spin sites are independent of one another, the trick of simultaneously sampling for all values of a parameter has been used for some time in the theory of random graphs <ref> [6, chapter 10] </ref> and percolation [28]. Holley [31] used an omnithermal Markov chain with two temperatures to give an alternate proof of the FKG inequality [24] governing attractive spin systems.
Reference: [7] <author> Stren Asmussen, Peter W. Glynn, and Hermann Thorisson. </author> <title> Stationary detection in the initial transient problem. </title> <journal> ACM Transactions on Modeling and Computer Simulation, </journal> <volume> 2(2) </volume> <pages> 130-157, </pages> <year> 1992. </year>
Reference-contexts: It has not escaped our notice that the method of coupling from the past can be applied to the problem (also considered in <ref> [7] </ref>, [1], [44], and [3]) of randomly sampling from the steady state of a Markov chain whose transition-probabilities are unknown but whose transitions can be simulated or observed. This problem will be treated in two companion papers [61], [60]. 2. General Theory 2.1.
Reference: [8] <author> Rodney J. Baxter. </author> <title> Exactly Solved Models in Statistical Mechanics. </title> <publisher> Academic Press, </publisher> <year> 1982. </year>
Reference-contexts: For example, carbon dioxide, xenon, and brass are thought to belong to the same universality class as the three-dimensional Ising model (see <ref> [8] </ref> and [12] and references contained therein). Other models that have received much attention include the Potts model [63] (which generalizes the Ising model) and the related random cluster model [23]. <p> that algorithm does not apply when different parts of the substance are subjected to magnetic fields of different polarity, which makes that algorithm less suitable for some applications, such as image processing.) The Ising model was introduced to model ferromagnetic substances; it is also equivalent to a lattice gas model <ref> [8] </ref>. An Ising system consists of a collection of n small interacting magnets, possibly in the presence of an external magnetic field. <p> Each magnet may be aligned up or down. (In general there are more directions that a magnet may point, but in crystals such as FeCl 2 and FeCO 3 there are in fact just two directions <ref> [8] </ref>.) Magnets that are close to each other prefer to be aligned in the same direction, and all magnets prefer to be aligned with the external magnetic field (which sometimes varies from site to site, but is often constant).
Reference: [9] <author> Julian Besag. </author> <title> On the statistical analysis of dirty pictures. </title> <journal> Journal of the Royal Statistical Society B, </journal> <volume> 48(3) </volume> <pages> 259-302, </pages> <year> 1986. </year>
Reference-contexts: The energy of a possible image depends on the observed pixel values, and nearby pixels tend to have similar values. Sampling from this Gibbs distribution can be effective in reducing noise. See [26] and <ref> [9] </ref> for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] [25] [33] [49] [46].
Reference: [10] <author> Julian Besag and Peter Clifford. </author> <title> Generalized Monte Carlo significance tests. </title> <journal> Biometrika, </journal> <volume> 76(4) </volume> <pages> 633-642, </pages> <year> 1989. </year>
Reference-contexts: Our scheme in effect uses the Markov chain in order to get an estimate of its own mixing time (cf. the work of Besag and Clifford <ref> [10] </ref>, who use a Markov chain to assess whether or not a given state was sampled from , while requiring and obtaining no knowledge of the Markov chain's mixing time).
Reference: [11] <author> Norman Biggs. </author> <title> Algebraic Graph Theory. </title> <publisher> Cambridge University Press, </publisher> <address> second edition, </address> <year> 1993. </year>
Reference-contexts: Random cluster model The random cluster model was introduced by Fortuin and Kasteleyn [23] and generalizes the Ising and Potts models. The random cluster model is also closely related to the Tutte polynomial of a graph (see <ref> [11] </ref>). The Ising state shown in Figure 1 was generated with the methods described here. In the random cluster model we have an undirected graph G, and the states of the system are subsets H of the edges of the graph. Often G is a two- or three-dimensional lattice.
Reference: [12] <author> J. J. Binney, N. J. Dowrick, A. J. Fisher, and M. E. J. Newman. </author> <title> The Theory of Critical Phenomena: An Introduction to the Renormalization Group. </title> <publisher> Oxford University Press, </publisher> <year> 1992. </year>
Reference-contexts: For example, carbon dioxide, xenon, and brass are thought to belong to the same universality class as the three-dimensional Ising model (see [8] and <ref> [12] </ref> and references contained therein). Other models that have received much attention include the Potts model [63] (which generalizes the Ising model) and the related random cluster model [23]. In Monte Carlo studies of phase transitions, it is essential to generate many random samples of the state of a system.
Reference: [13] <author> Anders Bjorner. </author> <title> Orderings of Coxeter groups. </title> <booktitle> In Combinatorics and Algebra, </booktitle> <pages> pages 175-195. </pages> <publisher> American Mathematical Society, </publisher> <year> 1984. </year> <note> Contemporary Mathematics, #34. </note>
Reference-contexts: It is clear that this Markov chain is ergodic and preserves the desired probability distribution. Define a partial order on S n by &lt; if and only if can be obtained from by sorting adjacent elements (this is called the weak Bruhat order <ref> [13] </ref>). The bottom element is the identity permutation ^ 0 : i 7! i and the top element is the totally reversing permutation ^ 1 : i 7! n + 1 i.
Reference: [14] <author> H. W. J. Blote and H. J. Hilhorst. </author> <title> Roughening transitions and the zero-temperature triangular Ising antiferromagnet. </title> <journal> Journal of Physics A, </journal> <volume> 15(11):L631-L637, </volume> <year> 1982. </year>
Reference-contexts: This approach can be traced back to Levitov [39] and Zheng and Sachdev [64] in the case of the square lattice, and to Blote and Hilhorst <ref> [14] </ref> in the case of the hexagonal lattice. An independent development is due to Thurston [57], building on earlier work of Conway [17]. A generalization of this technique is described in [47].
Reference: [15] <author> Andrei Broder. </author> <title> Generating random spanning trees. </title> <booktitle> In Foundations of Computer Science, </booktitle> <pages> pages 442-447, </pages> <year> 1989. </year> <month> 24 </month>
Reference-contexts: The first is the method for generating random spanning trees of finite graphs due to Broder <ref> [15] </ref> and Aldous [4] in conversations with Persi Diaconis. In this method one does a primary random walk on the graph and "shadows" it with a secondary random walk on the set of spanning trees.
Reference: [16] <author> Henry Cohn, Noam Elkies, and James Propp. </author> <title> Local statistics for random domino tilings of the Aztec diamond. </title> <journal> Duke Mathematical Journal, </journal> <note> 1996. To appear. </note>
Reference-contexts: The heterogeneity of the statistics is a consequence of the "non-flatness" of the height function on the boundary; this phenomenon is given a more detailed study in <ref> [16] </ref>. The tiling was generated using software written by the first author's undergraduate research assistants, using the methods described in this article.
Reference: [17] <author> John Conway and Jeffrey Lagarias. </author> <title> Tiling with polyominoes and combinatorial group theory. </title> <journal> Journal of Combinatorial Theory, series A, </journal> <volume> 53 </volume> <pages> 183-208, </pages> <year> 1990. </year>
Reference-contexts: This approach can be traced back to Levitov [39] and Zheng and Sachdev [64] in the case of the square lattice, and to Blote and Hilhorst [14] in the case of the hexagonal lattice. An independent development is due to Thurston [57], building on earlier work of Conway <ref> [17] </ref>. A generalization of this technique is described in [47]. Thurston's article describes the construction not in terms of dimer models (or equivalently perfect matchings of graphs) but rather in terms of tilings.
Reference: [18] <author> Persi Diaconis. </author> <title> Group Representations in Probability and Statistics. </title> <institution> Institute of Mathematical Statistics, </institution> <year> 1988. </year>
Reference-contexts: for M steps is defined as the total variation distance k M k, i.e., as 1 2 i j M (i) (i)j, or equivalently as the maximum of j M (E) (E)j over all measurable events E; for more background on this and other basic facts about Markov chains, see <ref> [18] </ref> or [5]. <p> Recently there has been much work at analyzing the rates of convergence of Markov chains <ref> [18] </ref> [34] [20] [43] [50] [19] [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior. <p> Permutations. For certain statistical applications, it is useful to sample permutations 2 S n on n items such that the probability of is proportional to q inv () ; this is sometimes called "Mallows' phi model through Kendall's tau". For background see [37] and <ref> [18] </ref> and the references contained therein. Recall that inv () denotes the number of inversions of , that is, the number of pairs (i; j) such that i &lt; j and (i) &gt; (j). We represent the permutation by the n-tuple [(1); : : :; (n)]. <p> is submultiplicative (see [2]), after k = T mix (1 + ln l) steps, d (k) 1=el, so Prob [T fl &gt; k] 1=e by Theorem 5, and by Lemma 7, Exp [T fl ] k=(1 1=e) &lt; 2k = 2T mix (1 + ln l): It has been noted <ref> [18] </ref> that many Markov chains exhibit a sharp threshold phenomenon: after (1 ")T mix steps the state is very far from being random, but after (1 + ")T mix steps the state is very close to being random (i.e. d (k) is close to 0).
Reference: [19] <author> Persi Diaconis and Laurent Saloff-Coste. </author> <booktitle> What do we know about the Metropolis algorithm? In ACM Symposium on the Theory of Computing, </booktitle> <pages> pages 112-129, </pages> <year> 1995. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] [34] [20] [43] [50] <ref> [19] </ref> [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [20] <author> Persi Diaconis and Daniel Stroock. </author> <title> Geometric bounds for eigenvalues of Markov chains. </title> <journal> The Annals of Applied Probability, </journal> <volume> 1(1) </volume> <pages> 36-61, </pages> <year> 1991. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] [34] <ref> [20] </ref> [43] [50] [19] [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [21] <author> Persi Diaconis and Bernd Sturmfels. </author> <title> Algebraic algorithms for sampling from conditional distributions. </title> <journal> The Annals of Statistics. </journal> <note> To appear. </note>
Reference-contexts: One instance of the first sort of motivation is the work of Diaconis and Sturmfels on design of chi-squared tests for arrays of non-negative integers with fixed row-and column-sums <ref> [21] </ref>; instances of the second sort of motivation are seen in the work of the first author and others on domino tilings [35] [45] and in the vast literature on Monte Carlo simulations in physics (Sokal gives a survey [51]).
Reference: [22] <author> Stefan Felsner and Lorenz Wernisch. </author> <title> Markov chains for linear extensions, the two-dimensional case, 1996. </title> <type> Manuscript. </type>
Reference-contexts: Given two permutations 1 and 2 with 1 2 , the random walk is restricted to those permutations such that 1 2 . This Markov chain can be used to sample random linear extensions of a two-dimensional partially ordered set <ref> [22] </ref>. Independent sets.
Reference: [23] <author> C. M. Fortuin and P. W. Kasteleyn. </author> <title> On the random cluster model. I. Introduction and relation to other models. </title> <journal> Physica, </journal> <volume> 57(4) </volume> <pages> 536-564, </pages> <year> 1972. </year>
Reference-contexts: Other models that have received much attention include the Potts model [63] (which generalizes the Ising model) and the related random cluster model <ref> [23] </ref>. In Monte Carlo studies of phase transitions, it is essential to generate many random samples of the state of a system. Sampling methods include the Metropolis algorithm and multi-grid versions of it. <p> Random cluster model The random cluster model was introduced by Fortuin and Kasteleyn <ref> [23] </ref> and generalizes the Ising and Potts models. The random cluster model is also closely related to the Tutte polynomial of a graph (see [11]). The Ising state shown in Figure 1 was generated with the methods described here.
Reference: [24] <author> C. M. Fortuin, P. W. Kasteleyn, and J. Ginibre. </author> <title> Correlation inequalites on some partially ordered sets. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 22 </volume> <pages> 89-103, </pages> <year> 1971. </year>
Reference-contexts: Holley [31] used an omnithermal Markov chain with two temperatures to give an alternate proof of the FKG inequality <ref> [24] </ref> governing attractive spin systems. More recently Grimmett has given a monotone omnithermal Markov chain for the bond-correlated percolation model [29] (another name for the random cluster model described in subsection 4.2) and used it to derive a number of properties about these systems.
Reference: [25] <author> Arnoldo Frigessi, Chii-Ruey Hwang, Shuenn-Jyi Sheu, and Patrizia di Stefano. </author> <title> Convergence rates of the Gibbs sampler, the Metropolis algorithm and other single-site updating dynamics. </title> <journal> Journal of the Royal Statistical Society B, </journal> <volume> 55(1) </volume> <pages> 205-219, </pages> <year> 1993. </year>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] <ref> [25] </ref> [33] [49] [46].
Reference: [26] <author> Stuart Geman and Donald Geman. </author> <title> Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images. </title> <journal> IEEE Transactions on Pattern Analysis and Machine Intelligence, </journal> <volume> PAMI-6(6):721-724, </volume> <year> 1984. </year>
Reference-contexts: The energy of a possible image depends on the observed pixel values, and nearby pixels tend to have similar values. Sampling from this Gibbs distribution can be effective in reducing noise. See <ref> [26] </ref> and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] [25] [33] [49] [46].
Reference: [27] <author> David Griffeath. </author> <title> Additive and Cancellative Interacting Particle Systems. </title> <publisher> Springer-Verlag, </publisher> <year> 1979. </year> <note> Lecture Notes in Mathematics, #724. </note>
Reference-contexts: A standard example of this duality is the relationship between the coalescing random walk model and the voter model generalized to weighted directed graphs (see [32], <ref> [27] </ref>, [41]).
Reference: [28] <author> Geoffrey Grimmett. </author> <title> Percolation. </title> <publisher> Springer-Verlag, </publisher> <year> 1989. </year>
Reference-contexts: In the case where all the spin sites are independent of one another, the trick of simultaneously sampling for all values of a parameter has been used for some time in the theory of random graphs [6, chapter 10] and percolation <ref> [28] </ref>. Holley [31] used an omnithermal Markov chain with two temperatures to give an alternate proof of the FKG inequality [24] governing attractive spin systems.
Reference: [29] <author> Geoffrey Grimmett. </author> <title> The stochastic random-cluster process and the uniqueness of random-cluster measures. </title> <journal> The Annals of Probability, </journal> <volume> 23(4) </volume> <pages> 1461-1510, </pages> <year> 1995. </year> <note> Special invited paper. </note>
Reference-contexts: Holley [31] used an omnithermal Markov chain with two temperatures to give an alternate proof of the FKG inequality [24] governing attractive spin systems. More recently Grimmett has given a monotone omnithermal Markov chain for the bond-correlated percolation model <ref> [29] </ref> (another name for the random cluster model described in subsection 4.2) and used it to derive a number of properties about these systems. Interestingly, Grimmett's Markov chain is different from the omnithermal heat bath chain. See subsection 4.2 for further discussion of omnithermal sampling and its uses. 3.2.
Reference: [30] <author> Monika Rauch Henzinger and Valerie King. </author> <title> Randomized dynamic algorithms with polyloga-rithmic time per operation. </title> <booktitle> In ACM Symposium on the Theory of Computing, </booktitle> <pages> pages 519-527, </pages> <year> 1995. </year>
Reference-contexts: Hence the partial order is preserved, and our approach can be applied. We have been unable to find monotonicity in the Swendsen-Wang or Wolff algorithms. Recent developments in dynamic connectivity algorithms <ref> [30] </ref> may make the single-bond heat bath algorithm a viable option, given that one can obtain exact samples at effectively all temperatures simultaneously using the heat bath algorithm. (See the discussion at the end of subsection 3.1.) Our implementation of the monotone coupling-from-the-past version of the single-bond heat bath algorithm, in
Reference: [31] <author> Richard Holley. </author> <title> Remarks on the FKG inequalities. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 36 </volume> <pages> 227-231, </pages> <year> 1974. </year>
Reference-contexts: In the case where all the spin sites are independent of one another, the trick of simultaneously sampling for all values of a parameter has been used for some time in the theory of random graphs [6, chapter 10] and percolation [28]. Holley <ref> [31] </ref> used an omnithermal Markov chain with two temperatures to give an alternate proof of the FKG inequality [24] governing attractive spin systems.
Reference: [32] <author> Richard Holley and Thomas Liggett. </author> <title> Ergodic theorems for weakly interacting systems and the voter model. </title> <journal> Annals of Probability, </journal> <volume> 3 </volume> <pages> 643-663, </pages> <year> 1975. </year> <month> 25 </month>
Reference-contexts: A standard example of this duality is the relationship between the coalescing random walk model and the voter model generalized to weighted directed graphs (see <ref> [32] </ref>, [27], [41]).
Reference: [33] <author> Salvatore Ingrassia. </author> <title> On the rate of convergence of the Metropolis algorithm and Gibbs sampler by geometric bounds. </title> <journal> The Annals of Applied Probability, </journal> <volume> 4(2) </volume> <pages> 347-389, </pages> <year> 1994. </year>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] [25] <ref> [33] </ref> [49] [46].
Reference: [34] <author> Mark Jerrum and Alistair Sinclair. </author> <title> Approximating the permanent. </title> <journal> SIAM Journal on Computing, </journal> <volume> 18(6) </volume> <pages> 1149-1178, </pages> <year> 1989. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] <ref> [34] </ref> [20] [43] [50] [19] [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [35] <author> William Jockusch, James Propp, and Peter Shor. </author> <title> Random domino tilings and the arctic circle theorem, 1995. </title> <type> Preprint. </type>
Reference-contexts: instance of the first sort of motivation is the work of Diaconis and Sturmfels on design of chi-squared tests for arrays of non-negative integers with fixed row-and column-sums [21]; instances of the second sort of motivation are seen in the work of the first author and others on domino tilings <ref> [35] </ref> [45] and in the vast literature on Monte Carlo simulations in physics (Sokal gives a survey [51]). <p> This permits us to study the effects that the imposition of boundary conditions can have even well away from the boundary. One such phenomenon is the "arctic circle effect" described in <ref> [35] </ref>; using our random-generation procedure we have been able to ascertain that such domain-wall effects are fairly general, albeit associated with boundary conditions that may be deemed non-physical.
Reference: [36] <author> Valen E. Johnson. </author> <title> Testing for convergence of Markov chain Monte Carlo algorithms using parallel sample paths, 1995. </title> <type> Preprint. </type>
Reference-contexts: We call this the monotone Monte Carlo technique. Often there is a unique minimal element and a unique maximal element, so only two histories need to be simulated. (For a related approach, see <ref> [36] </ref>.) In the case of finite spin-systems, there are a finite number of sites and each state is a configuration that assigns one of two spins ("up" or "down") to every site, and so there is a natural partial ordering with unique maximal and minimal elements. <p> This approach was foreshadowed by the work of Valen Johnson <ref> [36] </ref>, and it has been used by Kim, Shor, and Winkler [38] in their work on random independent subsets of certain graphs; see subsection 3.3. Indeed, if one chooses M large enough, the bias in one's sample can be made as small as one wishes.
Reference: [37] <author> Maurice G. Kendall. </author> <title> Rank Correlation Methods. </title> <publisher> Hafner Publishing Company, </publisher> <address> third edition, </address> <year> 1962. </year>
Reference-contexts: Permutations. For certain statistical applications, it is useful to sample permutations 2 S n on n items such that the probability of is proportional to q inv () ; this is sometimes called "Mallows' phi model through Kendall's tau". For background see <ref> [37] </ref> and [18] and the references contained therein. Recall that inv () denotes the number of inversions of , that is, the number of pairs (i; j) such that i &lt; j and (i) &gt; (j). We represent the permutation by the n-tuple [(1); : : :; (n)].
Reference: [38] <author> Jeong Han Kim, Peter Shor, and Peter Winkler. </author> <type> Personal communication. </type>
Reference-contexts: This approach was foreshadowed by the work of Valen Johnson [36], and it has been used by Kim, Shor, and Winkler <ref> [38] </ref> in their work on random independent subsets of certain graphs; see subsection 3.3. Indeed, if one chooses M large enough, the bias in one's sample can be made as small as one wishes. <p> However, in the case where G is bipartite, a pretty trick of Kim, Shor, and Winkler <ref> [38] </ref> permits us to apply our methods. Specifically, let us suppose that the vertices of G have been classified as white and black, so that every edge joins vertices of opposite color.
Reference: [39] <author> L. S. Levitov. </author> <title> Equivalence of the dimer resonating-valence-bond problem to the quantum roughening problem. </title> <journal> Physical Review Letters, </journal> <volume> 64(1) </volume> <pages> 92-94, </pages> <year> 1990. </year>
Reference-contexts: Here, as in the case of ice-models, one can introduce a height function that encodes the combinatorial structure and makes it possible to view the states as elements of a distributive lattice. This approach can be traced back to Levitov <ref> [39] </ref> and Zheng and Sachdev [64] in the case of the square lattice, and to Blote and Hilhorst [14] in the case of the hexagonal lattice. An independent development is due to Thurston [57], building on earlier work of Conway [17]. A generalization of this technique is described in [47].
Reference: [40] <author> Elliott Lieb. </author> <title> Residual entropy of square ice. </title> <journal> Physical Review, </journal> <volume> 162 </volume> <pages> 162-172, </pages> <year> 1967. </year>
Reference-contexts: Data points are given for 2 32 distinct values of the temperature, and are the result of a single simulation. 4.3. Ice and dimer models In the square ice (or "six-vertex") model whose residual entropy was determined by Lieb <ref> [40] </ref>, states are assignments of orientation to the edges of a square grid, such that at each internal vertex there are equal numbers of incoming and outgoing edges (the "ice condition").
Reference: [41] <author> Thomas Liggett. </author> <title> Interacting Particle Systems. </title> <publisher> Springer-Verlag, </publisher> <year> 1985. </year>
Reference-contexts: When the distribution on the state-space is attractive (a term we will define precisely in subsection 3.1), then the heat bath algorithm on the spin-system preserves the ordering (compare with section III.2 of <ref> [41] </ref>). In this situation, the idea of simulating from the past and the monotone Monte Carlo technique work together smoothly and lead to a procedure for exact sampling. <p> A standard example of this duality is the relationship between the coalescing random walk model and the voter model generalized to weighted directed graphs (see [32], [27], <ref> [41] </ref>).
Reference: [42] <author> Torgny Lindvall. </author> <title> Lectures on the Coupling Method. </title> <publisher> John Wiley & Sons, Inc., </publisher> <year> 1992. </year>
Reference-contexts: The versatility of the coupling method lies in the amount of freedom one has in choosing the statistics of the coupling (see <ref> [42] </ref> for background on couplings). Our approach is to simulate the Markov chain by performing random moves until some predetermined amount of time has elapsed, in the hope that all the states will "coalesce" in that time; if they do, we can output the resulting coalescent state as our sample.
Reference: [43] <author> Laszlo Lovasz and Miklos Simonovits. </author> <title> On the randomized complexity of volume and diameter. </title> <booktitle> In Foundations of Computer Science, </booktitle> <pages> pages 482-491, </pages> <year> 1992. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] [34] [20] <ref> [43] </ref> [50] [19] [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [44] <author> Laszlo Lovasz and Peter Winkler. </author> <title> Exact mixing in an unknown Markov chain. </title> <journal> Electronic Journal of Combinatorics, </journal> <volume> 2, </volume> <year> 1995. </year> <note> Paper #R15. </note>
Reference-contexts: It has not escaped our notice that the method of coupling from the past can be applied to the problem (also considered in [7], [1], <ref> [44] </ref>, and [3]) of randomly sampling from the steady state of a Markov chain whose transition-probabilities are unknown but whose transitions can be simulated or observed. This problem will be treated in two companion papers [61], [60]. 2. General Theory 2.1. <p> of calls to M arkov () may also be reduced, and in a companion paper [61] we will show that the procedure can be modified so that its expected running time is bounded by a fixed multiple of the so-called cover time of the Markov chain (for a definition see <ref> [44] </ref>). Theorem 1 With probability 1 the coupling-from-the-past protocol returns a value, and this value is distributed according to the stationary distribution of the Markov chain.
Reference: [45] <author> Michael Luby, Dana Randall, and Alistair Sinclair. </author> <title> Markov chain algorithms for planar lattice structures (extended abstract). </title> <booktitle> In Foundations of Computer Science, </booktitle> <pages> pages 150-159, </pages> <year> 1995. </year>
Reference-contexts: of the first sort of motivation is the work of Diaconis and Sturmfels on design of chi-squared tests for arrays of non-negative integers with fixed row-and column-sums [21]; instances of the second sort of motivation are seen in the work of the first author and others on domino tilings [35] <ref> [45] </ref> and in the vast literature on Monte Carlo simulations in physics (Sokal gives a survey [51]).
Reference: [46] <author> F. Martinelli, E. Olivieri, and R. H. Schonmann. </author> <title> For 2-d lattice spin systems weak mixing implies strong mixing. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 165(1) </volume> <pages> 33-47, </pages> <year> 1994. </year>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] [25] [33] [49] <ref> [46] </ref>.
Reference: [47] <author> James Propp. </author> <title> Lattice structure for orientations of graphs, 1993. </title> <type> Preprint. </type>
Reference-contexts: set of elements of any finite distributive lattice (see subsection 3.2); this 2 is in fact a more useful class of applications than one might at first suppose, since many interesting combinatorial structures can be viewed as elements of a distributive lattice in a non-obvious way (see subsection 3.3 and <ref> [47] </ref>). Section 4 contains our main applications, in which the desired distribution is the Gibbs distribution for a statistical mechanics model. <p> The set of height functions with prescribed boundary conditions can be shown to form a distributive lattice under the natural operations of taking the maximum or minimum of the heights of two height functions at all the various points in the grid <ref> [47] </ref>. Hence one can sample from the uniform distribution on the set of such height functions, and thereby obtain a random sample from the set of ice-configurations. <p> An independent development is due to Thurston [57], building on earlier work of Conway [17]. A generalization of this technique is described in <ref> [47] </ref>. Thurston's article describes the construction not in terms of dimer models (or equivalently perfect matchings of graphs) but rather in terms of tilings.
Reference: [48] <author> Jeffrey S. Rosenthal. </author> <title> Minorization conditions and convergence rates for Markov chain Monte Carlo. </title> <journal> Journal of the American Statistical Association, </journal> <volume> 90(430) </volume> <pages> 558-566, </pages> <year> 1995. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] [34] [20] [43] [50] [19] <ref> [48] </ref> but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [49] <author> Roberto H. Schonmann. </author> <title> Slow droplet-driven relaxation of stochastic Ising models in the vicinity of the phase coexistence region. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 161(1) </volume> <pages> 1-49, </pages> <year> 1994. </year>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] [53] [25] [33] <ref> [49] </ref> [46].
Reference: [50] <author> Alistair Sinclair. </author> <title> Algorithms for Random Generation and Counting: A Markov Chain Approach. </title> <publisher> Birkhauser, </publisher> <year> 1993. </year>
Reference-contexts: Recently there has been much work at analyzing the rates of convergence of Markov chains [18] [34] [20] [43] <ref> [50] </ref> [19] [48] but this remains an arduous undertaking. Thus, an experimenter who is using such random walk methods faces the risk that the Markov chain has not yet had time to equilibrate, and that it is exhibiting metastable behavior rather than true equilibrium behavior.
Reference: [51] <author> Alan D. Sokal. </author> <title> Monte Carlo methods in statistical mechanics: </title> <booktitle> Foundations and new algorithms, </booktitle> <year> 1989. </year> <institution> Lecture notes from Cours de Troisieme Cycle de la Physique en Suisse Romande. </institution>
Reference-contexts: chi-squared tests for arrays of non-negative integers with fixed row-and column-sums [21]; instances of the second sort of motivation are seen in the work of the first author and others on domino tilings [35] [45] and in the vast literature on Monte Carlo simulations in physics (Sokal gives a survey <ref> [51] </ref>). <p> A dramatic illustration of our approach is given in subsection 4.2, where we show (using a clever trick due to Fortuin and Kasteleyn) that one can sample from the Gibbs distribution (see <ref> [51] </ref> and below) on the set of states of a general ferromagnetic Ising model in any number of dimensions without being subject to the "critical slowing down" that besets more straightforward approaches. <p> To derive a random q-spin Potts state from a random H, one assigns a common random 16 spin to all the vertices lying in any given connected component (see Sokal's survey <ref> [51] </ref> for more information on this). Sweeny [54] used the results of Fortuin and Kasteleyn to generate random q-spin Potts states near the critical temperature. He used the "single-bond heat bath" algorithm (i.e. Glauber dynamics) to sample from the random cluster model, and then converted these samples into Potts states.
Reference: [52] <author> Richard P. Stanley. </author> <booktitle> Enumerative Combinatorics, </booktitle> <volume> volume 1. </volume> <publisher> Wadsworth, Inc., </publisher> <year> 1986. </year>
Reference-contexts: The set of order ideals of P is denoted by J (P ); it is a distributive lattice under the operations of union and intersection, and it is a standard theorem (see <ref> [52] </ref>) that every finite distributive lattice is of the form J (P ) for some finite partially ordered set P . <p> It so happens in this case that one can work out exactly what the constant of proportionality is, because one can sum q # of inversions over all lattice-paths with two fixed endpoints (these are the coefficients of the so-called "Gaussian binomial coefficients" <ref> [52] </ref>), and as a result of this there exists an efficient bounded-time procedure for generating a random q-weighted lattice-path. However, one also has the option of making use of coupling-from-the-past, as we now explain. <p> The bottom element is the identity permutation ^ 0 : i 7! i and the top element is the totally reversing permutation ^ 1 : i 7! n + 1 i. The above Markov chain is a random walk on the Hasse diagram of this partial order. (See <ref> [52] </ref> for background on partially ordered sets.) This Markov chain, coupled with itself in the obvious way, does not preserve the partial order, even on S 3 . However, it is still true that when the top and bottom states coalesce, all states have coalesced, as we will show below.
Reference: [53] <author> Daniel W. Stroock and Boguslaw Zegarlinski. </author> <title> The logarithmic Sobolev inequality for discrete spin systems on a lattice. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 149(1) </volume> <pages> 175-193, </pages> <year> 1992. </year> <month> 26 </month>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study [56] <ref> [53] </ref> [25] [33] [49] [46].
Reference: [54] <author> Mark Sweeny. </author> <title> Monte Carlo study of weighted percolation clusters relevant to the Potts models. </title> <journal> Physical Review B, </journal> <volume> 27(7) </volume> <pages> 4445-4455, </pages> <year> 1983. </year>
Reference-contexts: To derive a random q-spin Potts state from a random H, one assigns a common random 16 spin to all the vertices lying in any given connected component (see Sokal's survey [51] for more information on this). Sweeny <ref> [54] </ref> used the results of Fortuin and Kasteleyn to generate random q-spin Potts states near the critical temperature. He used the "single-bond heat bath" algorithm (i.e. Glauber dynamics) to sample from the random cluster model, and then converted these samples into Potts states.
Reference: [55] <author> Robert H. Swendsen and Jian-Sheng Wang. </author> <title> Nonuniversal critical dynamics in Monte Carlo simulations. </title> <journal> Physical Review Letters, </journal> <volume> 58(2) </volume> <pages> 86-88, </pages> <year> 1987. </year>
Reference-contexts: It turns out that the random clusters are in some ways more directly informative than the Potts states themselves, since for instance they can be used to obtain more precise information on spin correlations. Swendsen and Wang <ref> [55] </ref> proposed a different Markov chain based on the relation between the random cluster and Potts models. Given a random-cluster sample, they compute a random Potts state consistent with the clusters. Given a Potts state, they compute a random subgraph of G consistent with the Potts state.
Reference: [56] <author> Lawrence E. Thomas. </author> <title> Bound on the mass gap for finite volume stochastic Ising models at low temperature. </title> <journal> Communications in Mathematical Physics, </journal> <volume> 126(1) </volume> <pages> 1-11, </pages> <year> 1989. </year>
Reference-contexts: See [26] and [9] for more information. 4.1. The Ising model Here we introduce the Ising model and the single-site heat bath algorithm for sampling from it. The efficiency of the heat bath algorithm has been the object of much study <ref> [56] </ref> [53] [25] [33] [49] [46].
Reference: [57] <author> William Thurston. </author> <title> Conway's tiling groups. </title> <journal> American Mathematical Monthly, </journal> <volume> 97 </volume> <pages> 757-773, </pages> <year> 1990. </year>
Reference-contexts: This approach can be traced back to Levitov [39] and Zheng and Sachdev [64] in the case of the square lattice, and to Blote and Hilhorst [14] in the case of the hexagonal lattice. An independent development is due to Thurston <ref> [57] </ref>, building on earlier work of Conway [17]. A generalization of this technique is described in [47]. Thurston's article describes the construction not in terms of dimer models (or equivalently perfect matchings of graphs) but rather in terms of tilings.
Reference: [58] <author> Henk van Beijeren. </author> <title> Exactly solvable model for the roughening transition of a crystal surface. </title> <journal> Physical Review Letters, </journal> <volume> 38(18) </volume> <pages> 993-996, </pages> <year> 1977. </year>
Reference-contexts: to j if and only if j is the higher of the two vertices. (If one 18 pursues the analogue with field theory, one might think of this as a potential function associated with the discrete vector field.) Height functions for the six-vertex model were first introduced by van Beijeren <ref> [58] </ref>. The set of height functions with prescribed boundary conditions can be shown to form a distributive lattice under the natural operations of taking the maximum or minimum of the heights of two height functions at all the various points in the grid [47].
Reference: [59] <author> David B. Wilson. </author> <type> Manuscript. </type>
Reference-contexts: Therefore, the method applies. When q = 1, roughly n 3 log n steps on average are needed in order to generate an unbiased sample, where a b n; details will appear in <ref> [59] </ref>. Permutations. For certain statistical applications, it is useful to sample permutations 2 S n on n items such that the probability of is proportional to q inv () ; this is sometimes called "Mallows' phi model through Kendall's tau".
Reference: [60] <author> David B. Wilson. </author> <title> Generating random spanning trees more quickly than the cover time. </title> <booktitle> In ACM Symposium on the Theory of Computing, </booktitle> <pages> pages 296-303, </pages> <year> 1996. </year>
Reference-contexts: This problem will be treated in two companion papers [61], <ref> [60] </ref>. 2. General Theory 2.1. Coupling from the past Suppose that we have an ergodic (irreducible and aperiodic) Markov chain with n states, numbered 1 through n, where the probability of going from state i to state j is p i;j . <p> Using the coupling-from-the-past approach rather than time-reversal, we can generalize this algorithm to yield random trees in a directed and weighted graph. Details will be given in [61]. (It is worth mentioning that for purposes of generating random trees, one can now do better than the Broder-Aldous algorithm; see <ref> [60] </ref>.) Time reversal also shows up in the theory of coalescent duality for interacting particle systems. A standard example of this duality is the relationship between the coalescing random walk model and the voter model generalized to weighted directed graphs (see [32], [27], [41]).
Reference: [61] <author> David B. Wilson and James G. Propp. </author> <title> How to get a perfectly random sample from a generic Markov chain and generate a random spanning tree of a directed graph. </title> <booktitle> In ACM-SIAM Symposium on Discrete Algorithms, </booktitle> <pages> pages 448-457, </pages> <year> 1996. </year>
Reference-contexts: This problem will be treated in two companion papers <ref> [61] </ref>, [60]. 2. General Theory 2.1. Coupling from the past Suppose that we have an ergodic (irreducible and aperiodic) Markov chain with n states, numbered 1 through n, where the probability of going from state i to state j is p i;j . <p> state i with probability exactly (i), and that the expected number of simulation steps will nonetheless be finite. (Issues of efficiency will be dealt with in section 5 of our article, in the case where the Markov chain is monotone; for an analysis of the general case, see our article <ref> [61] </ref>, in which we improve on the naive approach just discussed.) To run fixed-time simulation backwards, we start by running the chain from time 1 to time 0. <p> The number of calls to M arkov () may also be reduced, and in a companion paper <ref> [61] </ref> we will show that the procedure can be modified so that its expected running time is bounded by a fixed multiple of the so-called cover time of the Markov chain (for a definition see [44]). <p> Using the coupling-from-the-past approach rather than time-reversal, we can generalize this algorithm to yield random trees in a directed and weighted graph. Details will be given in <ref> [61] </ref>. (It is worth mentioning that for purposes of generating random trees, one can now do better than the Broder-Aldous algorithm; see [60].) Time reversal also shows up in the theory of coalescent duality for interacting particle systems.
Reference: [62] <author> Ulli Wolff. </author> <title> Collective Monte Carlo updating for spin systems. </title> <journal> Physical Review Letters, </journal> <volume> 62(4) </volume> <pages> 361-364, </pages> <year> 1989. </year>
Reference-contexts: Given a random-cluster sample, they compute a random Potts state consistent with the clusters. Given a Potts state, they compute a random subgraph of G consistent with the Potts state. Their chain alternates between these two phases. In another variation due to Wolff <ref> [62] </ref>, a single cluster is built from the spin states and then flipped. One major advantage of these approaches over the single-bond heat bath algorithm is that they obviate the need to determine connectivity for many pairs of vertices adjacent in V .
Reference: [63] <author> F. Y. Wu. </author> <title> The Potts model. </title> <journal> Reviews of Modern Physics, </journal> <volume> 54(1) </volume> <pages> 235-268, </pages> <year> 1982. </year>
Reference-contexts: For example, carbon dioxide, xenon, and brass are thought to belong to the same universality class as the three-dimensional Ising model (see [8] and [12] and references contained therein). Other models that have received much attention include the Potts model <ref> [63] </ref> (which generalizes the Ising model) and the related random cluster model [23]. In Monte Carlo studies of phase transitions, it is essential to generate many random samples of the state of a system. Sampling methods include the Metropolis algorithm and multi-grid versions of it. <p> Indeed, it is well-known that it becomes disastrously slow near the critical temperature. An important generalization of the Ising model is the q-state Potts model, in which each site may have one of q different "spins". Wu <ref> [63] </ref> gives a survey describing the physical significance of the Potts model. In a Potts configuration , each site i has spin i which is one of 1; 2; 3; : : : ; q.
Reference: [64] <author> Wei Zheng and Subir Sachdev. </author> <title> Sine-Gordon theory of the non-Neel phase of two-dimensional quantum antiferromagnets. </title> <journal> Physical Review B, </journal> <volume> 40 </volume> <pages> 2704-2707, </pages> <year> 1989. </year> <month> 27 </month>
Reference-contexts: Here, as in the case of ice-models, one can introduce a height function that encodes the combinatorial structure and makes it possible to view the states as elements of a distributive lattice. This approach can be traced back to Levitov [39] and Zheng and Sachdev <ref> [64] </ref> in the case of the square lattice, and to Blote and Hilhorst [14] in the case of the hexagonal lattice. An independent development is due to Thurston [57], building on earlier work of Conway [17]. A generalization of this technique is described in [47].
References-found: 64

