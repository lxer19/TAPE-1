URL: http://www-graphics.stanford.edu/papers/bidir/gamma-fixed/bidir-bw.ps
Refering-URL: http://www-graphics.stanford.edu/papers/bidir/gamma-fixed/
Root-URL: http://www.cs.stanford.edu
Title: Bidirectional Estimators for Light Transport  
Author: Eric Veach Leonidas Guibas 
Affiliation: Computer Science Department, Stanford University  
Abstract: Most of the research on the global illumination problem in computer graphics has been concentrated on finite-element (radiosity) techniques. Monte Carlo methods are an intriguing alternative which are attractive for their ability to handle very general scene descriptions without the need for meshing. In this paper we study techniques for reducing the sampling noise inherent in pure Monte Carlo approaches to global illumination. Every light energy transport path from a light source to the eye can be generated in a number of different ways, according to how we partition the path into an initial portion traced from a light source, and a final portion traced from the eye. Each partitioning gives us a different unbiased estimator, but some partitionings give estimators with much lower variance than others. We give examples of this phenomenon and describe its significance. We also present work in progress on the problem of combining these multiple estimators to achieve near-optimal variance, with the goal of producing images with less noise for a given number of samples. 
Abstract-found: 1
Intro-found: 1
Reference: 1. <editor> J. Hammersley, D. Handscomb, </editor> <title> Monte Carlo Methods, </title> <publisher> Chapman and Hall, </publisher> <year> 1964. </year>
Reference-contexts: That is, how far can MC methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature <ref> [1, 2] </ref> (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community [3, 6, 7, 5]. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical.
Reference: 2. <author> M. Kalos, P. Whitlock, </author> <title> Monte Carlo Methods, Volume I: Basics. </title> <editor> J. </editor> <publisher> Wiley, </publisher> <address> New York, </address> <year> 1986. </year>
Reference-contexts: That is, how far can MC methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature <ref> [1, 2] </ref> (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community [3, 6, 7, 5]. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical. <p> For a pinhole aperture, W P has a component which is a two-dimensional ffi-function, reducing the inner product to a 2D integration over the film plane. 3.5 Importance Transport Adjoint methods for the solution of integral equations have long been used in other fields, such as neutron transport <ref> [23, 24, 2] </ref>. A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by [25], based on earlier work in [26] and [27].
Reference: 3. <author> R. Cook, T. Porter, L. Carpenter, </author> <title> Distributed ray tracing. </title> <journal> Computer Graphics (SIG-GRAPH '84), </journal> <volume> 18, </volume> <month> 137-146 </month> <year> (1984). </year>
Reference-contexts: methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature [1, 2] (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community <ref> [3, 6, 7, 5] </ref>. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical. Our goal is the development of new variance reduction methods that exploit the special properties of global illumination. <p> Pure methods are attractive because the only image artifact is noise; thus if an image we compute does not appear to be noisy, we have strong reason to believe that it is correct. Pure methods include distribution ray tracing <ref> [3] </ref> and path tracing [6]. Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources.
Reference: 4. <author> J. Arvo, D. Kirk, </author> <title> Particle transport and image synthesis, </title> <journal> Computer Graphics (SIG-GRAPH '90), </journal> <volume> 24, </volume> <month> 63-66 </month> <year> (1990). </year>
Reference-contexts: Pure methods include distribution ray tracing [3] and path tracing [6]. Many variants on these techniques are possible <ref> [4, 6, 5] </ref>. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. <p> The largest contributions typically come from short paths, so we can either ignore paths whose length exceeds some threshold, or use Russian roulette <ref> [4] </ref> to terminate long paths without adding bias. This lets us partition the estimate at P into a finite sum; we estimate separately the contribution due to each path length k. To estimate the contribution for a particular k, we use MC integration (Sect. 4).
Reference: 5. <author> P. Shirley, C. Wang, </author> <title> Luminaire sampling in distribution ray tracing. </title> <type> Technical Report 343, </type> <institution> CS Dept., Indiana University, </institution> <month> Jan </month> <year> 1992. </year> <note> Also appears in: SIGGRAPH '93 Global Illumination Course Notes. </note>
Reference-contexts: methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature [1, 2] (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community <ref> [3, 6, 7, 5] </ref>. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical. Our goal is the development of new variance reduction methods that exploit the special properties of global illumination. <p> Pure methods include distribution ray tracing [3] and path tracing [6]. Many variants on these techniques are possible <ref> [4, 6, 5] </ref>. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. <p> We are also experimenting with techniques for partitioning the transport paths between the k methods to reduce the variance of our estimates. Our results generalize the direct lighting calculation <ref> [6, 5] </ref>, a common optimization for MC methods. Rather than following paths all the way back to the light sources, this optimization handles the last path segment specially. <p> Thanks also to Jorge Stolfi and Stephen Harrison for many stimulating discussions. This work was supported by the National Science Foundation <ref> (CCR-9215219) </ref>, the Digital Systems Research Center, and the Digital External Research Program.
Reference: 6. <author> J. Kajiya, </author> <title> The rendering equation. </title> <journal> Computer Graphics (SIGGRAPH '86), </journal> <volume> 20, </volume> <month> 143-150 </month> <year> (1986). </year>
Reference-contexts: methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature [1, 2] (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community <ref> [3, 6, 7, 5] </ref>. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical. Our goal is the development of new variance reduction methods that exploit the special properties of global illumination. <p> Pure methods are attractive because the only image artifact is noise; thus if an image we compute does not appear to be noisy, we have strong reason to believe that it is correct. Pure methods include distribution ray tracing [3] and path tracing <ref> [6] </ref>. Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. <p> Pure methods include distribution ray tracing [3] and path tracing [6]. Many variants on these techniques are possible <ref> [4, 6, 5] </ref>. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. <p> We are also experimenting with techniques for partitioning the transport paths between the k methods to reduce the variance of our estimates. Our results generalize the direct lighting calculation <ref> [6, 5] </ref>, a common optimization for MC methods. Rather than following paths all the way back to the light sources, this optimization handles the last path segment specially. <p> was necessary to brighten these 8 Eric Veach and Leonidas Guibas images relative to Fig. 4, since each image accounts for only a fraction of the light in the scene. 3 Light Transport in Ray Form To analyze our algorithms, we have found it useful to reformulate the rendering equation <ref> [6] </ref> as an integral over rays. This leads to a very simple expression for the kernel; the geometric terms are hidden in the measure function we use for the inner product.
Reference: 7. <author> D. Kirk, J. Arvo, </author> <title> Unbiased sampling techniques for image synthesis, </title> <journal> Computer Graphics (SIGGRAPH '91), </journal> <volume> 25, </volume> <month> 153-156 </month> <year> (1991). </year>
Reference-contexts: methods be taken in terms of 2 Eric Veach and Leonidas Guibas variance reduction, without adding bias to the solution? Many techniques for variance reduction have been described in the Monte Carlo literature [1, 2] (e.g. importance sampling, stratified sampling) and have long been used by the computer graphics community <ref> [3, 6, 7, 5] </ref>. Yet even with these techniques, there are many reasonable scenes for which current MC algorithms are not practical. Our goal is the development of new variance reduction methods that exploit the special properties of global illumination.
Reference: 8. <author> F. Sillion, J. Arvo, S. Westin, D. Greenberg, </author> <title> A global illumination solution for general reflectance distributions. </title> <journal> Computer Graphics (SIGGRAPH '91), </journal> <volume> 25, </volume> <month> 187-196 </month> <year> (1991). </year>
Reference-contexts: The interface to the scene model is particularly nice|all operations access the scene as an object-oriented black box , allowing truly procedural geometric and reflection models. Pure MC methods do not suffer from many of the artifacts and limitations that must be addressed by radiosity techniques <ref> [8, 9, 10] </ref> ("blocky" appearance, Mach bands, missing shadows, limited reflectance models), making them an excellent choice for the validation of other methods. However, Monte Carlo methods have one well-known drawback: noise. The focus of this research is to determine to what extent this noise is an inherent limitation.
Reference: 9. <author> D. Baum, S. Mann, K. Smith, J. Winget, </author> <title> Making radiosity usable: automatic preprocessing and meshing techniques for the generation of accurate radiosity solutions. </title> <journal> Computer Graphics (SIGGRAPH '91), </journal> <volume> 25, </volume> <month> 51-60 </month> <year> (1991). </year>
Reference-contexts: The interface to the scene model is particularly nice|all operations access the scene as an object-oriented black box , allowing truly procedural geometric and reflection models. Pure MC methods do not suffer from many of the artifacts and limitations that must be addressed by radiosity techniques <ref> [8, 9, 10] </ref> ("blocky" appearance, Mach bands, missing shadows, limited reflectance models), making them an excellent choice for the validation of other methods. However, Monte Carlo methods have one well-known drawback: noise. The focus of this research is to determine to what extent this noise is an inherent limitation.
Reference: 10. <author> D. Lischinski, F. Tampieri, D. Greenberg, </author> <title> Combining hierarchical radiosity and discontinuity meshing. </title> <journal> Computer Graphics (SIG-GRAPH '93), </journal> <volume> 27, </volume> <month> 199-208 </month> <year> (1993). </year>
Reference-contexts: The interface to the scene model is particularly nice|all operations access the scene as an object-oriented black box , allowing truly procedural geometric and reflection models. Pure MC methods do not suffer from many of the artifacts and limitations that must be addressed by radiosity techniques <ref> [8, 9, 10] </ref> ("blocky" appearance, Mach bands, missing shadows, limited reflectance models), making them an excellent choice for the validation of other methods. However, Monte Carlo methods have one well-known drawback: noise. The focus of this research is to determine to what extent this noise is an inherent limitation.
Reference: 11. <author> S. Pattanaik, S. Mudur, </author> <title> Efficient potential equation solutions for global illumination computation. </title> <journal> Computers and Graphics, </journal> <volume> 17 (4), </volume> <month> 387-396 </month> <year> (1993). </year>
Reference-contexts: All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing [15, 13], bidirectional ray tracing [16, 12], and Monte Carlo radiosity <ref> [14, 11] </ref> all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 12. <author> S. Chen, H. Rushmeier, G. Miller, D. Turner, </author> <title> A progressive multi-pass method for global illumination. </title> <journal> Computer Graphics (SIG-GRAPH '91), </journal> <volume> 25, </volume> <month> 165-174 </month> <year> (1991). </year>
Reference-contexts: Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing [15, 13], bidirectional ray tracing <ref> [16, 12] </ref>, and Monte Carlo radiosity [14, 11] all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 13. <author> M. Watt, </author> <title> Light-water interaction using backward beam tracing. </title> <journal> Computer Graphics (SIGGRAPH '90), </journal> <volume> 24, </volume> <month> 377-385 </month> <year> (1990). </year>
Reference-contexts: Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing <ref> [15, 13] </ref>, bidirectional ray tracing [16, 12], and Monte Carlo radiosity [14, 11] all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 14. <author> P. Shirley, </author> <title> A ray tracing method for illumination calculation in diffuse-specular scenes. </title> <booktitle> Graphics Interface '90 , 205-212 (1990). </booktitle>
Reference-contexts: All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing [15, 13], bidirectional ray tracing [16, 12], and Monte Carlo radiosity <ref> [14, 11] </ref> all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 15. <author> J. Arvo, </author> <title> Backward ray tracing. SIGGRAPH '86 "Developments in Ray Tracing" course notes (1986). </title>
Reference-contexts: Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing <ref> [15, 13] </ref>, bidirectional ray tracing [16, 12], and Monte Carlo radiosity [14, 11] all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 16. <author> P. Heckbert, </author> <title> Adaptive radiosity textures for bidirectional ray tracing. </title> <journal> Computer Graphics (SIGGRAPH '90), </journal> <volume> 24, </volume> <month> 145-154 </month> <year> (1990). </year>
Reference-contexts: Many variants on these techniques are possible [4, 6, 5]. All pure MC techniques described in the literature have one feature in common: rays are traced only from the eye, not from the light sources. Techniques such as light ray tracing [15, 13], bidirectional ray tracing <ref> [16, 12] </ref>, and Monte Carlo radiosity [14, 11] all use the light rays to deposit energy on surface patches. Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper.
Reference: 17. <author> P. Shirley, </author> <title> Time complexity of Monte-Carlo radiosity. </title> <booktitle> Eurographics '91 Proceedings, </booktitle> <month> 459-465 </month> <year> (1991). </year>
Reference-contexts: Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper. Also, these techniques do not extend well to environments with many small patches <ref> [17] </ref> or to non-diffuse surfaces [18, 19, 20]. Lafortune and Willems [21] have independently developed a "bidirectional path trac ing" technique which uses some of the ideas presented in this paper.
Reference: 18. <author> P. Shirley, K. Sung, W. Brown, </author> <title> A ray tracing framework for global illumination. </title> <booktitle> Graphics Interface '91 , 117-128 (1991). </booktitle>
Reference-contexts: Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper. Also, these techniques do not extend well to environments with many small patches [17] or to non-diffuse surfaces <ref> [18, 19, 20] </ref>. Lafortune and Willems [21] have independently developed a "bidirectional path trac ing" technique which uses some of the ideas presented in this paper. However their framework does not recognize explicitly the multiple estimators for each path length, or the problem of optimally combining them.
Reference: 19. <author> B. Le Saec, C. Schlick, </author> <title> A progressive ray-tracing based radiosity with general reflectance functions. </title> <booktitle> Eurographics Workshop on Photosimulation, Realism, and Physics in Computer Graphics, </booktitle> <year> 1990. </year>
Reference-contexts: Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper. Also, these techniques do not extend well to environments with many small patches [17] or to non-diffuse surfaces <ref> [18, 19, 20] </ref>. Lafortune and Willems [21] have independently developed a "bidirectional path trac ing" technique which uses some of the ideas presented in this paper. However their framework does not recognize explicitly the multiple estimators for each path length, or the problem of optimally combining them.
Reference: 20. <author> G. Ward, F. Rubinstein, R. </author> <title> Clear, A ray tracing solution for diffuse interreflection. </title> <journal> Computer Graphics (SIGGRAPH '88), </journal> <volume> 22, </volume> <month> 85-92 </month> <year> (1988). </year>
Reference-contexts: Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper. Also, these techniques do not extend well to environments with many small patches [17] or to non-diffuse surfaces <ref> [18, 19, 20] </ref>. Lafortune and Willems [21] have independently developed a "bidirectional path trac ing" technique which uses some of the ideas presented in this paper. However their framework does not recognize explicitly the multiple estimators for each path length, or the problem of optimally combining them.
Reference: 21. <author> E. Lafortune, Y. Willems, </author> <title> Bidirectional path tracing. </title> <booktitle> CompuGraphics Proceedings (Alvor, </booktitle> <address> Portugal), </address> <month> 145-153 (Dec. </month> <year> 1993). </year>
Reference-contexts: Since this requires a mesh in object space, these methods are not "pure" for the purpose of this paper. Also, these techniques do not extend well to environments with many small patches [17] or to non-diffuse surfaces [18, 19, 20]. Lafortune and Willems <ref> [21] </ref> have independently developed a "bidirectional path trac ing" technique which uses some of the ideas presented in this paper. However their framework does not recognize explicitly the multiple estimators for each path length, or the problem of optimally combining them.
Reference: 22. <author> M. Cohen, J. Wallace, </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press, </publisher> <year> 1993. </year>
Reference-contexts: We find that the ray measure simplifies the description of bidirectional sampling, and is very useful when dealing with general filter functions and light distributions. 3.1 Local Form Pat Hanrahan has written an excellent development of the following material which can be found in <ref> [22] </ref>. Please consult this reference for an explanation of terms not defined here. <p> Physically accurate surface reflection models lead to a symmetric BRDF, i.e. f r (x; ~! o ; ~! i ) = f r (x; ~! i ; ~! o ) due to a physical principle known as Helmholtz reciprocity <ref> [22] </ref>. 3.2 Three-Point Form We can express L i in terms of L o via a change of variables to get the three-point form of the rendering equation (note that x is now x 0 , and L o is now L): Z K 3 (x ! x 0 ! x <p> The quantity d (y ! y 0 ) is known as the throughput of a differential beam <ref> [22] </ref>. Finally, the kernel K R describes the fraction of light travelling along ~ y which is scattered along ~ x.
Reference: 23. <author> Lewins, Jeffery, </author> <title> Importance, The Adjoint Function: The Physical Basis of Variational and Perturbation Theory in Transport and Diffusion Problems. </title> <publisher> Pergamon Press, </publisher> <address> New York, </address> <year> 1965. </year>
Reference-contexts: For a pinhole aperture, W P has a component which is a two-dimensional ffi-function, reducing the inner product to a 2D integration over the film plane. 3.5 Importance Transport Adjoint methods for the solution of integral equations have long been used in other fields, such as neutron transport <ref> [23, 24, 2] </ref>. A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by [25], based on earlier work in [26] and [27].
Reference: 24. <author> J. Spanier, E. Gelbard, </author> <title> Monte Carlo Principles and Neutron Transport Problems, </title> <publisher> Addison-Wesley, </publisher> <year> 1969. </year>
Reference-contexts: For a pinhole aperture, W P has a component which is a two-dimensional ffi-function, reducing the inner product to a 2D integration over the film plane. 3.5 Importance Transport Adjoint methods for the solution of integral equations have long been used in other fields, such as neutron transport <ref> [23, 24, 2] </ref>. A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by [25], based on earlier work in [26] and [27]. <p> Second, the idea of building paths from the light sources can be viewed as a direct solution method for the adjoint rendering equation. This idea has been applied in neutron transport problems <ref> [24] </ref>, where in fact "direct" and "adjoint" methods have the opposite meaning they are given in computer graphics. Appendix A develops this relationship further. To our knowledge the bidirectional Monte Carlo techniques proposed by this paper have not been explored elsewhere.
Reference: 25. <author> P. Christensen, D. Salesin, T. DeRose, </author> <title> A continuous adjoint formulation for radiance 14 Eric Veach and Leonidas Guibas transport. </title> <booktitle> Fourth Eurographics Workshop on Rendering, </booktitle> <year> 1993. </year>
Reference-contexts: A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by <ref> [25] </ref>, based on earlier work in [26] and [27]. We review this material here for two reasons: first, we believe that the inner product on rays helps to clarify the relationship between the rendering equation and its adjoint. <p> We speak of W as an importance distribution when it is propagated by T fl in this way. We give a simple proof here of a result from <ref> [25] </ref>, that except for a change in ray orientation, radiance and importance are propagated in the same way.
Reference: 26. <author> S. Pattanaik, S. Mudur, </author> <title> The Potential Equation and Importance in Illumination Computations. </title> <journal> Computer Graphics Forum, </journal> <volume> 12 (2), </volume> <month> 131-136 </month> <year> (1993). </year>
Reference-contexts: A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by [25], based on earlier work in <ref> [26] </ref> and [27]. We review this material here for two reasons: first, we believe that the inner product on rays helps to clarify the relationship between the rendering equation and its adjoint.
Reference: 27. <author> B. Smits, J. Arvo, D. Salesin, </author> <title> An importance-driven radiosity algorithm. </title> <journal> Computer Graphics (SIGGRAPH '92), </journal> <volume> 26, </volume> <month> 273-282 </month> <year> (1992). </year>
Reference-contexts: A continuous adjoint formulation for radiance transport was first proposed in the computer graphics literature by [25], based on earlier work in [26] and <ref> [27] </ref>. We review this material here for two reasons: first, we believe that the inner product on rays helps to clarify the relationship between the rendering equation and its adjoint.
References-found: 27

