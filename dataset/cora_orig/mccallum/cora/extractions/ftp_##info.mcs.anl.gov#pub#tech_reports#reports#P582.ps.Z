URL: ftp://info.mcs.anl.gov/pub/tech_reports/reports/P582.ps.Z
Refering-URL: http://www.mcs.anl.gov/publications/abstracts/abstracts96.htm
Root-URL: http://www.mcs.anl.gov
Title: Automatic Differentiation as a Tool for Sensitivity Analysis of a Convective Storm in a 3-D
Author: Seon Ki Park Kelvin K. Droegemeier Christian H. Bischof 
Keyword: tangent linear approximation, forward sensitivity, adjoint sensitivity, vartia tional data assimilation, convective storm, 3-D cloud model, moist convection, supercell storm  
Note: Preprint ANL/MCS-P582-0496  
Affiliation: Argonne  
Abstract: The ADIFOR automatic differentiation tool is applied to a 3-D storm-scale meteorological model to generate a sensitivity-enhanced code capable of providing derivatives of all model output variables and related diagnostic (derived) parameters as a function of specified control parameters. The tangent linear approximation, applied to a deep convective storm by the first of its kind using a full-physics compressible model, is valid up to 50 min for a 1 % water vapor perturbations. The result is very encouraging considering the highly nonlinear and discontinuous properties of solutions. The ADIFOR-generated code has provided valuable sensitivity information on storm dynamics. Especially, it is very efficient and useful for investigating how a perturbation inserted at earlier time propagates through the model variables at later times. However, it is computationally very expensive to be applied to the variational data assimilation, especially for 3-D meteorological models, which potentially have a large number of input variables. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> A. Arakawa and V. R. Lamb, </author> <title> Computational design of the basic dynamical processes of the UCLA general circulation model, in Methods in Computational Physics, 17, </title> <publisher> Academic Press, </publisher> <year> 1977, </year> <pages> pp. 174-265. </pages>
Reference-contexts: The prognostic variables, solved on the Arakawa C grid <ref> [1] </ref>, include Cartesian velocity components, perturbations of potential temperature and pressure, mixing ratios of water vapor, cloud water, and rain water, and turbulent kinetic energy.
Reference: [2] <author> C. Bischof, A. Carle, G. Corliss, A. Griewank, and P. Hovland, ADIFOR: </author> <title> Generating derivative codes from Fortran programs, </title> <booktitle> Scientific Programming, 1 (1992), </booktitle> <pages> pp. 11-29. </pages>
Reference-contexts: The gradients can be computed efficiently and accurately by using automatic differentiation (AD) tools, which apply the chain rule systematically to elementary operations or functions to generate derivative codes of given nonlinear models <ref> [2] </ref>. Besides providing basic sensitivity information, AD tools are indispensable in variational data assimilation, whose optimization processes require accurate gradient information. In meteorology, the adjoint model (ADJM) has been used substantially in both sensitivity analysis (e.g., [8]) and variational data assimilation (e.g., [14]). <p> A compilation of currently available AD tools can be found in [4] and on the World Wide Web at http://www.mcs.anl.gov/Projects/autodiff/AD Tools. In this study, we apply the ADIFOR (Automatic DIfferentiation of FORtran) general-purpose AD tool <ref> [2, 3] </ref> to the 3-D Advanced Regional Prediction System (ARPS) [22] to generate a sensitivity-enhanced (SE-ARPS) code capable of providing derivatives of all model output variables and related diagnostic (derived) parameters as a function of specified control parameters, including initial and boundary conditions as well as physical and computational constants.
Reference: [3] <author> C. Bischof, A. Carle, P. Khademi, and A. Mauer, </author> <title> The ADIFOR 2.0 system for the automatic differentiation of Fortran 77 programs, 1994. </title> <type> Preprint MCS-P481-1194, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, and CRPC-TR94491, Center for Research on Parallel Computation, Rice University. </institution> <note> To appear in IEEE Computational Science & Engineering. </note>
Reference-contexts: A compilation of currently available AD tools can be found in [4] and on the World Wide Web at http://www.mcs.anl.gov/Projects/autodiff/AD Tools. In this study, we apply the ADIFOR (Automatic DIfferentiation of FORtran) general-purpose AD tool <ref> [2, 3] </ref> to the 3-D Advanced Regional Prediction System (ARPS) [22] to generate a sensitivity-enhanced (SE-ARPS) code capable of providing derivatives of all model output variables and related diagnostic (derived) parameters as a function of specified control parameters, including initial and boundary conditions as well as physical and computational constants.
Reference: [4] <author> C. Bischof and F. Dilley, </author> <title> A compilation of automatic differentiation tools, </title> <journal> ACM SIGNUM Newsletter, </journal> <volume> 30 (1995), </volume> <pages> pp. 2-20. </pages>
Reference-contexts: Bischof et al. [5] have successfully applied an AD tool to generate the tangent linear model (TLM) of a 3-D mesoscale model (the PSU/NCAR MM5). A compilation of currently available AD tools can be found in <ref> [4] </ref> and on the World Wide Web at http://www.mcs.anl.gov/Projects/autodiff/AD Tools.
Reference: [5] <author> C. Bischof, G. Pusch, and R. Knoesel, </author> <title> Sensitivity analysis of the MM5 weather model using automatic differentiation, </title> <type> Preprint MCS-P532-0895, </type> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, </institution> <year> 1995. </year>
Reference-contexts: Sensitivity coefficients are then computed exactly by solving the differential equations using a nonlinear solution as a basic state (e.g., <ref> [8, 17, 5] </ref>). In this sense, the sensitivity is defined as the gradient (i.e., the first-order derivative) of the model response with respect to any input parameter [18]. <p> Although AD tools exist for generating the ADJM (e.g., Odyssee [19], AMC [10]), the ADJMs, especially of 3-D models, are still routinely generated by hand. Bischof et al. <ref> [5] </ref> have successfully applied an AD tool to generate the tangent linear model (TLM) of a 3-D mesoscale model (the PSU/NCAR MM5). A compilation of currently available AD tools can be found in [4] and on the World Wide Web at http://www.mcs.anl.gov/Projects/autodiff/AD Tools. <p> Subsequently, we discuss implications of the sensitivity results on data assimilation. ARPS is a fully compressible cloud model with full physics. Although an AD tool has been applied to a nonhydrostatic mesoscale model <ref> [5] </ref>, no AD tool has been applied to a compressible model. In a compressible model, meteorologically unimportant acoustic waves are also supported, which severely limit the timestep size of explicit time integration schemes. To improve efficiency, ARPS employs the mode-splitting time integration technique [13]. <p> The final results are exactly the same as would be obtained from as many ADJM runs as the number of DVs. In meteorology, ADIFOR has been applied to a 1-D convective cloud model [17, 16], a 3-D storm-scale model [15], a mesoscale model <ref> [5] </ref>, and an air quality model [11]. 3 Methodology Sensitivity to Perturbations In the context of 3-D models, the number of IVs is potentially very large when grid variables are considered, and this may inhibit the practical computation of sensitivity because of memory limitations. <p> We propose to compute sensitivities with respect to the perturbations inserted in model variables rather than the grid variables themselves. That is, by introducing an artificial perturbation parameter, e, into the original forward model (ARPS), ADIFOR can generate a sensitivity code that regards e as one of the IVs <ref> [5] </ref>. Consider, for example, the water vapor field, Q v . If we perturb it by a factor e, Q v (x; y; z; t; e) = (1 + e)Q v (x; y; z; t);(1) any quantity P that is influenced by the water vapor field implicitly depends upon e.
Reference: [6] <author> C. H. Bischof, </author> <title> Automatic differentiation, tangent linear models and pseudo-adjoints, in High-Performance Computing in the Geosciences, </title> <editor> F.-X. Le Dimet, ed., </editor> <volume> vol. </volume> <booktitle> 462 of Series C: Mathematical and Physical Sciences, </booktitle> <address> Boston, Mass., 1995, </address> <publisher> Kluwer Academic Publishers, </publisher> <pages> pp. 59-80. </pages>
Reference-contexts: The reason is that the former is basically a forward model and thus repeats the sensitivity computation implicitly for the number of IVs. Although we may save computing time by applying the sparse matrix option in generating the derivative codes and by using the pseudo-adjoint technique <ref> [6] </ref>, a comparative study has not been performed yet for a 3-D model.
Reference: [7] <author> K. K. Droegemeier, S. M. Lazarus, and R. Davies-Jones, </author> <title> The influence of helicity on numerically simulated convective storms, </title> <journal> Monthly Weather Review, </journal> <volume> 121 (1993), </volume> <pages> pp. 2005-2029. </pages>
Reference-contexts: The detailed model configuration for our experiments is described in [15]. The simulation to verify the computation of derivatives by ADIFOR is made by using the HALF4 (supercell) hodograph and thermodynamic sounding from <ref> [7] </ref>, the latter of which has a surface mixing ratio of 15 g/kg. This wind profile consists of a semi-circular arc of 10 m/s radius that turns clockwise over the lowest 4 km starting with the surface easterly winds.
Reference: [8] <author> R. M. Errico and T. Vukicevic, </author> <title> Sensitivity analysis using an adjoint of the PSU-NCAR mesoscale model, </title> <journal> Monthly Weather Review, </journal> <volume> 120 (1992), </volume> <pages> pp. 1644-1660. </pages>
Reference-contexts: Sensitivity coefficients are then computed exactly by solving the differential equations using a nonlinear solution as a basic state (e.g., <ref> [8, 17, 5] </ref>). In this sense, the sensitivity is defined as the gradient (i.e., the first-order derivative) of the model response with respect to any input parameter [18]. <p> Besides providing basic sensitivity information, AD tools are indispensable in variational data assimilation, whose optimization processes require accurate gradient information. In meteorology, the adjoint model (ADJM) has been used substantially in both sensitivity analysis (e.g., <ref> [8] </ref>) and variational data assimilation (e.g., [14]). Although AD tools exist for generating the ADJM (e.g., Odyssee [19], AMC [10]), the ADJMs, especially of 3-D models, are still routinely generated by hand.
Reference: [9] <author> B. Friedman, </author> <booktitle> Principles and Techniques of Applied Mathematics, </booktitle> <publisher> John Wiley & Sons, </publisher> <year> 1956. </year>
Reference-contexts: Here, the scalar product implies the sum of the products of corresponding components of the two vectors <ref> [9] </ref>.
Reference: [10] <author> R. Giering, </author> <title> Adjoint model compiler, manual version 0.2, AMC version 2.04, </title> <type> tech. rep., </type> <institution> Max-Planck Institut fur Meteorologie, </institution> <month> August </month> <year> 1992. </year>
Reference-contexts: In meteorology, the adjoint model (ADJM) has been used substantially in both sensitivity analysis (e.g., [8]) and variational data assimilation (e.g., [14]). Although AD tools exist for generating the ADJM (e.g., Odyssee [19], AMC <ref> [10] </ref>), the ADJMs, especially of 3-D models, are still routinely generated by hand. Bischof et al. [5] have successfully applied an AD tool to generate the tangent linear model (TLM) of a 3-D mesoscale model (the PSU/NCAR MM5).
Reference: [11] <author> D. Hwang and D. Byun, </author> <title> Application of automatic differentiation for studying the sensitivity of numerical advection schemes in air quality models, </title> <booktitle> in Proc. High Performance Computing 1995, </booktitle> <address> Phoenix, AZ, </address> <month> April 9-13, </month> <year> 1995, </year> <pages> pp. 52-57. </pages>
Reference-contexts: The final results are exactly the same as would be obtained from as many ADJM runs as the number of DVs. In meteorology, ADIFOR has been applied to a 1-D convective cloud model [17, 16], a 3-D storm-scale model [15], a mesoscale model [5], and an air quality model <ref> [11] </ref>. 3 Methodology Sensitivity to Perturbations In the context of 3-D models, the number of IVs is potentially very large when grid variables are considered, and this may inhibit the practical computation of sensitivity because of memory limitations.
Reference: [12] <author> E. Kessler, </author> <title> On the distribution and continuity of water substance in atmospheric circulation, Sensitivity Analusis of a Convective Storm 11 in Meteorological Monograph, 10, </title> <publisher> American Meteorological Society, </publisher> <year> 1969. </year>
Reference-contexts: The advective modes are computed on large timesteps with a leap-frog time scheme and second-order centered space differencing, whereas the acoustic modes are integrated on small timesteps with an implicit scheme. Kessler-explicit warm-rain microphysics is employed <ref> [12] </ref>. An extensive description of the model can be found in the ARPS users guide [22]. The computational domain consists of 53 fi 53 grids in the horizontal with a grid size of 1 km.
Reference: [13] <author> J. B. Klemp and R. B. Wilhelmson, </author> <title> The simulation of three-dimensional convective storm dynamics, </title> <journal> Journal of Atmospheric Sciences, </journal> <volume> 35 (1978), </volume> <pages> pp. 1070-1096. </pages>
Reference-contexts: In a compressible model, meteorologically unimportant acoustic waves are also supported, which severely limit the timestep size of explicit time integration schemes. To improve efficiency, ARPS employs the mode-splitting time integration technique <ref> [13] </ref>. In this technique, a large integration timestep is divided into a number of small timesteps; the acoustically active terms are updated every small timestep, while all other terms are computed only once every large timestep.
Reference: [14] <author> J. M. Lewis and J. C. Derber, </author> <title> The use of adjoint equations to solve a variational adjustment problem with advective constraints, </title> <booktitle> Tellus, 37A (1985), </booktitle> <pages> pp. 309-322. </pages>
Reference-contexts: Besides providing basic sensitivity information, AD tools are indispensable in variational data assimilation, whose optimization processes require accurate gradient information. In meteorology, the adjoint model (ADJM) has been used substantially in both sensitivity analysis (e.g., [8]) and variational data assimilation (e.g., <ref> [14] </ref>). Although AD tools exist for generating the ADJM (e.g., Odyssee [19], AMC [10]), the ADJMs, especially of 3-D models, are still routinely generated by hand.
Reference: [15] <author> S. K. Park, </author> <title> Sensitivity Analysis of Deep Convective Storms, </title> <type> PhD thesis, </type> <institution> School of Meteorology, University of Oklahoma, </institution> <year> 1996. </year>
Reference-contexts: The final results are exactly the same as would be obtained from as many ADJM runs as the number of DVs. In meteorology, ADIFOR has been applied to a 1-D convective cloud model [17, 16], a 3-D storm-scale model <ref> [15] </ref>, a mesoscale model [5], and an air quality model [11]. 3 Methodology Sensitivity to Perturbations In the context of 3-D models, the number of IVs is potentially very large when grid variables are considered, and this may inhibit the practical computation of sensitivity because of memory limitations. <p> The model is run for 140 min, with a large timestep of 6 sec and a small timestep of 1 sec. The detailed model configuration for our experiments is described in <ref> [15] </ref>. The simulation to verify the computation of derivatives by ADIFOR is made by using the HALF4 (supercell) hodograph and thermodynamic sounding from [7], the latter of which has a surface mixing ratio of 15 g/kg. <p> The required accuracy of water vapor can be estimated once the criteria on the forecast accuracy is determined. For example, suppose that a relative sensitivity of the forecast error <ref> [15] </ref> to water vapor is 20, which implies that the forecast error changes by 20% as a result of a 1% error in water vapor. If one wishes a forecast with only a 10% error, the observation for water vapor should have an error smaller than 0.5%.
Reference: [16] <author> S. K. Park and K. Droegemeier, </author> <title> On the use of automatic differentiation to assess parametric sensitivity in convective-scale variational data assimilation, </title> <booktitle> in Preprints, Proc. 2nd Int. Symp. on Assimilation of Observations in Meteorology and Oceanography, </booktitle> <address> Tokyo, Japan, </address> <month> March </month> <year> 1995., </year> <title> World Meteorological Organization, </title> <booktitle> 1995, p. </booktitle> <pages> 111-116. </pages>
Reference-contexts: The final results are exactly the same as would be obtained from as many ADJM runs as the number of DVs. In meteorology, ADIFOR has been applied to a 1-D convective cloud model <ref> [17, 16] </ref>, a 3-D storm-scale model [15], a mesoscale model [5], and an air quality model [11]. 3 Methodology Sensitivity to Perturbations In the context of 3-D models, the number of IVs is potentially very large when grid variables are considered, and this may inhibit the practical computation of sensitivity because <p> For perturbations in ambient environment, the cost function showed the largest sensitivity to temperature, followed by water vapor and then pressure. All other variables have almost negligible effect on the cost function. This result is also demonstrated in our 1-D experiments <ref> [16] </ref>.
Reference: [17] <author> S. K. Park, K. Droegemeier, C. Bischof, and T. Knauff, </author> <title> Sensitivity analysis of numerically-simulated convective storms using direct and adjoint methods, </title> <booktitle> in Preprints, 10th Conference on Numerical Weather Prediction, </booktitle> <address> Portland, Oregon, </address> <publisher> American Meterological Society, </publisher> <year> 1994, </year> <pages> pp. 457-459. </pages>
Reference-contexts: Sensitivity coefficients are then computed exactly by solving the differential equations using a nonlinear solution as a basic state (e.g., <ref> [8, 17, 5] </ref>). In this sense, the sensitivity is defined as the gradient (i.e., the first-order derivative) of the model response with respect to any input parameter [18]. <p> The final results are exactly the same as would be obtained from as many ADJM runs as the number of DVs. In meteorology, ADIFOR has been applied to a 1-D convective cloud model <ref> [17, 16] </ref>, a 3-D storm-scale model [15], a mesoscale model [5], and an air quality model [11]. 3 Methodology Sensitivity to Perturbations In the context of 3-D models, the number of IVs is potentially very large when grid variables are considered, and this may inhibit the practical computation of sensitivity because
Reference: [18] <author> Y. Ronen, </author> <title> Uncertainty analysis based on sensitivity analysis, in Uncertainty Analysis, </title> <publisher> CRC Press, </publisher> <year> 1988, </year> <pages> pp. 41-70. </pages>
Reference-contexts: Sensitivity coefficients are then computed exactly by solving the differential equations using a nonlinear solution as a basic state (e.g., [8, 17, 5]). In this sense, the sensitivity is defined as the gradient (i.e., the first-order derivative) of the model response with respect to any input parameter <ref> [18] </ref>. The gradients can be computed efficiently and accurately by using automatic differentiation (AD) tools, which apply the chain rule systematically to elementary operations or functions to generate derivative codes of given nonlinear models [2].
Reference: [19] <author> N. Rostaing, S. Dalmas, and A. Galligo, </author> <title> Automatic differentiation in Odyssee, </title> <booktitle> Tellus, 45a (1993), </booktitle> <pages> pp. 558-568. </pages>
Reference-contexts: In meteorology, the adjoint model (ADJM) has been used substantially in both sensitivity analysis (e.g., [8]) and variational data assimilation (e.g., [14]). Although AD tools exist for generating the ADJM (e.g., Odyssee <ref> [19] </ref>, AMC [10]), the ADJMs, especially of 3-D models, are still routinely generated by hand. Bischof et al. [5] have successfully applied an AD tool to generate the tangent linear model (TLM) of a 3-D mesoscale model (the PSU/NCAR MM5).
Reference: [20] <author> Z. Wang, </author> <title> Variational data assimilation with 2-d shallow water equations and 3-d FSU global spectral models, </title> <type> Tech. Rep. </type> <institution> FSU-SCRI-93T-149, Florida State University, Department of Mathematics, </institution> <month> December </month> <year> 1993. </year>
Reference-contexts: of velocity, is the potential temperature, p is the pressure, Q v , Q c and Q r are mixing ratios of water vapor, cloud water, and rain water, respectively. 4 Park, Droegemeier, and Bischof The weight for the vertical velocity, W w , for example, is computed following Wang <ref> [20] </ref>, W w = 8 n=1 k=1 n;k ) 2 ;(4) with similar expressions for other variables. Here, k denotes the grid space index.
Reference: [21] <author> B. A. Worley, E. M. Oblow, R. E. Pin, J. E. Maerker, J. E. Horwedel, R. Q. Wright, and J. L. </author> <title> Lucius, Deterministic methods for sensitivity and uncertainty analysis in large-scale computer models, in Proc. Conf. on Geostatistical, Sensitivity, and Uncertainty Methods for GroundWater Flow and Radionuclide Transport Modelling, </title> <editor> B. E. Buxton, ed., </editor> <publisher> Battelle Press, </publisher> <year> 1987, </year> <pages> pp. 135-154. </pages>
Reference-contexts: Cass Ave., Argonne, IL 60439, bischof@mcs.anl.gov. 1 2 Park, Droegemeier, and Bischof In the deterministic approach, one develops a set of differential sensitivity equations, which is used to express the gradient of the solution vector with respect to input parameters <ref> [21] </ref>. Sensitivity coefficients are then computed exactly by solving the differential equations using a nonlinear solution as a basic state (e.g., [8, 17, 5]). In this sense, the sensitivity is defined as the gradient (i.e., the first-order derivative) of the model response with respect to any input parameter [18].
Reference: [22] <author> M. Xue, K. K. Droegemeier, V. Wong, A. Shapiro, and K. Brewster, </author> <title> ARPS 4.0 User's Guide, Center for Analysis and Prediction of Storms, </title> <institution> University of Oklahoma, </institution> <year> 1995. </year>
Reference-contexts: A compilation of currently available AD tools can be found in [4] and on the World Wide Web at http://www.mcs.anl.gov/Projects/autodiff/AD Tools. In this study, we apply the ADIFOR (Automatic DIfferentiation of FORtran) general-purpose AD tool [2, 3] to the 3-D Advanced Regional Prediction System (ARPS) <ref> [22] </ref> to generate a sensitivity-enhanced (SE-ARPS) code capable of providing derivatives of all model output variables and related diagnostic (derived) parameters as a function of specified control parameters, including initial and boundary conditions as well as physical and computational constants. <p> Kessler-explicit warm-rain microphysics is employed [12]. An extensive description of the model can be found in the ARPS users guide <ref> [22] </ref>. The computational domain consists of 53 fi 53 grids in the horizontal with a grid size of 1 km.
References-found: 22

