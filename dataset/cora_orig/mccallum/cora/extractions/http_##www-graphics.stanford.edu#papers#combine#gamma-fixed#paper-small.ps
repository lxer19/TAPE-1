URL: http://www-graphics.stanford.edu/papers/combine/gamma-fixed/paper-small.ps
Refering-URL: http://www-graphics.stanford.edu/papers/combine/gamma-fixed/
Root-URL: http://www.cs.stanford.edu
Title: Optimally Combining Sampling Techniques for Monte Carlo Rendering  
Author: Eric Veach Leonidas J. Guibas 
Keyword: CR Categories: I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism; I.3.3 [Computer Graphics]: Picture/Image Generation; G.1.9 [Numerical Analysis]: Integral Equations Fredholm equations. Additional Keywords: Monte Carlo, variance reduction, rendering, distribution ray tracing, global illumination, lighting simulation.  
Affiliation: Computer Science Department Stanford University  
Abstract: Monte Carlo integration is a powerful technique for the evaluation of difficult integrals. Applications in rendering include distribution ray tracing, Monte Carlo path tracing, and form-factor computation for radiosity methods. In these cases variance can often be significantly reduced by drawing samples from several distributions, each designed to sample well some difficult aspect of the integrand. Normally this is done by explicitly partitioning the integration domain into regions that are sampled differently. We present a powerful alternative for constructing robust Monte Carlo estimators, by combining samples from several distributions in a way that is provably good. These estimators are unbiased, and can reduce variance significantly at little additional cost. We present experiments and measurements from several areas in rendering: calculation of glossy highlights from area light sources, the final gather pass of some radiosity algorithms, and direct solution of the rendering equation using bidirectional path tracing. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> J. Arvo and D. Kirk. </author> <title> Particle transport and image synthesis. </title> <booktitle> Computer Graphics (SIGGRAPH '90 Proceedings), </booktitle> <volume> 24, </volume> <month> 63-66 </month> <year> (1990). </year>
Reference-contexts: This tradeoff is summarized by the efficiency <ref> [1, 6] </ref> of a Monte Carlo estimator, *[F ] = V [F ] T [F ] where T [F ] is the time required to take a sample from F . The higher the efficiency, the less time required to achieve a given variance.
Reference: [2] <author> S. Chen, H. Rushmeier, G. Miller, and D. Turner. </author> <title> A progressive multi-pass method for global illumination. </title> <booktitle> Computer Graphics (SIGGRAPH '91 Proceedings), </booktitle> <volume> 25, </volume> <month> 165-174 </month> <year> (1991). </year>
Reference-contexts: For example, some radiosity algorithms use a local pass or final gather to recompute certain coefficients more accurately. We examine a variation called per-pixel final gather. The idea is to compute an approximate radiosity solution, and then use it to illuminate the visible surfaces during a ray tracing pass <ref> [11, 2] </ref>. Essentially, this type of final gather is equivalent to ray tracing with many area light sources (one for each patch, or one for each link in a hierarchical solution). As with the glossy highlight example, there are two common sampling techniques. <p> Essentially, this type of final gather is equivalent to ray tracing with many area light sources (one for each patch, or one for each link in a hierarchical solution). As with the glossy highlight example, there are two common sampling techniques. The brightest patches are classified as light sources <ref> [2] </ref>, and are handled with an area sampling technique (e.g. samples are distributed on the light sources according to emitted power). The remaining patches are sampled by casting rays randomly into the scene (i.e. directional sampling from the point intersected by the viewing ray).
Reference: [3] <author> M. Cohen and J. Wallace. </author> <title> Radiosity and Realistic Image Synthesis. </title> <publisher> Academic Press, </publisher> <year> 1993. </year>
Reference-contexts: For further details and background see <ref> [3] </ref>. <p> The term G (x $ x 0 ) measures the differential throughput of a beam <ref> [3] </ref> from x to x 0 . Often the incident radiance distribution is unknown, and we must solve for it. <p> Given some classification of patches into light sources and non (a) (b) (c) (d) (a) sampling the light source according to emitted power, with n 1 = 3 samples per pixel, (b) sampling the hemisphere according to the projected solid angle <ref> [3] </ref> cos ( 0 i ) d (~! 0 i ) (see Fig. 1), with n 2 = 6 samples per pixel, and (c) a weighted combination of samples from (a) and (b) using the power heuristic with fi = 2. (d) A plot of = (standard deviation divided by mean)
Reference: [4] <author> R. Cook, T. Porter, and L. Carpenter. </author> <title> Distributed ray tracing. </title> <booktitle> Computer Graphics (SIGGRAPH '84 Proceedings), </booktitle> <volume> 18, </volume> <month> 137-146 </month> <year> (1984). </year>
Reference: [5] <author> J. Kajiya. </author> <title> The rendering equation. </title> <booktitle> Computer Graphics (SIGGRAPH '86 Proceedings), </booktitle> <volume> 20, </volume> <month> 143-150 </month> <year> (1986). </year>
Reference-contexts: Monte Carlo rendering 2.1 Integrals for radiance We have chosen two basic problems in rendering to illustrate our techniques: evaluation of the radiance leaving a surface given a description of the incoming illumination (as in distribution ray tracing or some final gather approaches), and direct solution of the rendering equation <ref> [5] </ref>. For further details and background see [3]. <p> problem: given an emitted radiance distribution L e , find the equilibrium radiance distribution L satisfying L (x !x ) = L e (x !x ) (3) Z f r (x$x $x )G (x$x )L (x!x ) dA (x): This is known as the three-point rendering or light transport equation <ref> [5] </ref>. Equation (3) can be written concisely in operator form as L = L e + T L, where T is the light transport operator.
Reference: [6] <author> M. Kalos and P. Whitlock. </author> <title> Monte Carlo Methods, Volume I: Basics. </title> <editor> J. </editor> <publisher> Wiley, </publisher> <address> New York, </address> <year> 1986. </year>
Reference-contexts: This tradeoff is summarized by the efficiency <ref> [1, 6] </ref> of a Monte Carlo estimator, *[F ] = V [F ] T [F ] where T [F ] is the time required to take a sample from F . The higher the efficiency, the less time required to achieve a given variance. <p> Unfortunately the normalization p = f =F requires knowledge of F , so this is not practical. However, by choosing a distribution p whose shape is similar to f , variance can be reduced. This idea is known as importance sampling <ref> [6] </ref>. On the other hand, suppose that we sample f inadequately in some region U where its value is large (i.e. p t f =F ). By (8) we see that samples from U can make a large contribution to the variance, even if U is relatively small. <p> Each such group of samples is dependent, but this does not appear to significantly affect our results. Another important optimization reduces the number of visibility tests between the eye and light subpaths, by using Russian roulette <ref> [6] </ref> to randomly suppress small potential contributions without adding bias. The final image in Fig. 9 (b) was created by combining samples from all distributions using the power heuristic (with fi = 2). The image is 500 by 500 with 25 samples per pixel.
Reference: [7] <author> D. Kirk and J. Arvo. </author> <title> Unbiased sampling techniques for image synthesis. </title> <journal> Computer Graphics (SIGGRAPH '91), </journal> <volume> 25, </volume> <month> 153-156 </month> <year> (1991). </year>
Reference-contexts: One research area is the derivation of a priori rules for specific applications (similar to [12]). Another goal is to find strategies for the general case; adaptive methods seem promising here. Note that adaptive methods can introduce bias, unless two-stage sampling is used <ref> [7] </ref>. Acknowledgments Thanks to Pat Hanrahan, Marc Levoy, Luanne Lemmer, and the anonymous reviewers for helpful comments that improved the presentation. Discussions with John Tukey were also useful. Thanks to Bill Kalsow for answering lots of questions about Modula-3 [10], the language we used for our rendering system.
Reference: [8] <author> E. Lafortune and Y. Willems. </author> <title> Bi-directional path tracing. </title> <booktitle> Proceedings of CompuGraphics, </booktitle> <address> Alvor, Portugal, </address> <month> 145-153 (Dec. </month> <year> 1993). </year>
Reference-contexts: In this section, we show that by combining samples from several importance sampling techniques, this process can be made more efficient. As a source of sampling distributions, we use bidirectional path tracing (introduced independently in [14] and <ref> [8, 9] </ref>). We briefly overview the theory below. To apply our methods, we must first express the value I p of a pixel p in the standard form R f (x) d (x).
Reference: [9] <author> E. Lafortune, Y. Willems. </author> <title> A theoretical framework for physically based rendering. </title> <journal> Computer Graphics Forum, </journal> <volume> 13(2), </volume> <month> 97-108 </month> <year> (1994). </year>
Reference-contexts: In this section, we show that by combining samples from several importance sampling techniques, this process can be made more efficient. As a source of sampling distributions, we use bidirectional path tracing (introduced independently in [14] and <ref> [8, 9] </ref>). We briefly overview the theory below. To apply our methods, we must first express the value I p of a pixel p in the standard form R f (x) d (x).
Reference: [10] <author> G. Nelson, </author> <title> editor. Systems Programming with Modula-3. </title> <publisher> Pren-tice Hall, </publisher> <year> 1991. </year> <note> An implementation of Modula-3 is available at http://www.research.digital.com/SRC/. </note>
Reference-contexts: Acknowledgments Thanks to Pat Hanrahan, Marc Levoy, Luanne Lemmer, and the anonymous reviewers for helpful comments that improved the presentation. Discussions with John Tukey were also useful. Thanks to Bill Kalsow for answering lots of questions about Modula-3 <ref> [10] </ref>, the language we used for our rendering system. This research was supported by the National Science Foundation (CCR-9215219), the Digital Systems Research Center, and the Digital External Research Program.
Reference: [11] <author> H. Rushmeier. </author> <title> Realistic Image Synthesis for Scenes with Radiatively Participating Media. </title> <type> Doctoral Thesis, </type> <institution> Cornell University, </institution> <month> May </month> <year> 1988. </year>
Reference-contexts: For example, some radiosity algorithms use a local pass or final gather to recompute certain coefficients more accurately. We examine a variation called per-pixel final gather. The idea is to compute an approximate radiosity solution, and then use it to illuminate the visible surfaces during a ray tracing pass <ref> [11, 2] </ref>. Essentially, this type of final gather is equivalent to ray tracing with many area light sources (one for each patch, or one for each link in a hierarchical solution). As with the glossy highlight example, there are two common sampling techniques.
Reference: [12] <author> P. Shirley and C. Wang. </author> <title> Distribution ray tracing: theory and practice. </title> <booktitle> Proceedings of the Third Eurographics Workshop on Rendering, </booktitle> <address> Bristol, England, </address> <month> 33-44 </month> <year> (1992). </year>
Reference-contexts: In parts of the scene where these omitted factors become dominant, simple directional sampling can be more efficient. By combining both kinds of samples, we can make such strategies more robust. Shirley and Wang <ref> [12] </ref> also compare directional and area sampling techniques for glossy highlights (Sec. 4.1). They analyze a specific Phong-like BRDF and light source sampling method, and derive an expression for when to switch from one to the other (as a function of surface roughness and light source solid angle). <p> Again, global illumination provides a rich framework, because of the complexity of the domain and the integrand. Another interesting problem is how to choose the c i . One research area is the derivation of a priori rules for specific applications (similar to <ref> [12] </ref>). Another goal is to find strategies for the general case; adaptive methods seem promising here. Note that adaptive methods can introduce bias, unless two-stage sampling is used [7]. Acknowledgments Thanks to Pat Hanrahan, Marc Levoy, Luanne Lemmer, and the anonymous reviewers for helpful comments that improved the presentation.
Reference: [13] <author> P. Shirley, C. Wang, and K. Zimmerman. </author> <title> Monte Carlo Techniques for Direct Lighting Calculations. </title> <journal> ACM Transactions on Graphics, </journal> <note> to appear. </note>
Reference-contexts: They differ only in the terms of the reflectance equation that cause high variancethe BRDF, the 1=r 2 distance term, or the emitted radiance distribution L e . In Sec. 4.2, we used a simple light source sampling technique. Although there are more sophisticated techniques for direct lighting <ref> [13] </ref>, it can still be useful to combine several kinds of samples. Observe that any strategy for sampling a group of patches as light sources induces some probability distribution on the patch surfaces. <p> Sometimes this is problematice.g. p j (x) may be expensive or complicated to evaluate. More difficulties arise when a sampling technique p j uses random numbers that cannot be determined from the resulting sample point x. For example, some direct lighting strategies <ref> [13] </ref> generate several candidate sample points x i , and then choose one randomly. Given an arbitrary point x, it is difficult to evaluate p j (x) because this probability depends on information other than the sample location x itself.
Reference: [14] <author> E. Veach and L. Guibas. </author> <title> Bidirectional estimators for light transport. </title> <booktitle> Proceedings of the Fifth EurographicsWorkshop on Rendering, </booktitle> <address> Darm-stadt, Germany, </address> <month> 147-162 (June </month> <year> 1994). </year>
Reference-contexts: In this section, we show that by combining samples from several importance sampling techniques, this process can be made more efficient. As a source of sampling distributions, we use bidirectional path tracing (introduced independently in <ref> [14] </ref> and [8, 9]). We briefly overview the theory below. To apply our methods, we must first express the value I p of a pixel p in the standard form R f (x) d (x).
References-found: 14

