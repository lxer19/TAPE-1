URL: http://www.graphics.cornell.edu/~eric/papers/Porto.ps.gz
Refering-URL: http://www.graphics.cornell.edu/~eric/Porto.html
Root-URL: http://www.cs.brown.edu/
Email: E-mail: Eric.Lafortune@cs.kuleuven.ac.be  
Phone: Telephone: +1 607 255 4880 Fax: +1 607 255 0806  
Title: Rendering Participating Media with Bidirectional Path Tracing  
Author: Eric P. Lafortune and Yves D. Willems Eric Lafortune 
Address: 580 Rhodes Hall Ithaca, NY 14853-3801  
Affiliation: Cornell University Program of Computer Graphics  
Note: Paper presented at the 7th Eurographics Workshop on Rendering Please send any correspondence to:  
Abstract-found: 0
Intro-found: 1
Reference: 1. <author> H. Rushmeier, </author> <title> Rendering participating media: Problems and solutions from application areas, </title> <booktitle> in Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <address> (Darmstadt, Germany), </address> <pages> pp. 3555, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: A typical example is the beam of light from the sun shining through a window of a dusty interior. In other applications such as visibility studies for traffic or for fire exits in buildings, the medium even plays a central role in the simulation problem. Rushmeier <ref> [1] </ref> and others [2, 3] have presented extensive overviews of research efforts and packages for the simulation of light in participating media. Depending on the applications they handle homogeneous or non-homogeneous and isotropic or anisotropic media. Many techniques only model single scattering, which suffices for optically thin media.
Reference: 2. <author> E. Languenou, K. Bouatouch, and M. Chelle, </author> <title> Global illumination in presence of participating media with general properties, </title> <booktitle> in Proceedings of the Fifth Euro-graphics Workshop on Rendering, </booktitle> <address> (Darmstadt, Germany), </address> <pages> pp. 6985, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: A typical example is the beam of light from the sun shining through a window of a dusty interior. In other applications such as visibility studies for traffic or for fire exits in buildings, the medium even plays a central role in the simulation problem. Rushmeier [1] and others <ref> [2, 3] </ref> have presented extensive overviews of research efforts and packages for the simulation of light in participating media. Depending on the applications they handle homogeneous or non-homogeneous and isotropic or anisotropic media. Many techniques only model single scattering, which suffices for optically thin media. <p> This lifts the assumption of the zonal methods that the participating medium is isotropic, at the cost of increased memory requirements. Languenou et al. <ref> [2] </ref> and Max [3] present algorithms to efficiently distribute power between the discrete elements. Point collocation methods use higher order basis functions, such as spherical harmonics, to represent the illumination function over the sphere, e.g. [8].
Reference: 3. <author> N. Max, </author> <title> Efficient light propagation for multiple anisotropic volume scattering, </title> <booktitle> in Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <address> (Darmstadt, Germany), </address> <pages> pp. 87104, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: A typical example is the beam of light from the sun shining through a window of a dusty interior. In other applications such as visibility studies for traffic or for fire exits in buildings, the medium even plays a central role in the simulation problem. Rushmeier [1] and others <ref> [2, 3] </ref> have presented extensive overviews of research efforts and packages for the simulation of light in participating media. Depending on the applications they handle homogeneous or non-homogeneous and isotropic or anisotropic media. Many techniques only model single scattering, which suffices for optically thin media. <p> This lifts the assumption of the zonal methods that the participating medium is isotropic, at the cost of increased memory requirements. Languenou et al. [2] and Max <ref> [3] </ref> present algorithms to efficiently distribute power between the discrete elements. Point collocation methods use higher order basis functions, such as spherical harmonics, to represent the illumination function over the sphere, e.g. [8].
Reference: 4. <author> H. Rushmeier, </author> <title> Realistic Image Synthesis for Scenes with Radiatively Participating Media. </title> <type> PhD thesis, </type> <institution> The Sibley School of Mechanical and Aerospace Engineering, Cornell University, </institution> <year> 1988. </year>
Reference-contexts: Most approaches can be classified into a few basic categories: zonal methods for isotropic scattering, P N methods, discrete ordinate methods, point collocation methods and image-based Monte Carlo methods. A zonal method that handles participating media was presented by Rushmeier <ref> [4] </ref>, as an extension to the basic radiosity algorithm. The algorithm assumes that the participating medium is isotropic and computes the exchange of light between the discretised volume elements and the surface elements in the scene. <p> Monte Carlo methods are generally either an extension to the path tracing algorithm as proposed by Kajiya [9] or to light tracing algorithms, as pioneered by Arvo [10]. Rushmeier <ref> [4] </ref> for instance presents an extension to the path tracing algorithm. It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium. <p> Due to their integral formulations they are well-suited for Monte Carlo eval uation, which we will discuss in the next section. 3 Tracing a random walk The sampling of the radiance equations is fairly straightforward and has been described for instance by Rushmeier <ref> [4] </ref>. It is intuitive in the sense that it can be regarded as a direct simulation of light particles scattering at dust or fog particles and reflecting at surfaces until they are absorbed.
Reference: 5. <author> J. Kajiya and V. Herzen, </author> <title> Ray tracing volume densities, </title> <journal> Computer Graphics, </journal> <volume> vol. 18, </volume> <pages> pp. 165174, </pages> <month> July </month> <year> 1984. </year>
Reference-contexts: P N methods also discretise the volume into finite elements, but now represent the radiance function as a series of spherical harmonics. They then solve the problem in its differential form, e.g. <ref> [5, 6] </ref>. Discrete ordinate methods discretise not only the original volume into finite volume elements, but also the directions of the sphere into finite solid angles, e.g. [7]. This lifts the assumption of the zonal methods that the participating medium is isotropic, at the cost of increased memory requirements.
Reference: 6. <author> J. Stam, </author> <title> Multiple scattering as a diffusion process, </title> <booktitle> in Proceedings of the Sixth Eurographics Workshop on Rendering, (Dublin, Ireland), </booktitle> <pages> pp. 6979, </pages> <month> June </month> <year> 1995. </year>
Reference-contexts: P N methods also discretise the volume into finite elements, but now represent the radiance function as a series of spherical harmonics. They then solve the problem in its differential form, e.g. <ref> [5, 6] </ref>. Discrete ordinate methods discretise not only the original volume into finite volume elements, but also the directions of the sphere into finite solid angles, e.g. [7]. This lifts the assumption of the zonal methods that the participating medium is isotropic, at the cost of increased memory requirements.
Reference: 7. <author> Ch. Patmore, </author> <title> Simulated multiple scattering for cloud rendering, </title> <booktitle> in Proceedings of ICCG, (Bombay, India), </booktitle> <pages> pp. 5970, </pages> <month> Feb. </month> <year> 1993. </year>
Reference-contexts: They then solve the problem in its differential form, e.g. [5, 6]. Discrete ordinate methods discretise not only the original volume into finite volume elements, but also the directions of the sphere into finite solid angles, e.g. <ref> [7] </ref>. This lifts the assumption of the zonal methods that the participating medium is isotropic, at the cost of increased memory requirements. Languenou et al. [2] and Max [3] present algorithms to efficiently distribute power between the discrete elements.
Reference: 8. <author> N. Bhate and A. Tokuta, </author> <title> Photorealistic volume rendering of media with directional scattering, </title> <booktitle> in Proceedings of the Third Eurographics Workshop on Rendering, (Bristol, UK), </booktitle> <pages> pp. 227245, </pages> <month> May </month> <year> 1992. </year>
Reference-contexts: Languenou et al. [2] and Max [3] present algorithms to efficiently distribute power between the discrete elements. Point collocation methods use higher order basis functions, such as spherical harmonics, to represent the illumination function over the sphere, e.g. <ref> [8] </ref>. Monte Carlo methods are generally either an extension to the path tracing algorithm as proposed by Kajiya [9] or to light tracing algorithms, as pioneered by Arvo [10]. Rushmeier [4] for instance presents an extension to the path tracing algorithm.
Reference: 9. <author> J. Kajiya, </author> <title> The rendering equation, </title> <journal> Computer Graphics, </journal> <volume> vol. 20, </volume> <pages> pp. 143150, </pages> <month> Aug. </month> <year> 1986. </year>
Reference-contexts: Point collocation methods use higher order basis functions, such as spherical harmonics, to represent the illumination function over the sphere, e.g. [8]. Monte Carlo methods are generally either an extension to the path tracing algorithm as proposed by Kajiya <ref> [9] </ref> or to light tracing algorithms, as pioneered by Arvo [10]. Rushmeier [4] for instance presents an extension to the path tracing algorithm. It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium.
Reference: 10. <author> J. Arvo, </author> <title> Backward ray tracing, </title> <month> Aug. </month> <year> 1986. </year>
Reference-contexts: Point collocation methods use higher order basis functions, such as spherical harmonics, to represent the illumination function over the sphere, e.g. [8]. Monte Carlo methods are generally either an extension to the path tracing algorithm as proposed by Kajiya [9] or to light tracing algorithms, as pioneered by Arvo <ref> [10] </ref>. Rushmeier [4] for instance presents an extension to the path tracing algorithm. It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium.
Reference: 11. <author> B. Roysam, A. Cohen, P. Getto, and P. Boyce, </author> <title> A numerical approach to the computation of light propagation through turbid media: Application to the evaluation of lighted exit signs, </title> <journal> IEEE Transactions on Industry Applications, </journal> <pages> pp. 661669, </pages> <month> May </month> <year> 1993. </year>
Reference-contexts: Rushmeier [4] for instance presents an extension to the path tracing algorithm. It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium. Roysam et al. <ref> [11] </ref> and Roze et al. [12] apply light tracing approaches, tracing random walks from the light sources, until they hit a detector. Pat-tanaik [13] follows this approach in the context of a zonal method, updating the radios-ity values at discrete volume and surface elements.
Reference: 12. <author> C. Roze, B. Maheu, and G. Grehan, </author> <title> Evaluations of the sighting distance in a foggy atmosphere by Monte Carlo simulation, </title> <journal> Atmospheric Environment, </journal> <volume> vol. 28, no. 5, </volume> <pages> pp. 769775, </pages> <year> 1994. </year>
Reference-contexts: Rushmeier [4] for instance presents an extension to the path tracing algorithm. It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium. Roysam et al. [11] and Roze et al. <ref> [12] </ref> apply light tracing approaches, tracing random walks from the light sources, until they hit a detector. Pat-tanaik [13] follows this approach in the context of a zonal method, updating the radios-ity values at discrete volume and surface elements.
Reference: 13. <author> S. Pattanaik, </author> <title> Computational Methods for Global Illumination and Visualisation of Complex 3D Environments. </title> <type> PhD thesis, </type> <institution> NCST Birla Institute of Technology & Science, Pilani, India, </institution> <month> Feb. </month> <year> 1993. </year>
Reference-contexts: It traces random walks starting from the eye point, reflecting at surfaces and additionally scattering in the medium. Roysam et al. [11] and Roze et al. [12] apply light tracing approaches, tracing random walks from the light sources, until they hit a detector. Pat-tanaik <ref> [13] </ref> follows this approach in the context of a zonal method, updating the radios-ity values at discrete volume and surface elements. In this contribution we propose an image-based Monte Carlo solution, now applying bidirectional path tracing rather than just path tracing. <p> This representation particularly suits zonal methods and other techniques that already discretise the scene to compute the illumination. In a ray tracing context the discreti-sation can be traversed while tracing a ray, treating each element as a homogeneous medium, e.g. <ref> [13] </ref>. An alternative and slightly more general representation allows any function to describe the scattering characteristics of the medium. Typically, this is an empirical noise function that mimics media such as smoke plumes and clouds of dust.
Reference: 14. <author> E. Lafortune and Y. Willems, </author> <title> Bi-directional path tracing, </title> <booktitle> in Proceedings of CompuGraphics, (Alvor, Portugal), </booktitle> <pages> pp. 145153, </pages> <month> Dec. </month> <year> 1993. </year>
Reference-contexts: The paths can scatter inside the medium or reflect at surfaces. The points on the respective paths are connected by means of shadow rays, which determine the contribution to the estimated flux of the pixel. 4 Bidirectional path tracing Bidirectional path tracing has been introduced by us <ref> [14, 15] </ref> and has been presented independently and improved by Veach and Guibas [16, 17]. It combines the ideas of path tracing and light tracing by creating random walks, starting not only from the eye point, but also from the light sources. Figure 4 shows the basic idea.
Reference: 15. <author> E. Lafortune and Y. Willems, </author> <title> A theoretical framework for physically based rendering, </title> <journal> Computer Graphics Forum, </journal> <volume> vol. 13, </volume> <pages> pp. 97107, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: The paths can scatter inside the medium or reflect at surfaces. The points on the respective paths are connected by means of shadow rays, which determine the contribution to the estimated flux of the pixel. 4 Bidirectional path tracing Bidirectional path tracing has been introduced by us <ref> [14, 15] </ref> and has been presented independently and improved by Veach and Guibas [16, 17]. It combines the ideas of path tracing and light tracing by creating random walks, starting not only from the eye point, but also from the light sources. Figure 4 shows the basic idea.
Reference: 16. <author> E. Veach and L. Guibas, </author> <title> Bidirectional estimators for light transport, </title> <booktitle> in Proceedings of the Fifth Eurographics Workshop on Rendering, </booktitle> <address> (Darmstadt, Germany), </address> <pages> pp. 147162, </pages> <month> June </month> <year> 1994. </year>
Reference-contexts: The points on the respective paths are connected by means of shadow rays, which determine the contribution to the estimated flux of the pixel. 4 Bidirectional path tracing Bidirectional path tracing has been introduced by us [14, 15] and has been presented independently and improved by Veach and Guibas <ref> [16, 17] </ref>. It combines the ideas of path tracing and light tracing by creating random walks, starting not only from the eye point, but also from the light sources. Figure 4 shows the basic idea.
Reference: 17. <author> E. Veach and L. Guibas, </author> <title> Optimally combining sampling techniques for Monte Carlo rendering, </title> <journal> Computer Graphics, </journal> <volume> vol. 29, </volume> <pages> pp. 419428, </pages> <month> Aug. </month> <year> 1995. </year>
Reference-contexts: The points on the respective paths are connected by means of shadow rays, which determine the contribution to the estimated flux of the pixel. 4 Bidirectional path tracing Bidirectional path tracing has been introduced by us [14, 15] and has been presented independently and improved by Veach and Guibas <ref> [16, 17] </ref>. It combines the ideas of path tracing and light tracing by creating random walks, starting not only from the eye point, but also from the light sources. Figure 4 shows the basic idea. <p> The algorithm has proven to be particularly effective for rendering scenes with indirect illumination, compared to ordinary path tracing [18]. The different illumination transport paths present different estimators for the flux, each one with its own potential strength. A judicious combination of the estimators <ref> [17] </ref> yields a robust estimator with a generally lower variance. <p> Together with the appropriate probability densities (11), the illumination contribution (10) can be combined into an unbiased estimator, as discussed in <ref> [17] </ref>.
Reference: 18. <author> E. Lafortune, </author> <title> Mathematical Models and Monte Carlo Algorithms for Physically Based Rendering. </title> <type> PhD thesis, </type> <institution> Katholieke Universiteit Leuven, Belgium, </institution> <month> Feb. </month> <year> 1996. </year>
Reference-contexts: Each shadow ray that is not intercepted by an object in the scene contributes to the estimated flux or average radiance through the pixel. The algorithm has proven to be particularly effective for rendering scenes with indirect illumination, compared to ordinary path tracing <ref> [18] </ref>. The different illumination transport paths present different estimators for the flux, each one with its own potential strength. A judicious combination of the estimators [17] yields a robust estimator with a generally lower variance.
Reference: 19. <author> Ch. </author> <type> Schlick, </type> <institution> Divers El ements pour une Synth ese d'Images R ealistes. </institution> <type> PhD thesis, </type> <institution> Universite Bordeaux 1, France, </institution> <month> Nov. </month> <year> 1992. </year>
Reference-contexts: The traversal obviously requires additional work, depending on the coarseness of the discrete steps. 6 Implementation and results We have implemented the presented extension in an existing bidirectional path tracing program. The scattering characteristics of the medium are modelled using the phase function proposed by Schlick <ref> [19] </ref>, which is energy-conserving and reciprocal, and which is computationally inexpensive to evaluate and to use as a PDF. It has been rendered at 640 fi 480 pixels, with 100 samples per pixel.
References-found: 19

