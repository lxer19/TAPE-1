URL: http://www.cs.cmu.edu/afs/cs.cmu.edu/user/oghattas/www/papers/ns-opt-control.ps.gz
Refering-URL: http://www.cs.cmu.edu/afs/cs.cmu.edu/user/oghattas/www/home.html
Root-URL: 
Title: OPTIMAL CONTROL OF TWO- AND THREE-DIMENSIONAL INCOMPRESSIBLE NAVIER-STOKES FLOWS  
Author: OMAR GHATTAS AND JAI-HYEONG BARK 
Keyword: Key words. optimal control, large-scale optimization, Navier-Stokes equations, sequential quadratic programming, reduced Hessian method, Newton method, quasi-Newton method  
Note: AMS(MOS) subject classifications. 49M05, 49M07, 49M15, 49M27, 49M37, 65K10, 76D05, 76M10, 90C06  
Abstract: The focus of this work is on the development of large-scale numerical optimization methods for optimal control of steady incompressible Navier-Stokes flows. The control is affected by the suction or injection of fluid on portions of the boundary, and the objective function represents the rate at which energy is dissipated in the fluid. We develop reduced Hessian sequential quadratic programming methods that avoid converging the flow equations at each iteration. Both quasi-Newton and Newton variants are developed, and compared to the approach of eliminating the flow equations and variables, which is effectively the generalized reduced gradient method. Optimal control problems are solved for two-dimensional flow around a cylinder and three-dimensional flow around a sphere. The examples demonstrate at least an order-of-magnitude reduction in time taken, allowing the optimal solution of flow control problems in as little as half an hour on a desktop workstation. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> G. K. Batchelor, </author> <title> An Introduction to Fluid Dynamics, </title> <publisher> Cambridge University Press, </publisher> <year> 1967. </year>
Reference-contexts: Here, 16 O. GHATTAS AND J.-H. BARK we define the Reynolds number, Re, by Re = where D is the cylinder diameter. Without boundary control, the behavior of the velocity field with increasing Reynolds number is depicted in, for example, <ref> [1] </ref>. Flow separation is evident for Reynolds numbers as low as 10. The flowfield remains stationary and exhibits two symmetric standing eddies up to around Re=50. Beyond this range, the wake becomes increasingly unstable and oscillatory, and a vortex street forms in the wake and persists downstream. <p> Finally, we demonstrate the capability of the reduced Hessian SQP optimal control method by solving a three-dimensional optimal flow control problem. We select a model problem of flow around a sphere at a Reynolds number of 130, which is the limit of steady flow for this problem <ref> [1] </ref>. Again, we exploit symmetry, this time about two orthogonal planes, to obtain a quarter model of the sphere. Along the planes of symmetry, zero tangential traction and zero normal velocity are specified as boundary conditions.
Reference: [2] <author> L. T. Biegler, J. Nocedal, and C. Schmid, </author> <title> A reduced Hessian method for large-scale constrained optimization, </title> <journal> SIAM Journal on Optimization, </journal> <volume> 5 (1995), </volume> <pages> pp. 314-347. </pages>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction [19], structural design [24], [25], and compressible flow [22], [21]. SQP methods using these bases have been analyzed in [7], [26], and <ref> [2] </ref>, among others. <p> This is a big reduction, especially for large n c . However, we can do even better. At the expense of a reduction from one-step to two-step superlinear convergence <ref> [2] </ref>, we ignore the second-order terms (those involving submatrices of W) on the righthand side of (3.6). Furthermore, we reduce (3.7) to a first-order Lagrange multiplier estimate by dropping terms involving blocks of W.
Reference: [3] <author> E. J. Cramer, J. E. Dennis, P. D. Frank, R. M. Lewis, and G. R. Shubin, </author> <title> Problem formulation for multidisciplinary optimization, </title> <journal> SIAM Journal on Optimization, </journal> <volume> 4 (1994), </volume> <pages> pp. 754-776. </pages>
Reference-contexts: A related idea is to pose the early optimization iterations on a coarse mesh, and refine as the optimum is approached; this can be very effective, as advanced in [16] and [27]. Finally, in <ref> [3] </ref>, a number of possibilities are defined that are intermediate between the extremes of GRG (full flow convergence per optimization iteration) and reduced SQP (one state equation Newton step per optimization iteration).
Reference: [4] <author> T. A. Davis, </author> <title> Users' guide for the unsymmetric pattern multifrontal package (UMFPACK), </title> <type> Tech. Rep. </type> <institution> TR-93-020, CIS Dept., Univ. of Florida, </institution> <address> Gainesville, FL, </address> <year> 1993. </year>
Reference-contexts: This no doubt stems from the penalty formulation, and we expect that a different conclusion would have been reached had a mixed formulation (one that included both velocity and pressure) been chosen. Instead, we have chosen the multifrontal sparse LU factorization code UMFPACK <ref> [4] </ref>, [5] for solving the systems involving A ss and its transpose. UMFPACK provides a routine for computing the LU factors of a given sparse matrix.
Reference: [5] <author> T. A. Davis and I. S. Duff, </author> <title> An unsymmetric pattern multifrontal method for sparse LU factorization, </title> <type> Tech. Rep. </type> <institution> TR-93-018, CIS Dept., Univ. of Florida, </institution> <address> Gainesville, FL, </address> <year> 1993. </year>
Reference-contexts: This no doubt stems from the penalty formulation, and we expect that a different conclusion would have been reached had a mixed formulation (one that included both velocity and pressure) been chosen. Instead, we have chosen the multifrontal sparse LU factorization code UMFPACK [4], <ref> [5] </ref> for solving the systems involving A ss and its transpose. UMFPACK provides a routine for computing the LU factors of a given sparse matrix.
Reference: [6] <author> C. Farhat and P.-S. Chen, </author> <title> Tailoring domain decomposition methods for efficient parallel coarse grid solution and for systems with many right hand sides, in Domain Decomposition Methods in Science and Engineering, </title> <booktitle> vol. 180 of Contemporary Mathematics, </booktitle> <publisher> American Mathematical Society, </publisher> <year> 1994, </year> <pages> pp. 401-406. </pages>
Reference-contexts: In particular, domain decomposition methods tailored to multiple righthand sides appear to be attractive <ref> [6] </ref>. Once the matrix A 1 ss A sc is created, forming its products with subma-trices of W presents no difficulty. Recall that W has O (n) nonzeroes and a sparsity structure dictated by the underlying finite element mesh.
Reference: [7] <author> D. Gabay, </author> <title> Reduced Quasi-Newton methods with feasibility improvement for nonlinearly constrained optimization, Mathematical Programming Study, </title> <note> 16 (1982), p. 18. </note>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction [19], structural design [24], [25], and compressible flow [22], [21]. SQP methods using these bases have been analyzed in <ref> [7] </ref>, [26], and [2], among others.
Reference: [8] <author> M. Gad-el-Hak, </author> <title> Flow control, </title> <journal> Applied Mechanics Reviews, </journal> <volume> 42 (1989), </volume> <pages> pp. 261-292. </pages>
Reference-contexts: Since then, much experimental work has been devoted to establishing the technological basis for flow control, and certain flow control problems have become amenable to analytical investigation, albeit often with simplifying assumptions; see the review by Gad-el-Hak <ref> [8] </ref>. Recently, interest has increased in optimal flow control of viscous fluids, that is the determination of optimal values of controls based on the governing partial differential equations of the fluid, i.e. the Navier-Stokes equations [20]. These problems are among the most challenging optimization problems in computational science and engineering.
Reference: [9] <author> O. Ghattas and C. E. Orozco, </author> <title> A parallel reduced Hessian SQP method for shape optimization, in Multidisciplinary Design Optimization: State-of-the-Art, </title> <editor> N. Alexandrov and M. Hussaini, eds., </editor> <publisher> SIAM, </publisher> <year> 1996. </year> <note> To appear. </note>
Reference-contexts: Navier-Stokes flow simulation. Algorithms 3.1 and 3.2 are well suited to parallel machines, since the majority of their work involves solution of linear systems having state equation Jacobians as their coefficient matrix; this is just a step of the forward problem, the parallelization of which is well-understood. Indeed, in <ref> [9] </ref> we discuss the parallel implementation of Algorithm 3.2 for a problem in shape optimization governed by compressible flows. Acknowledgements. We thank Beichang He for providing the time dependent Navier-Stokes simulations that were used to verify the symmetry and stationarity of the optimally-controlled flow.
Reference: [10] <author> P. E. Gill, W. Murray, and M. H. Wright, </author> <title> Practical Optimization, </title> <publisher> Academic Press, </publisher> <year> 1981. </year>
Reference-contexts: The gradient of the objective can be obtained through the implicit function theorem. This method is essentially the GRG method, since we are satisfying the constraints at each iteration <ref> [10] </ref>. <p> Instead, we pursue here bona fide SQP methods for the problem (2.12)-(2.13). SQP requires satisfaction of only a linear approximation of the constraints at each iteration, thereby avoiding the need to converge them fully <ref> [10] </ref>. Thus, state equations are satisfied simultaneously as control variables are converged to their optimal values. Furthermore, we consider a special reduced Hessian SQP method that retains the three advantages attributed to GRG in the paragraph above. <p> equations 2 K sc K ss cs K cs + K " K ss K sc 0 5 &lt; u s s = (3.2) 8 : ss s sc s 9 ; 8 : 0 9 ; SQP can be derived as a Newton method for solving the optimality conditions <ref> [10] </ref>.
Reference: [11] <author> M. D. Gunzburger, </author> <title> Finite Element Methods for Viscous Incompressible Flows, </title> <publisher> Academic Press, </publisher> <year> 1989. </year>
Reference-contexts: we further reduce the size of the problem by employing a penalty method: let us relax (2.4) by replacing it with r u = "p in :(2.9) Clearly as " ! 0, we recover the original equation; in fact, the error in the derivative of u is of order " <ref> [11] </ref>. By introducing the pressure in the mass equation, we can eliminate it from the problem by solving for p in (2.9) and substituting the resulting expression into (2.3). In general it is not possible to solve infinite dimensional optimization problems such as (2.1)-(2.8) in closed form. <p> It is well known that for the forward problem, i.e. solving the discrete Navier-Stokes equations, Newton's method is only locally convergent. The diameter of the ball of convergence is of the order of the inverse of the Reynolds number that characterizes the flow <ref> [11] </ref>; better initial guesses are thus required as the Reynolds number increases. The optimal control problem should be no easier to converge than the forward problem, given that the flow equations form part of the first-order optimality conditions. <p> The optimal control problem should be no easier to converge than the forward problem, given that the flow equations form part of the first-order optimality conditions. This suggests continuation methods, which are popular techniques for globalizing the forward problem <ref> [11] </ref>. Here, we use a simple continuation on Reynolds number. That is, suppose we want to solve an optimal control problem with a Reynolds number of Re fl , for which it is difficult to find a starting point from which Newton's method will converge. <p> We expect its efficiency to be between SQP and GRG. Finite element approximation of the continuous problem is achieved with isoparametric biquadratic rectangles in 2D and triquadratic hexahedra in 3D. These elements produce errors in the derivatives of u h of O (h 2 + ") <ref> [11] </ref>. All integrals are evaluated with Gauss-Legendre numerical integration 4 Recall that with GRG the constraints are eliminated and therefore the problem is an unconstrained one.
Reference: [12] <author> M. D. Gunzburger, ed., </author> <title> Flow Control, vol. 68 of IMA Volumes in Mathematics and its Applications, </title> <publisher> Springer-Verlag, </publisher> <year> 1995. </year>
Reference-contexts: For these reasons, state equation elimination methods are almost universal for PDE-constrained problems. For examples of this approach in the context of flow control, see the papers contained in <ref> [12] </ref>. Nevertheless, the approach outlined in the last two paragraphs possesses a distinct disadvantage: it requires exact solution of the state equations at each iteration. This can be an onerous requirement, especially for highly nonlinear problems such as those governed by Navier-Stokes equations.
Reference: [13] <author> M. D. Gunzburger, L. S. Hou, and T. P. Svobodny, </author> <title> Optimal control and optimization of viscous, incompressible flows, in Incompressible Computational Fluid Dynamics, </title> <editor> M. D. Gunzburger and R. A. Nicolaides, eds., </editor> <address> Cambridge, </address> <year> 1993, </year> <journal> ch. </journal> <volume> 5, </volume> <pages> pp. 109-150. </pages>
Reference-contexts: A number of basic results concerning existence and regularity of solutions to the continuous problem, as well as error estimates for its numerical approximation, have been established mostly over the last decade; see the article by Gunzburger, Hou, and Svobodny for a good overview <ref> [13] </ref>. This rich mathematical basis, the increasing power of computers, and the maturation of numerical methods for the flow simulation itself motivate the desire to develop numerical optimization methods for solution of optimal flow control problems. The latter forms the subject of this article.
Reference: [14] <author> R. T. Haftka, Z. G urdal, and M. P. Kamat, </author> <title> Elements of Structural Optimization, </title> <publisher> Kluwer Academic Publishers, </publisher> <year> 1990. </year>
Reference-contexts: The second linear system to be solved at each iteration has A T ss as its coefficient matrix, and is termed the adjoint step, because of parallels with adjoint methods for sensitivity analysis [15], <ref> [14] </ref>. The steps of this algorithm are almost identical to a quasi-Newton GRG method; the major difference is that in GRG the state equations are fully converged at each iteration, while in Algorithm 3.2 essentially only a single Newton step is carried out. <p> This method is chosen because of its popularity in the optimal control literature, and since it is easy to implement. In both GRG cases, the sensitivity equations are used to compute the objective function gradient exactly using a direct (as opposed to adjoint) method (see e.g. <ref> [14] </ref> or [15]). Continuation is applied to N-SQP and QN-SQP as described at the end of Section 3.
Reference: [15] <author> E. J. Haug and J. S. Arora, </author> <title> Applied Optimal Design, </title> <publisher> Wiley-Interscience, </publisher> <year> 1979. </year>
Reference-contexts: The second linear system to be solved at each iteration has A T ss as its coefficient matrix, and is termed the adjoint step, because of parallels with adjoint methods for sensitivity analysis <ref> [15] </ref>, [14]. The steps of this algorithm are almost identical to a quasi-Newton GRG method; the major difference is that in GRG the state equations are fully converged at each iteration, while in Algorithm 3.2 essentially only a single Newton step is carried out. <p> This method is chosen because of its popularity in the optimal control literature, and since it is easy to implement. In both GRG cases, the sensitivity equations are used to compute the objective function gradient exactly using a direct (as opposed to adjoint) method (see e.g. [14] or <ref> [15] </ref>). Continuation is applied to N-SQP and QN-SQP as described at the end of Section 3.
Reference: [16] <author> W. P. Huffman, R. G. Melvin, D. P. Young, F. T. Johnson, J. E. Bussoletti, M. B. Bieterman, and C. L. Hilmes, </author> <title> Practical design and optimization in computational fluid dynamics, </title> <booktitle> in Proceedings of 24th AIAA Fluid Dynamics Conference, </booktitle> <address> Orlando, Florida, </address> <month> July </month> <year> 1993. </year>
Reference-contexts: A related idea is to pose the early optimization iterations on a coarse mesh, and refine as the optimum is approached; this can be very effective, as advanced in <ref> [16] </ref> and [27]. Finally, in [3], a number of possibilities are defined that are intermediate between the extremes of GRG (full flow convergence per optimization iteration) and reduced SQP (one state equation Newton step per optimization iteration).
Reference: [17] <author> T. J. R. Hughes, W. K. Liu, and A. Brooks, </author> <title> Finite element analysis of incompressible viscous flow by the penalty function formulation, </title> <journal> Journal of Computational Physics, </journal> <volume> 30 (1979), </volume> <pages> pp. 1-60. </pages>
Reference-contexts: OPTIMAL CONTROL OF NAVIER-STOKES FLOWS 15 using a 3 fi 3 (fi3) scheme, with the exception of the penalized terms, which are "underintegrated" with a 2 fi 2 (fi2) scheme to avoid "locking" <ref> [17] </ref>. The value of the penalty parameter " is taken to be 10 7 . The flow solver has been verified against a standard benchmark, the driven cavity problem.
Reference: [18] <author> M. S. Khaira, G. L. Miller, and T. J. Sheffler, </author> <title> Nested dissection: A survey and comparison of various nested dissection algorithms, </title> <type> Tech. Rep. </type> <institution> CMU-CS-92-106R, Carnegie Mellon University, </institution> <year> 1992. </year>
Reference-contexts: If quasi-uniform meshes and nested dissection orderings are used, and if pivoting is not required, A ss can be factored with O (n 2 s ) work in 3D and O (n 1:5 s ) work in 2D <ref> [18] </ref>. In any case, the cost of one iteration of Algorithm 3.1 is a fraction of the cost of the forward problem.
Reference: [19] <author> F. S. Kupfer and E. W. Sachs, </author> <title> A prospective look at SQP methods for semi-linear parabolic control problems, in Optimal Control of Partial Differential Equations, </title> <editor> K. Hoffmann and W. Krabs, eds., </editor> <publisher> Springer, </publisher> <year> 1991, </year> <pages> pp. 145-157. </pages>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction <ref> [19] </ref>, structural design [24], [25], and compressible flow [22], [21]. SQP methods using these bases have been analyzed in [7], [26], and [2], among others.
Reference: [20] <author> P. Moin and T. </author> <title> Bewley, Feedback control of turbulence, </title> <journal> Applied Mechanics Reviews, </journal> <volume> 47 (1994), </volume> <pages> pp. </pages> <month> S3-S13. </month> <title> OPTIMAL CONTROL OF NAVIER-STOKES FLOWS 27 </title>
Reference-contexts: Recently, interest has increased in optimal flow control of viscous fluids, that is the determination of optimal values of controls based on the governing partial differential equations of the fluid, i.e. the Navier-Stokes equations <ref> [20] </ref>. These problems are among the most challenging optimization problems in computational science and engineering. They owe their complexity to their being constrained by numerical approximations of the Navier-Stokes equations. These constraints are highly nonlinear and can number in the millions.
Reference: [21] <author> C. E. Orozco and O. Ghattas, </author> <title> Massively parallel aerodynamic shape optimization, </title> <booktitle> Computing Systems in Engineering, </booktitle> <month> 1-4 </month> <year> (1992), </year> <pages> pp. </pages> <month> 311-320. </month> <title> [22] , Optimal design of systems governed by nonlinear partial differential equations, </title> <booktitle> in Fourth AIAA/USAF/NASA/OAI Symposium on Multidisciplinary Analysis and Optimization, AIAA, </booktitle> <year> 1992, </year> <pages> pp. 1126-1140. </pages>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction [19], structural design [24], [25], and compressible flow [22], <ref> [21] </ref>. SQP methods using these bases have been analyzed in [7], [26], and [2], among others.
Reference: [23] <author> L. Prandtl and O. G. Tietjens, Applied Hydro- and Aeromechanics, Dover, </author> <year> 1934, </year> <note> p. 81. </note>
Reference-contexts: 1. Introduction. Flow control has had a long history since Prandtl's early experiments demonstrated the feasibility of preventing flow separation by sucking fluid away from the boundary layer in a diverging channel <ref> [23] </ref>. Since then, much experimental work has been devoted to establishing the technological basis for flow control, and certain flow control problems have become amenable to analytical investigation, albeit often with simplifying assumptions; see the review by Gad-el-Hak [8].
Reference: [24] <author> U. Ringertz, </author> <title> Optimal design of nonlinear shell structures, </title> <type> Tech. Rep. </type> <institution> FFA TN 91-18, The Aeronautical Research Institute of Sweden, </institution> <year> 1991. </year> <title> [25] , An algorithm for optimization of nonlinear shell structures, International Journal for Numerical Methods in Engineering, </title> <booktitle> 38 (1995), </booktitle> <pages> pp. 299-314. </pages>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction [19], structural design <ref> [24] </ref>, [25], and compressible flow [22], [21]. SQP methods using these bases have been analyzed in [7], [26], and [2], among others.
Reference: [26] <author> Y. Xie, </author> <title> Reduced Hessian algorithms for solving large-scale equality constrained optimization problems, </title> <type> PhD thesis, </type> <institution> University of Colorado, Boulder, Department of Computer Science, </institution> <year> 1991. </year>
Reference-contexts: The choice of bases (3.11) and (3.12) is known as a "coordinate basis," and has been applied to optimization problems in inverse heat conduction [19], structural design [24], [25], and compressible flow [22], [21]. SQP methods using these bases have been analyzed in [7], <ref> [26] </ref>, and [2], among others.
Reference: [27] <author> D. P. Young, W. P. Huffman, R. G. Melvin, M. B. Bieterman, C. L. Hilmes, and F. T. Johnson, </author> <title> Inexactness and global convergence in design optimization, </title> <booktitle> in Proceedings of the 5th AIAA/NASA/USAF/ISSMO Symposium on Multidisciplinary Analysis and Optimization, </booktitle> <address> Panama City, Florida, </address> <month> Septem-ber </month> <year> 1994. </year>
Reference-contexts: A related idea is to pose the early optimization iterations on a coarse mesh, and refine as the optimum is approached; this can be very effective, as advanced in [16] and <ref> [27] </ref>. Finally, in [3], a number of possibilities are defined that are intermediate between the extremes of GRG (full flow convergence per optimization iteration) and reduced SQP (one state equation Newton step per optimization iteration).
References-found: 25

