URL: http://diva.eecs.berkeley.edu/~ljilja/papers/iscas98.ps
Refering-URL: http://diva.eecs.berkeley.edu/~ljilja/
Root-URL: 
Email: ljilja@cs.sfu.ca  eula@sequence.stanford.edu sanders@eecs.berkeley.edu  
Title: HOMSPICE: SIMULATOR WITH HOMOTOPY ALGORITHMS FOR FINDING DC AND STEADY-STATE SOLUTIONS OF NONLINEAR CIRCUITS  
Author: Ljiljana Trajkovic Eula Fung and Seth Sanders 
Address: Canada V5A 1S6  Berkeley, CA 94720-1770  
Affiliation: School of Engineering Science Simon Fraser University Burnaby, British Columbia  EECS Department University of California  
Abstract: We describe the use of homotopy (also called parameter embedding and continuation) methods for finding dc operating points and steady-state solutions of BJT and MOS transistor circuits. Past implementation of homotopy algorithms in proprietary industrial circuit simulators proved that they were viable options to resolving convergence difficulties for finding circuits' dc operating points. In this paper we describe a software implementation of publicly available homotopy algorithms (from the software package called HOMPACK) in the UCB SPICE circuit simulator. The new simulator, called HomSPICE, provides options for finding a circuit's dc operating points and steady-state solutions via three homotopy algorithms. We illustrate the performance of HomSPICE on several simulation examples. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> E. L. Allgower and K. Georg, </author> <title> Numerical Continuation Methods: An Introduction. </title> <address> New York: </address> <publisher> Springer-Verlag Series in Computational Mathematics, </publisher> <year> 1990, </year> <pages> pp. 115. </pages>
Reference-contexts: 1. INTRODUCTION Parameter embedding methods are robust and accurate numerical techniques for solving nonlinear algebraic equations <ref> [1] </ref>, [2]. They can be used to find multiple solutions of equations that possess more than one solution. A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence [3] have been implemented in a publicly available software package HOM-PACK [4].
Reference: [2] <author> L. T. Watson, </author> <title> Globally convergent homotopy algorithms for nonlinear systems of equations, Nonlinear Dynamics, </title> <journal> vol. </journal> <volume> 1, </volume> <pages> pp. 143191, </pages> <month> Feb. </month> <year> 1990. </year>
Reference-contexts: 1. INTRODUCTION Parameter embedding methods are robust and accurate numerical techniques for solving nonlinear algebraic equations [1], <ref> [2] </ref>. They can be used to find multiple solutions of equations that possess more than one solution. A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence [3] have been implemented in a publicly available software package HOM-PACK [4]. <p> At the turning point the values of decrease as the path progresses. Increasing from 0 to 1 results in losing the curve. The difficulty is resolved by making a function of a new parameter: the arc length s. This method is known as the arc length continuation [4], <ref> [2] </ref>. A variation [5] of the standard homotopy (5) H (x; ) = (1 )G (x a) + F (x) (6) was implemented in the HomSPICE dc operating point analysis. Diagonal matrix G allows scaling of the linear term (1 )(x a) in (6).
Reference: [3] <author> S. Chow, J. Mallet-Paret, and J. A. Yorke, </author> <title> Finding zeroes of maps: homotopy methods that are constructive with probability one, </title> <journal> Mathematics of Computation, </journal> <volume> vol. 32, no. 143, </volume> <pages> pp. 887899, </pages> <month> July </month> <year> 1978. </year>
Reference-contexts: 1. INTRODUCTION Parameter embedding methods are robust and accurate numerical techniques for solving nonlinear algebraic equations [1], [2]. They can be used to find multiple solutions of equations that possess more than one solution. A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence <ref> [3] </ref> have been implemented in a publicly available software package HOM-PACK [4]. Past research and implementations of homo-topy algorithms for finding circuit dc operating points indicated promising results [5], [6], [7].

Reference: [5] <author> R. C. Melville, Lj. Trajkovic, S. C. Fang and L. T. Watson, </author> <title> Artificial parameter homotopy methods for the dc operating point problem, </title> <journal> IEEE Trans. on CAD, </journal> <volume> vol. 12, no. 6, </volume> <pages> pp. 861877, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence [3] have been implemented in a publicly available software package HOM-PACK [4]. Past research and implementations of homo-topy algorithms for finding circuit dc operating points indicated promising results <ref> [5] </ref>, [6], [7]. These algorithms have been used to find solutions to highly nonlinear circuits that could not be simulated using conventional numerical methods. They are also useful in finding dc operating points of multistable circuits. The main drawback of homotopy methods is their computational intensity. <p> Increasing from 0 to 1 results in losing the curve. The difficulty is resolved by making a function of a new parameter: the arc length s. This method is known as the arc length continuation [4], [2]. A variation <ref> [5] </ref> of the standard homotopy (5) H (x; ) = (1 )G (x a) + F (x) (6) was implemented in the HomSPICE dc operating point analysis. Diagonal matrix G allows scaling of the linear term (1 )(x a) in (6).
Reference: [6] <author> Lj. Trajkovic and W. Mathis, </author> <title> Parameter embedding methods for finding dc operating points: Formulation and implementation, </title> <booktitle> Proc. </booktitle> <address> NOLTA '95, Las Vegas, NV, </address> <month> Dec. </month> <year> 1995, </year> <pages> pp. 11591164. </pages>
Reference-contexts: A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence [3] have been implemented in a publicly available software package HOM-PACK [4]. Past research and implementations of homo-topy algorithms for finding circuit dc operating points indicated promising results [5], <ref> [6] </ref>, [7]. These algorithms have been used to find solutions to highly nonlinear circuits that could not be simulated using conventional numerical methods. They are also useful in finding dc operating points of multistable circuits. The main drawback of homotopy methods is their computational intensity.
Reference: [7] <author> D. Wolf and S. Sanders, </author> <title> Multiparameter homotopy methods for finding dc operating points of nonlinear circuits, </title> <journal> IEEE Trans. Circuits Syst., </journal> <volume> vol. 43, </volume> <pages> pp. 824 838, </pages> <month> Oct. </month> <year> 1996. </year>
Reference-contexts: A class of embedding algorithms called probability-one homotopy algorithms that promise global convergence [3] have been implemented in a publicly available software package HOM-PACK [4]. Past research and implementations of homo-topy algorithms for finding circuit dc operating points indicated promising results [5], [6], <ref> [7] </ref>. These algorithms have been used to find solutions to highly nonlinear circuits that could not be simulated using conventional numerical methods. They are also useful in finding dc operating points of multistable circuits. The main drawback of homotopy methods is their computational intensity.
Reference: [8] <author> T. L. Quarles, A. R. Newton, D. O. Pederson, and A. Sangiovanni-Vincentelli, </author> <note> SPICE 3 Version 3F5 User's Manual, </note> <institution> Department of EECS, University of California, Berkeley, </institution> <month> March </month> <year> 1994. </year>
Reference-contexts: For circuits that fall in this category, homotopy algorithms offer a very attractive alternative. We have implemented several homotopy algorithms in SPICE 3F5 <ref> [8] </ref>, the latest version of Berkeley SPICE [9], [10]. The new simulator called HomSPICE, uses homo-topy algorithms implemented in software package HOM-PACK [4]. The three algorithms, FIXPDF, FIXPNF, and FIXPQF, are based on the ordinary differential equation, the normal flow, and the augmented Jacobian matrix methods, respectively. <p> The three algorithms, FIXPDF, FIXPNF, and FIXPQF, are based on the ordinary differential equation, the normal flow, and the augmented Jacobian matrix methods, respectively. The advantage of using SPICE and HOM-PACK is their publicly available source code. Further benefit of using SPICE <ref> [8] </ref> is that most commercial circuit simulators, being derived from SPICE, employ similar numerical algorithms for solving circuit equations. Homotopy algorithms were added as options for two types of SPICE analyses: calculating a circuit's dc operating points and calculating a circuit's periodic steady-state response. <p> The first step was easily solved because SPICE <ref> [8] </ref> employs the Newton-Raphson method that requires knowing F (x) and its Jacobian.
Reference: [9] <author> T. L. Quarles, </author> <title> The SPICE3 Implementation Guide, </title> <note> Memorandum No. </note> <institution> UCB/ERL M89/44, Department of EECS, University of California, Berkeley, </institution> <month> April 24, </month> <year> 1989. </year>
Reference-contexts: For circuits that fall in this category, homotopy algorithms offer a very attractive alternative. We have implemented several homotopy algorithms in SPICE 3F5 [8], the latest version of Berkeley SPICE <ref> [9] </ref>, [10]. The new simulator called HomSPICE, uses homo-topy algorithms implemented in software package HOM-PACK [4]. The three algorithms, FIXPDF, FIXPNF, and FIXPQF, are based on the ordinary differential equation, the normal flow, and the augmented Jacobian matrix methods, respectively.
Reference: [10] <author> A. Vladimirescu, </author> <title> The SPICE Book. </title> <address> New York: </address> <publisher> John Wiley & Sons, Inc., </publisher> <year> 1994. </year>
Reference-contexts: For circuits that fall in this category, homotopy algorithms offer a very attractive alternative. We have implemented several homotopy algorithms in SPICE 3F5 [8], the latest version of Berkeley SPICE [9], <ref> [10] </ref>. The new simulator called HomSPICE, uses homo-topy algorithms implemented in software package HOM-PACK [4]. The three algorithms, FIXPDF, FIXPNF, and FIXPQF, are based on the ordinary differential equation, the normal flow, and the augmented Jacobian matrix methods, respectively.
Reference: [11] <author> P. N. Ashar, </author> <title> Implementation of algorithms for the periodic steady-state analysis of nonlinear circuits, M. S. </title> <type> Thesis, </type> <institution> UC Berkeley, </institution> <month> March </month> <year> 1989. </year>
Reference-contexts: Unfortunately, this process may take an intolerably long time for lightly damped circuits, circuits with time constants much larger than their switching periods, and for high Q circuits. For such circuits, a direct steady-state solver is a better option. Two steady-state algorithms were implemented in SPICE 3C1 <ref> [11] </ref> and these routines have been included in HomSPICE. 2. HOMOTOPY METHODS: BACKGROUND Homotopy methods are used to solve systems of nonlinear algebraic equations and can be applied to a large variety of problems. <p> The Jacobian matrix of (; 0; T ) can be computed using sensitivity circuits. It is most efficiently computed during the transient analysis that already generates many required values. The details of calculating the Jacobian, otherwise known as the sensitivity matrix, can be found in <ref> [11] </ref> and [14]. To apply globally convergent homotopies to the shooting problem requires that the Poincare map be: * C 2 and * (; 0; T ) maps a convex, compact set into itself. However, we cannot guarantee that any of these conditions are met.
Reference: [12] <author> C. W. Ho, A. E. Ruehli, and P. A. Brennan, </author> <title> The modified nodal approach to network analysis, </title> <journal> IEEE Trans. Circuits Syst., </journal> <volume> vol. CAS-22, </volume> <pages> pp. 504509, </pages> <month> Jan. </month> <year> 1975. </year>
Reference-contexts: matrix form, called here A, along with a right hand side vector b that satisfies Aj x (i) x (i) F (x (i) ) = bj x (i) : (8) Hence, at every iteration, F (x) = Ax b; (9) where F (x) are the Modified Nodal Analysis circuit equations <ref> [12] </ref>. Creating homotopies is rather straightforward, except for choosing which x j in the linear term (1 )g ii (x j a i ) needs to be added to each equation f i (x) when creating the homotopy (6).
Reference: [13] <author> P. Horowitz and W. Hill, </author> <booktitle> The Art of Electronics. </booktitle> <address> Cam-bridge, MA: </address> <publisher> Cambridge University Press, </publisher> <year> 1983. </year>
Reference-contexts: The algorithm implemented in HomSPICE uses a swapping technique to ensure that the same variable is never added twice. The performance of HomSPICE is illustrated by simulating the triple Schmitt trigger cascade circuit <ref> [13] </ref>. The results are shown in Table 1. 4. STEADY-STATE ANALYSIS Three standard techniques for computing the steady-state response directly are: finite difference, shooting, and harmonic balance [14]. The shooting method is the most attractive for implementation in SPICE.
Reference: [14] <author> K. S. Kundert, J. K. White, and A. Sangiovanni-Vincentelli, </author> <title> Steady-State Methods for Simulating Analog and Microwave Circuits. </title> <address> Boston, MA: </address> <publisher> Kluwer Academic Publishers, </publisher> <year> 1990. </year>
Reference-contexts: The performance of HomSPICE is illustrated by simulating the triple Schmitt trigger cascade circuit [13]. The results are shown in Table 1. 4. STEADY-STATE ANALYSIS Three standard techniques for computing the steady-state response directly are: finite difference, shooting, and harmonic balance <ref> [14] </ref>. The shooting method is the most attractive for implementation in SPICE. <p> The Jacobian matrix of (; 0; T ) can be computed using sensitivity circuits. It is most efficiently computed during the transient analysis that already generates many required values. The details of calculating the Jacobian, otherwise known as the sensitivity matrix, can be found in [11] and <ref> [14] </ref>. To apply globally convergent homotopies to the shooting problem requires that the Poincare map be: * C 2 and * (; 0; T ) maps a convex, compact set into itself. However, we cannot guarantee that any of these conditions are met.
Reference: [15] <author> T. J. Aprille and T. N. </author> <title> Trick, Steady-state analysis of nonlinear circuits with periodic inputs, </title> <journal> Proc. IEEE, </journal> <volume> vol. 60, </volume> <pages> pp. 10814, </pages> <month> January </month> <year> 1972. </year>
Reference-contexts: The state variables are the currents through the inductors and voltages across the capacitors. The map (; 0; T ) is called the first return map or Poincare map. The shooting problem can be solved by various methods, including Newton-Raphson <ref> [15] </ref> and extrapolation [16]. Both methods are locally convergent. Using homotopy methods promises global convergence, though the computation time will take longer. In both Newton-Raphson and globally convergent homotopies, the state transition function and its Jacobian matrix need to be computed for various values of the state variables.
Reference: [16] <author> S. Skelboe, </author> <title> Computation of the periodic steady-state response of nonlinear networks by extrapolation methods, </title> <journal> IEEE Trans. Circuits Syst., </journal> <volume> vol. CAS-27, </volume> <pages> pp. 161175, </pages> <month> March </month> <year> 1980. </year>
Reference-contexts: The state variables are the currents through the inductors and voltages across the capacitors. The map (; 0; T ) is called the first return map or Poincare map. The shooting problem can be solved by various methods, including Newton-Raphson [15] and extrapolation <ref> [16] </ref>. Both methods are locally convergent. Using homotopy methods promises global convergence, though the computation time will take longer. In both Newton-Raphson and globally convergent homotopies, the state transition function and its Jacobian matrix need to be computed for various values of the state variables. <p> In general, qualitative knowledge of the circuit's behavior should be sufficient to determine if the circuit will be an appropriate candidate for homotopy steady-state analysis. The steady-state HomSPICE solutions for a dc power supply circuit <ref> [16] </ref> are shown in Table 2. The two cycles in stead-state regime of each waveform are shown in Fig. 1 along with the solutions found by the homotopy analyses The solution traces of the FIXPNF algorithm are shown in Fig. 2. The traces generated by the other algorithms are similar.
References-found: 15

