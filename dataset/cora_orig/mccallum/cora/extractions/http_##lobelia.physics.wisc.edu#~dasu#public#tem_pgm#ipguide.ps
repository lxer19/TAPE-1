URL: http://lobelia.physics.wisc.edu/~dasu/public/tem_pgm/ipguide.ps
Refering-URL: http://lobelia.physics.wisc.edu/~dasu/public/tem_pgm/
Root-URL: http://www.cs.wisc.edu
Title: TEM/PGM Installation and Programming Guide  
Author: T. Gorski, J. Lackey, S.Dasu, W. H. Smith 
Date: September 15, 1993  
Affiliation: University of Wisconsin  
Pubnum: SDC Note SDC 93-00533  
Abstract-found: 0
Intro-found: 1
Reference: [1] <author> T. Gorski, S. Dasu, J. Kehres, J. Lackey, W. H. Smith, </author> <title> SDC Trigger Emulation Module (TEM) Operations Manual, </title> <editor> U. Wisconsin SDC Note SDC-93-00413, </editor> <year> 1993. </year>
Reference-contexts: This document describes the installation of the cards in to a VMEbus crate, and also methods by which the many features on these modules may be programmed. The document assumes a general familiarity with the performance specifications for both the TEM <ref> [1] </ref> and PGM [2]. Periodic references to those documents are included within this user's guide. <p> As described in <ref> [1] </ref> and [2], these voltages are supplied to the modules via the J2 connector through the use of a Power Adapter Card. 2 The 2V supply must be able to supply 4 Amps to a TEM/PGM pair, or 2 Amps to a TEM alone. <p> For most of the programming described below, the TEM clock is shut off and individual clock pulses are provided by program control through the TEM Clock Single-Pulse strobe. (See section 5.4 of reference <ref> [1] </ref> for a description of the TEM clock logic.) This method allows for precise control of the number of clock edges which occur on the hardware between other VMEbus accesses, which is an essential requirement for such tasks as filling the TEM FIFO from a program buffer. 5.1 TEM FIFO This <p> In particular, it describes how to initialize the FIFO to a selected depth, and how to read or write-transfer a contiguous block of words between the FIFO and a program buffer. Refer to Section 5.6 of reference <ref> [1] </ref> for a description of the TEM FIFO logic. 5.1.1 Initialization Initialization of the FIFO is the process by which the FIFO is emptied with any previous data in the FIFO discarded, and by which a fixed time delay between the write and read pointers is established. <p> This task would likely be performed to read out a captured block of data in the FIFO after the TEM high-speed clock has been stopped by a Clock Stop bit. (See section 5.4 of reference <ref> [1] </ref> for a description of Clock Stop bit operation.) Block reads should be performed before any other task which involves the application of clock edges to the TEM. Otherwise, captured data will advance out of the FIFO and not be available to be read. 1. <p> At this point the block read is complete, with the last read word still poised at the FIFO output. 5.2 Busy Timer/L1 Accept Counters This sections discusses the steps necessary to initialize and operate the TEM Busy Timer and Level 1 Accept Counters. Described in Section 5.5 of reference <ref> [1] </ref>, the Busy Timer measures the length of time which the TEM Busy signal is active within a finite time apeture. The Level 1 Accept counters tabulate the total number of Level 1 Accept signals seen and transmitted by the module within the same apeture. <p> The module will generate no further VMEbus interrupt requests until one of these two actions occurs. Refer to Section 5.5.2 of reference [2] and Section 5.2 of reference <ref> [1] </ref> for descriptions of the PGM and TEM VMEbus interrupt operation. While the two modules use the same interrupt request mechanism, the specific status bits and their assigned meanings are obviously different. <p> After identifying the status bit (s) acting as the interrupt source, the processor should reset those select status bit (s). See Section 5.2.1 of reference [2] for the PGM and section 5.2 of reference <ref> [1] </ref> for the TEM for discussions on clearing Status Register bits. 5. The processor may disable a status bit at any time as a VMEbus interrupt request source by resetting its corresponding interrupt enable bit in the Configuration Regis ter.
Reference: [2] <author> T. Gorski, J. Lackey, S. Dasu, W. H. Smith, </author> <title> SDC Pattern Generation Module (PGM) Performance Specification, </title> <editor> U. Wisconsin SDC Note SDC-93-00412, </editor> <year> 1993. </year>
Reference-contexts: This document describes the installation of the cards in to a VMEbus crate, and also methods by which the many features on these modules may be programmed. The document assumes a general familiarity with the performance specifications for both the TEM [1] and PGM <ref> [2] </ref>. Periodic references to those documents are included within this user's guide. <p> As described in [1] and <ref> [2] </ref>, these voltages are supplied to the modules via the J2 connector through the use of a Power Adapter Card. 2 The 2V supply must be able to supply 4 Amps to a TEM/PGM pair, or 2 Amps to a TEM alone. <p> In particular, it relates the physical structure of those memories to the most suitable software data structures. As discussed in Section 5.4.5 of reference <ref> [2] </ref>, VMEbus access to the PGM memories is permitted only when the Pattern Generation State Machine on the module is in a halt state. This is easily accomplished by performing the following steps: 1. Make sure that bit 0 (PGM Enable) is reset in the PGM Configuration Register. <p> After these steps are performed, the PGM will allow free VMEbus access to the Descriptor Word and Pattern memories. 5.3.1 DWM Data Structures As described in Section 5.4.5 of reference <ref> [2] </ref>, the Descriptor Word Memory (DWM) is comprised of 512 Descriptor Words. Each Descriptor Word is 32-bits wide, and contains numerous subfields, as described in Section 5.4.1 of reference [2]. From the viewpoint of the VMEbus however, each 32-bit Descriptor Word is accessed as two adjacent 16-bit words. <p> free VMEbus access to the Descriptor Word and Pattern memories. 5.3.1 DWM Data Structures As described in Section 5.4.5 of reference <ref> [2] </ref>, the Descriptor Word Memory (DWM) is comprised of 512 Descriptor Words. Each Descriptor Word is 32-bits wide, and contains numerous subfields, as described in Section 5.4.1 of reference [2]. From the viewpoint of the VMEbus however, each 32-bit Descriptor Word is accessed as two adjacent 16-bit words. <p> fields on individual Descriptor Words in logical DWM, while the DWM_IO_image type instructs the compiler to generate object code with 16-bit transfers when reading or writing the physical DWM, in accordance with the demands of the VMEbus and PGM. 5.3.2 PM Data Structures As described in Section 5.4.5 of reference <ref> [2] </ref>, the Pattern Memory (PM) is 4K fi 1 byte wide. This byte width is mapped onto the odd byte of the 16-bit-wide VMEbus data interface. <p> These edges will advance the Pattern Generation State Machine into a Reset Halt state. 3. Download the constructed DWM and PM memory images, as discussed in Section 5.3. 4. If the Bunch Crossing 0 Counter, discussed in Section 5.4.3 of reference <ref> [2] </ref> and Appendix section A.8, is to be used, then the sync rate for the counter must be written to the BC0 Preload Register [PGM:000E]. In addition, bit 12 (BC0 Counter Enable) should be set in the PGM Configuration Register. 5. <p> In addition, bit 12 (BC0 Counter Enable) should be set in the PGM Configuration Register. 5. If any of the frontpanel Interrupt Branch inputs, described in Section 5.5 of reference <ref> [2] </ref>, are used, they should be enabled at this point. Setting bit 9 in the PGM Configuration Register enables the Trigger A frontpanel input. Setting bit 10 enables the Trigger B Input, and bit 11 enables the Vectored Interrupt input. 6. <p> Described in detail in Section 5.6 of reference <ref> [2] </ref>, the Interval Timer, as its name implies, measures the length of a defined time apeture. The Reject Counters tabulate the number of Trigger A and B interrupt branch requests which were rejected by the state machine in that same time apeture. <p> The module will generate no further VMEbus interrupt requests until one of these two actions occurs. Refer to Section 5.5.2 of reference <ref> [2] </ref> and Section 5.2 of reference [1] for descriptions of the PGM and TEM VMEbus interrupt operation. While the two modules use the same interrupt request mechanism, the specific status bits and their assigned meanings are obviously different. <p> The Status Register read should occur as close as possible to the beginning of the interrupt service procedure. 4. After identifying the status bit (s) acting as the interrupt source, the processor should reset those select status bit (s). See Section 5.2.1 of reference <ref> [2] </ref> for the PGM and section 5.2 of reference [1] for the TEM for discussions on clearing Status Register bits. 5. The processor may disable a status bit at any time as a VMEbus interrupt request source by resetting its corresponding interrupt enable bit in the Configuration Regis ter.
References-found: 2

