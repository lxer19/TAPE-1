URL: ftp://info.mcs.anl.gov/pub/tech_reports/reports/P515.ps.Z
Refering-URL: http://www.mcs.anl.gov/publications/abstracts/abstracts95.htm
Root-URL: http://www.mcs.anl.gov
Title: CIRCUMVENTING STORAGE LIMITATIONS IN VARIATIONAL DATA ASSIMILATION STUDIES  
Author: Juan Mario Restrepoy Gary K. Leafy Andreas Griewankz 
Keyword: Key words and phrases. variational data assimilation, adjoint model, climate, oil recovery, meteorology, recursion, storage.  
Address: Argonne, IL 60439 U.S.A.  Mommsenstr. 13, 01062 Dresden, Germany  
Affiliation: yMathematics and Computer Science Division Argonne, National Laboratory,  zInstitute of Scientific Computing, Mathematics Department, Technical University of Dresden,  M S-T E X  
Note: Preprint MCS-P515-0595  1991 Mathematics Subject Classification. 86A05, 86A10, 86A22, 86-04, 86-08.  Typeset by A  
Abstract: The aim of data assimilation is to infer the state of a system from a geophysical model and possibly incomplete or nonuniformly distributed spatiotemporal observational data. Used extensively in engineering control theory applications, data assimilation has relatively recently been introduced into meteorological forecasting, natural-resource recovery modeling, and climate dynamics. Variational data assimilation is a promising assimilation technique in which it is assumed that the state of the system is an extrema of a carefully chosen objective function. Provided that an adjoint model is available, the required model gradients can be computed by integrating the model forward and its adjoint backward. The gradients are then used to extremize the cost function with a suitable iterative or conjugate gradient solver. The problem we address in this study is the explosive growth in both on-line computer memory and remote storage requirements of large-scale assimilation studies. This imposes a severe physical limitation on the size of assimilation studies, even on the largest computers. By using a recursive strategy, a schedule can be constructed that enables the forward/adjoint model runs to be performed in such a way that storage requirements can be traded for longer computational times. This generally applicable strategy enables data assimilation studies on significantly larger domains than would otherwise be possible given particular hardware constraints. We show that this tradeoff is indeed viable and that when the schedule is optimized, the storage and computational times grow at most logarithmically. The authors thank Eli Tziperman for making his climate code available to us. J.M.R. became aware of this data assimilation problem in the course of many stimulating hours of conversation with Jochem Marotzke at MIT and Kirk Bryan at GFDL; their patience and their hospitality are much appreciated. This research was supported in part by an appointment to the Distinguished Postdoctoral Research Program sponsored by the U.S. Department of Energy, Office of University and Science Education Programs, and administered by the Oak Ridge Institute for Science and Education. Further support was provided by the Mathematical, Information, and Computational Sciences Division subprogram of the Office of Computational and Technology Research, U.S. Department of Energy, under Contract W-31-109-Eng-38. 
Abstract-found: 1
Intro-found: 1
Reference: 1. <author> National Academy Press, </author> <title> Four-Dimensional Model Assimilation of Data, A Strategy for the Earth System Sciences, </title> <institution> National Research Council, </institution> <year> 1991. </year>
Reference-contexts: Further support was provided by the Mathematical, Information, and Computational Sciences Division subprogram of the Office of Computational and Technology Research, U.S. Department of Energy, under Contract W-31-109-Eng-38. Typeset by A M S-T E X 1 2 J. M. RESTREPO, G. K. LEAF, A. GRIEWANK <ref> [1] </ref>. Introduction Data assimilation has relatively recently become an important tool in many areas of geophysics, such as weather and climate forecasting [1-6], model sensitivity analysis [7, 8], and in the inclusion of field data sets into theoretical model-studies [9-11].
Reference: 2. <author> M. Ghil, </author> <title> Metereological Data Assimilation for Oceanographers. Part I: Description and Theoretical Framework, </title> <booktitle> Dynamics of Atmospheres and Oceans 14 (1989), </booktitle> <pages> 171-218. </pages>
Reference-contexts: Section 5 summarizes our findings, provides details of the strategy's computer implementation, and tells where to obtain code that implements the method. <ref> [2] </ref>. Statement of the Problem For the sake of clarity we will assume that the physical problem in question can be modeled by an evolutionary equation. The physical m-dimensional real domain is R R m with boundary @R.
Reference: 3. <author> F. X. Le Dimet, O. </author> <title> Talagrand and Variational Algorithms for Analysis and Assimilation of Metereological Observations, </title> <booktitle> Tellus, Series A 38 (1986), </booktitle> <pages> 97-110. </pages>
Reference-contexts: The optimization problem requires the computation of the gradient of the model with respect to the state set. One of the other strategies that accomplishes the calculation of the gradient is the "adjoint method" <ref> [3] </ref>. <p> However, the tape grows linearly in both number of steps and size of the state set, which for typical geophysical applications will quickly overwhelm even the largest storage capabilities of computer facilities [13]. <ref> [3] </ref>. Recursive Adjoint Method The recursive strategy or "schedule" is specifically designed to circumvent the storage limitations of the conventional adjoint method at the expense of a larger computational effort.
Reference: 4. <author> W. C. Thacker, </author> <title> Oceanographic Inverse Problems, </title> <journal> Physica D (1992). </journal>
Reference-contexts: It may be that the effort required in large problems is significant, but this must be weighed against the fact that these problems may be simply impossible to consider with the conventional strategy. <ref> [4] </ref>. Application to a Quasi-Geostrophic Ocean Problem The recursive procedure's viability will be demonstrated by applying it to a quasi-geostrophic model [15] [16], which was considered in Tziperman and Thacker's study [13], hereafter referred to as T&T.
Reference: 5. <author> J. C. Derber, </author> <title> Variational Four Dimensional Analysis Using Quasi-Geostrophic Constraints, </title> <journal> Mon. Wea. Rev. </journal> <volume> 115 (1987), </volume> <pages> 998-1008. </pages>
Reference-contexts: In all trials the conjugate gradient procedure converged in three iterations. The conventional strategy took a wall-clock time of t = 0:147n + 0:0571 seconds. The recursive strategy took longer to complete, and its growth is not linear. Table 3 contains further information on this particular set of trials. <ref> [5] </ref>. Conclusions We have shown in this study how a recursive strategy for the adjoint-method calculation of the gradient may be applied to variational data assimilation studies of large-scale geophysical problems.
Reference: 6. <author> J. Marotzke and C. Wunsch, </author> <title> Finding the Steady State of a General Circulation Model Through Data Assimilation: Application to the North Atlantic Ocean, </title> <journal> Journal of Geophysical Research 98, </journal> <volume> C11, </volume> <pages> 20149-20167. </pages>
Reference: 7. <author> J. Schroter, </author> <title> Variational Assimilation of XBT Data: I, </title> <journal> J. Phys. Ocean. </journal> <volume> 20 (1990), </volume> <pages> 672-688. </pages>
Reference-contexts: Department of Energy, under Contract W-31-109-Eng-38. Typeset by A M S-T E X 1 2 J. M. RESTREPO, G. K. LEAF, A. GRIEWANK [1]. Introduction Data assimilation has relatively recently become an important tool in many areas of geophysics, such as weather and climate forecasting [1-6], model sensitivity analysis <ref> [7, 8] </ref>, and in the inclusion of field data sets into theoretical model-studies [9-11]. In weather forecasting, field data that may be spatially and/or temporally heteregeneous is continuously blended into dynamical models as soon as the field data is available.
Reference: 8. <author> J. Schroter and C. Wunsch, </author> <title> Solution of Nonlinear Finite Difference Ocean Models by Optimization Methods with Sensitivity and Observational Strategy Analysis, </title> <journal> Journal of Physical Oceanography 16 (1986), </journal> <pages> 1855-1874. </pages>
Reference-contexts: Department of Energy, under Contract W-31-109-Eng-38. Typeset by A M S-T E X 1 2 J. M. RESTREPO, G. K. LEAF, A. GRIEWANK [1]. Introduction Data assimilation has relatively recently become an important tool in many areas of geophysics, such as weather and climate forecasting [1-6], model sensitivity analysis <ref> [7, 8] </ref>, and in the inclusion of field data sets into theoretical model-studies [9-11]. In weather forecasting, field data that may be spatially and/or temporally heteregeneous is continuously blended into dynamical models as soon as the field data is available.
Reference: 9. <author> J. Marotzke, </author> <title> The Role of Integration Time in Determining a Steady State through Data Assimilation, </title> <booktitle> American Metereological Society 79 (1992), </booktitle> <pages> 35-38. </pages>
Reference-contexts: In T&T's study, n = 1. In their experiment such a choice is possible since the assimilation occurs at just one time level. The role of the integration time length in connection to T&T's problem was investigated by Marotzke <ref> [9] </ref>, where he concluded that in this quasi-geostrophic model, advective phenomena would not adjust quickly enough. He suggested that the assimilation be carried out over longer time spans.
Reference: 10. <author> B. F. Farrell and A. M. Moore, </author> <title> An Adjoint Method for Obtaining the Most Rapidly Growing Perturbation to Oceanic Flows, </title> <journal> Journal of Physical Oceanography 22 (1992), </journal> <pages> 338-349. </pages>
Reference: 11. <author> W. C. Thacker and R. B. </author> <title> Long, Fitting Dynamics to Data, </title> <journal> Journal of Geophysical Research 93, </journal> <volume> C2, </volume> <pages> 1227-1240. </pages>
Reference: 12. <author> O. Talagrand and P. Courtier, </author> <title> Variational Assimilation of Meteorological Observations with the Adjoint Vorticity Equation, Part I, </title> <journal> Theory, Quart. J. Roy. Met. Soc. </journal> <volume> 113 (1987), </volume> <pages> 1311-1328. </pages>
Reference-contexts: A specific approach to data assimilation is called variational data assimilation <ref> [12] </ref>. An objective function is defined that provides a norm of the distance or misfit of the state set to observational data. The state set may comprise model predictions, parameters, boundary data, and/or initial conditions. The misfit is usually weighted in order to account for measurement errors, model uncertainties, etc.
Reference: 13. <author> E. Tziperman and W. C. Thacker, </author> <title> An Optimal Control-Adjoint Equations Approach to Studying the Oceanic General Circulation, </title> <journal> J. Phys. Ocean. </journal> <volume> 19 (1989), </volume> <pages> 1471-1485. </pages>
Reference-contexts: However, the tape grows linearly in both number of steps and size of the state set, which for typical geophysical applications will quickly overwhelm even the largest storage capabilities of computer facilities <ref> [13] </ref>. [3]. Recursive Adjoint Method The recursive strategy or "schedule" is specifically designed to circumvent the storage limitations of the conventional adjoint method at the expense of a larger computational effort. <p> Application to a Quasi-Geostrophic Ocean Problem The recursive procedure's viability will be demonstrated by applying it to a quasi-geostrophic model [15] [16], which was considered in Tziperman and Thacker's study <ref> [13] </ref>, hereafter referred to as T&T. <p> For the sake of clarity w e will omit explicit mention that these quantities are discretized in space. On a discrete time grid t = it, the state variables i i and i evolve to a steady state e i and e . Following <ref> [13] </ref>, an assimilation problem is defined as follows. The observational data will be the steady-state vorticity e i, which is independent of time. The state set is taken to be the forcing term curlo , the initial vorticity i 0 , and the parameters * b and * h . <p> To this end, a cost function is chosen that measures the fit of the model result to the observations. Since the observations represent the steady state, the cost function should measure the departure of the model from steady state as well as the departure from the observations. In <ref> [13] </ref> the authors use the following discrete cost function: H n (curlo; i 0 ; * b ; * h ) = X h i where the sum indicates a sum over all the discrete values of the variables over the unit box.
Reference: 14. <author> A. Griewank, </author> <title> Achieving Logarithmic Growth in Temporal and Spatial Complexity in Reverse Automatic Differentiation, </title> <booktitle> Optimization Methods and Software 1 (1992), </booktitle> <pages> 35-54. </pages>
Reference-contexts: It will be shown below that the gradient produced by the recursive method will be identical to its nondegraded counterpart obtained in the conventional way. The description that follows will present a heuristic explanation of the theoretical development that appears in <ref> [14] </ref>. The basis of this strategy is to limit the tape size to dR, , where d n snapshots (snaps, for short) of states fug at any given point during the program execution. This is done by carefully overwriting. <p> This is done by carefully overwriting. It requires at most an additional r-fold increase in additional full forward unrecorded computations, or "reps". The recursive strategy is not unique. However, from Theorem 6.1 due to Griewank <ref> [14] </ref>, among the partitioning algorithms the "binomial partitioning" schedule is optimal.
Reference: 15. <author> G. Veronis, </author> <title> Wind Driven Ocean Circulation- Part 2. Numerical Solutions of the Nonlinear Problem. </title> , <note> Deep Sea Research 13 (1966), 31-55. 20 J. </note> <author> M. RESTREPO, G. K. LEAF, A. </author> <note> GRIEWANK </note>
Reference-contexts: Application to a Quasi-Geostrophic Ocean Problem The recursive procedure's viability will be demonstrated by applying it to a quasi-geostrophic model <ref> [15] </ref> [16], which was considered in Tziperman and Thacker's study [13], hereafter referred to as T&T.
Reference: 16. <author> J. Pedlosky, </author> <title> Geophysical Fluid Dynamics, </title> <publisher> Springer-Verlag, </publisher> <address> New York, </address> <year> 1979. </year> <institution> Mathematics and Computer Science Division, Argonne National Laboratory, Argonne, IL 60439 U.S.A E-mail address: restrepo@mcs.anl.gov Mathematics and Computer Science Division Argonne National Laboratory, Argonne, IL 60439 U.S.A. E-mail address: leaf@mcs.anl.gov Institute of Scientific Computing, Mathematics Department, Technical University of Dresden, </institution> <address> Mommsenstr. 13, 01062 Dresden, Germany E-mail address: griewank@math.tu-dresden.de </address>
Reference-contexts: Application to a Quasi-Geostrophic Ocean Problem The recursive procedure's viability will be demonstrated by applying it to a quasi-geostrophic model [15] <ref> [16] </ref>, which was considered in Tziperman and Thacker's study [13], hereafter referred to as T&T.
References-found: 16

