URL: ftp://dimacs.rutgers.edu/pub/dimacs/TechnicalReports/TechReports/1997/97-18rev.ps.gz
Refering-URL: http://dimacs.rutgers.edu/TechnicalReports/1997.html
Root-URL: http://www.cs.rutgers.edu
Email: E-mail: bhaskar@crab.rutgers.edu  E-mail: xinhe@cs.buffalo.edu  E-mail: jiang@maccs.mcmaster.ca  Email: mli@math.uwaterloo.ca  E-mail: tromp@cwi.nl  
Title: On the Linear-Cost Subtree-Transfer Distance between Phylogenetic Trees (Revised version of  
Author: Bhaskar DasGupta Xin He Tao Jiang Ming Li John Tromp 
Note: 3 Supported in part by CGAT and NSF grant 9205982. Work done while the author was visiting at  4 Supported in part by NSERC Operating Grant OGP0046613 and CGAT. Work done while the author was visiting at University of Washington. 5 Supported by NSERC Operating Grant OGP0046506 and CGAT. 6 Supported by an NSERC International Fellowship and CGAT. Work done while the author was with  
Address: Camden, NJ 08102, USA  Buffalo, NY 14260, USA  Hamilton, Ontario L8S 4K1, Canada  Waterloo, Ont. N2L 3G1, Canada  1090 GB Amsterdam Netherlands  Waterloo  
Affiliation: Department of Computer Science Rutgers University  Department of Computer Science SUNY-Buffalo  Department of Computer Science McMaster University  Department of Computer Science University of Waterloo  CWI  University of  University of Waterloo.  
Pubnum: DIMACS technical report 97-18) 1  
Abstract: 1 The results reported here also form a subset of the results that appeared in Proc. 8th Annual ACM-SIAM Symposium on Discrete Algorithms, 1997, pp. 427-436, New Orleans. The remaining results of the conference paper which do not appear in this paper will be published seperately. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D. Barry and J.A. Hartigan, </author> <title> Statistical analysis of hominoid molecular evolution, </title> <journal> Stat. Sci., </journal> <volume> 2(1987), </volume> <pages> 191-210. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility [17], distance [10, 21], and maximum likelihood <ref> [6, 7, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [2] <author> T. H. Cormen, C. E. Leiserson and R. L. Rivest, </author> <title> Introduction to Algorithms, </title> <publisher> The MIT Press, </publisher> <year> 1990. </year>
Reference-contexts: any connected subgraph of k edges including a fixed edge (k &gt; 1) can be represented by a rooted binary tree on k+2 nodes (the root corresponding to the middle of the fixed edge), hence there are at most C k+2 = 1 k+3 k+2 &lt; 2 2k such subgraphs <ref> [2, page 262] </ref>. For k = 1, there is exactly 1 &lt; 2 2k such subgraph.
Reference: [3] <author> B. DasGupta, X. He, T. Jiang, M. Li, J. Tromp and L. Zhang, </author> <title> On Distances between Phyloge-netic Trees, </title> <booktitle> Proc. 8th Annual ACM-SIAM Symposium on Discrete Algorithms, </booktitle> <year> 1997, </year> <pages> 427-436. </pages>
Reference-contexts: The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in <ref> [3] </ref> that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in [3, 18]. The problem of computing distance between phylogenies also arises in a different context. <p> The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in [3] that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in <ref> [3, 18] </ref>. The problem of computing distance between phylogenies also arises in a different context. <p> The rest of the paper is organized as follows. In section 1.1, we show that the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, the complexity and approximation results for the nni distance reported in <ref> [3, 4] </ref> directly apply to the linear-cost subtree 2 (b). The genetic material (thick lines), that is in one sequence after recombination, was in two sequences just before the recombination. <p> The results presented in this paper form a part of the results in <ref> [3] </ref>. The remaining results in 3 [3] deal with the proof of NP-hardness of computing the nni distance for (uniquely) labeled trees, as well as extending the nni distance for weighted phylogenies, and will be published seperately [4]. <p> The results presented in this paper form a part of the results in <ref> [3] </ref>. The remaining results in 3 [3] deal with the proof of NP-hardness of computing the nni distance for (uniquely) labeled trees, as well as extending the nni distance for weighted phylogenies, and will be published seperately [4]. Unless otherwise mentioned explicitly, the following definitions are used uniformly throughout the rest of the paper. <p> Hence the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, all the results on computing the nni distance reported in <ref> [3, 4] </ref> directly apply to the linear-cost subtree-transfer problem on unweighted phylogenies also.
Reference: [4] <author> B. DasGupta, X. He, T. Jiang, M. Li, J. Tromp and L. Zhang, </author> <title> On Computing the Nearest Neighbor Interchange Distance, </title> <type> Preprint, </type> <year> 1997. </year>
Reference-contexts: The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies [8]. Just like the nni model <ref> [4] </ref>, the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in [16]. <p> The rest of the paper is organized as follows. In section 1.1, we show that the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, the complexity and approximation results for the nni distance reported in <ref> [3, 4] </ref> directly apply to the linear-cost subtree 2 (b). The genetic material (thick lines), that is in one sequence after recombination, was in two sequences just before the recombination. <p> The remaining results in 3 [3] deal with the proof of NP-hardness of computing the nni distance for (uniquely) labeled trees, as well as extending the nni distance for weighted phylogenies, and will be published seperately <ref> [4] </ref>. Unless otherwise mentioned explicitly, the following definitions are used uniformly throughout the rest of the paper. All the trees in this paper are trees with internal nodes of degree 3 and with unique labels on leaves. <p> Hence the linear-cost subtree-transfer distance is in fact identical to the nni distance on unweighted phylogenies. As a result, all the results on computing the nni distance reported in <ref> [3, 4] </ref> directly apply to the linear-cost subtree-transfer problem on unweighted phylogenies also.
Reference: [5] <author> W. H. E. Day, </author> <title> Optimal Algorithms for Comparing Trees with Labeled Leaves, </title> <journal> J. Classification, </journal> <volume> 2(1985), </volume> <pages> 7-28. </pages>
Reference-contexts: The proof of the following lemma can be found in <ref> [5] </ref> which deals with computing strict consesus trees. Lemma 2 [5] Let T 1 and T 2 be two trees, each with n leaves. Then, the set of good edges of T 1 (with respect to T 2 ) can be enumerated in O (n) time. <p> The proof of the following lemma can be found in <ref> [5] </ref> which deals with computing strict consesus trees. Lemma 2 [5] Let T 1 and T 2 be two trees, each with n leaves. Then, the set of good edges of T 1 (with respect to T 2 ) can be enumerated in O (n) time. We also need the following rather straightforward observation. <p> We would also like to thank all the anonymous reviewers for their extremely helpful comments and pointing out reference <ref> [5] </ref> to us.
Reference: [6] <author> A.W.F. Edwards and L.L. Cavalli-Sforza, </author> <title> The reconstruction of evolution, </title> <journal> Ann. Hum. Genet., </journal> <volume> 27(1964), </volume> <pages> 105. </pages> <note> (Also in Heredity 18, 553.) </note>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [6, 9, 22] </ref>, compatibility [17], distance [10, 21], and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16]. <p> Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility [17], distance [10, 21], and maximum likelihood <ref> [6, 7, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [7] <author> J. Felsenstein, </author> <title> Evolutionary trees for DNA sequences: a maximum likelihood approach. </title> <journal> J. Mol. Evol., </journal> <volume> 17(1981), </volume> <pages> 368-376. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility [17], distance [10, 21], and maximum likelihood <ref> [6, 7, 1] </ref>. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [8] <author> J. Felsenstein, </author> <type> personal communication, </type> <year> 1996. </year>
Reference-contexts: Comparison of weighted phylogenies has recently been studied in [16]. The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies <ref> [8] </ref>. Just like the nni model [4], the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in [16].
Reference: [9] <author> W.M. Fitch, </author> <title> Toward defining the course of evolution: minimum change for a specified tree topology, </title> <journal> Syst. Zool., </journal> <volume> 20(1971), </volume> <pages> 406-416. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [6, 9, 22] </ref>, compatibility [17], distance [10, 21], and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [10] <author> W.M. Fitch and E. Margoliash, </author> <title> Construction of phylogenetic trees, </title> <journal> Science, </journal> <volume> 155(1967), </volume> <pages> 279-284. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility [17], distance <ref> [10, 21] </ref>, and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [11] <author> M. R. Garey and D. S. Johnson, </author> <title> Computers and Intractability: A Guide to the Theory of NP-Completeness, </title> <editor> W. H. </editor> <publisher> Freeman, </publisher> <year> 1979. </year>
Reference-contexts: QUESTION: Are there q disjoint sets C i 1 ; : : : ; C i q such that [ q X3C is known to be NP-complete <ref> [11] </ref>. We will construct two trees T 1 and T 2 with leaf labels (not necessarily unique), such that transforming from T 1 into T 2 requires subtree-transfers of total cost exactly 1 iff an exact cover of S exists. <p> Remark: Since the X3C problem is NP-complete even if each element occurs in at most 3 sets <ref> [11] </ref>, it follows that Theorem 7 holds even if every label, except only one label (label x in the proof), occurs in at most 3 leaves. 14 3.3 An Approximation Algorithm In this section, we prove the following theorem.
Reference: [12] <author> J. Hein, </author> <title> Reconstructing evolution of sequences subject to recombination using parsimony, </title> <journal> Math. Biosci., </journal> <volume> 98(1990), </volume> <pages> 185-200. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model [24] and a model using a list of phylogenetic trees <ref> [12, 13] </ref>. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another. <p> Figure 2 shows a recombination event between two sequences and Figure 3 shows a subtree-transfer operation and its corresponding recombination event. The parsimony model in <ref> [12, 13] </ref> requires the computation of the subtree-transfer distance between two trees, i.e. the minimum number of subtrees we need 1 in one sequence after recombination, was in two sequences just before the recombination. to move to transform one tree into the other.
Reference: [13] <author> J. Hein, </author> <title> A heuristic method to reconstruct the history of sequences subject to recombination, </title> <journal> J. Mol. Evol., </journal> <volume> 36(1993), </volume> <pages> 396-405. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model [24] and a model using a list of phylogenetic trees <ref> [12, 13] </ref>. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another. <p> Figure 2 shows a recombination event between two sequences and Figure 3 shows a subtree-transfer operation and its corresponding recombination event. The parsimony model in <ref> [12, 13] </ref> requires the computation of the subtree-transfer distance between two trees, i.e. the minimum number of subtrees we need 1 in one sequence after recombination, was in two sequences just before the recombination. to move to transform one tree into the other. <p> It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies. For example, it is reasonable to assume that sequences that have only diverged recently give rise to more recombinations than sequences that diverged many generations ago <ref> [13, 14] </ref>. In this case, we can charge each subtree-transfer operation a cost equal to the distance (number of nodes passed) that the subtree has moved in the current tree.
Reference: [14] <author> J. </author> <title> Hein, </title> <type> personal email communication, </type> <year> 1996. </year>
Reference-contexts: It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies. For example, it is reasonable to assume that sequences that have only diverged recently give rise to more recombinations than sequences that diverged many generations ago <ref> [13, 14] </ref>. In this case, we can charge each subtree-transfer operation a cost equal to the distance (number of nodes passed) that the subtree has moved in the current tree.
Reference: [15] <author> J. Hein, T. Jiang, L. Wang, and K. Zhang, </author> <title> On the complexity of comparing evolutionary trees, </title> <booktitle> Discrete Applied Mathematics 71, </booktitle> <pages> 153-169, </pages> <year> 1996. </year>
Reference-contexts: The parsimony model in [12, 13] requires the computation of the subtree-transfer distance between two trees, i.e. the minimum number of subtrees we need 1 in one sequence after recombination, was in two sequences just before the recombination. to move to transform one tree into the other. In <ref> [15] </ref> the authors show that computing the subtree-transfer distance is NP-complete and give a simple approximation algorithm with approximation ratio 3. It is relevant in practice to discriminate among subtree-transfer operations as they occur with different frequencies.
Reference: [16] <author> M. Kuhner and J. Felsenstein, </author> <title> A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates. Mol. </title> <journal> Biol. Evol. </journal> <volume> 11(3), </volume> <year> 1994, </year> <pages> 459-468. </pages>
Reference-contexts: The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species <ref> [16] </ref>. It is thus of interest to compare phylogenies produced by different methods, or by the same method on different data, for similarity and discrepancy. The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. <p> Many phylogeny reconstruction methods, including the distance and maximum likelihood methods, actually produce weighted phylogenies. Comparison of weighted phylogenies has recently been studied in <ref> [16] </ref>. The distance measure adopted is based on the difference in the partitions of the leaves induced by the edges in both trees, and has the drawback of being somewhat insensitive to the tree topologies [8]. <p> Just like the nni model [4], the linear-cost subtree-transfer model can be naturally extended to weighted phylogenies: a moving subtree is charged for the weighted distance it travels. Intuitively this measure is more sensitive to the tree topologies than the one in <ref> [16] </ref>. In this paper, we study the computational complexity and approximation algorithms for linear-cost subtree-transfer distance on both unweighted and weighted phylogenies. The rest of the paper is organized as follows.
Reference: [17] <author> W.J. Le Quesne, </author> <title> The uniquely evolved character concept and its cladistic application, </title> <journal> Syst. Zool., </journal> <volume> 23(1974), </volume> <pages> 513-517. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility <ref> [17] </ref>, distance [10, 21], and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [18] <author> M. Li, J. Tromp and L. Zhang, </author> <title> Some notes on the nearest neighbor interchange distance, </title> <journal> Journal of Theoretical Biology, </journal> <volume> 182(1996), </volume> <pages> 463-467. </pages>
Reference-contexts: The computational complexity of computing the nni distance has puzzled the research community for nearly 25 years until recently. It is shown in [3] that the nni distance is NP-hard to compute. Some efficient logarithmic-ratio approximation algorithms for the nni distance have also been proposed in <ref> [3, 18] </ref>. The problem of computing distance between phylogenies also arises in a different context. <p> An n O (d) algorithm for this problem 4 is trivial. With careful inspection, one can derive an algorithm that runs in O (n O (1) d O (d 2 ) ) time. It turns out that by using the results in <ref> [23, 18] </ref>, we can improve this asymptotically to O (n 2 21d=2 ) time. Definition 1 Let T 1 and T 2 be the two trees being compared. <p> We know that T 1 contains at least 1 (and at most d) bad edges. Moreover, assume that these bad edges form t connected components B 1 ; : : : ; B t (1 t d). As observed in <ref> [18] </ref>, for an optimal nni transformation, sometimes one or more nni operations are needed across a good internal edge of T 1 . Consider the set of at most d 1 good edges in T 1 across which at least one nni operation is performed in an optimal nni sequence. <p> Notice that M 0 i has at most ` i + 3 leaves. Lemma 1 of <ref> [18] </ref> states that the number of trees within an nni distance of m &gt; 1 from any given tree with n leaves is at most 3 n2 2 4m (for m = 1, the number of such trees is obviously at most n 3).
Reference: [19] <author> G. W. Moore, M. Goodman and J. Barnabas, </author> <title> An iterative approach from the standpoint of the additive hypothesis to the dendrogram problem posed by molecular data sets, </title> <journal> Journal of Theoretical Biology 38(1973), </journal> <pages> 423-457. </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [19, 20, 25] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to operate or perform on this internal edge.
Reference: [20] <author> D. F. Robinson, </author> <title> Comparison of labeled trees with valency three, </title> <journal> Journal of Combinatorial Theory, Series B, </journal> <volume> 11(1971), </volume> <pages> 105-119. </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [19, 20, 25] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to operate or perform on this internal edge.
Reference: [21] <author> N. Saitou and M. Nei, </author> <title> The neighbor-joining method: a new method for reconstructing phylo-genetic trees, Mol. </title> <journal> Biol. Evol., </journal> <volume> 4(1987), </volume> <pages> 406-425. </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony [6, 9, 22], compatibility [17], distance <ref> [10, 21] </ref>, and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [22] <author> D. Sankoff, </author> <title> Minimal mutation trees of sequences, </title> <journal> SIAM J. Appl. Math., </journal> <volume> 28(1975) 35-42. </volume> <pages> 20 </pages>
Reference-contexts: Over the past few decades, many different objective criteria and algorithms for reconstructing phylogenies have been developed, including (not exhaustively) parsimony <ref> [6, 9, 22] </ref>, compatibility [17], distance [10, 21], and maximum likelihood [6, 7, 1]. The outcomes of these methods usually depend on the data and the amount of computational resources applied. As a result, in practice they often lead to different trees on the same set of species [16].
Reference: [23] <author> D. Sleator, R. Tarjan, W. Thurston, </author> <title> Short encodings of evolving structures, </title> <journal> SIAM J. Discr. Math., </journal> <volume> 5(1992), </volume> <pages> 428-450. </pages>
Reference-contexts: An n O (d) algorithm for this problem 4 is trivial. With careful inspection, one can derive an algorithm that runs in O (n O (1) d O (d 2 ) ) time. It turns out that by using the results in <ref> [23, 18] </ref>, we can improve this asymptotically to O (n 2 21d=2 ) time. Definition 1 Let T 1 and T 2 be the two trees being compared. <p> Assume also the two (unweighted or weighted) trees involved in the distance calculation share no good edge pairs (Definition 1 or Definition 2, as appropriate). In the unweighted case, it is known that there are two trees which are at a distance of (n log n) <ref> [23] </ref>. However, in the weighted case, our factor 2 approximation algorithm and the lower bounds in Lemma 6 imply that any two trees are at a distance of at most O (1). Several open questions still remain and may be worth persuing further: 1.
Reference: [24] <author> Arndt von Haseler and Gary A. Churchill, </author> <title> Network models for sequence evolution, </title> <journal> J. Mol. Evol., </journal> <volume> 37(1993), </volume> <pages> 77-85. </pages>
Reference-contexts: In an attempt to solve this problem, more general evolutionary models have been proposed including the network model <ref> [24] </ref> and a model using a list of phylogenetic trees [12, 13]. In the latter, every tree corresponds to a specific region of the sequences, and each tree can be obtained from the preceding tree on the list by transferring some subtrees from one place to another.
Reference: [25] <author> M. S. Waterman and T. F. Smith, </author> <title> On the similarity of dendrograms, </title> <journal> Journal of Theoretical Biology, </journal> <volume> 73(1978), </volume> <pages> 789-800. 21 </pages>
Reference-contexts: The comparison of phylogenies is also routinely performed in simulation studies where people analyze reconstructed phylogenies against the true ones. Several metrics for measuring the distance between phylogenies have been proposed in the literature. Among these measures, the nearest neighbor interchange (nni) distance <ref> [19, 20, 25] </ref> has perhaps received the most attention. An nni operation swaps two subtrees that are separated by an internal edge (u; v), as shown in Figure 1. The nni operation is said to operate or perform on this internal edge.
References-found: 25

