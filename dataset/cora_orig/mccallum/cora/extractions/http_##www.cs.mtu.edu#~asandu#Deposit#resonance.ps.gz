URL: http://www.cs.mtu.edu/~asandu/Deposit/resonance.ps.gz
Refering-URL: http://www.cs.mtu.edu/~asandu/publications.html
Root-URL: http://www.cs.mtu.edu
Title: Masking resonance artifacts in force-splitting methods for biomolecular simulations by extrapolative Langevin dynamics  
Author: Adrian Sandu and Tamar Schlick 
Address: 251 Mercer Street, New York  New York, NY 10012  MI 49931  
Affiliation: Department of Chemistry and Courant Institute of Mathematical Sciences,  University and Howard Hughes Medical Institute,  Department of Computer Science, Michigan Technological University, Houghton,  
Date: November 17, 1998  
Note: JOURNAL OF COMPUTATIONAL PHYSICS 1-?? ARTICLE NO. HA-00000  Present address:  Correspondence author: schlick@nyu.edu  
Abstract-found: 0
Intro-found: 1
Reference: 1. <author> Y. Duan and P. A. Kollman. </author> <title> Pathways to a protein folding intermediate observed in a 1-microsecond simulation in aqueous solution. </title> <journal> Science, </journal> <volume> 282 </volume> <pages> 740-744, </pages> <year> 1998. </year>
Reference-contexts: While approximations are made in practice to reduce the cost of long-range interactions, a nanosecond simulation of a solvated, medium-sized biomolecule (around 20; 000 atoms) can require several weeks of computing time on state-of-the-art laboratory workstations. A pioneering 1-s simulation of a small protein <ref> [1] </ref> was only possible on a massively parallel Cray supercomputer employed in full for about 4 months. Despite the large computational work of standard explicit integrators, the Verlet method [2] is often regarded as the "gold standard" of molecular dynamics simulations.
Reference: 2. <author> L. Verlet. </author> <title> Computer experiments on classical fluids: I. Thermodynamical properties of Lennard-Jones molecules. </title> <journal> Phys. Rev., </journal> <volume> 159 </volume> <pages> 98-103, </pages> <year> 1967. </year>
Reference-contexts: A pioneering 1-s simulation of a small protein [1] was only possible on a massively parallel Cray supercomputer employed in full for about 4 months. Despite the large computational work of standard explicit integrators, the Verlet method <ref> [2] </ref> is often regarded as the "gold standard" of molecular dynamics simulations. Its symplecticness (i.e., volume preserving in phase space; see [3]) and time reversibility are well suited for low-accuracy long-time simulations of Hamil-tonian systems; in particular, Verlet trajectories display good energy conservation in comparison to non-symplectic methods. 1.1. <p> More important, the analyses offer guidelines for constructing effective biomolecu-lar integrators that balance stability with accuracy given the pragmatic dilemma mentioned above. The linear analyses started in [11] for a one-dimensional (1D) system were based on the symplectic Euler method. Here we base derivations on the Verlet discretization <ref> [2] </ref> and compare resonance artifacts of Extrapolation versus Impulse force splitting for both Newtonian and Langevin dynamics. Numerical experiments are also performed for nonlinear systems. <p> Analysis of the 1D Linear Model 2.2.1. Newtonian Dynamics 8 ADRIAN SANDU AND TAMAR SCHLICK Barth and Schlick [15, 11] examined MTS schemes based on the first order sym-plectic Euler method. Here we formulate methods based on the Velocity Verlet discretization <ref> [2, 3] </ref>; this integrator propagates the velocities (at half steps) and positions (at integral multiples of the timestep t ) of the system (2.1) as follows: V n+ 1 t flX n 2 (2.7) 2 2 The superscript n refers to the numerical approximation of X and V at time nt
Reference: 3. <author> J.M. Sanz-Serna and M.P. Calvo. </author> <title> Numerical Hamiltonian problems. </title> <publisher> Chapman & Hall, </publisher> <address> London, </address> <year> 1994. </year>
Reference-contexts: Despite the large computational work of standard explicit integrators, the Verlet method [2] is often regarded as the "gold standard" of molecular dynamics simulations. Its symplecticness (i.e., volume preserving in phase space; see <ref> [3] </ref>) and time reversibility are well suited for low-accuracy long-time simulations of Hamil-tonian systems; in particular, Verlet trajectories display good energy conservation in comparison to non-symplectic methods. 1.1. <p> Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method [7]. These methods are symplectic <ref> [3] </ref> and time reversible, and thus are intended to simulate accurately Hamiltonian dynamics. The requirement for symplecticness dictates that the slow forces be incorporated via impulses, that is only at the time of their evaluation; hence the name Impulse-MTS. <p> Analysis of the 1D Linear Model 2.2.1. Newtonian Dynamics 8 ADRIAN SANDU AND TAMAR SCHLICK Barth and Schlick [15, 11] examined MTS schemes based on the first order sym-plectic Euler method. Here we formulate methods based on the Velocity Verlet discretization <ref> [2, 3] </ref>; this integrator propagates the velocities (at half steps) and positions (at integral multiples of the timestep t ) of the system (2.1) as follows: V n+ 1 t flX n 2 (2.7) 2 2 The superscript n refers to the numerical approximation of X and V at time nt
Reference: 4. <author> W.B. Street, D.J. Tildesley, and G. Saville. </author> <title> Multiple time step methods in molecular dynamics. Mol. </title> <journal> Phys., </journal> <volume> 35 </volume> <pages> 639-648, </pages> <year> 1978. </year>
Reference-contexts: MTS Approaches and Resonance Nearly two decades ago, multiple-timestep (MTS) methods were introduced <ref> [4, 5] </ref> in an effort to reduce the computational costs of dynamic simulations. MTS methods rely on the observation that the fastest components of the force, which limit the stepsize to 0.5-1 fs, act on a relatively small spatial scale and hence have linear complexity.
Reference: 5. <author> R.D. Swindoll and J.M. Haile. </author> <title> A multiple time step method for molecular dynamics simulations of fluids of chain molecules. </title> <journal> J. Chem. Phys., </journal> <volume> 53 </volume> <pages> 289-298, </pages> <year> 1984. </year>
Reference-contexts: MTS Approaches and Resonance Nearly two decades ago, multiple-timestep (MTS) methods were introduced <ref> [4, 5] </ref> in an effort to reduce the computational costs of dynamic simulations. MTS methods rely on the observation that the fastest components of the force, which limit the stepsize to 0.5-1 fs, act on a relatively small spatial scale and hence have linear complexity.
Reference: 6. <author> M. Tuckerman, B.J. Berne, and G.J. Martyna. </author> <title> Reversible multiple time scale molecular dynamics. </title> <journal> J. Chem. Phys., </journal> <volume> 97 </volume> <pages> 1990-2001, </pages> <year> 1992. </year>
Reference-contexts: This spatial and temporal division can be exploited by using small timesteps (t ) to resolve the rapidly-varying vibrational modes and larger time intervals (t) to update the costly long-range forces. In the early to mid 1990s, these approaches were further developed and applied to biomolecular dynamics <ref> [6, 7, 8, 9] </ref>. Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method [7]. <p> Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization <ref> [6] </ref>, a special case of which is the Verlet-I method [7]. These methods are symplectic [3] and time reversible, and thus are intended to simulate accurately Hamiltonian dynamics. <p> These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes <ref> [6, 7] </ref> are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. These large pulses in turn lead to incorrect physical behavior of the system, such as overstretching and/or breaking of bonds [12, 14].
Reference: 7. <author> H. Grubmuller, H. Heller, A. Windemuth, and K. Schulten. </author> <title> Generalized Verlet algorithm for efficient molecular dynamics simulations with long-range interactions. Mol. </title> <journal> Sim., </journal> <volume> 6 </volume> <pages> 121-142, </pages> <year> 1991. </year>
Reference-contexts: This spatial and temporal division can be exploited by using small timesteps (t ) to resolve the rapidly-varying vibrational modes and larger time intervals (t) to update the costly long-range forces. In the early to mid 1990s, these approaches were further developed and applied to biomolecular dynamics <ref> [6, 7, 8, 9] </ref>. Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method [7]. <p> Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method <ref> [7] </ref>. These methods are symplectic [3] and time reversible, and thus are intended to simulate accurately Hamiltonian dynamics. The requirement for symplecticness dictates that the slow forces be incorporated via impulses, that is only at the time of their evaluation; hence the name Impulse-MTS. <p> These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes <ref> [6, 7] </ref> are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. These large pulses in turn lead to incorrect physical behavior of the system, such as overstretching and/or breaking of bonds [12, 14]. <p> This approach was considered by several groups to reduce the energy drift of extrapolation [22, 23, 10]; the derivation in [10], in particular, was motivated by the desire to approximate Verlet equivalence <ref> [7] </ref> for Constant Extrapolation. Hermans recently noticed [J. Hermans, personal communication] that correcting only for velocities improves numerical performance. This is the version we consider.
Reference: 8. <author> R. Zhou and B. J. </author> <title> Berne. A new molecular dynamics method combining the reference system propagator algorithm with a fast multipole method for simulating proteins and other complex systems. </title> <journal> J. Chem. Phys., </journal> <volume> 103 </volume> <pages> 9444-9459, </pages> <year> 1995. </year>
Reference-contexts: This spatial and temporal division can be exploited by using small timesteps (t ) to resolve the rapidly-varying vibrational modes and larger time intervals (t) to update the costly long-range forces. In the early to mid 1990s, these approaches were further developed and applied to biomolecular dynamics <ref> [6, 7, 8, 9] </ref>. Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method [7].
Reference: 9. <author> M. Watanabe and M. Karplus. </author> <title> Simulations of macromolecules by multiple time-step methods. </title> <journal> J. Chem. Phys., </journal> <volume> 99 </volume> <pages> 5680-5697, </pages> <year> 1995. </year>
Reference-contexts: This spatial and temporal division can be exploited by using small timesteps (t ) to resolve the rapidly-varying vibrational modes and larger time intervals (t) to update the costly long-range forces. In the early to mid 1990s, these approaches were further developed and applied to biomolecular dynamics <ref> [6, 7, 8, 9] </ref>. Much of these developments relied on the 4 ADRIAN SANDU AND TAMAR SCHLICK rigorous and general factorization formalism (disparate timescales, masses, etc.) of the r-RESPA method based on the Trotter factorization [6], a special case of which is the Verlet-I method [7]. <p> The requirement for symplecticness dictates that the slow forces be incorporated via impulses, that is only at the time of their evaluation; hence the name Impulse-MTS. These force-splitting schemes also provide modest computational speedup (factors of 4-5) <ref> [9] </ref> over single-timestep trajectories since savings are realized from updating the long-range forces less frequently than the rapidly-varying components. Yet, the outer timestep (long-range force update frequency) in Impulse-MTS cannot be lengthened as might be expected based on criteria of reasonable resolution of the slow forces.
Reference: 10. <author> J.J. Biesiadecki and R.D. Skeel. </author> <title> Dangers of multiple time step methods. </title> <journal> J. Comp. Phys., </journal> <volume> 109 </volume> <pages> 318-328, </pages> <year> 1993. </year>
Reference-contexts: Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts <ref> [10, 11] </ref>. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. <p> Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts <ref> [10, 11] </ref>. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. <p> Throughout this work we assume that the (inner) timestep t obeys this stability restriction. The following interpretation of Velocity Verlet proves useful later <ref> [10] </ref>. <p> ! fl sin (! fl t) 4! 2 fl sin (! fl t) cos (! fl t) fl # where ! fl = fl 4 2.3. 3D Linear Model Before testing MTS variants on nonlinear problems, we also consider numerical results for a 3D linear model from Biesiadecki and Skeel <ref> [10] </ref> for three colinear particles (of unit mass) connected by springs of constants k 1 and k 2 . <p> Extrapolation/Correction (E/C) The choice X fl = X n in the above scheme yields impulse velocity and position corrections before and after each outer timestep. This approach was considered by several groups to reduce the energy drift of extrapolation <ref> [22, 23, 10] </ref>; the derivation in [10], in particular, was motivated by the desire to approximate Verlet equivalence [7] for Constant Extrapolation. Hermans recently noticed [J. Hermans, personal communication] that correcting only for velocities improves numerical performance. This is the version we consider. <p> Extrapolation/Correction (E/C) The choice X fl = X n in the above scheme yields impulse velocity and position corrections before and after each outer timestep. This approach was considered by several groups to reduce the energy drift of extrapolation [22, 23, 10]; the derivation in <ref> [10] </ref>, in particular, was motivated by the desire to approximate Verlet equivalence [7] for Constant Extrapolation. Hermans recently noticed [J. Hermans, personal communication] that correcting only for velocities improves numerical performance. This is the version we consider.
Reference: 11. <author> E. Barth and T. Schlick. </author> <title> Extrapolation versus impulse in multiple-timestepping schemes: II. linear analysis and applications to Newtonian and Langevin dynamics. </title> <journal> J. Chem. Phys., </journal> <volume> 109 </volume> <pages> 1632-1642, </pages> <year> 1998. </year>
Reference-contexts: Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts <ref> [10, 11] </ref>. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. <p> Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts <ref> [10, 11] </ref>. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. <p> The earlier extrapolative force-splitting alternatives were abandoned because of their noted energy drift (a consequence of nonsymplecticness). 1.2. A Stochastic MTS Approach Barth and Schlick have recently developed an alternative nonsymplectic, stochastic approach termed LN <ref> [11, 15] </ref> that combines force splitting via extrapolation and stochastic dynamics to overcome this resonance barrier. This combination succeeds, as demonstrated on proteins [15], because extrapolation alleviates the severe resonances of the impulse treatment, and the Langevin heat bath counteracts the instabilities (or energy drift) characteristic of extrapolation. <p> By choosing the Langevin frictional constant fl as small as possible, just sufficient to ensure numerical stability, we also suggested how to minimize the effects introduced by the stochastic terms, not present in pure Newtonian formulations <ref> [11, 15] </ref>. In practice, setting 5 fl 50 ps 1 has been suggested in these works. The LN approach in principal states with Boltzmann probabilities and hence is useful for configurational and thermodynamic sampling. <p> More important, the analyses offer guidelines for constructing effective biomolecu-lar integrators that balance stability with accuracy given the pragmatic dilemma mentioned above. The linear analyses started in <ref> [11] </ref> for a one-dimensional (1D) system were based on the symplectic Euler method. Here we base derivations on the Verlet discretization [2] and compare resonance artifacts of Extrapolation versus Impulse force splitting for both Newtonian and Langevin dynamics. Numerical experiments are also performed for nonlinear systems. <p> A comparison of results between the 1D and 3D linear model emphasizes this limitation. RESONANCE IN FORCE SPLITTING INTEGRATORS 7 2.1. 1-D Linear Model 2.1.1. Newtonian Dynamics Consider the simple 1D linear model problem used by Barth and Schlick <ref> [15, 11] </ref>: _ V = ( 1 + 2 )X : The variables X and V denote the scalar position and velocity, respectively, for a particle of unit mass. This system can be considered a harmonic oscillator driven by a linear force with constant fl = 1 + 2 . <p> The three components correspond to fast, medium, and slow forces. 2.2. Analysis of the 1D Linear Model 2.2.1. Newtonian Dynamics 8 ADRIAN SANDU AND TAMAR SCHLICK Barth and Schlick <ref> [15, 11] </ref> examined MTS schemes based on the first order sym-plectic Euler method. <p> The propagation matrix A V V (t; fl) is symplectic and determines the stability of the method. It can be shown <ref> [11] </ref> that stability is achieved for t 2= fl : (2.9) This is the familiar linear stability requirement on the timestep of T = (T =the period) [20]. Throughout this work we assume that the (inner) timestep t obeys this stability restriction. <p> The physical angular frequency (eq. 2.2) is numerically approximated by an effective angular frequency [14, 13] eff = t 2.2.2. Langevin Dynamics RESONANCE IN FORCE SPLITTING INTEGRATORS 9 We analyze the stability and resonance independent of the random force (i.e., R (t) = 0), following <ref> [15, 11] </ref>). We assume that the inner timestep is sufficiently small (t ! 0) to justify the asymptotic approximation. <p> This reduces to e flkt 2 + 1 e flkt 2 + 1 1 , fl p p log 1 + 2 1 : This is a slightly sharper estimate than given in <ref> [15, 11] </ref>, which was fl (2 1 =) log (1 + 2 2 = 1 ): However, numerical experiments suggest that, while qualitatively correct, neither estimate is sufficient for stability; a practical lower bound (for the linear 1D prob lem) was empirically found to be fl p p log 1 + <p> Resonant spikes appear at odd multiples of the fast half period only. Thus, as concluded by Barth and Schlick <ref> [11, 15] </ref>, this hybrid approach seems useful only for small outer RESONANCE IN FORCE SPLITTING INTEGRATORS 19 timesteps. <p> Since for most values of the outer timestep the spectrum of A CE consists of a pair of complex conjugate eigenvalues (in general not on the unit circle <ref> [15, 11] </ref>). When the outer timestep is close to odd multiples of the fast half period the eigenvalues approach the real axis and eventually become a real pair. <p> This explains the remarkable fact that the spike amplitudes are independent of k for extrapolation methods. The smallest (in absolute value) eigenvalue has a "peak" at 1, which is in excellent agreement with the numerical results of Barth and Schlick <ref> [15, 11] </ref>. <p> 2 = t cotan 1 t 2 1 2 1 and hence jr 2 j 1 + 2 1 The (non-resonant) peak value of the spectral radius of A CE can be estimated roughly as (A CE ) 2 2 : This confirms the empirical relations of Barth and Schlick <ref> [15, 11] </ref> for the magnitude of the instability. The non-resonance value for kt = mT eff 1 can be readily obtained by noticing that = 0 in this case. Hence det (A CE )=1, trace (A CE )=2 and r 1 = r 2 = 1.
Reference: 12. <author> M. Mandziuk and T. Schlick. </author> <title> Resonance in the dynamics of chemical systems simulated by the implicit-midpoint scheme. </title> <journal> Chem. Phys. Lett., </journal> <volume> 237 </volume> <pages> 525-535, </pages> <year> 1995. </year>
Reference-contexts: Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts [10, 11]. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint <ref> [12] </ref> and related integrators [13, 14], and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. <p> Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. These large pulses in turn lead to incorrect physical behavior of the system, such as overstretching and/or breaking of bonds <ref> [12, 14] </ref>. The earlier extrapolative force-splitting alternatives were abandoned because of their noted energy drift (a consequence of nonsymplecticness). 1.2.
Reference: 13. <author> R. D. Skeel, G. Zhang, and T. Schlick. </author> <title> A family of symplectic integrators: Stability, accuracy, and molecular dynamics applications. </title> <journal> SIAM J. Sci. Comp., </journal> <volume> 18 </volume> <pages> 202-222, </pages> <month> January </month> <year> 1997. </year>
Reference-contexts: Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts [10, 11]. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators <ref> [13, 14] </ref>, and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. <p> The physical angular frequency (eq. 2.2) is numerically approximated by an effective angular frequency <ref> [14, 13] </ref> eff = t 2.2.2. Langevin Dynamics RESONANCE IN FORCE SPLITTING INTEGRATORS 9 We analyze the stability and resonance independent of the random force (i.e., R (t) = 0), following [15, 11]). We assume that the inner timestep is sufficiently small (t ! 0) to justify the asymptotic approximation. <p> The resulting method is Impulse Verlet. RESONANCE IN FORCE SPLITTING INTEGRATORS 35 We now add and subtract an "extrapolation potential" A (X), which can be thought of as a computationally cheap approximation to E S (X) <ref> [13] </ref>.
Reference: 14. <author> T. Schlick, M. Mandziuk, R.D. Skeel, and K. Srinivas. </author> <title> Nonlinear resonance artifacts in molecular dynamics simulations. </title> <journal> J. Comp. Phys., </journal> <volume> 139 </volume> <pages> 1-29, </pages> <year> 1998. </year>
Reference-contexts: Though the first applications attributed these disturbances to general inaccuracies, they were later recognized as resonance artifacts [10, 11]. These artifacts have been analyzed in connection with implicit integration schemes such as implicit midpoint [12] and related integrators <ref> [13, 14] </ref>, and with MTS (or force-splitting) schemes [10, 11]. Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. <p> Impulse-MTS schemes [6, 7] are particularly vulnerable to resonances since relatively large energy pulses are introduced to the governing dynamics equations when the slow forces are evaluated. These large pulses in turn lead to incorrect physical behavior of the system, such as overstretching and/or breaking of bonds <ref> [12, 14] </ref>. The earlier extrapolative force-splitting alternatives were abandoned because of their noted energy drift (a consequence of nonsymplecticness). 1.2. <p> The physical angular frequency (eq. 2.2) is numerically approximated by an effective angular frequency <ref> [14, 13] </ref> eff = t 2.2.2. Langevin Dynamics RESONANCE IN FORCE SPLITTING INTEGRATORS 9 We analyze the stability and resonance independent of the random force (i.e., R (t) = 0), following [15, 11]). We assume that the inner timestep is sufficiently small (t ! 0) to justify the asymptotic approximation.
Reference: 15. <author> E. Barth and T. Schlick. </author> <title> Overcoming stability limitations in biomolecular dynamics: I. combining force splitting via extrapolation with Langevin dynamics in ln. </title> <journal> J. Chem. Phys., </journal> <volume> 109 </volume> <pages> 1617-1632, </pages> <year> 1998. </year>
Reference-contexts: The earlier extrapolative force-splitting alternatives were abandoned because of their noted energy drift (a consequence of nonsymplecticness). 1.2. A Stochastic MTS Approach Barth and Schlick have recently developed an alternative nonsymplectic, stochastic approach termed LN <ref> [11, 15] </ref> that combines force splitting via extrapolation and stochastic dynamics to overcome this resonance barrier. This combination succeeds, as demonstrated on proteins [15], because extrapolation alleviates the severe resonances of the impulse treatment, and the Langevin heat bath counteracts the instabilities (or energy drift) characteristic of extrapolation. <p> A Stochastic MTS Approach Barth and Schlick have recently developed an alternative nonsymplectic, stochastic approach termed LN [11, 15] that combines force splitting via extrapolation and stochastic dynamics to overcome this resonance barrier. This combination succeeds, as demonstrated on proteins <ref> [15] </ref>, because extrapolation alleviates the severe resonances of the impulse treatment, and the Langevin heat bath counteracts the instabilities (or energy drift) characteristic of extrapolation. The simple Langevin formulation used in LN mimics molecular collisions of a biomolecule coupled to a heat bath. <p> By choosing the Langevin frictional constant fl as small as possible, just sufficient to ensure numerical stability, we also suggested how to minimize the effects introduced by the stochastic terms, not present in pure Newtonian formulations <ref> [11, 15] </ref>. In practice, setting 5 fl 50 ps 1 has been suggested in these works. The LN approach in principal states with Boltzmann probabilities and hence is useful for configurational and thermodynamic sampling. <p> In practice, setting 5 fl 50 ps 1 has been suggested in these works. The LN approach in principal states with Boltzmann probabilities and hence is useful for configurational and thermodynamic sampling. Moreover, the long-time stability of the scheme yields speedups of an order of magnitude over reference simulations <ref> [15] </ref>. <p> This finding is exploited to balance short-time accuracy with long-time stability in LN by relying on Midpoint Extrapolation (via position Verlet) for the medium forces and restricting the medium timestep, t m , to less than T min =2, and treating the long-range forces by Constant Extrapolation <ref> [15] </ref>. Performance of these variants also highlights the limitations of the 1D linear analysis and emphasizes the requirement for analyzing multidimensional linear models and experimenting on nonlinear models. Higher dimensionality combined with nonlinearity only aggravates resonance disturbances. <p> A comparison of results between the 1D and 3D linear model emphasizes this limitation. RESONANCE IN FORCE SPLITTING INTEGRATORS 7 2.1. 1-D Linear Model 2.1.1. Newtonian Dynamics Consider the simple 1D linear model problem used by Barth and Schlick <ref> [15, 11] </ref>: _ V = ( 1 + 2 )X : The variables X and V denote the scalar position and velocity, respectively, for a particle of unit mass. This system can be considered a harmonic oscillator driven by a linear force with constant fl = 1 + 2 . <p> The three components correspond to fast, medium, and slow forces. 2.2. Analysis of the 1D Linear Model 2.2.1. Newtonian Dynamics 8 ADRIAN SANDU AND TAMAR SCHLICK Barth and Schlick <ref> [15, 11] </ref> examined MTS schemes based on the first order sym-plectic Euler method. <p> The physical angular frequency (eq. 2.2) is numerically approximated by an effective angular frequency [14, 13] eff = t 2.2.2. Langevin Dynamics RESONANCE IN FORCE SPLITTING INTEGRATORS 9 We analyze the stability and resonance independent of the random force (i.e., R (t) = 0), following <ref> [15, 11] </ref>). We assume that the inner timestep is sufficiently small (t ! 0) to justify the asymptotic approximation. <p> This reduces to e flkt 2 + 1 e flkt 2 + 1 1 , fl p p log 1 + 2 1 : This is a slightly sharper estimate than given in <ref> [15, 11] </ref>, which was fl (2 1 =) log (1 + 2 2 = 1 ): However, numerical experiments suggest that, while qualitatively correct, neither estimate is sufficient for stability; a practical lower bound (for the linear 1D prob lem) was empirically found to be fl p p log 1 + <p> Resonant spikes appear at odd multiples of the fast half period only. Thus, as concluded by Barth and Schlick <ref> [11, 15] </ref>, this hybrid approach seems useful only for small outer RESONANCE IN FORCE SPLITTING INTEGRATORS 19 timesteps. <p> We thus discard this method, in addition to EE/CC, from further consideration. These hybrids do not appear to offer any practical benefits over Impulse and Constant Extrapolation. RESONANCE IN FORCE SPLITTING INTEGRATORS 21 4.5. Three-Class Splitting by Extrapolation Finally, to analyze a three-class extrapolative method as LN <ref> [20, 15] </ref>, we consider the Langevin 1D linear model of system (2.6) where the random force is given by eq. (2.5). A stochastic extrapolative approach is motivated by the goal of long-time stability and large computational savings rather than accurate Hamiltonian dynamics. <p> The heated system was equilibrated for 20 ps of Newtonian dynamics before production runs began. The splitting procedure uses three classes and follows <ref> [15] </ref>. Namely, bond-length, bond-angle, and dihedral-angle terms are considered fast interactions and resolved at t = 0:5 fs; local nonbonded forces (within 7 A) are considered medium interactions and resolved at t m = 1 or 2 fs; and all other forces are classified as slow. <p> Namely, for the solvated protein, this ratio is smaller (slower modes are present) and hence the instability amplitude is relatively small. The removal of the 5 fs resonance by the Langevin approach was also shown in <ref> [15] </ref>. For large outer timesteps, Langevin/Impulse is unstable, with marked resonances at multiples of 10 fs. The LN results, in contrast, are very good for large outer timesteps: energy averages and variances are correct for all values of t displayed. <p> Results obtained with these settings are reported in Table I (see also <ref> [15] </ref>) and in the remaining figures. reference trajectory for the various energy components and the temperature, shows that all relative errors remain below 3% for t up to 200 fs. RESONANCE IN FORCE SPLITTING INTEGRATORS 25 Dynamic properties as a function of fl are next examined. <p> On the basis of linear theory, we suggest guidelines for choosing minimal coupling to the heat bath (optimal fl) for the stochastic/extrapolative combination; for nonlinear sys tems, empirical tests are necessary and suggest the values 5-50 ps 1 <ref> [15] </ref>. 5. While results of the 1D linear model problem provide useful resonance predictions, multidimensional linear models provide a stricter test of method RESONANCE IN FORCE SPLITTING INTEGRATORS 27 feasibility. <p> stability and computational speed are important factors, and exact Hamiltonian dynamics is not required (i.e., rather, thermodynamic and conformational sampling is goal), an effective protocol for biomolecules is a three-class Langevin MTS scheme which uses Midpoint Extrapolation for the medium forces and Constant Extrapolation for the slow forces, like LN <ref> [15] </ref>. <p> used in the LN framework to increase the maximum feasible medium timestep from 2 fs; this modification should not degrade the resolution quality of the medium forces but might improve the asymptotic speedup of the resulting MTS protocol, since this value is dominated by the cost of the medium forces <ref> [15] </ref>. Given the formidable sampling problem, it appears that a pragmatic balance between accuracy and long-time stability is warranted in biomolecular simulations so as to bridge the gap between theoretical and experimental biophysics; the extrapolative stochastic approach of LN analyzed here is one such compromise. <p> Since for most values of the outer timestep the spectrum of A CE consists of a pair of complex conjugate eigenvalues (in general not on the unit circle <ref> [15, 11] </ref>). When the outer timestep is close to odd multiples of the fast half period the eigenvalues approach the real axis and eventually become a real pair. <p> This explains the remarkable fact that the spike amplitudes are independent of k for extrapolation methods. The smallest (in absolute value) eigenvalue has a "peak" at 1, which is in excellent agreement with the numerical results of Barth and Schlick <ref> [15, 11] </ref>. <p> 2 = t cotan 1 t 2 1 2 1 and hence jr 2 j 1 + 2 1 The (non-resonant) peak value of the spectral radius of A CE can be estimated roughly as (A CE ) 2 2 : This confirms the empirical relations of Barth and Schlick <ref> [15, 11] </ref> for the magnitude of the instability. The non-resonance value for kt = mT eff 1 can be readily obtained by noticing that = 0 in this case. Hence det (A CE )=1, trace (A CE )=2 and r 1 = r 2 = 1.
Reference: 16. <author> S. Broyde and B. E. Hingerty. </author> <title> Effective computational strategies for determining structures of carcinogen damaged DNA. </title> <journal> J. Comp. Phys., </journal> <volume> this volume, </volume> <year> 1999. </year>
Reference-contexts: Moreover, the long-time stability of the scheme yields speedups of an order of magnitude over reference simulations [15]. These physical and computational properties are advantageous in numerous applications of biomolecular simulations that address the critical sampling problem (see, for example, the Broyde and Hingerty article in this volume <ref> [16] </ref>); only applications that aim at specific kinetic measurements such as rates of con RESONANCE IN FORCE SPLITTING INTEGRATORS 5 formational transitions demand accurate Newtonian integrators.
Reference: 17. <author> L. S. D. Caves, J. D. Evanseck, and M. Karplus. </author> <title> Locally accessible conformations of proteins: Multiple molecular dynamics simulations of crambin. </title> <journal> Prot. Sci., </journal> <volume> 7 </volume> <pages> 649-666, </pages> <year> 1998. </year>
Reference-contexts: that an individual 5-ns trajectory of a protein (crambin) samples a fraction of conformational states generated by 10 shorter 120 ps runs; the average structural and dynamic properties over the 10 trajectories differ from those obtained from each run and, moreover, this ensemble average resembles the X-ray structure most closely <ref> [17] </ref>. Clearly, efficient sampling approaches are critically needed for macromolecular studies. 1.3. Resonance Analyses In this work, theoretical analyses are developed for various force-splitting strategies for molecular and Langevin dynamics to explain these resonance observations.
Reference: 18. <author> G. Zhang and T. Schlick. LIN: </author> <title> A new algorithm combining implicit integration and normal mode techniques for molecular dynamics. </title> <journal> J. Comp. Chem., </journal> <volume> 14 </volume> <pages> 1212-1233, </pages> <year> 1993. </year>
Reference-contexts: LINEAR MODELS FOR MTS ANALYSIS A linear model is a starting point for MTS analysis since the fast forces are near harmonic and oscillatory. For this reason, numerical experiments performed in conjunction with LIN and its variants <ref> [18, 19, 20] </ref> have shown that, on a large number of systems of real interest, the fast forces can be replaced by linear approximations, with good overall results, provided that the linear approximations are updated often.
Reference: 19. <author> G. Zhang and T. Schlick. </author> <title> The Langevin/implicit-Euler/Normal-Mode scheme (LIN) for molecular dynamics at large time steps. </title> <journal> J. Chem. Phys., </journal> <volume> 101 </volume> <pages> 4995-5012, </pages> <year> 1994. </year>
Reference-contexts: LINEAR MODELS FOR MTS ANALYSIS A linear model is a starting point for MTS analysis since the fast forces are near harmonic and oscillatory. For this reason, numerical experiments performed in conjunction with LIN and its variants <ref> [18, 19, 20] </ref> have shown that, on a large number of systems of real interest, the fast forces can be replaced by linear approximations, with good overall results, provided that the linear approximations are updated often.
Reference: 20. <author> T. Schlick, E. Barth, and M. Mandziuk. </author> <title> Biomolecular dynamics at long timesteps: Bridging the timescale gap between simulation and experimentation. Annu. </title> <journal> Rev. Biophys. Biomol. Struc., </journal> <volume> 26 </volume> <pages> 179-220, </pages> <year> 1997. </year>
Reference-contexts: LINEAR MODELS FOR MTS ANALYSIS A linear model is a starting point for MTS analysis since the fast forces are near harmonic and oscillatory. For this reason, numerical experiments performed in conjunction with LIN and its variants <ref> [18, 19, 20] </ref> have shown that, on a large number of systems of real interest, the fast forces can be replaced by linear approximations, with good overall results, provided that the linear approximations are updated often. <p> The propagation matrix A V V (t; fl) is symplectic and determines the stability of the method. It can be shown [11] that stability is achieved for t 2= fl : (2.9) This is the familiar linear stability requirement on the timestep of T = (T =the period) <ref> [20] </ref>. Throughout this work we assume that the (inner) timestep t obeys this stability restriction. The following interpretation of Velocity Verlet proves useful later [10]. <p> We thus discard this method, in addition to EE/CC, from further consideration. These hybrids do not appear to offer any practical benefits over Impulse and Constant Extrapolation. RESONANCE IN FORCE SPLITTING INTEGRATORS 21 4.5. Three-Class Splitting by Extrapolation Finally, to analyze a three-class extrapolative method as LN <ref> [20, 15] </ref>, we consider the Langevin 1D linear model of system (2.6) where the random force is given by eq. (2.5). A stochastic extrapolative approach is motivated by the goal of long-time stability and large computational savings rather than accurate Hamiltonian dynamics. <p> An interesting avenue to examine rigorously is the use of a constrained formulation for the bond stretches in combination with the MTS protocol. Though the gap in the vibrational frequency between the heavy-atom bond stretches and the light-atom bending modes is not large <ref> [20] </ref>, resonance disturbances can likely be pushed further if rigid water models are used.
Reference: 21. <author> B. Garcia-Archilla, J. M. Sanz-Serna, and R. D. Skeel. </author> <title> Long-time-step methods for oscillatory differential equations. </title> <type> Technical Report 7, </type> <institution> Dept. Math. Applic. Comp., Univ. Valladolid, </institution> <year> 1996. </year>
Reference-contexts: We choose the numerical values k 1 = 2 =2, k 2 = 2 =50 to reproduce the fundamental periods T 1 = 2 and T 2 = 10 used in the 1D linear model above. See also Garcia-Archilla et al. <ref> [21] </ref> for a theoretical stability analysis of a linear multidimensional model. 3.
Reference: 22. <author> M. E. Tuckerman, B.J. Berne, and G. J. Martyna. </author> <title> Molecular dynamics algorithm for multiple time scales: Systems with long range forces. </title> <journal> J. Chem. Phys., </journal> <volume> 94 </volume> <pages> 6811-6815, </pages> <year> 1991. </year>
Reference-contexts: Extrapolation/Correction (E/C) The choice X fl = X n in the above scheme yields impulse velocity and position corrections before and after each outer timestep. This approach was considered by several groups to reduce the energy drift of extrapolation <ref> [22, 23, 10] </ref>; the derivation in [10], in particular, was motivated by the desire to approximate Verlet equivalence [7] for Constant Extrapolation. Hermans recently noticed [J. Hermans, personal communication] that correcting only for velocities improves numerical performance. This is the version we consider.
Reference: 23. <author> J. L. Scully and J. Hermans. </author> <title> Multiple time steps: Limits on the speed-up of molecular dynamics simulations of aqueous systems. Mol. </title> <journal> Sim., </journal> <volume> 11 </volume> <pages> 67-77, </pages> <year> 1993. </year>
Reference-contexts: Extrapolation/Correction (E/C) The choice X fl = X n in the above scheme yields impulse velocity and position corrections before and after each outer timestep. This approach was considered by several groups to reduce the energy drift of extrapolation <ref> [22, 23, 10] </ref>; the derivation in [10], in particular, was motivated by the desire to approximate Verlet equivalence [7] for Constant Extrapolation. Hermans recently noticed [J. Hermans, personal communication] that correcting only for velocities improves numerical performance. This is the version we consider.
Reference: 24. <author> G.D. Quinlan and S. Tremaine. </author> <title> Symmetric multistep methods for the numerical integration of planetary orbits. Astro. </title> <journal> J., </journal> <volume> 100 </volume> <pages> 1692-1700, </pages> <year> 1990. </year> <note> 38 ADRIAN SANDU AND TAMAR SCHLICK </note>
Reference-contexts: We report the Langevin behavior for EE/CC for reference in Figure 1 for fl = 0:3, but do not consider the method further; additional experiments substantiate this conclusion. 4.4. Leap Extrapolation Leap Extrapolation is motivated by methods that "symmetrize" the force extrapolation process <ref> [24] </ref> to obtain stable, long-time integrators for Hamiltonian systems.
Reference: 25. <author> T. Schlick and S. Figueroa. </author> <title> A molecular dynamics simulation of a water droplet by the implicit Euler/Langevin scheme. </title> <journal> J. Chem. Phys., </journal> <volume> 94 </volume> <pages> 2118-2129, </pages> <year> 1991. </year>
Reference-contexts: The purpose of the second example is to demonstrate an effective three-class stochastic extrapolation strategy for biomolecules that combines Midpoint Extrapolation for the medium forces with Constant Extrapolation for the slow forces. 5.1. A Water Tetramer This test problem is borrowed from Schlick <ref> [25] </ref>, where a flexible water droplet is simulated based on standard water potentials. The intermolecular and intramolec-ular forces correspond to the slowly-varying and rapidly-varying components, respectively. <p> The parameters S 1 , S 2 have the values S 1 = 94 Kcal/(mol A 4 ), and S 2 = 42 Kcal/mol. The initial coordinates and velocities were chosen as described in <ref> [25] </ref>. A minimum energy configuration was found with the truncated Newton package TNPACK [26, 27, 28], followed by an equilibration of the structure at 300 K via a Langevin simulation.
Reference: 26. <author> T. Schlick and A. Fogelson. </author> <title> A truncated Newton minimization package for large-scale problems: I. Algorithm and usage. </title> <journal> ACM Trans. Math. Softw., </journal> <volume> 14 </volume> <pages> 46-70, </pages> <year> 1992. </year>
Reference-contexts: The parameters S 1 , S 2 have the values S 1 = 94 Kcal/(mol A 4 ), and S 2 = 42 Kcal/mol. The initial coordinates and velocities were chosen as described in [25]. A minimum energy configuration was found with the truncated Newton package TNPACK <ref> [26, 27, 28] </ref>, followed by an equilibration of the structure at 300 K via a Langevin simulation.
Reference: 27. <author> T. Schlick and A. Fogelson. </author> <title> A truncated Newton minimization package for large-scale problems: II. Implementation examples. </title> <journal> ACM Trans. Math. Softw., </journal> <volume> 14 </volume> <pages> 71-111, </pages> <year> 1992. </year>
Reference-contexts: The parameters S 1 , S 2 have the values S 1 = 94 Kcal/(mol A 4 ), and S 2 = 42 Kcal/mol. The initial coordinates and velocities were chosen as described in [25]. A minimum energy configuration was found with the truncated Newton package TNPACK <ref> [26, 27, 28] </ref>, followed by an equilibration of the structure at 300 K via a Langevin simulation.
Reference: 28. <author> D. Xie and T. Schlick. </author> <title> Efficient implementation of the truncated Newton algorithm for large-scale chemistry applications. </title> <journal> SIAM J. Opt., </journal> <note> In Press, </note> <year> 1997. </year>
Reference-contexts: The parameters S 1 , S 2 have the values S 1 = 94 Kcal/(mol A 4 ), and S 2 = 42 Kcal/mol. The initial coordinates and velocities were chosen as described in [25]. A minimum energy configuration was found with the truncated Newton package TNPACK <ref> [26, 27, 28] </ref>, followed by an equilibration of the structure at 300 K via a Langevin simulation.
Reference: 29. <author> B. R. Brooks, R. E. Bruccoleri, B. D. Olafson, D. J. States, S. Swaminathan, and M. Karplus. CHARMM: </author> <title> A program for macromolecular energy, minimization, and dynamics calculations. </title> <journal> J. Comp. Chem., </journal> <volume> 4 </volume> <pages> 187-217, </pages> <year> 1983. </year>
Reference-contexts: Solvated Bovine Pancreatic Trypsin Inhibitor (BPTI) We model the BPTI protein (892 atoms) in CHARMM <ref> [29, 30] </ref> version 25, sol-vated in 60 crystallographic and 4401 bulk water molecules (14,275 atoms total).
Reference: 30. <author> A. D. MacKerell, Jr., D. Bashford, M. Bellott, R. L. Dunbrack, Jr., J. D. Evanseck, M. J. Field, S. Fischer, J. Gao, H. Guo, S. Ha, D. Joseph-McCarthy, L. Kuchnir, K. Kuczera, F. T. K. Lau, C. Mattos, S. Michnick, T. Ngo, D. T. Nguyen, B. Prodhom, W. E. Reiher, III, B. Roux, M. Schlenkrich, J. C. Smith, R. Stote, J. Straub, M. Watanabe, J. Wiorkiewicz-Kuczera, D. Yin, and M. Karplus. </author> <title> All-atom empirical potential for molecular modeling and dynamics studies of proteins. </title> <journal> J. Phys. Chem., </journal> <volume> 102 </volume> <pages> 3586-3616, </pages> <year> 1998 </year>
Reference-contexts: Solvated Bovine Pancreatic Trypsin Inhibitor (BPTI) We model the BPTI protein (892 atoms) in CHARMM <ref> [29, 30] </ref> version 25, sol-vated in 60 crystallographic and 4401 bulk water molecules (14,275 atoms total).

References-found: 30

