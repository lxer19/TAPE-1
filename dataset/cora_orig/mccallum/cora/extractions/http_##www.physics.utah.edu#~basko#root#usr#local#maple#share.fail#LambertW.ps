URL: http://www.physics.utah.edu/~basko/root/usr/local/maple/share.fail/LambertW.ps
Refering-URL: http://www.physics.utah.edu/~basko/root/usr/local/maple/share.fail/
Root-URL: 
Phone: 2  3  
Title: On Lambert's W Function  
Author: by Robert M. Corless Gaston H. Gonnet D. E. G. Hare and David J. Jeffrey 
Address: Ontario London, CANADA, N6A 5B7  Switzerland  Waterloo, Canada  
Affiliation: 1 Department of Applied Mathematics University of Western  Informatik ETH Zurich  Symbolic Computation Group University of Waterloo  
Abstract: Lambert's W function is the inverse of the function w 7! we w . It has been applied in combinatorics, number theory, fluid mechanics, quantum mechanics, and biochemistry. Some of these applications are briefly described here. This paper presents a new discussion of the complex branches of W , asymptotic expansions valid for all branches, an efficient numerical procedure for evaluating the function to arbitrary precision, and a method for symbolic integration of expressions containing W . 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> G. Alefeld, </author> <title> "On the Convergence of Halley's method", </title> <journal> American Mathematical Monthly, </journal> <volume> 88 (1981), </volume> <pages> 530-536. </pages>
Reference-contexts: We note that f 0 (w) = (w + 1)e w and f 00 (w) = (w + 2)e w are available at the cost of only one (complex) flop each, given that e w must be computed for f (w), and so we can use Halley's method <ref> [1] </ref> w j+1 = w j f 0 (w j ) 1 f 00 (w j )f (w j ) ; (5:11) which is a third order method.
Reference: [2] <institution> American National Standards Institute/Institute of Electrical and Electronic Engineers: IEEE Standard for Binary Floating-Point Arithmetic, </institution> <address> ANSI/IEEE Std 754-1985, New York, </address> <year> 1985. </year> <month> 19 </month>
Reference-contexts: Systems which have a signed 0 (for example, systems which implement IEEE Standard 754 <ref> [2] </ref>) can exploit this symmetry on the branch cut as well.
Reference: [3] <author> John D. Anderson, </author> <title> Introduction to Flight, </title> <publisher> 3rd Ed., McGraw-Hill, </publisher> <address> New York, </address> <year> 1989. </year>
Reference-contexts: We wish to find the thrust specific fuel consumption c t and the weight of the fuel w 0 w 1 , given the physical constants describing the plane and its environment. The equations are <ref> [3, pp. 312-323] </ref> E t = c t C D w 1 (2:6) 2 S w 0 w 1 (2:7) where E t is the endurance, C L and C D are the lift and drag coefficients, w 0 is the initial weight of the plane, w 1 is the final
Reference: [4] <author> V. I. Arnold, </author> <title> Mathematical Methods for Classical Mechanics, </title> <publisher> Springer-Verlag, </publisher> <year> 1978. </year>
Reference-contexts: form, one can use the same substitution to integrate Z Z = G (f (y); y)f (y) f (y) dy (3:12) This technique is not part of the standard calculus curriculum, even though it is not new (it can be shown that equation (3.11) is related to the Legendre Transform <ref> [4] </ref>). This technique allows a simpler derivation of R sin 1 (x) dx than the standard method, and also allows for straightforward integration of more complicated expressions containing inverse functions, such as R R 1=(1 + sin 1 (x)) dx.
Reference: [5] <author> I. N. Baker and P. J. Rippon, </author> <title> "A Note on Complex Iteration", </title> <journal> Amer. Math. Monthly, </journal> <volume> 92 (1985), </volume> <pages> 501-504. </pages>
Reference-contexts: This immediately answers the question posed in [20] about the analytic continuation of h (z). Moreover, the region of convergence of the iteration for h (z) was proved in <ref> [5] </ref> to be the set z = te t where jtj &lt; 1, that is, the inverse image of the open unit disk under the map x 7! W (x), and convergence also occurs for images of the roots of unity (but not elsewhere on the boundary).
Reference: [6] <author> A. Barry, </author> <title> "A class of exact solutions for Richard's equation", </title> <journal> J. Hydrology, </journal> <note> (1993) to appear. </note>
Reference-contexts: In brief, the exponentially subdominant terms were missing from the previous asymptotic developments, but are still significant for small enough R. A similarity solution for Richards' equation. Recent work <ref> [6] </ref> uses both real branches of W to give a new exact solution for Richards' equation for water movement in soil.
Reference: [7] <author> N. G. de Bruijn, </author> <title> Asymptotic Methods in Analysis, </title> <publisher> North-Holland, </publisher> <year> 1961. </year>
Reference-contexts: We have carried out a study of the complex analytic properties of W and, building on the work of de Bruijn <ref> [7, pp. 27-28] </ref>, determined the complex asymptotic expansions at both complex infinity and 0. This work led to an efficient and accurate implementation (in Maple V Release 2) of the arbitrary-precision complex floating-point evaluation of all branches of W over the complex plane. Finally, some results of K. B. <p> Log z can only be a negative real number if Log is chosen to be the principal branch of the logarithm and z is a positive real number less than 1. Keeping this in mind, then, we now adapt de Bruijn's argument <ref> [7, pp. 27-28] </ref> establishing the asymptotic expansions for the branches of W at 0 and infinity. (de Bruijn computes the expansion only for real z ! 1, but we will see below that the method is valid for all branches and for z ! 0 as well. de Bruijn comments that <p> This expansion corrects a typographical error in equation (2.4.4) in <ref> [7] </ref> and extends the expansion to higher-order terms.
Reference: [8] <author> A. </author> <title> Cayley, "A theorem on trees", </title> <journal> Quarterly Journal of Mathematics, Oxford Series, </journal> <volume> 23 (1889), </volume> <pages> 376-378. </pages>
Reference-contexts: Since then, this function, or the related function W (x) which satisfies we w = x, has been used to solve many different problems. Cayley <ref> [8] </ref> discusses the function in the context of enumeration of trees. Skovgaard et al. give a fluid-dynamical application of W in [31]. W is considered by Polya and Szego [24, Problem 209, p. 146].
Reference: [9] <author> Bruce W. Char, Keith O. Geddes, Gaston H. Gonnet, Benton L. Leong, Michael B. Monagan, and Stephen M. Watt, </author> <title> The Maple V Language Reference Manual, </title> <publisher> Springer-Verlag, </publisher> <year> 1991. </year>
Reference-contexts: W is considered by Polya and Szego [24, Problem 209, p. 146]. Fritsch, Shafer and Crowley [15] present an algorithm for the fixed-precision computation of one branch of W (x) for x &gt; 0. The computer algebra language Maple <ref> [9] </ref> has had an arbitrary precision implementation of this same real-valued branch of W for many years now, and has an arbitrary precision implementation of all branches in Maple V Release 2. <p> Notation. We use the letter W for this function, following early Maple notation. We propose to call this Lambert's W function, because Lambert posed the first problem which required W for its solution, and because Euler attributed the series with which he solved the problem to Lambert. In <ref> [9] </ref>, it is also called the Omega function. If x is real, then for 1=e x &lt; 0 there are two possible real values of W (x) (see there is no possibility for confusion, and the branch satisfying W (x) 1 by W 1 (x).
Reference: [10] <author> S. D. Conte & C. de Boor, </author> <title> Elementary Numerical Analysis, </title> <publisher> 3rd Ed., McGraw-Hill, </publisher> <year> 1980. </year>
Reference-contexts: We first consider the conditioning of W , and then go on to examine methods for efficient approximation. The standard theory of conditioning of function evaluation <ref> [10, p. 14] </ref> gives the expres sion C = xf 0 (x)=f (x) which estimates the relative effect on y = f (x) of a small relative change in x.
Reference: [11] <author> Robert M. Corless and D. J. Jeffrey, </author> <title> "Well, It Isn't Quite That Simple", </title> <journal> SIGSAM Bulletin, </journal> <volume> 26 (1992), </volume> <pages> 2-6. </pages>
Reference-contexts: The equation above is a typical example, for Maple V Release 2 will return the last expression given when asked to differentiate W , and hence is able to compute W 0 0 (0) only as a limit. See <ref> [11] </ref> for further discussion of 7 the handling of special cases (the so-called specialization problem) by computer algebra systems.
Reference: [12] <editor> CRC Standard Mathematical Tables, 28th Ed., W. H. Beyer (ed.), </editor> <year> 1987. </year>
Reference-contexts: Finally, the curves separating the remaining branches are f cot () + i : 2k &lt; &lt; (2k + 1)g for k = 1; 2; : : : (4:5) Remark. The curves (4.4) and (4.5) together form a subset of the so-called Quadratrix of Hippias <ref> [12] </ref>, the missing parts being the curves corresponding to (2k 1) &lt; &lt; 2k. 10 That is, the Quadratrix of Hippias is the union of the images of the real axis under the various branches of W , excluding (1; 1).
Reference: [13] <author> Harold T. Davis, </author> <title> Introduction to Nonlinear Differential and Integral Equations, </title> <publisher> Dover, </publisher> <year> 1962. </year>
Reference-contexts: If we use W 0 the solution corresponds to capillary rise, while if we instead use W 1 the solution can be interpreted as infiltration. The Volterra Equations for Population Growth. In <ref> [13] </ref>, pages 102-109, we find an implicit analytic phase plane solution of the Volterra equations dx = ax (1 y); dt essentially in terms of the W function (see equations (11) and (12) on page 104 of [13]). <p> The Volterra Equations for Population Growth. In <ref> [13] </ref>, pages 102-109, we find an implicit analytic phase plane solution of the Volterra equations dx = ax (1 y); dt essentially in terms of the W function (see equations (11) and (12) on page 104 of [13]). These equations, with a = 2 and c = 1, appear as problem B1 of the DETEST test suite [18] for numerical methods for integration of ordinary differential equations. The analytic solution is a closed loop in the phase plane.
Reference: [14] <author> L. Euler, "De Serie Lambertina Plurismique Eius Insignibus Proprietatibus", Leon-hardi Euleri Opera Omnia, Ser. </author> <note> 1. Opera Mathematica, Bd 6, 1921 (orig. date 1779). </note>
Reference-contexts: 1. Introduction In <ref> [14] </ref>, Euler studied Lambert's transcendental equation [21] x ff x fi = (ff fi)vx ff+fi : (1:1) For the solution in a special case, he introduced a function of x satisfying !e ! = x. <p> We present below a selection of applications. Solution of a Transcendental Equation by Euler. The first use of W (actually of a trivially related function, z 7! W (z)) was by Euler <ref> [14] </ref>. <p> The jet-fuel problem was communicated to us by Michael Kamprath, with commentary by Harald Hanche-Olsen. We are indebted to G.-C. Rota and D. Loeb for their explanation of the applications of W to combinatorics. We are also indebted to D. E. Gerber for his work in translating Euler's paper <ref> [14] </ref>. This work was supported by the Natural Science and Engineering Research Council of Canada, and the Information Technology Research Council of Ontario.
Reference: [15] <author> F. N. Fritsch, R. E. Shafer, & W. P. Crowley, </author> <title> "Algorithm 443: Solution of the Transcendental Equation we w = x", </title> <journal> Comm. ACM, </journal> <volume> 16 (1973), </volume> <pages> 123-124. </pages>
Reference-contexts: Cayley [8] discusses the function in the context of enumeration of trees. Skovgaard et al. give a fluid-dynamical application of W in [31]. W is considered by Polya and Szego [24, Problem 209, p. 146]. Fritsch, Shafer and Crowley <ref> [15] </ref> present an algorithm for the fixed-precision computation of one branch of W (x) for x &gt; 0. <p> We now turn to practical methods for computing all the branches of W . We here only consider arbitrary-precision computations, such as are needed in Maple. We find that a fixed order approximation scheme such as that given in <ref> [15] </ref> is not adequate. Rather, we suggest an iterative scheme with crude initial guesses and gradual refinement of the precision used as the residuals decrease. Consider iterative rootfinding methods applied to finding w such that f (w) = we w z = 0.
Reference: [16] <author> K. O. Geddes, S. R. Czapor & G. Labahn, </author> <title> Algorithms for Computer Algebra, </title> <publisher> Kluwer Academic Publishers, </publisher> <year> 1992. </year>
Reference-contexts: We believe that it would be useful to include this technique in a typical first-year calculus course. Finally, note that this technique allows the Risch decision procedure <ref> [16] </ref> to be applied to determine if integrals containing W are elementary or not. 4. Branches and Asymptotics We have seen that W has two branches on the real line. We have also seen that complex values for W are required.
Reference: [17] <author> Ch. C. Gillispie, ed., </author> <title> Dictionary of Scientific Biography, </title> <editor> Scribners, N. Y., </editor> <year> 1973. </year>
Reference: [18] <author> T. E. Hull, W. H. Enright, B. M. Fellen, and A. E. Sedgwick, </author> <title> "Comparing numerical methods for ordinary differential equations", </title> <journal> SIAM J. Numer. Anal., </journal> <volume> 9 (1972), </volume> <pages> 603-637. </pages>
Reference-contexts: These equations, with a = 2 and c = 1, appear as problem B1 of the DETEST test suite <ref> [18] </ref> for numerical methods for integration of ordinary differential equations. The analytic solution is a closed loop in the phase plane.
Reference: [19] <author> W. </author> <title> Kahan,"Branch cuts for complex elementary functions", In The state of the art in numerical analysis, </title> <editor> M. J. D. Powell and A. Iserles, Eds, </editor> <publisher> Oxford University Press. </publisher>
Reference-contexts: The branch choices shown in Figures (4.1) and (4.2) conform to the rule of counter-clockwise continuity (CCC) around the branch point, which is a mnemonic principle that gives some uniformity to the choices for branch cuts of all the elementary functions <ref> [19] </ref>. This convention distinguishes here between two possibilities, namely the choice of attaching the image of the boundary in the p-plane to the top or to the bottom of the branch cut in the z-plane. <p> In Maple V Release 3 1 , the branch cuts for W are as described above. For all multivalued functions, the division of the complex plane into branches is somewhat arbitrary, and even the elementary functions do not have universally accepted branches <ref> [19] </ref>. The benefits of our choices for Lambert's W function are as follows.
Reference: [20] <author> R. A. Knoebel, </author> <title> "Exponentials reiterated", </title> <journal> Amer. Math. Monthly, </journal> <volume> 88 (1981), </volume> <pages> 235-252. </pages>
Reference-contexts: Euler was the first to prove that this iteration converges for real z between e e and e 1=e . We direct the reader to the references and discussion in <ref> [20] </ref> for more detail. However, it is not widely known that this function has a closed-form expression in terms of W . <p> When this iteration converges, it converges to h (z) = log (z) as can be seen by solving h (z) = z h (z) for h (z) by taking logarithms. This immediately answers the question posed in <ref> [20] </ref> about the analytic continuation of h (z).
Reference: [21] <author> J. H. </author> <title> Lambert, </title> <journal> "Observationes variae in Mathesin Puram" Acta Helvetica, physico-mathematico-anatomico-botanico-medica, </journal> <volume> 3, Basel, (1758), </volume> <pages> 128-168 </pages>
Reference-contexts: 1. Introduction In [14], Euler studied Lambert's transcendental equation <ref> [21] </ref> x ff x fi = (ff fi)vx ff+fi : (1:1) For the solution in a special case, he introduced a function of x satisfying !e ! = x.
Reference: [22] <editor> J. H. Lambert, Photometria sive de mensura et gradibus luminis, colorum et umbra,, Augustae Vindelicorum, </editor> <publisher> Basel, </publisher> <pages> 1760. </pages>
Reference: [23] <author> Robert E. O'Malley, Jr., </author> <title> Singular Perturbation Methods for Ordinary Differential Equations, </title> <journal> Springer-Verlag Applied Mathematical Sciences, </journal> <volume> 89, </volume> <year> 1991. </year>
Reference-contexts: The model problem dy = y 2 (1 y); y (0) = " &gt; 0 (2:11) is used in [23,27] to explore perturbation methods for its solution. We show here that an explicit analytic solution is possible, in terms of W , and thus all the perturbation results in <ref> [23] </ref> can be simply tested by comparison with the exact solution. The model problem is separable and integration leads to an implicit form for the solution y (t) (as given in [23]): 1 + log 1 1 = " " which can be solved to get y = 1 + W <p> that an explicit analytic solution is possible, in terms of W , and thus all the perturbation results in <ref> [23] </ref> can be simply tested by comparison with the exact solution. The model problem is separable and integration leads to an implicit form for the solution y (t) (as given in [23]): 1 + log 1 1 = " " which can be solved to get y = 1 + W (ue ut ) where u = 1=" 1. <p> Inspection of the differential equation shows that 0 &lt; " y &lt; 1 and this implies that the principal branch of W should be used. From this explicit solution, all the series results for this function in <ref> [23] </ref> can easily be verified. Solution of an Enzyme Kinetics Problem. In contrast to the last section, where W provided an exact solution to compare with perturbation expansions, this section gives an example where the perturbation expansion itself is done in terms of the W function. In [23] the Michaelis-Menton model <p> this function in <ref> [23] </ref> can easily be verified. Solution of an Enzyme Kinetics Problem. In contrast to the last section, where W provided an exact solution to compare with perturbation expansions, this section gives an example where the perturbation expansion itself is done in terms of the W function. In [23] the Michaelis-Menton model of enzyme kinetics is solved with a perturbation technique. A similar model, with a better scaling, is examined in [29]. <p> The first order correction terms can also be expressed in terms of s 0 , and hence W . Solution of Certain Nonlinear Equations. Nonlinear algebraic equations often occur in the determination of equilibrium or turning points in differential equations. For example, in <ref> [23] </ref>, p. 89, we find the condition U 2 arising from such a problem. The solution is given approximately as U 0 0:7, but it is exactly U 0 = 2W (1=2) 0:703467 : : :.
Reference: [24] <author> G. Polya & G. </author> <title> Szego, Problems and Theorems in Analysis, </title> <publisher> Springer-Verlag, </publisher> <year> 1972. </year>
Reference-contexts: Cayley [8] discusses the function in the context of enumeration of trees. Skovgaard et al. give a fluid-dynamical application of W in [31]. W is considered by Polya and Szego <ref> [24, Problem 209, p. 146] </ref>. Fritsch, Shafer and Crowley [15] present an algorithm for the fixed-precision computation of one branch of W (x) for x &gt; 0.
Reference: [25] <author> G. Polya and R. C. </author> <title> Read, Combinatorial Enumeration of Groups, Graphs, and Chemical Compounds, </title> <publisher> Springer-Verlag, </publisher> <year> 1987. </year>
Reference-contexts: In combinatorial analyses of trees [8,28] and their subsequent application to areas such as chemistry <ref> [25] </ref>, the W function has been used extensively, although not under that name. Let t n be the number of n-element rooted trees. Then the generating function is T (x) = t n x n =n!.
Reference: [26] <author> K. B. Ranger, </author> <title> "A complex variable integration technique for the 2-dimensional Navier-Stokes equations", Q. </title> <journal> Applied Maths, </journal> <volume> 49 (1991), </volume> <pages> 555-562. 20 </pages>
Reference-contexts: This work led to an efficient and accurate implementation (in Maple V Release 2) of the arbitrary-precision complex floating-point evaluation of all branches of W over the complex plane. Finally, some results of K. B. Ranger given at the Tenth Canadian Fluid Mechanics Symposium (also discussed in <ref> [26] </ref>) led us to rediscover a very old method of integration of inverse functions, which allows the symbolic integration of a large class of functions containing W . This very elementary technique is suitable for inclusion in first year calculus classes and computer algebra systems. Notation. <p> (3.4) with respect to y gives dx = dy dy and simplifying using equation (3.5) we then obtain dy = p (p + 1)e p (3:7) which is easily integrated to give y = (p 2 p + 1)e p + C : (3:8) This example is pursued further in <ref> [26] </ref>. Since y is clearly an antiderivative of W (x), Ranger had discovered a simple technique for symbolic integration of W (x).
Reference: [27] <author> E. L. Reiss, </author> <title> "A new asymptotic method for jump phenomena", </title> <journal> SIAM J. Appl. Math, </journal> <volume> 39 (1980), </volume> <pages> 440-455. </pages>
Reference: [28] <author> Gian-Carlo Rota, </author> <title> Finite Operator Calculus, </title> <publisher> Academic Press, </publisher> <year> 1975. </year>
Reference: [29] <author> Lee A. Segel and Marshall Slemrod, </author> <title> "The Quasi-Steady-State Assumption: A Case Study in Perturbation", </title> <journal> SIAM Review, </journal> <volume> 31 (1989), </volume> <pages> 446-477. </pages>
Reference-contexts: In [23] the Michaelis-Menton model of enzyme kinetics is solved with a perturbation technique. A similar model, with a better scaling, is examined in <ref> [29] </ref>.
Reference: [30] <author> T. C. Scott, J. F. Babb, A. Dalgarno, and John D. Morgan III, </author> <title> "Resolution of a Paradox in the Calculation of Exchange Forces", </title> <type> preprint. </type>
Reference-contexts: This solution is used in a later section of this paper. Resolution of a Paradox in Physics. We give here a brief overview of the recent use in <ref> [30] </ref> of W to explain an anomaly in the calculation of exchange forces between two hydrogen nuclei.
Reference: [31] <author> Ove Skovgaard, Ivar G. Jonsson, and Jens A. Bertelsen, </author> <title> "Computation of Wave Heights Due to Refraction and Friction", </title> <institution> J. Waterways Harbours and Coastal Engineering Division, </institution> <month> February, </month> <year> 1975, </year> <pages> 15-32. </pages>
Reference-contexts: Since then, this function, or the related function W (x) which satisfies we w = x, has been used to solve many different problems. Cayley [8] discusses the function in the context of enumeration of trees. Skovgaard et al. give a fluid-dynamical application of W in <ref> [31] </ref>. W is considered by Polya and Szego [24, Problem 209, p. 146]. Fritsch, Shafer and Crowley [15] present an algorithm for the fixed-precision computation of one branch of W (x) for x &gt; 0.
Reference: [32] <author> E. C. Titchmarsh, </author> <title> Theory of Functions, 2nd ed., </title> <publisher> Oxford, </publisher> <year> 1939. </year>
Reference-contexts: For complex variable courses, it provides a useful example, similar to the logarithm, of a multivalued function. It also provides one of the only simple examples of the application of the Lagrange Inversion Theorem <ref> [32] </ref>. The asymptotics of the W function might profitably be used in a later course. 3. Calculus The principal branch of W is analytic at 0. This follows from the Lagrange Inversion Theorem [32] which gives the series expansion below for W 0 (z): W 0 (z) = n=1 n! It <p> It also provides one of the only simple examples of the application of the Lagrange Inversion Theorem <ref> [32] </ref>. The asymptotics of the W function might profitably be used in a later course. 3. Calculus The principal branch of W is analytic at 0. This follows from the Lagrange Inversion Theorem [32] which gives the series expansion below for W 0 (z): W 0 (z) = n=1 n! It is an interesting exercise to calculate this series directly by reverting the series for we w . <p> If we now choose the positive number a = ffi=(2 ( + 1)), then we have j t j jjjj + jt j &lt; 1 2 ffi (4:14) This means that je 1j &gt; j t j on the circle jj = . Thus, by Rouche's Theorem <ref> [32, x3.42] </ref>, equation (4.13) has exactly one root, v, inside the circle. By Cauchy's Theorem, v = 2i jj= e 1 + t where the integration contour is taken in the counterclockwise direction.
References-found: 32

