URL: file://ftp.tc.cornell.edu/pub/tech.reports/tr144.ps
Refering-URL: http://www.tc.cornell.edu/~liao/papers.html
Root-URL: http://www.tc.cornell.edu
Title: An efficient trust region method for unconstrained discrete-time optimal control problems 1  
Author: Thomas F. Coleman and Aiping Liao 
Date: July 8, 1993  
Abstract: Discrete-time optimal control (DTOC) problems are large-scale optimization problems with a dynamic structure. In previous work this structure has been exploited to provide very fast and efficient local procedures. Two examples are the differential dynamic programming algorithm (DDP) and the stagewise Newton procedure both require only O(N ) operations per iteration, where N is the number of timesteps. Both exhibit a quadratic convergence rate. However, most algorithms in this category do not have a satisfactory global convergence strategy. The most popular global strategy is shifting: this sometimes works poorly due to the lack of automatic adjustment to the shifting element. In this paper we propose a method that incorporates the trust region idea with the local stagewise Newton's method. This method possesses advantages of both the trust region idea and the stagewise Newton's method, i.e., our proposed method has strong global and local convergence properties yet remains economical. Preliminary numerical results are presented to illustrate the behavior of the proposed algorithm. We also collect in the Appendix some DTOC problems that have appeared in the literature. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> D. P. Bertsekas. </author> <title> Projected Newton methods for optimization problems with simple constraints. </title> <journal> SIAM J. Control and Optimization, </journal> <volume> 20 </volume> <pages> 221-246, </pages> <year> 1982. </year>
Reference-contexts: Note: this problem is the modification of that in [21] where the the single loss function is given by L (y; x) = exp (kyk 2 ) sin 2 ( n x # Problem 3. <ref> [1] </ref> (n y = 2 n x = 1) min F := s P N1 i+1 Qy i+1 + Rx 2 y i+1 = 1 s # " s x i ; i = 1; : : : ; N 1: where R = 6 and Q = 2 0 #
Reference: [2] <author> B. D. Craven. </author> <title> Mathematical Programming and Control Theory. </title> <publisher> Chapman and Hall, </publisher> <address> London, </address> <year> 1978. </year>
Reference-contexts: 1 Introduction Discrete-time optimal control (DTOC) problems arise in many practical applications including multi-reservoir control problems [14], the treatment of polluted groundwater [3], and inventory control <ref> [2] </ref>.
Reference: [3] <author> T. B. Culver and C. A. Shoemaker. </author> <title> Dynamic optimal control for groundwater remediation with flexible management periods. </title> <journal> Water Resources Research, </journal> <volume> 28 </volume> <pages> 629-641, </pages> <year> 1992. </year>
Reference-contexts: 1 Introduction Discrete-time optimal control (DTOC) problems arise in many practical applications including multi-reservoir control problems [14], the treatment of polluted groundwater <ref> [3] </ref>, and inventory control [2].
Reference: [4] <author> P. Dyer and S. R. Mcreynolds. </author> <title> The computation and theory of optimal control. </title> <publisher> Academic Press, </publisher> <year> 1970. </year>
Reference-contexts: We show below that these quantities can be calculated in O (N) operations. We first consider (b). It turns out the g can be obtained efficiently by means of a "backward" sequence of equations. The following procedure is essentially that of Dyer and Mcreynolds <ref> [4] </ref>. We assume that g is in the matrix form, i.e., g = [g 1 ; : : : ; g N1 ], g i 2 R n x ; i = 1; : : : ; N 1.
Reference: [5] <author> D. M. Gay. </author> <title> Computing optimal local constrained steps. </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 2 </volume> <pages> 186-197, </pages> <year> 1981. </year>
Reference-contexts: Our method possesses advantages of both the trust region method and the stagewise Newton's method. It has strong convergence properties yet remains economical. There are other trust region algorithms, such as those proposed in More and Sorensen [12] and Gay <ref> [5] </ref>, which have stronger convergence properties. In the Nocedal-Yuan algorithm the subproblem (subP) is not solved very accurately: it only guarantees that k (d k ) fi minf k (d) : d = g k ; kdk k g; kd k k k where fi is some positive constant.
Reference: [6] <author> D. Jacobson and D. Mayne. </author> <title> Differential dynamic programming. </title> <publisher> Elsevier Sci. Publ., </publisher> <year> 1970. </year>
Reference-contexts: Obviously, problem (P) is an optimization problem with a dynamic structure. Taking advantage of this structure, and using the principle of optimality, Mayne [10] and Jacobson and Mayne <ref> [6] </ref> propose a second order algorithm called the differential dynamic programming (DDP) algorithm for solving (P). It has been proven, see Murray and Yakowitz [14] for example, that the DDP algorithm is locally quadratically convergent. However, we note that most DDP-like algorithms do not have a satisfactory global convergence strategy.
Reference: [7] <author> L.-Z. Liao and C. A. Shoemaker. </author> <title> Convergence in unconstrained discrete-time differential dynamic programming. </title> <journal> IEEE Trans. Automat. Contr., </journal> <volume> 36 </volume> <pages> 692-706, </pages> <year> 1991. </year>
Reference-contexts: It has been proven, see Murray and Yakowitz [14] for example, that the DDP algorithm is locally quadratically convergent. However, we note that most DDP-like algorithms do not have a satisfactory global convergence strategy. For example, Liao and Shoemaker <ref> [7] </ref> propose an "adaptive shift" procedure which guarantees global convergence. This procedure is similar to the method proposed in Luen-berger [9]: the smallest eigenvalue of each of the stagewise Hessian matrices fC i g needs to be calculated. <p> If we ignore the lower order terms the total number of operations per iteration of Pantoja's algorithm is the same as the DDP algorithm <ref> [7] </ref>: N (2n 3 7 n 2 x + 3 x ): (1) 2.2 A trust region method The trust region method of Nocedal and Yuan [15] is actually an algorithm that employs both trust region techniques and line searches.
Reference: [8] <author> L.-Z. Liao and C. A. Shoemaker. </author> <title> Advantages of differential dynamic programming over Newton's method for discrete-time optimal control problems. </title> <type> Technical Report ctc92tr97, </type> <institution> Advanced Computing Research Institute, Cor-nell University, </institution> <year> 1992. </year>
Reference-contexts: Acknowledgment: We thank Christine Shoemaker and Li-Zhi Liao for many illuminating discussions on discrete-time optimal control problems. 20 Appendix We collect some test problems in this section. Problem 1. <ref> [8] </ref> min F := i=1 ( j=1 (y i;j + 1 P n x 2 ) 4 ) + j=1 (y N;j + 1 y i+1 = T i (y i ; x i ); i = 1; : : : ; N 1 where T i (y i ; x <p> Problem 2. <ref> [8] </ref> min F := i=1 (ky i k 2 [sin 2 ( kx i k 2 y i+1 = T i (y i ; x i ); i = 1; : : : ; N 1 where T i (y i ; x i ) = sin (y i ) +
Reference: [9] <author> D. G. Luenberger. </author> <title> Linear and Nonlinear Programming. </title> <publisher> Addison-Wesley, </publisher> <address> Reading, Mass., </address> <year> 1984. </year>
Reference-contexts: However, we note that most DDP-like algorithms do not have a satisfactory global convergence strategy. For example, Liao and Shoemaker [7] propose an "adaptive shift" procedure which guarantees global convergence. This procedure is similar to the method proposed in Luen-berger <ref> [9] </ref>: the smallest eigenvalue of each of the stagewise Hessian matrices fC i g needs to be calculated. If the matrices fC i g are large the adaptive shift procedure can be very expensive.
Reference: [10] <author> D. Mayne. </author> <title> A second-order gradient method for determining optimal trajectories of non-linear discrete-time systems. </title> <journal> Intnl. J. Control, </journal> <volume> 3 </volume> <pages> 85-95, </pages> <year> 1966. </year>
Reference-contexts: Obviously, problem (P) is an optimization problem with a dynamic structure. Taking advantage of this structure, and using the principle of optimality, Mayne <ref> [10] </ref> and Jacobson and Mayne [6] propose a second order algorithm called the differential dynamic programming (DDP) algorithm for solving (P). It has been proven, see Murray and Yakowitz [14] for example, that the DDP algorithm is locally quadratically convergent.
Reference: [11] <author> J. J. </author> <title> More. Recent developments in algorithms and software for trust region methods. </title> <editor> In A. Bachem, M. Grotschel, and B. Korte, editors, </editor> <booktitle> Mathematical Programming, </booktitle> <pages> pages 258-287, </pages> <address> New York, 1983. </address> <publisher> Springer-Verlag. </publisher> <pages> 24 </pages>
Reference-contexts: If x k converges to a point x fl such that r 2 f (x fl ) is positive definite, the rate of convergence is quadratic. Proof. See Nocedal and Yuan [15]. 2 We note that it follows from Theorem 4.14 of More <ref> [11] </ref> that if, in addition to the assumptions of Theorem 2.5, f is bounded below on and rf is uniformly continuous then we have lim kg k k = 0: Table 1: Numerical results for problem 1 (n y = 4; n x = 2) N Iter Feva F fl kgk <p> Therefore, the More-Sorensen and Gay's algorithms possess stronger convergence properties <ref> [11] </ref>: if fx k g is bounded then there is a limit point x fl which satisfies the first and second order necessary conditions; if r 2 f (x fl ) is nonsingular for some limit point x fl then r 2 f (x fl ) is positive definite and fx
Reference: [12] <author> J. J. More and D. C. Sorensen. </author> <title> Computing a trust region step. </title> <journal> SIAM J. Sci. Stat. Comput., </journal> <volume> 4 </volume> <pages> 553-572, </pages> <year> 1983. </year>
Reference-contexts: Our method possesses advantages of both the trust region method and the stagewise Newton's method. It has strong convergence properties yet remains economical. There are other trust region algorithms, such as those proposed in More and Sorensen <ref> [12] </ref> and Gay [5], which have stronger convergence properties.
Reference: [13] <author> D. M. Murray and S. J. Yakowitz. </author> <title> The application of optimal control methodology to nonlinear programming problems. </title> <journal> Mathematical Programming, </journal> <volume> 21 </volume> <pages> 331-347, </pages> <year> 1981. </year>
Reference-contexts: Numerical results for problems 3-5 are presented in Table 3. We take s = 1=N in problem 3. The initial point for problem 5 is x 1 = e where e is the all-one vector. Problem 6 is the DTOC form of the so-called "sum of exponentials" problem <ref> [13] </ref>. <p> The initial point is x 1 = e. Problem 6. <ref> [13] </ref> (n y = 1 n x = 1) min F := i=1 [ 1 2 (x i ) 2 ] where y 1 = 0. <p> There are some other nonlinear optimization problems in <ref> [13] </ref> that can be reduced to the DTOC form. 23
Reference: [14] <author> D. M. Murray and S. J. Yakowitz. </author> <title> Differential dynamic programming and Newton's method for discrete optimal control problems. </title> <journal> J. of Optimization Theory and Applications, </journal> <volume> 43 </volume> <pages> 395-414, </pages> <year> 1984. </year>
Reference-contexts: 1 Introduction Discrete-time optimal control (DTOC) problems arise in many practical applications including multi-reservoir control problems <ref> [14] </ref>, the treatment of polluted groundwater [3], and inventory control [2]. <p> Taking advantage of this structure, and using the principle of optimality, Mayne [10] and Jacobson and Mayne [6] propose a second order algorithm called the differential dynamic programming (DDP) algorithm for solving (P). It has been proven, see Murray and Yakowitz <ref> [14] </ref> for example, that the DDP algorithm is locally quadratically convergent. However, we note that most DDP-like algorithms do not have a satisfactory global convergence strategy. For example, Liao and Shoemaker [7] propose an "adaptive shift" procedure which guarantees global convergence.
Reference: [15] <author> J. Nocedal and Y. Yuan. </author> <title> Combining trust region and line search techniques. </title> <type> Technical Report, </type> <institution> Dept of EE and Computer Science, Northwestern University, </institution> <year> 1992. </year>
Reference-contexts: In section 3 numerical results are presented to illustrate the behavior of our algorithm. 2 Description of the algorithm In this section we describe our algorithm which combines the stagewise Newton's method of Pantoja [16] with the trust region method of Nocedal and Yuan <ref> [15] </ref>. 2.1 The stagewise Newton's method Pantoja [16] proposes a modified DDP method for solving (P) which produces iterates identical to those that Newton's method would produce for problem ( P ): min f (x) which is obtained by eliminating the state variables in (P). <p> If we ignore the lower order terms the total number of operations per iteration of Pantoja's algorithm is the same as the DDP algorithm [7]: N (2n 3 7 n 2 x + 3 x ): (1) 2.2 A trust region method The trust region method of Nocedal and Yuan <ref> [15] </ref> is actually an algorithm that employs both trust region techniques and line searches. <p> Nocedal and Yuan <ref> [15] </ref> propose the following algorithm to solve (subP) approximately: Algorithm [Algorithm 2.6 of Nocedal and Yuan [15]] Step 1. Given fl &gt; 1, * &gt; 0, set := 0. <p> Nocedal and Yuan <ref> [15] </ref> propose the following algorithm to solve (subP) approximately: Algorithm [Algorithm 2.6 of Nocedal and Yuan [15]] Step 1. Given fl &gt; 1, * &gt; 0, set := 0. If H is positive definite go to Step 2; else find 2 [0; kHk + (1 + *)kgk=] such that H + I is positive definite, where I is the identity matrix. 6 Step 2. <p> Until kdk , do d = (H + I) 1 g + d T d 0 flkdk End The following algorithm is based on Algorithm 3.1 of Nocedal and Yuan <ref> [15] </ref> in which we use our modified algorithm to solve (subP). Algorithm 3 Initialization. Given x 1 and 1 &gt; 0, choose c 1 ; c 2 such that 0 &lt; c 1 &lt; 1 and 0 &lt; c 2 &lt; 1. Set k = 1. Until convergence do (i). <p> For this algorithm we have 14 Lemma 2.4 If H is not positive definite then Algorithm terminates in at most d (2kHk)=kgke + 1 steps. Proof. If H is not positive definite, then it follows from Lemma 2.3 of Nocedal and Yuan <ref> [15] </ref> that the solution of (subP) is on the boundary, i.e., if d fl is a solution of (subP) then kd fl k = , and there is a fl such that H + fl I is a positive semi-definite and 0 fl kHk + kgk=. <p> Therefore for any given * &gt; 0 H + I is positive definite for any 2 (kHk + kgk=; kHk + (1 + *)kgk=). Hence, Algorithm terminates in at most d (2kHk)=kgke + 1 steps. 2 Our algorithm is the trust region method of Nocedal and Yuan <ref> [15] </ref> tailored to the DTOC setting by adapting the efficient stagewise Newton idea due to Pantoja [16]. Clearly, the convergence properties of the Nocedal-Yuan method carry over here. <p> If x k converges to a point x fl such that r 2 f (x fl ) is positive definite, the rate of convergence is quadratic. Proof. See Nocedal and Yuan <ref> [15] </ref>. 2 We note that it follows from Theorem 4.14 of More [11] that if, in addition to the assumptions of Theorem 2.5, f is bounded below on and rf is uniformly continuous then we have lim kg k k = 0: Table 1: Numerical results for problem 1 (n y
Reference: [16] <author> J. F. A. De O. Pantoja. </author> <title> Differential dynamic programming and Newton's method. </title> <journal> Intnl. J. Control, </journal> <volume> 47 </volume> <pages> 1539-1553, </pages> <year> 1988. </year>
Reference-contexts: In section 3 numerical results are presented to illustrate the behavior of our algorithm. 2 Description of the algorithm In this section we describe our algorithm which combines the stagewise Newton's method of Pantoja <ref> [16] </ref> with the trust region method of Nocedal and Yuan [15]. 2.1 The stagewise Newton's method Pantoja [16] proposes a modified DDP method for solving (P) which produces iterates identical to those that Newton's method would produce for problem ( P ): min f (x) which is obtained by eliminating the <p> section 3 numerical results are presented to illustrate the behavior of our algorithm. 2 Description of the algorithm In this section we describe our algorithm which combines the stagewise Newton's method of Pantoja <ref> [16] </ref> with the trust region method of Nocedal and Yuan [15]. 2.1 The stagewise Newton's method Pantoja [16] proposes a modified DDP method for solving (P) which produces iterates identical to those that Newton's method would produce for problem ( P ): min f (x) which is obtained by eliminating the state variables in (P). Pantoja's algorithm is regarded as a stagewise Newton's method. <p> Pantoja's algorithm is regarded as a stagewise Newton's method. Unlike the conventional Newton's method for ( P ) which requires (N 3 ) works per iteration 1 Pantoja's algorithm needs only O (N ) operations per iteration. Pantoja <ref> [16] </ref> shows that the DTOC problem (P) can be transformed into the following equivalent problem: min F 0 := y 0 y 0 i (y 0 y 0 1 where y 0 i ; y 0 T 0 i ; x i ) = [T i (y i ; x i <p> Algorithm 1 [Pantoja's stagewise Newton's method <ref> [16] </ref>] Step 1. Given the current control variable x; calculate the current state variable y 0 via the transition function T 0 ; calculate P = (L N ) y 0 N y 0 N ; G = Step 2. <p> The proof of the equivalence of Algorithm 1 and Newton's method can be found in Pantoja <ref> [16] </ref>. 5 Returning to problem (P), we can define a procedure for calculating New--ton's step d = H 1 g as follows: we first transform (P) into (PP) and then use Algorithm 1 to obtain d. <p> The key to our approach is the following observation. Lemma 2.1 H is positive definite if and only if C i is positive definite for all i = 1; : : : ; N 1. Proof. According to Theorem 4.6 of Pantoja <ref> [16] </ref>, if C i is positive definite for all i = 1; : : : ; N 1 then H is positive definite. On the other hand, if H is positive definite then it follows from Theorem 4.5 of Pantoja [16] that C i is invertible for all i. <p> Proof. According to Theorem 4.6 of Pantoja <ref> [16] </ref>, if C i is positive definite for all i = 1; : : : ; N 1 then H is positive definite. On the other hand, if H is positive definite then it follows from Theorem 4.5 of Pantoja [16] that C i is invertible for all i. Thus the Gauss block-triangularization procedure in Pantoja [16] can be carried out. <p> On the other hand, if H is positive definite then it follows from Theorem 4.5 of Pantoja <ref> [16] </ref> that C i is invertible for all i. Thus the Gauss block-triangularization procedure in Pantoja [16] can be carried out. We thus have H = U L where U = 6 6 4 0 M 2;2 M 2;N1 . . . 0 0 M N1;N1 7 7 5 L = 6 6 4 L 2;1 C 2 0 . . . <p> Hence, Algorithm terminates in at most d (2kHk)=kgke + 1 steps. 2 Our algorithm is the trust region method of Nocedal and Yuan [15] tailored to the DTOC setting by adapting the efficient stagewise Newton idea due to Pantoja <ref> [16] </ref>. Clearly, the convergence properties of the Nocedal-Yuan method carry over here. Theorem 2.5 Assume that f : R n ! R is twice continuously differentiable on the level set = fx : f (x) f (x 0 )g and the sequence fx k g be generated by our algorithm. <p> 12 12 2.9473466E+00 1.6331E-08 1000 27 27 2.8748904E+00 2.7201E-07 Prob. 5 10 16 16 1.4519006E+00 6.7223E-07 100 21 21 1.5325863E+00 7.1019E-07 1000 34 34 1.5349460E+00 9.1366E-07 We also would like to point out that although the DDP method requires less computation than the stagewise Newton method during each iteration, Pan-toja <ref> [16] </ref> provides an example showing that the stagewise Newton method gives the exact solution in one iteration while DDP only provides an iterative solution.
Reference: [17] <author> G. Di Pillo, L. Grippo, and F. Lampariello. </author> <title> A class of structured quasi-Newton algorithms for optimal control problems. </title> <editor> In H. E. Rauch, editor, </editor> <booktitle> IFAC Applications of nonlinear programming to optimization and control, </booktitle> <pages> pages 101-107. </pages> <booktitle> International Federation of Automatic Control, </booktitle> <publisher> Pergamon Press, </publisher> <address> New York, </address> <year> 1983. </year>
Reference-contexts: The initial point is x 1 = 0. Problem 4. <ref> [17] </ref> (n y = 2 n x = 1) min F := ( 5h 1 ) + 5h i=2 (ky i k 2 + x 2 2 ky N k 2 " (y i;1 ) ; i = 1; : : : ; N 1 where h = 1=N and y <p> The initial point is x 1 = 0. Problem 5. <ref> [17] </ref> (n y = 1 n x = 1) min F := h i=1 (y 2 i ) i x i ); i = 1; : : : ; N 1 where h = 1=N and y 1 = 1. The initial point is x 1 = e.
Reference: [18] <author> M. J. D. Powell. </author> <title> A new algorithm for unconstrained optimization. </title> <editor> In J. B. Rosen, O. Mangasarian, and K. Ritter, editors, </editor> <booktitle> Nonlinear Programming, </booktitle> <pages> pages 31-65, </pages> <address> New York, 1970. </address> <publisher> Academic Press. </publisher>
Reference-contexts: However both the More-Sorensen algorithm and Gay's algorithm assume that the explicit Hessian is available which is not the case for most discrete-time optimal control problems. Another algorithm, in the trust region camp, is the dogleg algorithm of Pow-ell <ref> [18] </ref>. The convergence results for the dogleg algorithm do not guarantee both the first and second order necessary conditions in the case that fx k g converges to x fl ; therefore, they are weaker than those for the Nocedal-Yuan algorithm.
Reference: [19] <author> D. Ralph. </author> <title> A parallel method for discrete-time optimal control problems. </title> <type> Technical Report ctc93tr118, </type> <institution> Advanced Computing Research Institute, Cor-nell University, </institution> <year> 1993. </year>
Reference-contexts: Finally, while our work makes use of the dynamic structure in series, Ralph <ref> [19] </ref> and Wright [20] propose some parallel algorithms for DTOC problems that explore the dynamic structure in parallel. Acknowledgment: We thank Christine Shoemaker and Li-Zhi Liao for many illuminating discussions on discrete-time optimal control problems. 20 Appendix We collect some test problems in this section.
Reference: [20] <author> S. J. Wright. </author> <title> Partitioned dynamic programming for optimal control. </title> <journal> SIAM Journal on optimization, </journal> <volume> 1 </volume> <pages> 620-642, </pages> <year> 1991. </year>
Reference-contexts: Finally, while our work makes use of the dynamic structure in series, Ralph [19] and Wright <ref> [20] </ref> propose some parallel algorithms for DTOC problems that explore the dynamic structure in parallel. Acknowledgment: We thank Christine Shoemaker and Li-Zhi Liao for many illuminating discussions on discrete-time optimal control problems. 20 Appendix We collect some test problems in this section.
Reference: [21] <author> S. Yakowitz and B. Rutherford. </author> <title> Computational aspects of discrete-time optimal control. </title> <journal> Applied Mathematics and Computation, </journal> <volume> 15 </volume> <pages> 29-45, </pages> <year> 1984. </year> <month> 25 </month>
Reference-contexts: The initial state is given by y 1;j = 2n y 21 The initial point is x 1 = 0. Note: this problem is the modification of that in <ref> [21] </ref> where the the single loss function is given by L (y; x) = exp (kyk 2 ) sin 2 ( n x # Problem 3. [1] (n y = 2 n x = 1) min F := s P N1 i+1 Qy i+1 + Rx 2 y i+1 = 1
References-found: 21

