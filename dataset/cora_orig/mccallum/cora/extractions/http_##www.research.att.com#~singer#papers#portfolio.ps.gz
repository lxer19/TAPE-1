URL: http://www.research.att.com/~singer/papers/portfolio.ps.gz
Refering-URL: http://www.research.att.com/~singer/pub.html
Root-URL: 
Email: dph@cse.ucsc.edu  schapire@research.att.com  singer@research.att.com  manfred@cse.ucsc.edu  
Title: On-Line Portfolio Selection Using Multiplicative Updates  
Author: David P. Helmbold Robert E. Schapire Yoram Singer Manfred K. Warmuth 
Keyword: portfolio selection and investment strategies, on-line learning, worst case analysis.  
Date: April 19, 1996  
Address: Santa Cruz, CA 95064  600 Mountain Avenue, Room 2A-424 Murray Hill, NJ 07974  600 Mountain Avenue, Room 2A-407 Murray Hill, NJ 07974  Santa Cruz, CA 95064  
Affiliation: Computer and Information Sciences University of California  AT&T Laboratories  AT&T Laboratories  Computer and Information Sciences University of California  
Abstract: We present an on-line investment algorithm which achieves almost the same wealth as the best constant-rebalanced portfolio determined in hindsight from the actual market outcomes. The algorithm employs a multiplicative update rule derived using a framework introduced by Kivinen and Warmuth. Our algorithm is very simple to implement and requires only constant storage and computing time per stock in each trading period. We tested the performance of our algorithm on real stock data from the New York Stock Exchange accumulated during a 22-year period. On this data, our algorithm clearly outperforms the best single stock as well as Cover's universal portfolio selection algorithm. We also present results for the situation in which the investor has access to additional "side information." 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> P. H. Algoet. </author> <title> Universal schemes for prediction, gambling, and portfolio selection. </title> <journal> Annals of Probability, </journal> <volume> 20 </volume> <pages> 901-941, </pages> <year> 1992. </year>
Reference-contexts: In this approach, the price relative sequences can be drawn from one of a known set of possible distributions. This approach was used by Algoet <ref> [1] </ref> who considered the set of all ergodic and stationary distributions on infinite sequences, and estimated the underlying distribution in order to choose the next portfolio vector. <p> Then t = i i =w t = i i =w t x t log Z t ) u x t To bound log Z t , we apply the following lemma: Lemma 2 For all ff 2 <ref> [0; 1] </ref> and x 2 R, we have: log (1 ff (1 e x )) ffx + x 2 =8: Since x t i 2 [0; 1] and since fi x 1 (1 fi)x for fi &gt; 0 and x 2 [0; 1], we have: Z t = i i e <p> t log Z t ) u x t To bound log Z t , we apply the following lemma: Lemma 2 For all ff 2 <ref> [0; 1] </ref> and x 2 R, we have: log (1 ff (1 e x )) ffx + x 2 =8: Since x t i 2 [0; 1] and since fi x 1 (1 fi)x for fi &gt; 0 and x 2 [0; 1], we have: Z t = i i e x t i i (1 (1 e =w t x t i ) )w t x t : Now, applying Lemma 2, we have log <p> the following lemma: Lemma 2 For all ff 2 <ref> [0; 1] </ref> and x 2 R, we have: log (1 ff (1 e x )) ffx + x 2 =8: Since x t i 2 [0; 1] and since fi x 1 (1 fi)x for fi &gt; 0 and x 2 [0; 1], we have: Z t = i i e x t i i (1 (1 e =w t x t i ) )w t x t : Now, applying Lemma 2, we have log Z t + 8 (w t x t ) 2 : Combining with Equation (5) gives: <p> We will deal with both of these difficulties, starting with the dependence of on r. When no lower bound r on x t i is known, we can use the following portfolio update algorithm which is parameterized by a real number ff 2 <ref> [0; 1] </ref>. Let ~ x t = (1 ff=N )x t + (ff=N )1 where 1 is the all 1's vector.
Reference: [2] <author> P. H. Algoet and T. M. </author> <title> Cover. Asymptotic optimality and asymptotic equipartition properties of log-optimum investment. </title> <journal> Annals of Probability, </journal> <volume> 16(2) </volume> <pages> 876-898, </pages> <year> 1988. </year>
Reference-contexts: Kelly [16] assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector. Under various conditions, it was demonstrated (e.g. <ref> [5, 7, 6, 4, 2] </ref>) that with probability one the Bayes decision approach achieves the same growth rate of the wealth as the best rebalanced portfolio. In this approach, the price relative sequences can be drawn from one of a known set of possible distributions.
Reference: [3] <author> P. Auer and M. K. Warmuth. </author> <title> Tracking the best disjunction. </title> <booktitle> In 36th Annual Symposium on Foundations of Computer Science, </booktitle> <year> 1995. </year>
Reference-contexts: One of the main contributions of this line of work is the use of the relative entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates <ref> [18, 3, 17, 12] </ref> are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach [15, 11]. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that <p> However, this assumption is far from being realistic. An interesting question is whether the techniques developed for tracking a drifting concept <ref> [3, 14] </ref> can be applied to the case of on-line portfolio selection in a changing market. Clearly, using a scheme that tracks a drifting portfolio vector might yield a more powerful investment strategy, both theoretically and empirically.
Reference: [4] <author> A. Barron and T. M. </author> <title> Cover. A bound on the financial value of information. </title> <journal> IEEE Transactions on Information Theory, </journal> <volume> 34 </volume> <pages> 1097-1100, </pages> <year> 1988. </year>
Reference-contexts: Kelly [16] assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector. Under various conditions, it was demonstrated (e.g. <ref> [5, 7, 6, 4, 2] </ref>) that with probability one the Bayes decision approach achieves the same growth rate of the wealth as the best rebalanced portfolio. In this approach, the price relative sequences can be drawn from one of a known set of possible distributions.
Reference: [5] <author> R. Bell and T. M. </author> <title> Cover. Competitive optimality of logarithmic investment. </title> <journal> Mathematics of Operations Research, </journal> <volume> 5 </volume> <pages> 161-166, </pages> <year> 1980. </year>
Reference-contexts: Kelly [16] assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector. Under various conditions, it was demonstrated (e.g. <ref> [5, 7, 6, 4, 2] </ref>) that with probability one the Bayes decision approach achieves the same growth rate of the wealth as the best rebalanced portfolio. In this approach, the price relative sequences can be drawn from one of a known set of possible distributions.
Reference: [6] <author> R. Bell and T. M. </author> <title> Cover. Game-theoretic optimal portfolios. </title> <journal> Managment Science, </journal> <volume> 34 </volume> <pages> 724-733, </pages> <year> 1988. </year>
Reference-contexts: Kelly [16] assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector. Under various conditions, it was demonstrated (e.g. <ref> [5, 7, 6, 4, 2] </ref>) that with probability one the Bayes decision approach achieves the same growth rate of the wealth as the best rebalanced portfolio. In this approach, the price relative sequences can be drawn from one of a known set of possible distributions.
Reference: [7] <author> T. M. </author> <title> Cover. An algorithm for maximizing expected log investment return. </title> <journal> IEEE Transactions on Information Theory, </journal> <volume> 30 </volume> <pages> 369-373, </pages> <year> 1984. </year>
Reference-contexts: Kelly [16] assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector. Under various conditions, it was demonstrated (e.g. <ref> [5, 7, 6, 4, 2] </ref>) that with probability one the Bayes decision approach achieves the same growth rate of the wealth as the best rebalanced portfolio. In this approach, the price relative sequences can be drawn from one of a known set of possible distributions.
Reference: [8] <author> T. M. </author> <title> Cover. Universal portfolios. </title> <journal> Mathematical Finance, </journal> <volume> 1(1) </volume> <pages> 1-29, </pages> <year> 1991. </year>
Reference-contexts: Our algorithm is very simple to implement and its time and storage requirements grow linearly in the number of stocks. Experiments on real New York Stock Exchange data indicate that our algorithm outperforms Cover's <ref> [8] </ref> universal portfolio algorithm. The following simple example demonstrates the power of constant-rebalanced portfolio strategies. Assume that two investments are available. The first is a risk-free, no-growth investment stock whose value never changes. The second investment is a hypothetical highly volatile stock. <p> Investment strategies which maintain a fixed fraction of the total wealth in each of the underlying investments, like the one described above, are called constant-rebalanced portfolio strategies. Previously, Cover <ref> [8] </ref> described a portfolio-selection algorithm that provably performs "almost as well" as the best constant-rebalanced portfolio. In this paper, we describe a new algorithm with similar properties. Like the results for Cover's algorithm, this performance property is proven without making any statistical assumptions on the nature of the stock market. <p> Obviously, the optimal vector w ? can only be computed after after the entire sequence of price relatives is known (at which point, it is no longer of value). However, the algorithm described in this paper (as well as Cover's <ref> [8] </ref> algorithm) performs almost as well as w ? while using only the previously observed history of price relatives to make each day's investment decision. 2.3 Universal portfolios Cover [8] introduced the notion of universal portfolio. <p> However, the algorithm described in this paper (as well as Cover's <ref> [8] </ref> algorithm) performs almost as well as w ? while using only the previously observed history of price relatives to make each day's investment decision. 2.3 Universal portfolios Cover [8] introduced the notion of universal portfolio. <p> Cover and Gluss [9] considered the restricted case where the set of price relatives is finite and gave an investment scheme with universal properties. The most closely related previous results are by Cover <ref> [8] </ref> and Cover and Ordentlich [10]. They prove that certain investment strategies are universal without making any (or almost any) statistical assumptions on the nature of the stock market. Cover [8] proved that the wealth achieved by his universal portfolio algorithm is "almost as large" as the best constant-rebalanced portfolio. <p> The most closely related previous results are by Cover <ref> [8] </ref> and Cover and Ordentlich [10]. They prove that certain investment strategies are universal without making any (or almost any) statistical assumptions on the nature of the stock market. Cover [8] proved that the wealth achieved by his universal portfolio algorithm is "almost as large" as the best constant-rebalanced portfolio. <p> That is, w t = w S t1 (w) d (w) S t1 (w) d (w) where d is one of the Dirichlet distributions mentioned above. Note that the portfolio vectors are weighted according to their past performance, S t1 (w), as well as the prior (w). Discrete approximation <ref> [8] </ref> or recursive series expansion [10] are used to evaluate the above integrals. In both cases, however, the time and space required for finding the new portfolio vector appears to grow exponentially in the number of stocks. <p> After determining the best constant-rebalanced portfolio we then computed its performance on the price relative sequence. We also compared the performance of our update rules to that of Cover's universal portfolio algorithm. We compared the results for all subsets of stocks considered by Cover <ref> [8] </ref> in his experiments. <p> The results of the wealth achieved over the 22 years are depicted for this subset of stocks, as well as other subsets, in Figure 1. We got quantitatively similar results for the different portfolios considered by Cover <ref> [8] </ref>: Commercial Metals and Kin Ark, Commercial Metals and Meicco Corp., and IBM and Coca-Cola. The results are summarized in Table 1. <p> However, when the stocks considered are not volatile and show a lockstep performance, as in the case of IBM and Coca-Cola, the wealth achieved by the universal portfolios and the EG ()-update as well as the best constant-rebalanced portfolio barely outperform the individual stocks. Following Cover <ref> [8] </ref>, we also tested the case when we can invest in stock when margin loans are allowed. This case can be modeled by adding an additional "margin component" for each stock to the vector of price relatives.
Reference: [9] <author> T. M. Cover and D. Gluss. </author> <title> Empirical Bayes stock market portfolios. </title> <booktitle> Advances in Applied Mathematics, </booktitle> <volume> 7, </volume> <year> 1986. </year>
Reference-contexts: This approach was used by Algoet [1] who considered the set of all ergodic and stationary distributions on infinite sequences, and estimated the underlying distribution in order to choose the next portfolio vector. Cover and Gluss <ref> [9] </ref> considered the restricted case where the set of price relatives is finite and gave an investment scheme with universal properties. The most closely related previous results are by Cover [8] and Cover and Ordentlich [10].
Reference: [10] <author> T. M. Cover and E. Ordentlich. </author> <title> Universal portfolios with side information. </title> <type> Unpublished manuscript, </type> <year> 1995. </year>
Reference-contexts: The theoretical bound we prove on the performance of our algorithm relative to the best constant-rebalanced portfolio is not as strong as the bound proved by Cover and Ordentlich <ref> [10] </ref>. However, the time and space required for our algorithm is linear in the number of stocks whereas Cover's algorithm is exponential in the number of stocks. <p> Moreover, we tested our algorithm experi mentally on historical data from the New York Stock Exchange (NYSE) accumulated over a 22-year period, and found that our algorithm clearly outperforms the algorithm of Cover and Ordentlich. Following Cover and Ordentlich <ref> [10] </ref>, we also present results for the situation in which the investor has some finite "side information," such as the current interest rate. Side information may provide hints to the investor that one or a set of stocks are likely to outperform the other stocks in the portfolio. <p> Side information such as prevailing interest rates or consumer-confidence figures can indicate which stocks are likely to outperform the other stocks in the portfolio. Following Cover and Ordentlich <ref> [10] </ref>, we denote the side information by an integer y from a finite set f1; 2; : : :; Kg. Thus, the behavior of the market including the side information is now denoted by the sequence fx t ; y t g. Following Cover and Ordentlich [10], we allow the constant-rebalanced <p> Following Cover and Ordentlich <ref> [10] </ref>, we denote the side information by an integer y from a finite set f1; 2; : : :; Kg. Thus, the behavior of the market including the side information is now denoted by the sequence fx t ; y t g. Following Cover and Ordentlich [10], we allow the constant-rebalanced portfolio to exploit the side information by expanding the single portfolio into a set of portfolios, one for each possible value of the side information. <p> One can easily define a notion of universality analogous to the definition given in Section 2.3. As noticed by Cover and Ordentlich <ref> [10] </ref>, the investor can partition the trading days based on the side information, and treat each partition separately. Exploiting the side information is therefore no more difficult than running K copies of our algorithm, one for each possible value of the side information. <p> Cover and Gluss [9] considered the restricted case where the set of price relatives is finite and gave an investment scheme with universal properties. The most closely related previous results are by Cover [8] and Cover and Ordentlich <ref> [10] </ref>. They prove that certain investment strategies are universal without making any (or almost any) statistical assumptions on the nature of the stock market. Cover [8] proved that the wealth achieved by his universal portfolio algorithm is "almost as large" as the best constant-rebalanced portfolio. <p> His analysis depends on a sensitivity matrix that characterizes the behavior of the market and he 4 assumes that there is an upper bound on the price relatives and that they are bounded away from zero. Cover and Ordentlich <ref> [10] </ref> introduced the notion of side information and generalized Cover's universal portfolio algorithm by using the Dirichlet (1=2; : : : ; 1=2) and the Dirichlet (1; : : : ; 1) priors over the set of all possible portfolio vectors. <p> Note that the portfolio vectors are weighted according to their past performance, S t1 (w), as well as the prior (w). Discrete approximation [8] or recursive series expansion <ref> [10] </ref> are used to evaluate the above integrals. In both cases, however, the time and space required for finding the new portfolio vector appears to grow exponentially in the number of stocks. <p> Surprisingly, the wealth achieved by the universal portfolio strategy using the Dirichlet (1; : : : ; 1) prior performed better than the Dirichlet (1=2; : : : ; 1=2) prior, despite the better theoretical bounds proved for the Dirichlet (1=2; : : : ; 1=2) prior <ref> [10] </ref>. Furthermore, the wealth achieved by the EG ()- update and 2 ()-update was larger than the wealth achieved by the universal portfolio algorithm | again, despite the superior worst-case bounds proved for the universal portfolio algorithm. <p> In comparison, the bounds proved by Cover and Ordentlich <ref> [10] </ref> for their algorithm converge to zero at the rate O ((N log T )=T ). In terms of the number of trading days T , their bounds are much superior, especially compared to our bound for g EG (ff; ).
Reference: [11] <author> D. Haussler, N. Littlestone, and M. K. Warmuth. </author> <title> Predicting f0; 1g-functions on randomly drawn points. </title> <journal> Information and Computation, </journal> <volume> 115(2) </volume> <pages> 284-293, </pages> <year> 1994. </year> <month> 15 </month>
Reference-contexts: entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates [18, 3, 17, 12] are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach <ref> [15, 11] </ref>. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that are computationally cheaper: D 2 (ujjv) def 2 i=1 v i Note that both distance functions are non-negative and zero if and only
Reference: [12] <author> D. P. Helmbold, J. Kivinen, and M. K. Warmuth. </author> <title> Worst-case loss bounds for sigmoided linear neurons. </title> <booktitle> In Advances in Neural Information Processing Systems 8, </booktitle> <year> 1996. </year>
Reference-contexts: One of the main contributions of this line of work is the use of the relative entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates <ref> [18, 3, 17, 12] </ref> are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach [15, 11]. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that
Reference: [13] <author> D. P. Helmbold, R. E. Schapire, Y. Singer, and M. K. Warmuth. </author> <title> A comparison of new and old algorithms for a mixture estimation problem. </title> <booktitle> In Proceedings of the Eighth Annual Workshop on Computational Learning Theory, </booktitle> <pages> pages 69-78, </pages> <year> 1995. </year>
Reference-contexts: Iterative methods for finding this vector using the entire sequence of price relatives x 1 ; : : : ; x T are discussed in our earlier paper <ref> [13] </ref> which gives several updates for solving a general mixture estimation problem, including multiplicative updates like those described in this paper. <p> We found the best constant-rebalanced portfolio by applying a batch maximum-likelihood mixture estimation procedure as described in our earlier paper <ref> [13] </ref>. After determining the best constant-rebalanced portfolio we then computed its performance on the price relative sequence. We also compared the performance of our update rules to that of Cover's universal portfolio algorithm. We compared the results for all subsets of stocks considered by Cover [8] in his experiments.
Reference: [14] <author> M. Herbster and M. K. Warmuth. </author> <title> Tracking the best expert. </title> <booktitle> In Proceedings of the Twelfth International Conference on Machine Learning, </booktitle> <pages> pages 286-294, </pages> <year> 1995. </year>
Reference-contexts: However, this assumption is far from being realistic. An interesting question is whether the techniques developed for tracking a drifting concept <ref> [3, 14] </ref> can be applied to the case of on-line portfolio selection in a changing market. Clearly, using a scheme that tracks a drifting portfolio vector might yield a more powerful investment strategy, both theoretically and empirically.
Reference: [15] <author> G. Jumarie. </author> <title> Relative information. </title> <publisher> Springer-Verlag, </publisher> <year> 1990. </year>
Reference-contexts: entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates [18, 3, 17, 12] are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach <ref> [15, 11] </ref>. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that are computationally cheaper: D 2 (ujjv) def 2 i=1 v i Note that both distance functions are non-negative and zero if and only
Reference: [16] <author> J. L. Kelly. </author> <title> A new interpretation of information rate. </title> <journal> Bell Systems Technical Journal, </journal> <volume> 35 </volume> <pages> 917-926, </pages> <year> 1956. </year>
Reference-contexts: Kelly <ref> [16] </ref> assumed the existence of an underlying distribution of the price relatives and used Bayes decision theory to specify the next portfolio vector.
Reference: [17] <author> J. Kivinen and M. K. Warmuth. </author> <title> Exponentiated gradient versus gradient descent for linear predictors. </title> <type> Technical Report UCSC-CRL-94-16, </type> <institution> University of California, Santa Cruz, Computer Research Laboratory, </institution> <month> June </month> <year> 1994. </year> <note> Revised December, </note> <year> 1995. </year> <booktitle> An extended abstract appeared in the Proceedings of the Twenty-Seventh Annual ACM Symposium on the Theory of Computing, </booktitle> <pages> pages 209-218, </pages> <year> 1995. </year>
Reference-contexts: 1 Introduction We present an on-line investment algorithm which achieves almost the same wealth as the best constant-rebalanced portfolio investment strategy. The algorithm employs a multiplicative update rule derived using a framework introduced by Kivinen and Warmuth <ref> [17] </ref>. Our algorithm is very simple to implement and its time and storage requirements grow linearly in the number of stocks. Experiments on real New York Stock Exchange data indicate that our algorithm outperforms Cover's [8] universal portfolio algorithm. The following simple example demonstrates the power of constant-rebalanced portfolio strategies. <p> and Ordentlich are stronger than ours, we show that on historical stock data our algorithm performs better while requiring time and space linear in the number of stocks. 3 Multiplicative portfolio selection algorithms Our framework for updating a portfolio vector is analogous to the framework developed by Kivinen and Warmuth <ref> [17] </ref> for on-line regression. In this on-line framework the portfolio vector itself encapsulates the necessary information from the previous price relatives. <p> One of the main contributions of this line of work is the use of the relative entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates <ref> [18, 3, 17, 12] </ref> are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach [15, 11]. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that <p> N i = 1 gives a portfolio update which we call the exponentiated gradient (EG ()) update: w t+1 w t i =w t x t j=1 w t j =w t x t A similar update for the case of linear regression was first given by Kivinen and Warmuth <ref> [17] </ref>.
Reference: [18] <author> N. Littlestone. </author> <title> Redundant noisy attributes, attribute errors, and linear threshold learning using Winnow. </title> <booktitle> In Proceedings of the Fourth Annual Workshop on Computational Learning Theory, </booktitle> <pages> pages 147-156, </pages> <year> 1991. </year> <month> 16 </month>
Reference-contexts: One of the main contributions of this line of work is the use of the relative entropy as a distance function for motivating updates: D RE (ujjv) def N X u i log v i Many other on-line algorithms with multiplicative weight updates <ref> [18, 3, 17, 12] </ref> are also motivated by this distance function and are thus rooted in the minimum relative entropy principle of Kullbach [15, 11]. 5 We also use a second-order Taylor approximation (at u = v) of the relative entropy called the 2 -distance, since it leads to updates that
References-found: 18

