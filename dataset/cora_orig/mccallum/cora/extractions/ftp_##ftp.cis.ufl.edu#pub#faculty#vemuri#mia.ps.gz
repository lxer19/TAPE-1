URL: ftp://ftp.cis.ufl.edu/pub/faculty/vemuri/mia.ps.gz
Refering-URL: http://www.cis.ufl.edu/~vemuri/vp10.html
Root-URL: http://www.cis.ufl.edu
Title: An Efficient Motion Estimator with Application to Medical Image Registration  
Author: B. C. Vemuri S. Huang S. Sahni C. M. Leonard C. Mohr R. Gilmore and J. Fitzsimmons 
Keyword: Image Registration, Optical Flow, SSD, B-splines, Newton Iteration, Leven burg Marquardt, Brain Images, MRI.  Image Analysis.  
Note: This work was supported in part by the grant NIH-R01-LM05944. Submitted to the journal of Medical  
Address: Gainesville, Fl 32611  
Affiliation: 1 Department of Computer Information Sciences 2 Department of Neuroscience 3 Department of Neuclear Engineering 4 Department of Neurology 5 Department of Radiology University of Florida,  
Abstract-found: 0
Intro-found: 1
Reference: <author> Aggarwal, J. K. and Nandhakumar, N. </author> <title> (1988) On the Computation of Motion from a Sequences of Images a Review. </title> <journal> Proc. of the IEEE, </journal> <volume> 76(8) </volume> <pages> 917-935. </pages>
Reference: <author> Bajscy, R. and Kovacic, S. </author> <title> (1989) Multiresolution Elastic Matching. Computer Vision, </title> <journal> Graphics and Image Processing, </journal> <volume> vol. 46, </volume> <pages> pages 1-21. </pages>
Reference-contexts: The research reported on the mutual information-based method requires that the motion be expressed in a parameterized form and be global. There is no provision for handling local (nonparametric) and multiple motions. Bajscy and Kovacic <ref> (Bajscy and Kovacic, 1989) </ref> studied registration under nonrigid deformations using volumetric deformations based on elasticity theory of solids. Other direct approaches have used the so called "fluid registration" approach introduced by Christensen et al. (Christensen el al., 1996).
Reference: <author> Barron, J. L., Fleet, D. J. and Beauchemin, S. </author> <title> S.(1994) Performance of Optical Flow Techniques. </title> <journal> Intern. J. Comput. Vision, </journal> <volume> 1(12) </volume> <pages> 43-77. </pages> <note> 35 Black, </note> <author> M. J. and Anandan, P. </author> <title> (1993) A Framework for Robust Estimation of Optical Flow. </title> <booktitle> Proc. Intl. Conf. on Compu. Vision (ICCV), </booktitle> <pages> pages 231-236, </pages> <address> Berlin, Germany. </address>
Reference-contexts: The measure is more meaningful than the average angle error between computed and true flow vectors used by Barron et al. <ref> (Barron et al., 1994) </ref>. In addition, it can be used for global as well as local flow models of motion.
Reference: <author> Borgefors, G., </author> <title> (1988) Hierarchical chamfer matching: a parametric edge matching algorithm. </title> <journal> IEEE Trans. on PAMI, </journal> <volume> 10, </volume> <pages> 849-865. </pages>
Reference: <author> Bro-Nielsen, M. and Gramkow, C. </author> <title> (1996) Fast Fliud Registration of Medical Images. </title> <booktitle> Proc. of the IV Intl. Conf. on Visualization in Biomedical Computing, </booktitle> <pages> pages 267-284, </pages> <address> Hamburg, Germany. </address>
Reference: <author> Burkhardt, H. and Diehl, N. </author> <title> (1986) Simultaneous Estimation of Rotation and Translation in Image Sequences. </title> <booktitle> Proc. of the European Signal Processing Congerence, </booktitle> <publisher> Elsevier Science Publishers B.V. (North-Holland), </publisher> <pages> pages 821-824. </pages>
Reference-contexts: ^x j ^y j ^z j 1 7 2 4 ^y j 3 5 ; (15) which can be written as ^u j = T j T ^ X j : (16) 3 Numerical Solution We now describe a novel adaptation of an elegant numerical method by Burkardt and Diehl <ref> (Burkhardt and Diehl, 1986) </ref> which is a modification of the standard Newton method for solving a system of nonlinear equations. The modification involves precomputation of the Hessian matrix at the optimum without starting the iterative minimization process. <p> In the following, we will essentially adopt the notation from <ref> (Burkhardt and Diehl, 1986) </ref> to derive the modified Newton iteration and develop new notation as necessary. <p> The major advantage is a computational one, which stems from the fact that the Hessian is precomputed . In addition, the Modified Newton method has a broader range of convergence than the standard Newton scheme, as was shown in <ref> (Burkhardt and Diehl, 1986) </ref>. This allows the algorithm to cope with large motions even when the initial guess is far from the optimum. An example depicting the convergence range for the conventional Newton and Modified Newton scheme is shown in figure 4. <p> This allows the algorithm to cope with large motions even when the initial guess is far from the optimum. An example depicting the convergence range for the conventional Newton and Modified Newton scheme is shown in figure 4. Finally, the Modified Newton schemes is at least quadratically convergent <ref> (Burkhardt and Diehl, 1986) </ref>. 3.2 Application of the Modified Newton Method to the Local/Global Mo tion Model In this section, we describe a robust way of pre-computing the Hessian matrix at the optimum and the gradient vector at each iteration step for motion models including local and global ones. 16 (a) <p> translation to the model to generate the red head. (b) After the registration, ^ T 1 (red head) is superimposed on the original green model, where ^ T is the computed motion vector. 26 1994) for minimization of the spline-based representation SSD error and the modified Newton method of Burkhardt <ref> (Burkhardt and Diehl, 1986) </ref> for minimizing the expectation of the squared differences error and our method. This experimental study involved comparing the performance of our algorithm with the performance of our implementation of the published algorithms in Szeliski et al., (Szeliski and Coughlan, 1994) and Burkhardt (Burkhardt and Diehl, 1986). <p> Newton method of Burkhardt <ref> (Burkhardt and Diehl, 1986) </ref> for minimizing the expectation of the squared differences error and our method. This experimental study involved comparing the performance of our algorithm with the performance of our implementation of the published algorithms in Szeliski et al., (Szeliski and Coughlan, 1994) and Burkhardt (Burkhardt and Diehl, 1986). Our implementation of the algorithm in (Szeliski and Coughlan, 1994) was able to reproduce their published results of estimated motion for public domain image data thereby lending credence to our implementation. Our method is a combination of these two methods and inherits their best features.
Reference: <author> Christensen, G. E., Miller, M. I. and Vannier, M. </author> <title> (1996) Individualizing Neuroanatomical Atlases Using a Massively Parallel Computer. </title> <journal> IEEE Computer, </journal> <volume> 1(29) </volume> <pages> 32-38. </pages>
Reference-contexts: There is no provision for handling local (nonparametric) and multiple motions. Bajscy and Kovacic (Bajscy and Kovacic, 1989) studied registration under nonrigid deformations using volumetric deformations based on elasticity theory of solids. Other direct approaches have used the so called "fluid registration" approach introduced by Christensen et al. <ref> (Christensen el al., 1996) </ref>. In this approach the registration transformation is modeled by a viscous fluid flow model expressed as a partial differential equation (PDE).
Reference: <author> Collignon, A., Maes, F., Delaere, D., Vandermeulen, D., Suetens P., and Marchal., G., </author> <title> (1995) Automated multimodality image registration using information theory, </title> <editor> In Bizais, Y., Barillot, C., and Di paoloa, R., (eds.), </editor> <booktitle> Proc. Information Processing in Medical Imaging (Brest), </booktitle> <pages> pp. 263-274. </pages> <publisher> Kluwer, Dordrecht. </publisher>
Reference-contexts: Another direct approach is based on the concept of maximizing mutual information reported in violoa and Wells (Viola and Wells, 1995) and Wells et al., (Wells III et al., 1996), Collignon et al., <ref> (Collignon et al., 1995) </ref> and Studholme et al., (Studholme et al.,). <p> Mutual information between the model and the image that are to be registered is maximized using a stochastic analog of the gradient descent method in (Wells III et al., 1996) and other optimization methods such as the Powells method in <ref> (Collignon et al., 1995) </ref> and a multiresolution scheme in (Studholme et al.,). Reported registration experiments in these works are quite impressive for the case of rigid motion. The research reported on the mutual information-based method requires that the motion be expressed in a parameterized form and be global.
Reference: <author> Davatzikos, C. and Prince, J, L. </author> <title> (1994) Brain Image Registration Based on Curve Mapping. </title> <booktitle> IEEE Workshop on Biomedical Image Analysis, </booktitle> <pages> pages 245-254, </pages> <address> Seattle, WA. </address>
Reference-contexts: The key difference in their scheme from earlier methods is the use of tensor product splines to represent different registration transformations, namely rigid, affine, trilinear, quadratic etc. In addition, they also introduced the novel concept of octree splines for very fast computation of distance between surfaces. Davatzikos et al. <ref> (Davatzikos and Prince, 1994) </ref> introduced a two stage brain image registration algorithm.
Reference: <author> Diehl, N. and Burkhardt, H. </author> <title> (1989) Motion Estimation in Image Sequences. </title> <booktitle> High Precision Navigation, </booktitle> <pages> pages 297-312, </pages> <publisher> Springer-Verlag, </publisher> <address> New York. </address>
Reference-contexts: However, for a slightly different formulation, the Hessian for general motion can be precomputed. In the following, we will describe such a formulation. A clever technique was introduced in <ref> (Diehl and Burkhardt, 1989) </ref>, exploiting the facts that the expectation is independent of coordinate systems and when motion is small, rotation and translation do commute. <p> However, in the modified Newton scheme described earlier, we always used the zero vector as the initial guess for the motion vector to start the iterations. For more details on the convergence behavior of this method, we refer the reader to <ref> (Diehl and Burkhardt, 1989) </ref>. For visualization purpose, we apply the inverse of the computed transformation to the second image I 2 and then superimpose it on I 1 .
Reference: <author> Duncan, J. H. and Chou, T. C. </author> <title> (1992) On the Detection of Motion and the Computation of Optical Flow. </title> <journal> IEEE Trans. Patt. Anal. Mach. Intell., PAMI-14(3):346-352. </journal>
Reference: <author> Evans, A. C., Dai, W., Collins, L., Neeling P. and Marett S. </author> <title> (1991) Warping of Computerized 3D Atlas to Match Brain Image Volumes for Quantitative Neuroanatomical and Functional Analysis. </title> <booktitle> Proc. SPIE Medical Imaging V, </booktitle> <volume> vol. 1445, </volume> <pages> pages 236-246. </pages>
Reference-contexts: The minimization is carried out numerically using Powell's method. Their measure of distance between surfaces is appropriate only for 2 spherical shapes. Evans et al. <ref> (Evans etl al., 1991) </ref> developed a registration scheme based on approximating the 3D warp between the model and target image by a 3D thin plate spline fitted to landmarks.
Reference: <author> Feldmar, J. and Ayache, N. </author> <title> (1994) Locally Affine Registration of Free-form Surfaces. </title> <booktitle> Proc. of IEEE CVPR, </booktitle> <pages> pages 496-501, </pages> <address> Seattle, WA. </address> <note> 36 Gill, </note> <author> P.E., Wright, W. and H., M. </author> <title> (1981) Practical Optimization. </title> <publisher> Academic Press, London. </publisher>
Reference-contexts: The first stage involved using active contours to establish a one-to-one mapping between cortical and ventricular boundaries in the brain and in the second stage, an elastic deformation transformation that determines the best correspondence between the identified contours in the two data sets is determined. Feldmar et al., <ref> (Feldmar and Ayache, 1994) </ref> developed a novel surface to surface nonrigid registration scheme, using locally affine transformation. Maintz et al., (Maintz et al.,) compared edge (Borgefors, 1989) and ridge-based (Gueziec and Ayache, 1992; Monga et al.,; van den Elsen, 1993) registration of CT and MR brain images.
Reference: <author> Gueziec, A. and Ayache, N. </author> <title> (1992) Smoothing and matching of 3D space curves. </title> <editor> In Robb. R. (ed.), </editor> <booktitle> Visualization in Biomedical Computing, Proc. SPIE, </booktitle> <volume> 1808, </volume> <pages> pp. 259-273. </pages> <publisher> SPIE Press, Bellingham, </publisher> <address> WA. </address>
Reference: <author> Monga, O., Benayoun, S. and Faugeras, O. D. </author> <title> (1992) From partial derivatives of 3D density images to ridge lines. Robb. </title> <editor> R. A. (ed.), </editor> <booktitle> Visualization in Biomedical Computing, Proc. SPIE, </booktitle> <volume> 1808, </volume> <pages> pp. 118-127. </pages> <publisher> SPIE Press, Bellingham, </publisher> <address> WA. </address>
Reference: <author> Gupta, S. and Prince, J. </author> <title> (1995) On Variable Brightness Optical Flow for Tagged MRI. </title> <booktitle> Proc. of IPMI, </booktitle> <pages> pages 323-334, </pages> <address> Dordredcht, </address> <publisher> Kluwer. </publisher>
Reference: <author> Horn, B. P. K. and Schunk, B. G. </author> <title> (1981) Determining optical flow. </title> <journal> Artificial Intelligence, </journal> <volume> vol. 17, </volume> <pages> pages 185-203. </pages>
Reference-contexts: Expanding I 2 in a Taylor series in (u i ; v i ) to the first order yields the famous image brightness constraint of Horn and Schunk <ref> ( Horn and Schunk, 1981) </ref>. The above described objective function has been minimized in the past by several techniques, some of them using regularization on (u; v) ( Horn and Schunk, 1981; 6 Lai and Vemuri, 1995).
Reference: <author> Ju, S. X., Black, M. J. and Jepson, A. D. </author> <title> (1996) Skin and Bones: Multi-layer, Locally Affine, Optical Flow and Regularization With Transparency. </title> <booktitle> Proc. of CVPR'96, </booktitle> <pages> pages 307-314, </pages> <address> San Fransico, CA. </address>
Reference: <author> Lai, S. H. and Vemuri, B. C. </author> <title> (1995) Robust and Efficient Computation of Optical Flow. </title> <booktitle> IEEE Symposium on CVS, </booktitle> <pages> pages 455-460, </pages> <address> Miami, Florida. </address>
Reference-contexts: The specific preconditioning we use in our implementation of the 18 local flow is a simple diagonal Hessian preconditioning. More sophisticated preconditioners can be used in place of this simple preconditioner and we refer the reader to <ref> (Lai and Vemuri, 1995) </ref> for more preconditioning. 3.2.2 H & g for 2D Rigid Flow We now derive the Hessian matrix and the gradient vector for the case when the flow field is expressed using a global parametric form specifically, rigid motion parameterization.
Reference: <author> Maintz, J. B. A., van den Elsen P. A., and Viergever M. A., </author> <title> (1996) Comparison of edge-based and ridge-based registration of CT and MR brain images. </title> <journal> Medical Image Analysis, </journal> <volume> 1(2), </volume> <pages> pages 151-161. </pages>
Reference: <author> Nagel, H. H. and Enkelmannm, W. </author> <title> (1986) An Investigation of Smoothness Constraints for the Estimation of Displacement Vector Fields from Image Sequences. </title> <journal> IEEE Trans. Patt. Anal. Mach. Intell., </journal> <volume> 8(5): </volume> <pages> 565-593. </pages>
Reference: <author> Okuomi, M. and Kanade, T. </author> <title> (1992) A Locally Adaptive Window for Signal Matching. </title> <journal> International Journal of Computer Vision, </journal> <volume> 7(2) </volume> <pages> 143-162. </pages>
Reference-contexts: The alternative class of registration algorithms involves using the direct approach, i.e., determining the registration transformation directly from the image data. One such straightforward approach is locally adaptive correlation window scheme <ref> (Okuomi and Kanade, 1992) </ref>, which can achieve high accuracy. But it is computationally demanding (Szeliski and Cough-lan, 1994).
Reference: <author> Pelizarri, C. A., Chen, G. T. Y. and Spelbring, D. R. </author> <title> (1989) Accurate Three-Dimensional Registration of CT, PET and MR Images of the Brain. </title> <journal> J. Comput. Assist. Tomogr., </journal> <volume> 13(1) </volume> <pages> 20-26. </pages>
Reference-contexts: A large body of literature exists on registration, especially for medical image data registration. Generally, they can be cast into two categories. One is feature-based approach. Pellizari et al. <ref> (Pelizarri et al., 1989) </ref> have developed a method for the registration of two brains identified from two different data sets by minimizing the distance between the surfaces measured from a single central point. The minimization is carried out numerically using Powell's method.
Reference: <author> T. Schormann, S. Henn and K. Zilles. </author> <title> A New Approach to Fast Elastic Alignment with Appli--cation to Human Brains. </title> <booktitle> Visualization in Biomedical Computing, </booktitle> <pages> pages 338-342, </pages> <address> Hamburg, Germany. </address>
Reference: <author> Studholme , C., Hill and Hawkes, D. J. </author> <title> Automated 3D registration of MR and CT images in the head. </title> <journal> Medical Image Analysis, </journal> <volume> 1(2), </volume> <pages> pp 163-175. </pages>
Reference: <author> Szeliski, R. and Coughlan, J. </author> <title> (1994) Hierarchical Spline-Based Image Registration. </title> <booktitle> IEEE Conf. Comput. Vision Patt. Recog., </booktitle> <pages> pages 194-201, </pages> <address> Seattle, WA. Thirion, </address> <month> J-P. </month> <title> (1994) Extremal Points: Definition and Application to 3D Registration. </title> <booktitle> Proc. of IEEE CVPR, </booktitle> <pages> pages 587-592, </pages> <address> Seattle, </address> <note> WA. </note> <author> van den Elsen, P. A. </author> <title> (1993) Multimodality matching of brain images. </title> <type> Ph.D. Thesis, </type> <institution> Utrecht University, </institution> <address> The Netherlands. </address> <booktitle> Alignment by maximization of mutual information, In Proc. of the IEEE Intl. Conf. on Computer Vision, (Boston), </booktitle> <pages> 15-23. </pages>
Reference-contexts: Their measure of distance between surfaces is appropriate only for 2 spherical shapes. Evans et al. (Evans etl al., 1991) developed a registration scheme based on approximating the 3D warp between the model and target image by a 3D thin plate spline fitted to landmarks. Szeliski et al. <ref> (Szeliski and Coughlan, 1994) </ref> developed a fast matching algorithm for registration of 3D anatomical surfaces found in 3D medical image data. They use a distance metric minimization to find the optimal transformation between the surfaces. <p> The alternative class of registration algorithms involves using the direct approach, i.e., determining the registration transformation directly from the image data. One such straightforward approach is locally adaptive correlation window scheme (Okuomi and Kanade, 1992), which can achieve high accuracy. But it is computationally demanding <ref> (Szeliski and Cough-lan, 1994) </ref>. A more general scheme than window-based correlation approach is the optical flow formulation, in which the problem of registering two images is treated as equivalent to 3 computing the flow between the data sets. <p> The decision to tile a region further is made based on the error in computed motion/registration. 2.1 2D Local Flow We represent the displacement fields u (x; y) and v (x; y) by B-splines with a small number of control points ^u j and ^v j as in Szeliski <ref> (Szeliski and Coughlan, 1994) </ref>. <p> This experimental study involved comparing the performance of our algorithm with the performance of our implementation of the published algorithms in Szeliski et al., <ref> (Szeliski and Coughlan, 1994) </ref> and Burkhardt (Burkhardt and Diehl, 1986). Our implementation of the algorithm in (Szeliski and Coughlan, 1994) was able to reproduce their published results of estimated motion for public domain image data thereby lending credence to our implementation. <p> This experimental study involved comparing the performance of our algorithm with the performance of our implementation of the published algorithms in Szeliski et al., <ref> (Szeliski and Coughlan, 1994) </ref> and Burkhardt (Burkhardt and Diehl, 1986). Our implementation of the algorithm in (Szeliski and Coughlan, 1994) was able to reproduce their published results of estimated motion for public domain image data thereby lending credence to our implementation. Our method is a combination of these two methods and inherits their best features. <p> Once again, our method is the most robust of the three. The Szeliski's method here refers to a 3D version of the scheme described in <ref> (Szeliski and Coughlan, 1994) </ref>. Figure 7 visualizes the result in the first row of the table 3. 4.4 Testing with 3D Real Data Sets Finally, we applied our algorithm in 3D to register three pairs of MR brain scans, each pair belonging to the same individual before and after surgery.
Reference: <author> Wells III, W. M., Viola, P. and Atsumi, H. </author> <title> (1996) Multi-modal Volume Registration by Maximization of Mutual Information. </title> <journal> Medical Image Analysis, </journal> <volume> 1(1) </volume> <pages> 35-51. 38 </pages>
Reference-contexts: Another direct approach is based on the concept of maximizing mutual information reported in violoa and Wells (Viola and Wells, 1995) and Wells et al., <ref> (Wells III et al., 1996) </ref>, Collignon et al., (Collignon et al., 1995) and Studholme et al., (Studholme et al.,). Mutual information between the model and the image that are to be registered is maximized using a stochastic analog of the gradient descent method in (Wells III et al., 1996) and other <p> Wells, 1995) and Wells et al., <ref> (Wells III et al., 1996) </ref>, Collignon et al., (Collignon et al., 1995) and Studholme et al., (Studholme et al.,). Mutual information between the model and the image that are to be registered is maximized using a stochastic analog of the gradient descent method in (Wells III et al., 1996) and other optimization methods such as the Powells method in (Collignon et al., 1995) and a multiresolution scheme in (Studholme et al.,). Reported registration experiments in these works are quite impressive for the case of rigid motion.
References-found: 27

