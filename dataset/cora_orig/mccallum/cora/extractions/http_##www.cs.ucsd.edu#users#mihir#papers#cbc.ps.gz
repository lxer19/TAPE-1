URL: http://www.cs.ucsd.edu/users/mihir/papers/cbc.ps.gz
Refering-URL: http://www.cs.ucsd.edu/users/mihir/papers/cbc.html
Root-URL: http://www.cs.ucsd.edu
Email: E-mail: mihir@cs.ucsd.edu  
Title: The Security of the Cipher Block Chaining Message Authentication Code Cipher Block Chaining Message Authentication
Author: Mihir Bellare Joe Kilian Phillip Rogaway f (m) 
Address: San Diego, 9500 Gilman Drive, La Jolla, CA 92093.  4 Independence Way, Princeton, New Jersey 08540, U.S.A.  95616, U.S.A.  
Affiliation: def Department of Computer Science Engineering, Mail Code 0114, University of California at  NEC Research Institute,  Department of Computer Science, University of California, Davis California  
Date: July 1997  
Note: Advances in Cryptology Crypto 94 Proceedings, Lecture Notes in Computer Science Vol. 839, Y. Desmedt ed., Springer-Verlag, 1994. This is a revised and expanded version.  The  
Abstract: A preliminary version of this paper, titled "The security of cipher block chaining," appeared in Abstract where f is some underlying block cipher (e.g., the Data Encryption Standard) and a is its key. This method is a pervasively used international and U.S. standard. We provide its first formal justification, showing the following general lemma: that cipher block chaining a pseudorandom function gives a pseudorandom function. Underlying our results is a technical lemma of independent interest, bounding the success probability of a computationally unbounded adversary in distinguishing between a random ml-bit to l-bit function and the CBC MAC of a random l-bit to l-bit function. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> ANSI X9.9, </author> <title> "American National Standard for Financial Institution Message Authentication (Wholesale)," </title> <journal> American Bankers Association, </journal> <note> 1981. Revised 1986. </note>
Reference-contexts: The most popular and widely used special case uses F = DES (the Data Encryption Standard; here k = 56 and l = 64) and s = 32, in which case we recover the definition of the corresponding U.S. Standard <ref> [1] </ref>. These standards are extensively employed in the banking sector and in other commercial sectors. Given this degree of usage and standardization, one might expect that there would be a large body of work aimed at learning if the CBC MAC is secure. Yet this has not been the case. <p> The algorithm is trying to predict b. The advantage is easily seen to be twice Pr [A g = b] 1=2, the amount that the probability of A is correct is bounded away from the guessing probability 1=2. Multiplying by two scales the advantage to be in <ref> [1; 1] </ref>. For 0 * 1, we say that A *-distinguishes F and F 0 if advantage A (F; F 0 ) *. We say that A (q; *)-distinguishes F and F 0 if A is a q-adversary and A *-distinguishes F and F 0 .
Reference: [2] <author> M. Bellare, J. Kilian and P. Rogaway, </author> <title> "The security of cipher block chaining." Preliminary version of the current paper, </title> <booktitle> Advances in Cryptology | Crypto '94 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 839, </volume> <publisher> Springer-Verlag, </publisher> <editor> Y. Desmedt, </editor> <publisher> Ed., </publisher> <pages> pp. 340-358, </pages> <year> 1994. </year>
Reference-contexts: Alternative MAC constructions can be just as simple and efficient as the CBC MAC, but enjoy security bounds that are substantially better than that which is achieved by the CBC MAC. An earlier version of the current paper appears as <ref> [2] </ref>. 1.6 Discussion and open problems The current paper provides a lower bound on the security of the CBC MAC. Preneel and van Oorschot) [15] give a corresponding upper bound (attack). Some gap remains between our result and theirs; closing it is an interesting problem. <p> The second claim has the most involved proof; we know no argument which does not involve modifying and verifying that the proof of the CBC Lemma goes through after making this extension. Note: In the preliminary version of this paper <ref> [2] </ref>, we had also suggested another method, namely Two-step MAC. Set MAC a (x), where x = x 1 x m , to be (m) (2) (m) , where a 0 = f a (0) and a 00 = f a (1).
Reference: [3] <author> M. Bellare, R. Gu erin and P. Rogaway, </author> <title> "XOR MACs: New methods for message authentication using finite pseudorandom functions." </title> <booktitle> Advances in Cryptology | Crypto '95 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 963, </volume> <publisher> Springer-Verlag, </publisher> <address> D. </address> <publisher> Coppersmith, Ed., </publisher> <pages> pp. 15-28, </pages> <year> 1995. </year>
Reference-contexts: Amongst the other methods that have been proposed we note that of <ref> [3] </ref> and [18, 16]. Alternative MAC constructions can be just as simple and efficient as the CBC MAC, but enjoy security bounds that are substantially better than that which is achieved by the CBC MAC.
Reference: [4] <author> M. Bellare and P. Rogaway, </author> <title> "Entity authentication and key distribution," </title> <booktitle> Advances in Cryptology | Crypto '93 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 773, </volume> <publisher> Springer-Verlag, </publisher> <editor> D. Stinson, </editor> <publisher> Ed., </publisher> <pages> pp. 232-249, </pages> <year> 1993. </year>
Reference-contexts: The CBC Lemma provides a provably-good way of extending the basic PRFs (which work on short inputs) to PRFs which work on longer inputs. It was based on such constructions that PRFs were suggested by <ref> [4] </ref> as the tool of choice for practical applications such as entity authentication and key distribution. 1.5 History and related work The lack of any theorem linking the security of f to that of f (m) lead previous users of the CBC MAC to view f (m) , and not f
Reference: [5] <author> R. Bird, I. Gopal, A. Herzberg, P. Janson, S. Kutten, R. Molva and M. Yung, </author> <title> "Systematic design of two-party authentication protocols," </title> <booktitle> Advances in Cryptology - Crypto 91 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 576, </volume> <editor> J. Feigenbaum ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1991. </year>
Reference-contexts: Thus for example in Bird et. al. <ref> [5] </ref>, when the 5 authors require a practical message authentication code in order to achieve their higher-level goal of entity authentication, they made appropriate assumptions about the CBC MAC. A cryptanalytic approach directly attacks the CBC MAC based on details of the underlying block cipher F .
Reference: [6] <author> U. Feige and M. Naor, </author> <title> Private communication, </title> <month> April </month> <year> 1994. </year>
Reference: [7] <author> O. Goldreich, S. Goldwasser and S. Micali, </author> <title> "How to construct random functions," </title> <journal> Journal of the ACM, </journal> <volume> Vol. 33, No. 4, </volume> <pages> 210-217, </pages> <year> (1986). </year>
Reference-contexts: They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali <ref> [7] </ref>. <p> That a PRF automatically makes a secure message authentication code is a well-known observation due to <ref> [7, 8] </ref>|see Section 6 for details. Exact security We wish to obtain results which are meaningful for practice. In particular, we aim to say something about the correct and incorrect use of DES. Since DES is a finite function there are no asymptotics present. <p> Here, following <ref> [7] </ref>, we are considering the following game, or statistical test. Algorithm A is provided as oracle a function g chosen at random from either F or from F 0 , the choice being made at random according to a bit b. The algorithm is trying to predict b. <p> As we remarked in the introduction the reduction is standard <ref> [7, 8] </ref>. But we need to see what is the exact security. The following shows that the reduction is almost tight| security hardly degrades at all. 13 Let G be a finite function family whose keys name functions in R k!l . <p> We say that B is successful if MAC G g (y) = . We say that B (t; q; *)-breaks MAC G if it is successful with probability at least *. The Proposition that follows is the exact security version of the standard reduction of <ref> [7, 8] </ref>. Proposition 6.1 There is an algorithm U and a constant c as follows. Let l 1 and k 1 be integers. Let G R k!l be a finite function family. Suppose q &lt; 2 k . Let B be an algorithm which (t; q; *)-breaks MAC G .
Reference: [8] <author> O. Goldreich, S. Goldwasser and S. Micali, </author> <title> "On the cryptographic applications of random functions," </title> <booktitle> Advances in Cryptology - Crypto 84 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 196, </volume> <editor> R. Blakely ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1984. </year>
Reference-contexts: That a PRF automatically makes a secure message authentication code is a well-known observation due to <ref> [7, 8] </ref>|see Section 6 for details. Exact security We wish to obtain results which are meaningful for practice. In particular, we aim to say something about the correct and incorrect use of DES. Since DES is a finite function there are no asymptotics present. <p> As we remarked in the introduction the reduction is standard <ref> [7, 8] </ref>. But we need to see what is the exact security. The following shows that the reduction is almost tight| security hardly degrades at all. 13 Let G be a finite function family whose keys name functions in R k!l . <p> We say that B is successful if MAC G g (y) = . We say that B (t; q; *)-breaks MAC G if it is successful with probability at least *. The Proposition that follows is the exact security version of the standard reduction of <ref> [7, 8] </ref>. Proposition 6.1 There is an algorithm U and a constant c as follows. Let l 1 and k 1 be integers. Let G R k!l be a finite function family. Suppose q &lt; 2 k . Let B be an algorithm which (t; q; *)-breaks MAC G .
Reference: [9] <author> S. Goldwasser, S. Micali and R. Rivest, </author> <title> "A digital signature scheme secure against adaptive chosen-message attacks," </title> <journal> SIAM Journal of Computing, </journal> <volume> 17(2) </volume> <pages> 281-308, </pages> <month> April </month> <year> 1988. </year>
Reference-contexts: What does it mean for a MAC to be secure? Our notion of security for a message authentication code adopts the viewpoint of Goldwasser, Micali and Rivest <ref> [9] </ref> with regard to signature schemes; namely, a secure MAC must resist existential forgery under adaptive message attack. <p> Let MAC G be defined by MAC G Security of MAC G is discussed via the notion of chosen message attack <ref> [9] </ref>. An adversary B attacks MAC G via the following experiment. Pick g at random from G and provide MAC G g () to B as an oracle.
Reference: [10] <author> ISO/IEC 9797, </author> <title> "Data cryptographic techniques Data integrity mechanism using a cryptographic check function employing a block cipher algorithm," </title> <year> 1989. </year>
Reference-contexts: The CBC MAC is then defined for any ml-bit string x = x 1 : : : x m by CBC-MAC F def = The first s bits of f (m) The CBC MAC is an International Standard <ref> [10] </ref>. The most popular and widely used special case uses F = DES (the Data Encryption Standard; here k = 56 and l = 64) and s = 32, in which case we recover the definition of the corresponding U.S. Standard [1].
Reference: [11] <author> M. Luby and C. Rackoff, </author> <title> "How to construct pseudorandom permutations from pseudorandom functions," </title> <journal> SIAM J. Computation, </journal> <volume> Vol. 17, No. 2, </volume> <month> April </month> <year> 1988. </year>
Reference-contexts: See Section 1.4 for a discussion of length variability. 3 What does it mean to assume DES is secure? To describe the security of a block cipher we elaborate on a viewpoint suggested by Luby and Rackoff <ref> [11, 12] </ref> with regard to DES. They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali [7].
Reference: [12] <author> M. Luby and C. Rackoff, </author> <title> "A study of password security," </title> <booktitle> Advances in Cryptology - Crypto 87 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 293, </volume> <editor> C. Pomerance ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1987. </year>
Reference-contexts: See Section 1.4 for a discussion of length variability. 3 What does it mean to assume DES is secure? To describe the security of a block cipher we elaborate on a viewpoint suggested by Luby and Rackoff <ref> [11, 12] </ref> with regard to DES. They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali [7].
Reference: [13] <author> K. Ohta and M. Matsui, </author> <title> "Differential attack on message authentication codes," </title> <booktitle> Advances in Cryptology - Crypto 93 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 773, </volume> <editor> D. Stin-son ed., </editor> <publisher> Springer-Verlag, </publisher> <year> 1993. </year>
Reference-contexts: A cryptanalytic approach directly attacks the CBC MAC based on details of the underlying block cipher F . Refer to <ref> [13] </ref> for an attempt to directly attack the DES CBC MAC using differential cryptanalysis. Another approach to studying MACs is rooted in the examination of protocols which use them. Stubblebine and Gligor [17] find flaws in the use of the CBC MAC in some well-known protocols.
Reference: [14] <author> E. Petrank and C. Rackoff, </author> <title> "CBC MAC for real time data sources," </title> <type> DIMACS Technical Report 97-26, </type> <year> 1997. </year>
Reference-contexts: Set MAC a (x), where x = x 1 x m , to be (m) (2) (m) , where a 0 = f a (0) and a 00 = f a (1). However, Petrank and Rackoff <ref> [14] </ref> pointed out that this does not work. These authors have also suggested a different scheme for handling length variability, called the Double MAC: Double MAC [14]: Set MAC a (x), where x = x 1 x m , to be f a 0 (f (m) a 00 (x)), where a <p> However, Petrank and Rackoff <ref> [14] </ref> pointed out that this does not work. These authors have also suggested a different scheme for handling length variability, called the Double MAC: Double MAC [14]: Set MAC a (x), where x = x 1 x m , to be f a 0 (f (m) a 00 (x)), where a 0 = f a (0) and a 00 = f a (1). <p> Furthermore a complete proof of security for the scheme, building on techniques from this paper, is provided in <ref> [14] </ref>. 6 From PRFs to MACs Since justifying the CBC MAC is a primary aim of this paper, to complete this project we need one more step|to show that pseudorandom functions make good message authentication codes. As we remarked in the introduction the reduction is standard [7, 8].
Reference: [15] <author> B. Preneel and P. van Oorschot, </author> <title> "MDx-MAC and building fast MACs from hash functions." </title> <booktitle> Advances in Cryptology | Crypto '95 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 963, </volume> <publisher> Springer-Verlag, </publisher> <address> D. </address> <publisher> Coppersmith, Ed., </publisher> <pages> pp. 1-14, </pages> <year> 1995. </year>
Reference-contexts: An earlier version of the current paper appears as [2]. 1.6 Discussion and open problems The current paper provides a lower bound on the security of the CBC MAC. Preneel and van Oorschot) <ref> [15] </ref> give a corresponding upper bound (attack). Some gap remains between our result and theirs; closing it is an interesting problem. Block ciphers like DES are in fact permutations.
Reference: [16] <author> P. Rogaway, </author> <title> "Bucket hashing and its application to fast message authentication." </title> <booktitle> Advances in Cryptology | Crypto '95 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 963, </volume> <publisher> Springer-Verlag, </publisher> <address> D. </address> <publisher> Coppersmith, Ed., </publisher> <pages> pp. 29-42, </pages> <year> 1995. </year> <month> 15 </month>
Reference-contexts: Amongst the other methods that have been proposed we note that of [3] and <ref> [18, 16] </ref>. Alternative MAC constructions can be just as simple and efficient as the CBC MAC, but enjoy security bounds that are substantially better than that which is achieved by the CBC MAC.
Reference: [17] <author> S. Stubblebine and V. Gligor, </author> <title> "On message integrity in cryptographic protocols," </title> <booktitle> Pro- ceedings of the 1992 IEEE Computer Society Symposium on Research in Security and Privacy. </booktitle> <month> May </month> <year> 1992. </year>
Reference-contexts: Refer to [13] for an attempt to directly attack the DES CBC MAC using differential cryptanalysis. Another approach to studying MACs is rooted in the examination of protocols which use them. Stubblebine and Gligor <ref> [17] </ref> find flaws in the use of the CBC MAC in some well-known protocols.
Reference: [18] <author> M. Wegman and L. Carter, </author> <title> "New hash functions and their use in authentication and set equality." </title> <journal> J. of Computer and System Sciences 22, </journal> <month> 265-279 </month> <year> (1981). </year>
Reference-contexts: Amongst the other methods that have been proposed we note that of [3] and <ref> [18, 16] </ref>. Alternative MAC constructions can be just as simple and efficient as the CBC MAC, but enjoy security bounds that are substantially better than that which is achieved by the CBC MAC.
References-found: 18

