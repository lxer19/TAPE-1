URL: http://www.cse.ucsc.edu/research/compbio/papers/weighting.ps
Refering-URL: http://www.cse.ucsc.edu/research/compbio/sam.html
Root-URL: http://www.cse.ucsc.edu
Title: Weighting Hidden Markov Models For Maximum Discrimination  
Author: Rachel Karchin and Richard Hughey 
Note: PREPRINT to appear in Bioinformatics, 1998  
Address: Santa Cruz, CA 95064  
Affiliation: Department of Computer Engineering Jack Baskin School of Engineering University of California  
Abstract: 1 Abstract 
Abstract-found: 1
Intro-found: 1
Reference: <author> Agarwal, P. & States, D. J. </author> <year> (1998). </year> <title> Comparative accuracy of methods for protein-sequence similarity search. </title> <journal> Bioin-formatics, </journal> <volume> 14 (1). </volume>
Reference-contexts: On completing our evaluation of these different weighting schemes, we performed a more general analysis of our best weighting schemes based on the recent work of Agar-wal and States <ref> (Agarwal & States, 1998) </ref>. Using 67 su-perfamilies from an annotated version of PIR (Pearson, 1995), they compared several pairwise sequence comparison methods, leading to the observation that Probabilistic Smith Waterman (PSW) (Bucher & Hoffmann, 1996) was the best discrimination technique tested for whole proteins. <p> Agarwal and States have analyzed five single-sequence search algorithms using a single sequence from each of the 67 superfamilies <ref> (Agarwal & States, 1998) </ref>.
Reference: <author> Althschul, S. & Gish, W. </author> <year> (1996). </year> <title> Local alignment statistics. </title> <journal> Methods Enzymol. </journal> <volume> 266, </volume> <pages> 460-480. </pages>
Reference: <author> Altschul, S. F. </author> <year> (1991). </year> <title> Amino acid substitution matrices from an information theoretic perspective. </title> <journal> JMB, </journal> <volume> 219, </volume> <pages> 555-565. </pages>
Reference-contexts: By assigning larger weights to poorly scoring sequences during model training, we have been able to significantly reduce the number of errors made when the resulting model is used to recognize members of a particular family. The methods we have considered are based entirely on the log-odds score <ref> (Altschul, 1991) </ref> of the sequence against the model being trained. This investigation was motivated by HMMer's maximum-discrimination training method (Eddy et al., 1995; Eddy, 1995). HMMer 1 uses a simulated annealing approach, in which the num-ber of sequences actively in the training set is reduced over the course of training. <p> Making the assumption that the models M and are a priori equally likely, this reduces to the log-odds probability of P (M ja) = P (ajM ) + P (aj) Typically, a log-odds score S is used instead <ref> (Altschul, 1991) </ref>: P (ajM ) 2 P (M ja) = 1 + e S : This score measures whether the probability that the sequence was generated by the model is greater than the probability it was generated by a null model (in SAM's case, the geometric average of the modeled sequence
Reference: <author> Altschul, S. F., Gish, W., Miller, W., Meyers, E. W., & Lipp-man, D. J. </author> <year> (1990). </year> <title> Basic local alignment search tool. </title> <journal> JMB, </journal> <volume> 215, </volume> <pages> 403-410. </pages>
Reference-contexts: They analyzed Smith and Waterman SSEARCH (Smith & Waterman, 1981; Pearson & Lipman, 1988), FASTA (FA) (Pearson & Lipman, 1988), Probabilistic Smith-Waterman (PS) (Bucher & Hoffmann, 1996), BLASTP 1.4 (BP) <ref> (Altschul et al., 1990) </ref>, and WU-BLASTP2 6 Unweighted Method 2 Method 7 Position specific Entropy weighting Fig. 4. Average and range of equivalence numbers for each size group of ferredoxin training sets for several weighting methods.
Reference: <author> Bailey, T. L. & Elkan, C. </author> <year> (1994). </year> <title> Fitting a mixture model by expectation maximization to discover motifs in biopoly-mers. </title> <booktitle> In: </booktitle> <pages> ISMB-94 pp. 28-36, </pages> <address> Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference-contexts: We used the default HMMer configuration. The impending rewrite of HMMer can be expected to have improved performance. We also built HMMs using a combined MEME <ref> (Bailey & Elkan, 1994) </ref> and HMMer method called Meta-MEME (Grundy et al., 1997; Grundy, 1998).
Reference: <author> Baldi, P., Chauvin, Y., Hunkapillar, T., & McClure, M. </author> <year> (1994). </year> <title> Hidden Markov models of biological primary sequence information. </title> <journal> PNAS, </journal> <volume> 91, </volume> <pages> 1059-1063. </pages>
Reference: <author> Barrett, C., Hughey, R., & Karplus, K. </author> <year> (1997). </year> <title> Scoring hidden Markov models. </title> <journal> CABIOS, </journal> <volume> 13 (2), </volume> <pages> 191-199. </pages>
Reference-contexts: P (ajM ) 2 P (M ja) = 1 + e S : This score measures whether the probability that the sequence was generated by the model is greater than the probability it was generated by a null model (in SAM's case, the geometric average of the modeled sequence positions <ref> (Barrett et al., 1997) </ref>). This log-odds score is used to calculate the weight of a sequence. (SAM actually uses negative log-odds, but for this discussion, hopefully consistently, we use positive log-odds scores.) HMMer's maximum discrimination method gives to each sequence a weight of 1P (M ja). <p> W old : W = (1 x)W old + x W new ; (10) where x is the "weight mix" parameter that is decreased linearly from one to zero over the training iterations depending on a factor, either default or specified by the user. 5 Method Evaluations Following previous work <ref> (Barrett et al., 1997) </ref>, we initially tested these eight methods on three protein families: globins, ferredoxins and EF-hands. Models were generated from large training sets of known family members using SAM's buildmodel program. We would expect such models to be quite good at discriminating between family and non-family members.
Reference: <author> Bucher, P. & Bairoch, A. </author> <year> (1994). </year> <title> A generalized profile syntax for biomolecular sequence motifs and its function in automatic sequence interpretation. </title> <booktitle> In: </booktitle> <pages> ISMB-94 pp. 53-61, </pages> <address> Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference-contexts: on obtaining the Sequence Alignment and Modeling (SAM) software suite and additional data from this work, can be found at http://www.cse.ucsc.edu/research/comp-bio/sam.html. 1.4 Contact Email: rph@cse.ucsc.edu. fl To whom correspondence should be addressed 2 Introduction Linear hidden Markov models (HMMs) (Haussler et al., 1993; Krogh et al., 1994) or generalized profiles <ref> (Bucher & Bairoch, 1994) </ref> have been demonstrated to be very effective in detecting conserved patterns in multiple sequences (Hughey & Krogh, 1996; Baldi et al., 1994; Eddy et al., 1995; Eddy, 1995; Bucher et al., 1996; McClure et al., 1996; Karplus et al., 1997).
Reference: <author> Bucher, P. & Hoffmann, K. </author> <year> (1996). </year> <title> A sequence similarity search algorithm based on probabalistic interpretation of an alignment scoring system. </title> <booktitle> In: </booktitle> <pages> ISMB-96 pp. 44-51, </pages> <address> Menlo Park, CA: </address> <publisher> AAAI Press. </publisher>
Reference-contexts: Using 67 su-perfamilies from an annotated version of PIR (Pearson, 1995), they compared several pairwise sequence comparison methods, leading to the observation that Probabilistic Smith Waterman (PSW) <ref> (Bucher & Hoffmann, 1996) </ref> was the best discrimination technique tested for whole proteins. <p> Agarwal and States have analyzed five single-sequence search algorithms using a single sequence from each of the 67 superfamilies (Agarwal & States, 1998). They analyzed Smith and Waterman SSEARCH (Smith & Waterman, 1981; Pearson & Lipman, 1988), FASTA (FA) (Pearson & Lipman, 1988), Probabilistic Smith-Waterman (PS) <ref> (Bucher & Hoffmann, 1996) </ref>, BLASTP 1.4 (BP) (Altschul et al., 1990), and WU-BLASTP2 6 Unweighted Method 2 Method 7 Position specific Entropy weighting Fig. 4. Average and range of equivalence numbers for each size group of ferredoxin training sets for several weighting methods.
Reference: <author> Bucher, P., Karplus, K., Moeri, N., & Hoffman, K. </author> <year> (1996). </year> <title> A flexible motif search technique based on generalized profiles. </title> <journal> Computers and Chemistry, </journal> <volume> 20 (1), </volume> <pages> 3-24. </pages>
Reference-contexts: Using 67 su-perfamilies from an annotated version of PIR (Pearson, 1995), they compared several pairwise sequence comparison methods, leading to the observation that Probabilistic Smith Waterman (PSW) <ref> (Bucher & Hoffmann, 1996) </ref> was the best discrimination technique tested for whole proteins. <p> Agarwal and States have analyzed five single-sequence search algorithms using a single sequence from each of the 67 superfamilies (Agarwal & States, 1998). They analyzed Smith and Waterman SSEARCH (Smith & Waterman, 1981; Pearson & Lipman, 1988), FASTA (FA) (Pearson & Lipman, 1988), Probabilistic Smith-Waterman (PS) <ref> (Bucher & Hoffmann, 1996) </ref>, BLASTP 1.4 (BP) (Altschul et al., 1990), and WU-BLASTP2 6 Unweighted Method 2 Method 7 Position specific Entropy weighting Fig. 4. Average and range of equivalence numbers for each size group of ferredoxin training sets for several weighting methods.
Reference: <author> Eddy, S. </author> <year> (1995). </year> <title> Multiple alignment using hidden Markov models. </title> <editor> In: ISMB-95, (Rallings, C. et al., eds) pp. </editor> <address> 114-120, Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference: <author> Eddy, S., Mitchison, G., & Durbin, R. </author> <year> (1995). </year> <title> Maximum discrimination hidden Markov models of sequence consensus. </title> <journal> J. Comput. Biol. </journal> <volume> 2, </volume> <pages> 9-23. </pages>
Reference: <author> Grundy, W. N. </author> <year> (1998). </year> <title> Family-based homology detection via pairwise sequence comparison. </title> <booktitle> In: Int. Conf. Computational Molecular Biology (RECOMB-98) , New York: </booktitle> <publisher> ACM Press. </publisher>
Reference-contexts: We again used the same training and discrimination sets. We ran the programs from the MEME suite using the settings described in the literature <ref> (Grundy, 1998) </ref>: a minimum motif width of 12, maximum motif width of 55, the ZOOPS motif model (zero or one motif occurrence per sequence), ten selected motifs from each training set, and 7 Fig. 5. Weight versus score snapshots during the training process of 100 ferredoxins. <p> The comparison of single-sequence PSW with multiple-sequence HMMs is somewhat unfair. A more complete comparison would include a modified version of PSW that uses all sequences in the training set and, for example, using an iterative search technique (Pearson, 1997) or averaging the scores <ref> (Grundy, 1998) </ref>. As our primary goal was to evaluate the effectiveness of internal weighting methods in SAM, this work was considered beyond the scope of the paper. 7 Acknowledgments We gratefully acknowledge Christian Barrett, David Haussler, and Kevin Karplus for their assistance and commentary on this work.
Reference: <author> Grundy, W. N., Bailey, W., Elkan, T., & Baker, C. </author> <year> (1997). </year> <title> Meta-MEME: Motif-based hidden Markov models of protein families. </title> <journal> CABIOS, </journal> <volume> 13 (4), </volume> <pages> 397-406. </pages>
Reference: <author> Haussler, D., Krogh, A., Mian, I. S., & Sjolander, K. </author> <year> (1993). </year> <title> Protein modeling using hidden Markov models: Analysis of globins. </title> <booktitle> In: Proceedings of the Hawaii International Conference on System Sciences volume 1 pp. </booktitle> <pages> 792-802, </pages> <address> Los Alamitos, CA: </address> <publisher> IEEE Computer Society Press. </publisher>
Reference: <author> Henikoff, S. & Henikoff, J. G. </author> <year> (1994). </year> <title> Position-based sequence weights. </title> <journal> JMB, </journal> <volume> 243 (4), </volume> <pages> 574-578. </pages>
Reference-contexts: This came in two phases. The first is external weighting, in which a file of weights can be read in and assigned to sequences. Our group currently uses this and either position-specific weighting <ref> (Henikoff & Henikoff, 1994) </ref> or an entropy-based method (Karplus, 1997), using an unpublished method to assign the total weight (without regularization, only relative weight matters; with regularization, required for small sample sizes, total weight will influence how strongly the sequences can overpower the reg-ularizer (Karplus, 1995)). <p> Computationally method 4 performed the worst, requiring two and three times as many model building iterations as the other internal methods. We restricted further experiments to method 2, method 7, unweighted, external entropy, and external position-specific <ref> (Henikoff & Henikoff, 1994) </ref>.
Reference: <author> Hughey, R. & Krogh, A. </author> <year> (1996). </year> <title> Hidden Markov models for sequence analysis: Extension and analysis of the basic method. </title> <journal> CABIOS, </journal> <volume> 12 (2), </volume> <pages> 95-107. </pages>
Reference: <author> Karplus, K. </author> <year> (1995). </year> <title> Regularizers for estimating distributions of amino acids from small samples. </title> <booktitle> In: </booktitle> <address> ISMB-95 , Menlo Park, CA: </address> <publisher> AAAI/MIT Press. </publisher>
Reference-contexts: uses this and either position-specific weighting (Henikoff & Henikoff, 1994) or an entropy-based method (Karplus, 1997), using an unpublished method to assign the total weight (without regularization, only relative weight matters; with regularization, required for small sample sizes, total weight will influence how strongly the sequences can overpower the reg-ularizer <ref> (Karplus, 1995) </ref>). Both of these methods are based on analyzing a multiple alignment of the training sequences. When one is not available, a rough alignment is created using unweighted HMM training, the sequences are weighted based on that alignment, and then a new HMM is trained using those weights.
Reference: <author> Karplus, K. </author> <year> (1997). </year> <type> Personal communication. </type>
Reference-contexts: This came in two phases. The first is external weighting, in which a file of weights can be read in and assigned to sequences. Our group currently uses this and either position-specific weighting (Henikoff & Henikoff, 1994) or an entropy-based method <ref> (Karplus, 1997) </ref>, using an unpublished method to assign the total weight (without regularization, only relative weight matters; with regularization, required for small sample sizes, total weight will influence how strongly the sequences can overpower the reg-ularizer (Karplus, 1995)).
Reference: <author> Karplus, K., Kimmen Sjolander, Barrett, C., Cline, M., Haus-sler, D., Hughey, R., Holm, L., & Sander, C. </author> <year> (1997). </year> <title> Predicting protein structure using hidden Markov models. Proteins: Structure, Function, and Genetics, </title> . <note> to appear. </note>
Reference-contexts: This came in two phases. The first is external weighting, in which a file of weights can be read in and assigned to sequences. Our group currently uses this and either position-specific weighting (Henikoff & Henikoff, 1994) or an entropy-based method <ref> (Karplus, 1997) </ref>, using an unpublished method to assign the total weight (without regularization, only relative weight matters; with regularization, required for small sample sizes, total weight will influence how strongly the sequences can overpower the reg-ularizer (Karplus, 1995)).
Reference: <author> Krogh, A., Brown, M., Mian, I. S., Sjolander, K., & Haussler, D. </author> <year> (1994). </year> <title> Hidden Markov models in computational biology: Applications to protein modeling. </title> <journal> JMB, </journal> <volume> 235, </volume> <pages> 1501-1531. </pages>
Reference: <author> McClure, M., Smith, C., & Elton, P. </author> <year> (1996). </year> <title> Parameteri--zation studies for the SAM and HMMER methods of hidden Markov model generation. </title> <booktitle> In: </booktitle> <pages> ISMB-96 pp. 155-164, </pages> <address> St. Louis: </address> <publisher> AAAI Press. </publisher>
Reference: <author> Milosavljevic, A. & Jurka, J. </author> <year> (1993). </year> <title> Discovering simple DNA sequences by the algorithmic similarity method. </title> <journal> CABIOS, </journal> <volume> 9 (4), </volume> <pages> 407-411. </pages>
Reference: <author> Pearson, W. </author> <year> (1995). </year> <title> Comparison of methods for searching protein sequence databases. </title> <journal> Protein Science, </journal> <volume> 4, </volume> <pages> 1145-1160. </pages>
Reference-contexts: On completing our evaluation of these different weighting schemes, we performed a more general analysis of our best weighting schemes based on the recent work of Agar-wal and States (Agarwal & States, 1998). Using 67 su-perfamilies from an annotated version of PIR <ref> (Pearson, 1995) </ref>, they compared several pairwise sequence comparison methods, leading to the observation that Probabilistic Smith Waterman (PSW) (Bucher & Hoffmann, 1996) was the best discrimination technique tested for whole proteins. <p> find out whether or not our methods had value beyond these three protein families and to compare our discrimination results with other methods in general use, we ran another set of experiments using training and discrimination sets based Pearson's annotated version of the PIR 39 database with 12219 proteins total <ref> (Pearson, 1995) </ref>. Agarwal and States have analyzed five single-sequence search algorithms using a single sequence from each of the 67 superfamilies (Agarwal & States, 1998).
Reference: <author> Pearson, W. & Lipman, D. </author> <year> (1988). </year> <title> Improved tools for biological sequence comparison. </title> <booktitle> Proc. </booktitle> <institution> Natl. Acad. Sci. USA, </institution> <month> 85, </month> <pages> 2444-2448. </pages>
Reference-contexts: Agarwal and States have analyzed five single-sequence search algorithms using a single sequence from each of the 67 superfamilies (Agarwal & States, 1998). They analyzed Smith and Waterman SSEARCH (Smith & Waterman, 1981; Pearson & Lipman, 1988), FASTA (FA) <ref> (Pearson & Lipman, 1988) </ref>, Probabilistic Smith-Waterman (PS) (Bucher & Hoffmann, 1996), BLASTP 1.4 (BP) (Altschul et al., 1990), and WU-BLASTP2 6 Unweighted Method 2 Method 7 Position specific Entropy weighting Fig. 4. Average and range of equivalence numbers for each size group of ferredoxin training sets for several weighting methods.
Reference: <author> Pearson, W. R. </author> <year> (1997). </year> <title> Identifying distantly related protein sequences. </title> <journal> CABIOS, </journal> <volume> 13 (4), </volume> <pages> 325-332. </pages>
Reference-contexts: The comparison of single-sequence PSW with multiple-sequence HMMs is somewhat unfair. A more complete comparison would include a modified version of PSW that uses all sequences in the training set and, for example, using an iterative search technique <ref> (Pearson, 1997) </ref> or averaging the scores (Grundy, 1998).
Reference: <author> Sjolander, K., Karplus, K., Brown, M. P., Hughey, R., Krogh, A., Mian, I. S., & Haussler, D. </author> <year> (1996). </year> <title> Dirichlet mixtures: A method for improving detection of weak but significant protein sequence homology. </title> <journal> CABIOS, </journal> <volume> 12 (4), </volume> <pages> 327-345. </pages>
Reference-contexts: In this case, the entire training set is aligned to the model, and a completely new model is generated by combining the information from these alignments and the transition regularizer and a Dirichlet mixture prior <ref> (Sjolander et al., 1996) </ref>. (SAM uses the full forward-backward algorithm, so more precisely, the sum of probabilities across all possible alignments is calculated for each sequence.) SAM can produce a model from unaligned sequences, as was done in these experiments, or SAM can be given an initial seed alignment, which often
Reference: <author> Smith, T. F. & Waterman, M. S. </author> <year> (1981). </year> <title> Identification of common molecular subsequences. </title> <journal> JMB, </journal> <volume> 147, </volume> <pages> 195-197. </pages>
Reference: <author> Tarnas, C. & Hughey, R. </author> <year> (1998). </year> <title> Reduced space hidden Markov model training. </title> <type> Bioinformatics, </type> <note> (to appear). 12 </note>
References-found: 29

