URL: http://wwwcsif.cs.ucdavis.edu/~rogaway/papers/cbc.ps
Refering-URL: http://seclab.cs.ucdavis.edu/papers.html
Root-URL: http://www.cs.ucdavis.edu
Title: The Security of Cipher Block Chaining  
Author: M. Bellare J. Kilian P. Rogaway 
Keyword: f (m)  
Address: PO Box 704, Yorktown Heights, NY 10598, USA.  4 Independence Way, Princeton, NJ 08540, USA.  CA 95616, USA.  
Affiliation: Laboratory, IBM T.J. Watson Research Center,  NEC Research Institute,  Department of Computer Science, University of California at Davis, Davis,  
Note: Appears in Proceedings of Crypto 94.  Advanced Networking  
Email: e-mail: mihir@watson.ibm.com  e-mail: joe@research.nj.nec.com  e-mail: rogaway@cs.davis.edu  
Date: June 2, 1994  
Abstract: where f is some underlying block cipher (eg. f = DES). This method is a pervasively used international and U.S. standard. We provide its first formal justification, showing the following general lemma: that cipher block chaining a pseudorandom function gives a pseudorandom function. Underlying our results is a technical lemma of independent interest, bounding the success probability of a computationally unbounded adversary in distinguishing between a random ml-bit to l-bit function and the CBC MAC of a random l-bit to l-bit function. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> ANSI X9.9, </author> <title> "American National Standard for Financial Institution Message Authentication (Wholesale)," </title> <journal> American Bankers Association, </journal> <note> 1981. Revised 1986. </note>
Reference-contexts: The most popular and widely used special case uses F = DES (so k = 56 and l = 64) and s = 32, in which case we recover the definition of the corresponding U.S. Standard <ref> [1] </ref>. These standards are extensively employed in the banking sector and in other commercial sectors. Given this degree of usage and standardization, you might expect that there would be a large body of work aimed at learning if the CBC MAC is secure.
Reference: [2] <author> M. Bellare, R. Gu erin and P. Rogaway, </author> <title> "Fully parallelizable message authentication," </title> <type> Manuscript, </type> <month> April </month> <year> 1994. </year>
Reference-contexts: The authors go on to correct some protocols by having them properly use the CBC MAC. Cipher block chaining is not the only method of constructing a MAC out of a block cipher. Amongst the other methods that have been proposed we note that of <ref> [2] </ref>. There the authors concern was to provide a construction which, unlike cipher-block chaining, is parallelizable. Their constructions are simple and efficient.
Reference: [3] <author> M. Bellare and P. Rogaway, </author> <title> "Entity authentication and key distribution," </title> <booktitle> Advances in Cryptology - Crypto 93 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 773, </volume> <publisher> Springer-Verlag, </publisher> <editor> D. Stinson, ed., </editor> <year> 1994. </year>
Reference-contexts: Our CBC Lemma provides a provably-good way of extending the basic PRFs (which work on short inputs) to PRFs which work on longer inputs. It was based on these facts that PRFs were suggested by <ref> [3] </ref> as the tools of choice for practical applications, particularly entity authentication and key distribution. 5 1.5 History and related work The lack of any theorem linking the security of f to that of f (m) lead previous users of the CBC-MAC to view f (m) , and not f ,
Reference: [4] <author> M. Bellare and P. Rogaway, </author> <title> "Optimal asymmetric encryption," </title> <booktitle> Advances in Cryptology - Eurocrypt 94 Proceedings, </booktitle> <year> 1994. </year>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [5] <author> R. Bird, I. Gopal, A. Herzberg, P. Janson, S. Kutten, R. Molva and M. Yung, </author> <title> "Systematic design of two-party authentication protocols," </title> <booktitle> Advances in Cryptology - Crypto 91 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 576, </volume> <publisher> Springer-Verlag, </publisher> <editor> J. Feigenbaum, ed., </editor> <year> 1991. </year>
Reference-contexts: Thus for example in Bird et. al. <ref> [5] </ref>, when the authors require a practical message authentication code in order to achieve their higher-level goal of entity authentication they made appropriate assumptions about the CBC MAC.
Reference: [6] <author> S. Even, O. Goldreich and S. Micali, </author> <title> "On-line/Off line digital signatures," </title> <type> Manuscript, </type> <month> March </month> <year> 1994. </year> <note> Preliminary version in Crypto 89. </note>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [7] <author> U. Feige and M. Naor, </author> <title> Private communication, </title> <month> April </month> <year> 1994. </year>
Reference-contexts: The fact that one typically outputs a number of bits s &lt; l seems relevant and useful in strengthening the bounds that would otherwise be achieved. Feige and Naor <ref> [7] </ref> observe that the dependence on q in the bound in Lemma 1 is optimal up to a constant: they can show that there is an adversary who achieves an advantage of O (mq 2 2 l ).
Reference: [8] <author> O. Goldreich and L. Levin, </author> <title> "A hard predicate for all one-way functions," </title> <booktitle> Proceedings of the Twenty First Annual Symposium on the Theory of Computing, ACM, </booktitle> <year> 1989. </year>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [9] <author> O. Goldreich, S. Goldwasser and S. Micali, </author> <title> "How to construct random functions," </title> <journal> Journal of the ACM, </journal> <volume> Vol. 33, No. 4, </volume> <pages> 210-217, </pages> <year> (1986). </year> <month> 14 </month>
Reference-contexts: They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali <ref> [9] </ref>. Roughly said, a function family F is pseudorandom if any reasonable adversary is unable to distinguish the following two types of objects, based on their input/output behavior: a black-box for f a (), on a random key a; a black-box for a "truly random" function f (). <p> That a PRF automatically makes a secure message authentication code is a well-known observation due to <ref> [9, 10] </ref>|see Section 6 for details. Exact security We wish to obtain results which are meaningful for practice. In particular, in our setting we need to say something about the correct or incorrect use of DES, where there are no asymptotics present. <p> Here, following <ref> [9] </ref>, we are considering the following game, or statistical test. Algorithm A is provided as oracle a function g chosen at random from either F or from F 0 , the choice being made at random according to a bit b. The algorithm is trying to predict b. <p> To formally complete this project we need one more step|to show that pseudorandom functions make good message authentication codes. As we remarked in the introduction the reduction is standard <ref> [9, 10] </ref>. But we need to see what is the exact security. The following shows that the reduction is almost tight| security hardly degrades at all. Let G be a finite function family whose keys name functions in R k!l . <p> We say that B is successful if MAC G g (y) = . We say that B (t; q; *)-breaks MAC G if it is successful with probability at least *. The Proposition that follows is the exact security version of the standard reduction of <ref> [9, 10] </ref>. Proposition 6.1 There is an algorithm U and a constant c as follows. Let l 1 and k 1 be integers. Let G R k!l be a given function family. Suppose q &lt; 2 k . Let B be an algorithm which (t; q; *)-breaks MAC G .
Reference: [10] <author> O. Goldreich, S. Goldwasser and S. Micali, </author> <title> "On the cryptographic applications of ran-dom functions," </title> <booktitle> Advances in Cryptology - Crypto 84 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 196, </volume> <publisher> Springer-Verlag, </publisher> <editor> B. Blakley, ed., </editor> <year> 1985. </year>
Reference-contexts: That a PRF automatically makes a secure message authentication code is a well-known observation due to <ref> [9, 10] </ref>|see Section 6 for details. Exact security We wish to obtain results which are meaningful for practice. In particular, in our setting we need to say something about the correct or incorrect use of DES, where there are no asymptotics present. <p> To formally complete this project we need one more step|to show that pseudorandom functions make good message authentication codes. As we remarked in the introduction the reduction is standard <ref> [9, 10] </ref>. But we need to see what is the exact security. The following shows that the reduction is almost tight| security hardly degrades at all. Let G be a finite function family whose keys name functions in R k!l . <p> We say that B is successful if MAC G g (y) = . We say that B (t; q; *)-breaks MAC G if it is successful with probability at least *. The Proposition that follows is the exact security version of the standard reduction of <ref> [9, 10] </ref>. Proposition 6.1 There is an algorithm U and a constant c as follows. Let l 1 and k 1 be integers. Let G R k!l be a given function family. Suppose q &lt; 2 k . Let B be an algorithm which (t; q; *)-breaks MAC G .
Reference: [11] <author> S. Goldwasser, S. Micali and R. Rivest, </author> <title> "A digital signature scheme secure against adaptive chosen-message attacks," </title> <journal> SIAM Journal of Computing, </journal> <volume> 17(2) </volume> <pages> 281-308, </pages> <month> April </month> <year> 1988. </year>
Reference-contexts: What does it mean for a MAC to be secure? Our notion of security for a message authentication code adopts the viewpoint of Goldwasser, Micali and Rivest <ref> [11] </ref> with regard to signature schemes; namely, a secure MAC must resist existential forgery under adaptive message attack. <p> Let G be a finite function family whose keys name functions in R k!l . Let MAC G be defined by MAC G Security of MAC G is discussed via the notion of chosen message attack <ref> [11] </ref>. An adversary B attacks MAC G via the following experiment. Pick g at random from G and provide MAC G g () to B as an oracle.
Reference: [12] <author> R. Impagliazzo, L. Levin and M. Luby, </author> <title> "Pseudo-random generation from one-way functions," </title> <booktitle> Proceedings of the Twenty First Annual Symposium on the Theory of Computing, ACM, </booktitle> <year> 1989. </year>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [13] <author> ISO/IEC 9797, </author> <title> "Data cryptographic techniques Data integrity mechanism using a cryptographic check function employing a block cipher algorithm," </title> <year> 1989. </year>
Reference-contexts: The CBC MAC is then defined for any ml-bit string x = x 1 : : : x m by CBC-MAC F def = The first s bits of f (m) The CBC MAC is an International Standard <ref> [13] </ref>. The most popular and widely used special case uses F = DES (so k = 56 and l = 64) and s = 32, in which case we recover the definition of the corresponding U.S. Standard [1].
Reference: [14] <author> T. Leighton and S. Micali, </author> <title> "Provably fast and secure digital signature algorithms based on secure hash functions," </title> <type> Manuscript, </type> <month> March </month> <year> 1993. </year>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [15] <author> M. Luby and C. Rackoff, </author> <title> "How to construct pseudorandom permutations from pseudorandom functions," </title> <journal> SIAM J. Computation, </journal> <volume> Vol. 17, No. 2, </volume> <month> April </month> <year> 1988. </year>
Reference-contexts: See Section 1.4 for a discussion of length variability. 3 What does it mean to assume DES is secure? To describe the security of a block cipher we adopt the viewpoint introduced by Luby and Rackoff <ref> [15, 16] </ref> with regard to DES. They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali [9].
Reference: [16] <author> M. Luby and C. Rackoff, </author> <title> "A study of password security," </title> <booktitle> Advances in Cryptology - Crypto 87 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 293, </volume> <publisher> Springer-Verlag, </publisher> <editor> C. Pomerance, ed., </editor> <year> 1987. </year>
Reference-contexts: See Section 1.4 for a discussion of length variability. 3 What does it mean to assume DES is secure? To describe the security of a block cipher we adopt the viewpoint introduced by Luby and Rackoff <ref> [15, 16] </ref> with regard to DES. They suggest that a block cipher should be assumed to be a pseudorandom function (PRF) with respect to "practical" computation. The notion of a PRF is in turn due to Goldreich, Goldwasser and Micali [9].
Reference: [17] <author> K. Ohta and M. Matsui, </author> <title> "Differential attack on message authentication codes," </title> <booktitle> Advances in Cryptology - Crypto 93 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 773, </volume> <publisher> Springer-Verlag, </publisher> <editor> D. Stinson, ed., </editor> <year> 1994. </year>
Reference-contexts: The cryptanalytic approach to the problem of the security of the CBC MAC is to attack the CBC MAC construction for a particular block cipher F . Refer to <ref> [17] </ref> for an attempt to directly attack the DES CBC MAC using differential cryptanalysis. Another approach to studying MACs is rooted in the examination of protocols which use them. Stubblebine and Gligor [20] find flaws in the use of the CBC MAC in some well-known protocols.
Reference: [18] <author> R. Rivest, </author> <title> "The MD5 message-digest algorithm," IETF Network Working Group, </title> <type> RFC 1321, </type> <month> April </month> <year> 1992. </year>
Reference: [19] <author> C. Schnorr, </author> <title> "Efficient identification and signatures for smart cards," </title> <booktitle> Advances in Cryptology - Crypto 89 Proceedings, Lecture Notes in Computer Science Vol. </booktitle> <volume> 435, </volume> <publisher> Springer-Verlag, </publisher> <editor> G. Brassard, ed., </editor> <year> 1989. </year>
Reference-contexts: However, a lack of concern with the exactness means 4 that in many cases the reductions are very inefficient, and the results are not useful for practice. Previous works which address exact security explicitly and strive for efficient reductions are <ref> [8, 12, 19, 6, 14, 4] </ref>, the last four on the more practical side. 1.3 Main result Of course the power of results such as those indicated above depends on what values of t 0 ; q 0 ; * 0 one can prove.
Reference: [20] <author> S. Stubblebine and V. Gligor, </author> <title> "On message integrity in cryptographic protocols," </title> <booktitle> Proceedings of the 1992 IEEE Computer Society Symposium on Research in Security and Privacy. </booktitle> <month> May </month> <year> 1992. </year>
Reference-contexts: Refer to [17] for an attempt to directly attack the DES CBC MAC using differential cryptanalysis. Another approach to studying MACs is rooted in the examination of protocols which use them. Stubblebine and Gligor <ref> [20] </ref> find flaws in the use of the CBC MAC in some well-known protocols. But as the authors make clear, it is not the CBC MAC itself which is at fault for the indicated protocol failures|it is the manner in which the containing protocols incorrectly embed the CBC MAC.
References-found: 20

