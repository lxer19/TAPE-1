URL: ftp://ftp.cse.ucsc.edu/pub/rna/gibbs.ps.Z
Refering-URL: http://www.cse.ucsc.edu/research/compbio/gibbs.html
Root-URL: http://www.cse.ucsc.edu
Title: RNA Modeling Using Gibbs Sampling and Stochastic Context Free Grammars  
Author: Leslie Grate and Mark Herbster and Richard Hughey and David Haussler I. Saira Mian and Harry Noller 
Keyword: RNA secondary structure, Gibbs sampler, Expectation Maximization, stochastic context-free grammars, hidden Markov models, tRNA, snRNA, 16S rRNA, linguistic methods  
Address: Santa Cruz, CA 95064  Santa Cruz, CA 95064  
Affiliation: Baskin Center for Computer Engineering and Computer and Information Sciences University of California  Sinsheimer Laboratories University of California  
Abstract: A new method of discovering the common secondary structure of a family of homologous RNA sequences using Gibbs sampling and stochastic context-free grammars is proposed. Given an unaligned set of sequences, a Gibbs sampling step simultaneously estimates the secondary structure of each sequence and a set of statistical parameters describing the common secondary structure of the set as a whole. These parameters describe a statistical model of the family. After the Gibbs sampling has produced a crude statistical model for the family, this model is translated into a stochastic context-free grammar, which is then refined by an Expectation Maximization (EM) procedure to produce a more complete model. A prototype implementation of the method is tested on tRNA, pieces of 16S rRNA and on U5 snRNA with good results. 
Abstract-found: 1
Intro-found: 1
Reference: <author> Baldi, P.; Chauvin, Y.; Hunkapillar, T.; and McClure, M. </author> <year> 1994. </year> <title> Hidden markov models of biological primary sequence information. </title> <booktitle> PNAS 91 </booktitle> <pages> 1059-1063. </pages>

Reference: <author> Eddy, S. R., and Durbin, R. </author> <year> 1994. </year> <title> RNA sequence analysis using covariance models. </title> <publisher> NAR in press. </publisher>
Reference-contexts: It incorporates elements of both the thermodynamic and phylogenetic approaches, with emphasis on the latter. The method of Sakakibara et al (Sakakibara et al. 1994; 1993) requires some initial knowledge of the common secondary structure of the sequences in the family. In contrast, Eddy and Durbin <ref> (Eddy & Durbin 1994) </ref> derive the structure of the grammar directly from unaligned sequences and estimate the probability parameters of the resulting grammar using Expectation Maximization (EM).
Reference: <author> Fox, G. E., and Woese, C. R. </author> <year> 1975. </year> <title> 5S RNA secondary structure. </title> <booktitle> Nature 256 </booktitle> <pages> 505-507. </pages>
Reference: <author> Geman, S., and Geman, D. </author> <year> 1984. </year> <title> Stochastic relaxations, Gibbs distributions and the Bayesian restoration of images. </title> <journal> IEEE Trans. on Pattern Analysis and Machine Intelligence 6 </journal> <pages> 721-742. </pages>
Reference-contexts: Here we propose a different method for deriving the structure of the grammar from unaligned sequences which uses Gibbs sampling techniques <ref> (Geman & Geman 1984) </ref> described in (Lawrence et al. 1993; 1994). It is related to the EM methods described in (Neal & Hinton 1993) (incremental EM) and (Meng & Rubin 1992) (Partitioned Expectation/Conditional Maximization, or PECM). <p> In the course of Gibbs sampling, we also obtain estimates for the hidden variables X giving the locations of the helices in each sequence. The Gibbs sampler can be annealed as in <ref> (Geman & Geman 1984) </ref> to make X approach MAP estimates. Hence the Gibbs sampler can be used alone to try to determine the secondary structure of each of the sequences. This is a direct extension to RNA of the Gibbs sampling approach for proteins described in (Lawrence et al. 1994).
Reference: <author> Gouy, M. </author> <year> 1987. </year> <title> Secondary structure prediction of RNA. </title> <editor> In Bishop, M. J., and Rawlings, C. R., eds., </editor> <title> Nucleic acid and protein sequence analysis, a practical approach. </title> <publisher> Oxford, </publisher> <address> England: </address> <publisher> IRL Press. </publisher> <pages> 259-284. </pages>

Reference: <author> H. F. </author> <year> 1985. </year> <title> Comparative anatomy of 16S like ribosomal RNA. </title> <journal> volume 32 of Prog. Nuc. Acids. Res. Mol. Biol. </journal> <pages> 155-216. </pages>
Reference: <author> Gutell, R. R.; Power, A.; Hertz, G. Z.; Putz, E. J.; and Stormo, G. D. </author> <year> 1992. </year> <title> Identifying constraints on the higher-order structure of RNA: continued development and application of comparative sequence analysis methods. </title> <type> NAR 20 </type> <pages> 5785-5795. </pages>
Reference: <author> Guthrie, C., and Patterson, B. </author> <year> 1988. </year> <journal> Spliceosomal snRNAs. </journal> <volume> ARGen 22 </volume> <pages> 387-419. </pages>
Reference-contexts: We used 34 U5 snRNA sequences (Guthrie, Roha, & Mian 1993) to produce helix nesting models (Figure 8). Gibbs sampling finds the accepted secondary structure <ref> (Guthrie & Patterson 1988) </ref> with the addition of one extra stem (stem X).
Reference: <author> Guthrie, C.; Roha, H.; and Mian, I. S. </author> <year> 1993. </year> <title> Spliceo-somal snRNA structure: function. </title> <note> Unpublished. </note>
Reference-contexts: U5 snRNA snRNAs are expected to be more difficult than tRNA and 16S rRNA because the structures change dynamically in vivo and strong static secondary structures may not be so prominent (Guthrie & Pat-terson 1988; McKeown 1993; Wise 1993). We used 34 U5 snRNA sequences <ref> (Guthrie, Roha, & Mian 1993) </ref> to produce helix nesting models (Figure 8). Gibbs sampling finds the accepted secondary structure (Guthrie & Patterson 1988) with the addition of one extra stem (stem X).
Reference: <author> Han, K., and Kim, H.-J. </author> <year> 1993. </year> <title> Prediction of common folding structures of homologous RNAs. </title> <booktitle> NARes 21 </booktitle> <pages> 1251-1257. </pages>
Reference: <author> James, B. D.; Olsen, G. J.; and Pace, N. R. </author> <year> 1989. </year> <title> Phylogenetic comparative analysis of RNA secondary structure. </title> <booktitle> Methods in Enzymology 180 </booktitle> <pages> 227-239. </pages>
Reference: <author> Klinger, T., and Brutlag, D. </author> <year> 1993. </year> <title> Detection of correlations in tRNA sequences with structural implications. </title> <editor> In Hunter, L.; Searls, D.; and Shavlik, J., eds., </editor> <booktitle> First International Conference on Intelligent Systems for Molecular Biology. </booktitle> <address> Menlo Park: </address> <publisher> AAAI Press. </publisher>
Reference: <author> Krogh, A.; Brown, M.; Mian, I. S.; Sjolander, K.; and Haussler, D. </author> <year> 1994. </year> <title> Hidden Markov models in computational biology: Applications to protein modeling. </title> <journal> Journal of Molecular Biology 235 </journal> <pages> 1501-1531. </pages>
Reference-contexts: We use a massively parallel computer to speed the process (a MasPar MP-2204). Development of an initial model While it is possible in principle for a Gibbs sampler with an appropriate prior and some kind of "model surgery" method similar to that used in <ref> (Krogh et al. 1994) </ref> to arrive at a correct helix model H starting from an empty model, this method would be time consuming and prone to falling into local minima. <p> We use an HMM to align the sequences initially as in <ref> (Krogh et al. 1994) </ref>, and then later add special penalty functions to this HMM to encourage base pairing in the helices we have found.

Reference: <author> Lapedes, A. </author> <year> 1992. </year> <title> Private communication. </title>
Reference: <author> Larsen, N.; Olsen, G. J.; Maidak, B. L.; McCaughey, M. J.; Overbeek, R.; Macke, T. J.; Marsh, T. L.; and Woese, C. R. </author> <year> 1993. </year> <title> The ribosomal database project. </title> <booktitle> NARes 21 </booktitle> <pages> 3021-3023. </pages>
Reference-contexts: For each of the three segments, we used the Gibbs sampler to produce helix nesting models for four sequences (E. coli and three archaea) taken from the RDP <ref> (Larsen et al. 1993) </ref>. Figure 9 shows the three regions along with the consensus structure produced from their respective Gibbs sampler models. Although Gibbs sampling produced a very good nesting structure, each individual sequence can differ from the standard.
Reference: <author> Lawrence, C. E.; Altschul, S.; Boguski, M.; Liu, J.; Neuwald, A.; and Wootton, J. </author> <year> 1993. </year> <title> Detecting subtle sequence signals: A Gibbs sampling strategy for multiple alignment. </title> <booktitle> Science 262 </booktitle> <pages> 208-214. </pages>
Reference: <author> Lawrence, C. E.; Altschul, S.; Wootton, J.; Boguski, M.; Neuwald, A.; and Liu, J. </author> <year> 1994. </year> <title> A gibbs sampler for the detection of subtle motifs in multiple sequences. </title> <booktitle> In Proceedings of the Hawaii International Conference on System Sciences, </booktitle> <pages> 245-254. </pages> <address> Los Alami-tos, CA: </address> <publisher> IEEE Computer Society Press. </publisher>
Reference-contexts: We use these same methods here. Gibbs Sampling for common RNA secondary structure The Gibbs sampler we use applies a variant of the method of Lawrence and colleagues <ref> (Lawrence et al. 1994) </ref> to locate helices in RNA molecules. Let S be a set of jSj sequences (each individual sequence S 2 S has its own length, jSj) with similar secondary structure. <p> The parameters in H are then rees-timated given the current placement of all helices in all sequences. 2 Apart from it's close similarity with the 2 In the current implementation, the parameters in H are Gibbs sampler of <ref> (Lawrence et al. 1994) </ref> which it was modeled on, this system can also be viewed as a hybrid of the incremental EM method discussed in (Neal & Hinton 1993) and the PECM method of (Meng & Rubin 1992). <p> Hence the Gibbs sampler can be used alone to try to determine the secondary structure of each of the sequences. This is a direct extension to RNA of the Gibbs sampling approach for proteins described in <ref> (Lawrence et al. 1994) </ref>. However, the model H used by the Gibbs sampler does not allow the length of a helix to vary between sequences, nor does it currently have any sophisticated parametric models for the loop regions. <p> that is being replaced are subtracted from the total counts when it is removed, the parameters of the model are reestimated before the conditional distribution on possible replacement locations is calculated, and then the new counts from the replacement added back to the total counts after the replacement, as in <ref> (Lawrence et al. 1994) </ref>. <p> When the parameters of H are not held fixed during the Gibbs sampling, these parameters are re-estimated after each of the above helix replacements using the same method as in <ref> (Lawrence et al. 1994) </ref>, employing the Dirichlet priors in the case of the r H parameters. <p> If the "freezing" option is turned on, se 3 Actually, there is a slight adjustment to the parameters in H when the counts for the position of the helix H in S are decremented due to its removal, as in <ref> (Lawrence et al. 1994) </ref>. quences that match the dominant structure to start with require zero Gibbs phase iterations.
Reference: <author> Le, S. Y., and Zuker, M. </author> <year> 1991. </year> <title> Predicting common foldings of homologous RNAs. </title> <editor> J. </editor> <booktitle> Biomolecular Structure and Dynamics 8 </booktitle> <pages> 1027-1044. </pages>
Reference: <author> McKeown, M. </author> <year> 1993. </year> <title> The role of small nuclear RNAs in RNA splicing. </title> <booktitle> Current Opinion in Cell Biology 5 </booktitle> <pages> 448-454. </pages>
Reference: <author> Meng, X.-L., and Rubin, D. B. </author> <year> 1992. </year> <title> Recent extensions to the em algorithm. </title> <booktitle> Bayesian Statistics 4 </booktitle> <pages> 307-320. </pages>
Reference-contexts: Here we propose a different method for deriving the structure of the grammar from unaligned sequences which uses Gibbs sampling techniques (Geman & Geman 1984) described in (Lawrence et al. 1993; 1994). It is related to the EM methods described in (Neal & Hinton 1993) (incremental EM) and <ref> (Meng & Rubin 1992) </ref> (Partitioned Expectation/Conditional Maximization, or PECM). The Gibbs sampler we propose simultaneously estimates the secondary structure of each sequence and a statistical model of the family with parameters describing the consensus secondary structure of the set as a whole. <p> similarity with the 2 In the current implementation, the parameters in H are Gibbs sampler of (Lawrence et al. 1994) which it was modeled on, this system can also be viewed as a hybrid of the incremental EM method discussed in (Neal & Hinton 1993) and the PECM method of <ref> (Meng & Rubin 1992) </ref>. In the course of Gibbs sampling, we also obtain estimates for the hidden variables X giving the locations of the helices in each sequence. The Gibbs sampler can be annealed as in (Geman & Geman 1984) to make X approach MAP estimates.
Reference: <author> Neal, R. M., and Hinton, G. E. </author> <year> 1993. </year> <title> A new view of the em algorithm that justifies incremental and other variants. </title> <note> to appear in Biometrika. </note>
Reference-contexts: Here we propose a different method for deriving the structure of the grammar from unaligned sequences which uses Gibbs sampling techniques (Geman & Geman 1984) described in (Lawrence et al. 1993; 1994). It is related to the EM methods described in <ref> (Neal & Hinton 1993) </ref> (incremental EM) and (Meng & Rubin 1992) (Partitioned Expectation/Conditional Maximization, or PECM). The Gibbs sampler we propose simultaneously estimates the secondary structure of each sequence and a statistical model of the family with parameters describing the consensus secondary structure of the set as a whole. <p> helices in all sequences. 2 Apart from it's close similarity with the 2 In the current implementation, the parameters in H are Gibbs sampler of (Lawrence et al. 1994) which it was modeled on, this system can also be viewed as a hybrid of the incremental EM method discussed in <ref> (Neal & Hinton 1993) </ref> and the PECM method of (Meng & Rubin 1992). In the course of Gibbs sampling, we also obtain estimates for the hidden variables X giving the locations of the helices in each sequence.
Reference: <author> Nickolls, J. R. </author> <year> 1990. </year> <title> The design of the Maspar MP-1: A cost effective massively parallel computer. </title> <booktitle> In Proc. COMPCON Spring 1990, </booktitle> <pages> 25-28. </pages> <publisher> IEEE Computer Society. </publisher>
Reference: <author> Noller, H. F., and Woese, C. R. </author> <year> 1981. </year> <title> Secondary structure of 16S ribosomal RNA. </title> <booktitle> Science 212 </booktitle> <pages> 403-411. </pages>
Reference: <author> Sakakibara, Y.; Brown, M.; Hughey, R.; Mian, I. S.; Sjolander, K.; Underwood, R.; and Haussler, D. </author> <year> 1993. </year> <title> The application of stochastic context-free grammars to folding, aligning and modeling homologous RNA sequences. </title> <type> Technical Report UCSC-CRL-94-14, </type> <institution> University of California, Santa Cruz, Computer and Information Sciences Dept., </institution> <address> Santa Cruz, CA 95064. </address>
Reference-contexts: When the Gibbs sampling has produced a crude statistical model for the family, this model is translated into a SCFG which is then refined by an EM procedure to produce a more complete model, as described elsewhere <ref> (Sakakibara et al. 1993) </ref>. A prototype implementation of the method is tested on tRNA, pieces of 16S rRNA, and U5 snRNA. Methods Since this work builds on modeling RNA families with SCFGs (Searls 1993; Eddy & Durbin 1994; Sakakibara et al. 1993), we provide a review of this method first. <p> The probability of a molecule is the probability that it will be derived in a random derivation, assuming each production is chosen independently. Hence an SCFG defines a stochastic model for the family. In <ref> (Sakakibara et al. 1993) </ref>, SCFG models were used to determine the most likely secondary 1 Context-free grammars can only represent secondary structure with properly nested helices; they cannot represent pseudoknots. <p> For each of these we use a specific Dirichlet prior that we estimated from analysis of 16S rRNA multiple alignments <ref> (Sakakibara et al. 1993) </ref>. During estimation, these guide the Gibbs sampler to position helices in appropriate places in the sequences, and greatly improve the results. Currently we use a simple greedy method, described in the next section, to initially estimate the number of helices, their lengths and their nesting structure. <p> The initial values of the parameters in G that cannot be obtained from H are set according to an appropriate prior distribution. Then, using the same sequences S , the EM algorithm described in <ref> (Sakakibara et al. 1993) </ref> (called Tree-grammar EM) is used to obtain a MAP estimate of the parameters of G using the same prior. Implicit in this estimation is a reestimation of the hidden random variables X that give the locations of the helices in each sequence. <p> the method The current implementation of our model construction algorithm has three parts: the development of an initial model H, a Gibbs sampling placement of the helices in H in each sequence and re-estimation of the parameters of H, and the generation and training of a SCFG with Tree-Grammar EM <ref> (Sakakibara et al. 1993) </ref>. We use a massively parallel computer to speed the process (a MasPar MP-2204). <p> The parser associated with the SCFG training algorithm is used to determine the final estimate of the secondary structure of each sequence based on the trained grammar, see <ref> (Sakakibara et al. 1993) </ref>. Software implementation The MasPar MP-2204 at UCSC is a single instruction stream, multiple data stream (SIMD) parallel computer with 4096 32-bit processing elements arranged in a 64 fi 64 grid (Nick-olls 1990). <p> In the case of tRNA, this was translated to a SCFG followed by refinement using Tree-Grammar EM. All experiments used the freezing option and fixed helix lengths in the Gibbs phase (lengths having been determined in the greedy phase). tRNA In our previous studies of tRNA <ref> (Sakakibara et al. 1993) </ref>, we employed a hand generated helix nesting structure that captured fine details of tRNA structure. We would not expect the SCFG generated from the results of the Gibbs sampler to achieve the same level of detail for this or any other RNA family. <p> The results were essentially insensitive to the number and choice of the sequences ie. similar results were obtained when the data set consisted of 4 to 100 sequences. This Gibbs grammar was compared to the hand generated nesting structure from our earlier work <ref> (Sakakibara et al. 1993) </ref>. Both nesting structures were similar cloverleaf structures and corresponding helices had similar lengths (Figure 6). Starting from the Gibbs generated grammar, we repeated our earlier experiments that used the training set MT10CY10 and Tree-Grammar EM (Sakakibara et al. 1993) to produce a discriminator. <p> compared to the hand generated nesting structure from our earlier work <ref> (Sakakibara et al. 1993) </ref>. Both nesting structures were similar cloverleaf structures and corresponding helices had similar lengths (Figure 6). Starting from the Gibbs generated grammar, we repeated our earlier experiments that used the training set MT10CY10 and Tree-Grammar EM (Sakakibara et al. 1993) to produce a discriminator. <p> The method is used to estimate the numbers, lengths and nesting structure of RNA helices in related RNA sequences. Previously, we relied on hand generated grammars to derive the structure of the grammar from unaligned primary sequences <ref> (Sakakibara et al. 1993) </ref>. The novel aspect of the Gibbs sampling approach is that this task is performed automatically. The resulting crude statistical model is then translated into a SCFG and subsequently refined using EM.
Reference: <author> Sakakibara, Y.; Brown, M.; Mian, I. S.; Underwood, R.; and Haussler, D. </author> <year> 1994. </year> <title> Stochastic context-free grammars for modeling RNA. </title> <booktitle> In Proceedings of the Hawaii International Conference on System Sciences. </booktitle> <address> Los Alamitos, CA: </address> <publisher> IEEE Computer Society Press. </publisher>
Reference: <author> Sankoff, D. </author> <year> 1985. </year> <title> Simultaneous solution of the RNA folding, alignment and protosequence problems. </title>
Reference: <author> SIAM J. </author> <title> Appl. </title> <journal> Math. </journal> <volume> 45 </volume> <pages> 810-825. </pages>
Reference: <author> Searls, D. B. </author> <year> 1993. </year> <title> The computational linguistics of biological sequences. </title> <booktitle> In Artificial Intelligence and Molecular Biology. </booktitle> <publisher> AAAI Press. </publisher> <pages> chapter 2, 47-120. </pages>
Reference: <author> Steinberg, S.; Misch, A.; and Sprinzl, M. </author> <year> 1993. </year> <title> Compilation of tRNA sequences and sequences of tRNA genes. </title> <type> NAR 21 </type> <pages> 3011-3015. </pages>
Reference-contexts: Sequences were taken from a database that includes tRNAs from virus, archaea, bacteria, cyanelle, chloro-plast, cytoplasm and mitochondria <ref> (Steinberg, Misch, & Sprinzl 1993) </ref>. We used 10 sequences chosen at random from 1222 tRNAs to produce a helix nesting model which was then translated into a SCFG.
Reference: <author> Tinoco Jr., I.; Uhlenbeck, O. C.; and Levine, M. D. </author> <year> 1971. </year> <title> Estimation of secondary structure in ribonucleic acids. </title> <booktitle> Nature 230 </booktitle> <pages> 363-367. </pages>
Reference: <author> Turner, D. H.; Sugimoto, N.; and Freier, S. M. </author> <year> 1988. </year> <title> RNA structure prediction. </title> <journal> Annual Review of Biophysics and Biophysical Chemistry 17 </journal> <pages> 167-192. </pages>
Reference: <author> Waterman, M. S. </author> <year> 1989. </year> <title> Consensus methods for folding single-stranded nucleic acids. </title> <editor> In Waterman, M. S., ed., </editor> <title> Mathematical Methods for DNA Sequences. </title> <publisher> CRC Press. </publisher> <address> chapter 8. </address>
Reference: <author> White, J. V.; Stultz, C. M.; and Smith, T. F. </author> <year> 1994. </year> <title> Protein classification by stochastic modeling and optimal filtering of amino-acid sequences. </title> <booktitle> Mathematical Biosciences 119 </booktitle> <pages> 35-75. </pages>
Reference: <author> Winker, S.; Overbeek, R.; Woese, C.; Olsen, G.; and Pfluger, N. </author> <year> 1990. </year> <title> Structure detection through automated covariance search. </title> <booktitle> CABIOS 6 </booktitle> <pages> 365-371. </pages>
Reference: <author> Wise, J. A. </author> <year> 1993. </year> <title> Guides to the heart of the spliceo-some. </title> <booktitle> Science 262 </booktitle> <pages> 1978-1979. </pages>
Reference: <author> Woese, C. R.; Magrum, L. J.; Gupta, R.; Siegel, R. B.; Stahl, D. A.; Kop, J.; Crawford, N.; Bro-sius, J.; Gutell, R.; Hogan, J. J.; and Noller, H. F. </author> <year> 1980. </year> <title> Secondary structure model for bacterial 16S ribosomal RNA: phylogenetic, </title> <journal> enzymatic and chemical evidence. </journal> <volume> NARes 8 </volume> <pages> 2275-2293. </pages>
Reference: <author> Woese, C. R.; Gutell, R. R.; Gupta, R.; and Noller, H. F. </author> <year> 1983. </year> <title> Detailed analysis of the higher-order structure of 16S-like ribosomal ribonucleic acids. </title> <journal> Mi-crobiology Reviews 47(4) </journal> <pages> 621-669. </pages>
Reference: <author> Zuker, M. </author> <year> 1989. </year> <title> On finding all suboptimal foldings of an RNA molecule. </title> <booktitle> Science 244 </booktitle> <pages> 48-52. </pages>
References-found: 38

