URL: http://www.csl.sri.com/~gong/papers/password-guessing.ps.gz
Refering-URL: http://www.csl.sri.com/~gong/papers/pubs93.html
Root-URL: 
Title: Protecting Poorly Chosen Secrets from Guessing Attacks  
Author: Li Gong, T. Mark A. Lomas, Roger M. Needham, and Jerome H. Saltzer 
Date: June 8, 1993  
Abstract: In a security system that allows people to choose their own passwords, those people tend to choose passwords that can be easily guessed. This weakness exists in practically all widely used systems. Instead of forcing users to choose well-chosen secrets, which are likely to be difficult to remember, we propose solutions that maintain both user convenience and a high level of security at the same time. The basic idea is to ensure that data available to the attacker is sufficiently unpredictable to prevent an off-line verification of whether a guess is successful or not. We examine common forms of guessing attacks, develop examples of cryptographic protocols that are immune to such attacks, and suggest a systematic way to examine protocols to detect vulnerabilities to such attacks. 
Abstract-found: 1
Intro-found: 1
Reference: [Aho 74] <author> A.V. Aho, J.E. Hopcroft, and J.D. Ullman, </author> <title> The Design and Analysis of 15 Computer Algorithms, </title> <publisher> Addison-Wesley Publishing Company, </publisher> <address> Reading, Mas--sachusetts, </address> <year> 1974, </year> <note> pp.195-201 and pp.299-300. </note>
Reference-contexts: In other words, the final state of W should be the closure of its initial state under R; there are well-known algorithms to perform this operation <ref> [Aho 74] </ref>. Last we specify the set G containing all secrets that an attacker might choose to guess. The sets W and G might differ between different assumed attackers. Let V be the set of verifiable texts within M . <p> If they match, the probability that the guess is correct is P fg = g 0 j t = t 0 g. Searching for verifiable texts can be cast as the path-finding problem in graph theory <ref> [Aho 74] </ref>. Let each message in M represent a node of a directed graph. Define all messages in W [ G to be reachable.
Reference: [ANSI 86] <institution> American National Standard Institute, "Financial Institution Message Authentication (Wholesale)", ANSI X9.9, </institution> <month> August, </month> <year> 1986. </year>
Reference-contexts: This pair of messages may be considered two ways: as a message and its checksum or a single message with sufficient redundancy known to the attacker. In practice techniques such as checksums are often used to help guarantee message integrity; also the formats of messages are usually predetermined <ref> [ANSI 86, Linn 89] </ref>. These structural properties generally increase the vulnerability to guessing attacks [Gong 90c]. When considering the pair as a single message with sufficient redundancy, redundancy is difficult to assess objectively.
Reference: [Bellovin 92] <author> S. Bellovin and M. Merritt, </author> <title> "Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks", </title> <booktitle> in Proceedings of the IEEE Symposium on Security and Privacy, </booktitle> <address> Oakland, California, </address> <month> May, </month> <year> 1992, </year> <month> pp.72-84. </month>
Reference-contexts: In particular, we were able to detect insider attacking paths of a protocol that was resistant to outsider attacks. 14 7 Related Work We are aware of only one protocol of a similar nature, recently proposed by Bellovin and Merritt <ref> [Bellovin 92] </ref>, which achieves roughly the same objective as our direct authentication protocol. They also discussed the use of several cryptosystems in detail. Their protocol is as follows: 1. A ! B : A; fkg p 2. B ! A : ffrg k g p 3.
Reference: [DEC 89] <author> Digital Equipment Corporation, </author> <title> "VAX/VMS System Management: Guide to VMS System Security", </title> <note> Version 5.2, </note> <month> June, </month> <year> 1989. </year>
Reference-contexts: Although our discussion uses only examples of user-chosen passwords, our analysis is equally applicable in other applications, such as the use of ATM cards or "smart-cards". Our new proposal is inexpensive and maintains both user convenience and a high level of security at the 1 Some systems (e.g., <ref> [DEC 89] </ref>) may even lie to the client after an excessive number of guesses so as to prevent an attacker from gaining useful information. 2 same time.
Reference: [Diffie 76] <author> W. Diffie and M.E. Hellman, </author> <title> "New Directions in Cryptography", </title> <journal> IEEE Transactions on Information Theory, </journal> <volume> Vol. </volume> <pages> IT-22, </pages> <address> No.6, </address> <month> November, </month> <year> 1976, </year> <month> pp.644-654. </month>
Reference-contexts: We will use the notation fmg k to indicate the result of encrypting a piece of text, a message m, using key k. We shall consider symmetric key or conventional cryptosystems such as DES [NBS 77, Smid 88] as well as asymmetric or public-key systems such as RSA <ref> [Diffie 76, Rivest 78] </ref>. The word "plaintext" refers to the message m that is encrypted to form the "ciphertext" fmg k ; similarly, fmg k denotes decryption. The notation "," denotes concatenation; for example, m; n represents the concatenation of m and n.
Reference: [Feldmeier 89] <author> D.C. Feldmeier and P.R. Karn, </author> <title> "UNIX Password Security Ten Years Later", </title> <booktitle> Proceedings of Crypto'89, published as Lecture Notes in Computer Science, </booktitle> <address> No.435, </address> <publisher> Springer-Verlag, pp.44-63. </publisher>
Reference-contexts: If h (p 0 ) does not match h (p) the attacker tries the next candidate value of p 0 from a list of guesses, perhaps a dictionary that contains all words in the sender's language, plus a list of proper names, rock group names, and cartoon characters <ref> [Feldmeier 89, Klein 90] </ref>. The Internet Worm guessed passwords in the same way [Seeley 89].
Reference: [Gong 90a] <author> L. Gong, </author> <title> "Cryptographic Protocols for Distributed Systems", </title> <type> Ph.D. dissertation, </type> <institution> University of Cambridge, </institution> <month> April, </month> <year> 1990. </year>
Reference-contexts: This is not just an idle suggestion; there are good security reasons why a clock used for authentication should not be turned back, even if it has accidentally drifted forwards. 3 The inclusion of a timestamp in message 1 (and 3) has another unusual impact <ref> [Gong 90a] </ref>. Suppose that the timestamp is replaced with information that does not reflect the timeliness of the message.
Reference: [Gong 90b] <author> L. Gong, </author> <title> "Verifiable-Text Attacks in Cryptographic Protocols", </title> <booktitle> in Proceedings of the IEEE INFOCOM '90, </booktitle> <address> San Francisco, California, </address> <month> June, </month> <year> 1990, </year> <month> pp.686-693. </month>
Reference-contexts: Diverting vital messages to separate communication channels may prevent the attackers from recorded all messages necessary for the attack. In a sense, diversion resembles the concept of separation of privilege [Saltzer 75]. A more detailed discussion and some examples of analysis using this algorithm appeared elsewhere <ref> [Gong 90b] </ref>.
Reference: [Gong 90c] <author> L. Gong, </author> <title> "A Note on Redundancy in Encrypted Messages", </title> <journal> ACM Computer Communication Review, Vol.20, </journal> <volume> No.5, </volume> <month> October, </month> <year> 1990, </year> <month> pp.18-22. </month>
Reference-contexts: In practice techniques such as checksums are often used to help guarantee message integrity; also the formats of messages are usually predetermined [ANSI 86, Linn 89]. These structural properties generally increase the vulnerability to guessing attacks <ref> [Gong 90c] </ref>. When considering the pair as a single message with sufficient redundancy, redundancy is difficult to assess objectively. A message that can be recognized by one could appear 5 to contain unrecognizable random data to another.
Reference: [Gong 92] <author> L. Gong, </author> <title> "A Security Risk of Depending on Synchronized Clocks", </title> <journal> ACM Operating Systems Review, Vol.26, </journal> <volume> No.1, </volume> <month> January, </month> <year> 1992, </year> <month> pp.49-53. </month>
Reference-contexts: The two session keys, k and k 0 , generated by the server are likely to be different since S should choose a new session key each time. However, because both 3 However, such a clock poses additional security risks even if it is not turned back <ref> [Gong 92] </ref>. 9 messages contain na1, the attacker can guess Ka and decrypt both to see if the same value na1 emerges. Therefore, random numbers must not be reused, and S should be able to detect replays of messages 1 and 3 so as not to respond to them again.
Reference: [Kahn 67] <author> D. Kahn, </author> <title> The Codebreakers, </title> <publisher> MacMillan, </publisher> <address> New York, </address> <year> 1967. </year>
Reference-contexts: We do not address this issue here. 4 3 Known Plaintext and Verifiable Text The concept of known plaintext has historically been of major interest to both cryptographers and cryptanalysts <ref> [Kahn 67] </ref>. If a cryptanalyst is presented with a piece of ciphertext and can predict all or part of the plaintext before the message is decrypted, the message is said to contain known plaintext. <p> Note that guessing c would be useless if k1 is unknown to the attacker. In a sense, a confounder also plays the role of a one-time pad <ref> [Kahn 67] </ref> but has the distinct advantage that its value need not be agreed upon in advance by the communicating parties. An alternative is to be more selective in our choice of the function f ().
Reference: [Klein 90] <author> D.V. Klein, </author> <title> "Foiling the Cracker: A Survey of, and Improvements to, Password Security", </title> <booktitle> in Proceedings of the 2nd USENIX Unix Security Workshop, </booktitle> <month> August, </month> <year> 1990, </year> <month> pp.5-14. </month>
Reference-contexts: If h (p 0 ) does not match h (p) the attacker tries the next candidate value of p 0 from a list of guesses, perhaps a dictionary that contains all words in the sender's language, plus a list of proper names, rock group names, and cartoon characters <ref> [Feldmeier 89, Klein 90] </ref>. The Internet Worm guessed passwords in the same way [Seeley 89].
Reference: [Linn 89] <author> J. Linn, </author> <title> "Privacy Enhancement for Internet Electronic Mail: Part I Message Encipherment and Authentication Procedures", IAB Privacy Task Force, Network Working Group, </title> <type> RFC 1113, </type> <month> August, </month> <year> 1989. </year>
Reference-contexts: This pair of messages may be considered two ways: as a message and its checksum or a single message with sufficient redundancy known to the attacker. In practice techniques such as checksums are often used to help guarantee message integrity; also the formats of messages are usually predetermined <ref> [ANSI 86, Linn 89] </ref>. These structural properties generally increase the vulnerability to guessing attacks [Gong 90c]. When considering the pair as a single message with sufficient redundancy, redundancy is difficult to assess objectively.
Reference: [Lomas 89] <author> T.M.A. Lomas, L. Gong, J.H. Saltzer, and R.M. Needham, </author> <title> "Reducing Risks from Poorly Chosen Keys", </title> <booktitle> in Proceedings of the 12th ACM Symposium on Operating System Principles, </booktitle> <address> Litchfield Park, Arizona, </address> <month> December, </month> <year> 1989. </year> <note> Published as ACM Operating Systems Review, </note> <author> Vol.23, No.5, pp.14-18. </author> <title> [MasterCard 82] "PIN Manual: A Guide to the Use of Personal Identification Numbers in Interchange", </title> <booktitle> MasterCard International, </booktitle> <publisher> Inc., </publisher> <month> September, </month> <year> 1980, </year> <title> Reprinted in Cryptography: A New Dimension in Computer Data Security by Meyer, C.H. and Matyas, S.M., </title> <publisher> John Wiley and Sons., </publisher> <year> 1982, </year> <month> pp.429-444. </month>
Reference-contexts: Likewise inconvenient to users are long passwords. For example, personal identification numbers (PINs) for automatic teller machines (ATMs) are generally only four to six digits because longer PINs would probably be written down. In an earlier paper <ref> [Lomas 89] </ref>, we started to explore an approach in which we accepted poorly chosen secrets as a fact of life and looked instead for ways to improve the security of the system so that such secrets do not make the system vulnerable to guessing attacks. <p> We first give a protocol similar to that in the earlier paper <ref> [Lomas 89] </ref> (that protocol was originally chosen for ease of discussion rather than for actual use.); we then propose a number of variations of the protocol that take into account practical considerations such as the minimization of message traffic, the use of nonces instead of timestamps, the adaptation for simple (and <p> It is easy to see how to attack s when given a corresponding value v. It is also apparent that both known plaintext and verifiable plaintext <ref> [Lomas 89] </ref> form subsets of verifiable text. A guessing attack is very worrying if it can happen off-line. The threshold t is a measure of the system's tolerance in this regard.
Reference: [Miller 88] <author> S.P. Miller, C. Neuman, J.I. Schiller, and J.H. Saltzer, </author> <title> "Kerberos Authentication and Authorization System", </title> <type> Project Athena Technical Plan, </type> <institution> Section E.2.1, Massachusetts Institute of Technology, </institution> <month> October, </month> <year> 1988. </year> <month> 16 </month>
Reference-contexts: be open to attack. 2.3 The Kerberos Authentication System The server's initial response to a user request contains recognizable information such as a timestamp t and the name or address of a network service S; before transmission, the response is encrypted under a key derived from a user's password p <ref> [Miller 88, Steiner 88] </ref>. Let us assume that the packet has the form ft; S; :::g p ; the actual order of the message fields is unimportant.
Reference: [Morris 79] <author> R. Morris and K. Thompson, </author> <title> "Password Security: A Case History", </title> <booktitle> Commu--nications of the ACM, </booktitle> <address> Vol.22, No.11, </address> <month> November, </month> <year> 1979, </year> <month> pp.594-597. </month>
Reference-contexts: 1 Introduction In a security system that allows people to choose their own passwords, those people tend to select passwords that can be easily guessed <ref> [Morris 79] </ref>. These poorly chosen passwords are vulnerable to attacks based upon copying information (for example, the result of applying a one-way hash function to a password or of encrypting a message using the password as the encryption key) and experimenting off-line.
Reference: [NBS 77] <author> U.S. </author> <title> National Bureau of Standards, "Data Encryption Standard", </title> <type> U.S. </type> <note> Federal Information Processing Standards Publication, FIPS PUB 46, </note> <month> January, </month> <year> 1977. </year>
Reference-contexts: In particular, we assume that every bit of a ciphertext depends upon all plaintext bits. We will use the notation fmg k to indicate the result of encrypting a piece of text, a message m, using key k. We shall consider symmetric key or conventional cryptosystems such as DES <ref> [NBS 77, Smid 88] </ref> as well as asymmetric or public-key systems such as RSA [Diffie 76, Rivest 78]. The word "plaintext" refers to the message m that is encrypted to form the "ciphertext" fmg k ; similarly, fmg k denotes decryption.
Reference: [NBS 85] <institution> U.S. National Bureau of Standards, "Password Usage", U.S. Federal Information Processing Standards Publication, </institution> <note> FIPS PUB 112, </note> <month> May, </month> <year> 1985. </year>
Reference: [Needham 78] <author> R.M. Needham and M.D. Schroeder, </author> <title> "Using Encryption for Authentication in Large Networks of Computers", </title> <journal> Communications of the ACM, Vol.21, </journal> <volume> No.12, </volume> <month> December, </month> <year> 1978, </year> <month> pp.993-999. </month>
Reference-contexts: involves interaction with some part of the system that is in a position to react (as, for example, ATMs do [MasterCard 82]) to an excessive number of tries, notice wrong guesses, log them, and raise an alarm. 1 To illustrate applications of our techniques, we construct Needham-Schroeder style authentication protocols <ref> [Needham 78, Needham 87] </ref> in which any guessing attack must involve interaction with the authentication server and is thus open to detection by the server. <p> A system is totally secure against such attacks only if t = 1=n. 4 Protection Techniques To introduce the basic techniques, we first examine a simple two-message handshake transaction, which is often found in existing protocols <ref> [Needham 78, Needham 87, Voydock 83] </ref>. This pair of messages may be considered two ways: as a message and its checksum or a single message with sufficient redundancy known to the attacker.
Reference: [Needham 87] <author> R.M. Needham and M.D. Schroeder, </author> <title> "Authentication Revisited", </title> <journal> ACM Operating Systems Review, Vol.21, </journal> <volume> No.1, </volume> <month> January, </month> <year> 1987, </year> <month> p.7. </month>
Reference-contexts: involves interaction with some part of the system that is in a position to react (as, for example, ATMs do [MasterCard 82]) to an excessive number of tries, notice wrong guesses, log them, and raise an alarm. 1 To illustrate applications of our techniques, we construct Needham-Schroeder style authentication protocols <ref> [Needham 78, Needham 87] </ref> in which any guessing attack must involve interaction with the authentication server and is thus open to detection by the server. <p> A system is totally secure against such attacks only if t = 1=n. 4 Protection Techniques To introduce the basic techniques, we first examine a simple two-message handshake transaction, which is often found in existing protocols <ref> [Needham 78, Needham 87, Voydock 83] </ref>. This pair of messages may be considered two ways: as a message and its checksum or a single message with sufficient redundancy known to the attacker.
Reference: [Otway 87] <author> D. Otway and O. Rees, </author> <title> "Efficient and Timely Mutual Authentication", </title> <journal> ACM Operating Systems Review, Vol.21, </journal> <volume> No.1, </volume> <month> January, </month> <year> 1987, </year> <month> pp.8-10. </month>
Reference-contexts: As an alternative to timestamps we might choose to use a challenge-response scheme as shown later in the "nonce" protocol. 5.2 Reducing the Number of Messages By rearranging the routes of the messages, we can produce a protocol similar to that of Otway and Rees <ref> [Otway 87] </ref>. Our protocol retains the nice feature of theirs that two nested Remote Procedure Calls (RPCs) suffice for implementation. Compact Protocol. 1. A ! B : fA; B; na1; na2; ca; ftag Ka g Ks ; ra 2.
Reference: [Rivest 78] <author> R.L. Rivest, A. Shamir, and L. Adleman, </author> <title> "A Method for Obtaining Digital Signatures and Public-Key Cryptosystems", </title> <journal> Communications of the ACM, Vol.21, No.2, </journal> <month> February, </month> <year> 1978, </year> <month> pp.120-126. </month>
Reference-contexts: We will use the notation fmg k to indicate the result of encrypting a piece of text, a message m, using key k. We shall consider symmetric key or conventional cryptosystems such as DES [NBS 77, Smid 88] as well as asymmetric or public-key systems such as RSA <ref> [Diffie 76, Rivest 78] </ref>. The word "plaintext" refers to the message m that is encrypted to form the "ciphertext" fmg k ; similarly, fmg k denotes decryption. The notation "," denotes concatenation; for example, m; n represents the concatenation of m and n. <p> Public-key cryptosystems can be characterized in a similar manner: if y = fxg +k then (+k; x ! y) and (k; y ! x). Certain public-key systems <ref> [Rivest 78] </ref> have the property that ffxg k g k+ = x, leading to an additional rule (+k; y ! x). The rule (+k; k ! 1) reflects the fact that +k and k are mutual inverses, and so each may be used to verify the other.
Reference: [Saltzer 75] <author> J.H. Saltzer and M.D. Schroeder, </author> <title> "The Protection of Information in Computer Systems", </title> <booktitle> Proceedings of the IEEE, </booktitle> <address> Vol.63, No.9, </address> <month> September, </month> <year> 1975, </year> <month> pp.1278-1308. </month>
Reference-contexts: It also helps to reveal the effects of some messages being accidentally or deliberately leaked. Diverting vital messages to separate communication channels may prevent the attackers from recorded all messages necessary for the attack. In a sense, diversion resembles the concept of separation of privilege <ref> [Saltzer 75] </ref>. A more detailed discussion and some examples of analysis using this algorithm appeared elsewhere [Gong 90b].
Reference: [Seeley 89] <author> D. Seeley, </author> <title> "Password Cracking: A Game of Wits", </title> <journal> Communications of the ACM, Vol.32, </journal> <volume> No.6, </volume> <month> June, </month> <year> 1989, </year> <month> p.700-703. </month>
Reference-contexts: The Internet Worm guessed passwords in the same way <ref> [Seeley 89] </ref>. A possible solution is to restrict access to the file /etc/passwd. 2.2 SunOS Secure NFS Because of the known risks of the UNIX password system, the SunOS-4.0 documentation recommends that the file /etc/passwd be removed when the C2 security features are installed [Sun 88].
Reference: [Smid 88] <author> M.E. Smid and D.K. Branstad, </author> <title> "The Data Encryption Standard: Past and Future", </title> <booktitle> Proceedings of the IEEE, </booktitle> <address> Vol.76, No.5, </address> <month> May, </month> <year> 1988, </year> <month> pp.550-559. </month>
Reference-contexts: In particular, we assume that every bit of a ciphertext depends upon all plaintext bits. We will use the notation fmg k to indicate the result of encrypting a piece of text, a message m, using key k. We shall consider symmetric key or conventional cryptosystems such as DES <ref> [NBS 77, Smid 88] </ref> as well as asymmetric or public-key systems such as RSA [Diffie 76, Rivest 78]. The word "plaintext" refers to the message m that is encrypted to form the "ciphertext" fmg k ; similarly, fmg k denotes decryption.
Reference: [Steiner 88] <author> J.G. Steiner, C. Neuman, and J.I. Schiller, </author> <title> "Kerberos: An Authentication Service for Open Network Systems", </title> <booktitle> in Proceedings of the USENIX Winter Conference, </booktitle> <month> February, </month> <year> 1988, </year> <month> pp.191-202. </month>
Reference-contexts: The distinction is based on the (presumably low) probability of an attacker successfully guessing a randomly chosen key, compared with the (presumably higher) probability of successfully guessing a user-chosen password. For example, the Kerberos authentication system <ref> [Steiner 88] </ref> is vulnerable to guessing attacks: fl This paper appeared in IEEE Journal on Selected Areas in Communications, Vol.11, No.5, June 1993, pp.648-656. L. Gong is with SRI International, Computer Science Laboratory, 333 Ravenswood Avenue, Menlo Park, CA 94025. T.M.A. Lomas and R.M. <p> be open to attack. 2.3 The Kerberos Authentication System The server's initial response to a user request contains recognizable information such as a timestamp t and the name or address of a network service S; before transmission, the response is encrypted under a key derived from a user's password p <ref> [Miller 88, Steiner 88] </ref>. Let us assume that the packet has the form ft; S; :::g p ; the actual order of the message fields is unimportant.
Reference: [Stubblebine 92] <author> S. Stubblebine and V.D. Gligor, </author> <title> "On Message Integrity in Cryptographic Protocols", </title> <booktitle> in Proceedings of the 1992 IEEE Symposium on Security and Privacy, </booktitle> <address> Oakland, California, </address> <month> May, </month> <year> 1992, </year> <month> pp.85-104. </month>
Reference: [Sun 88] <author> Sun Microsystems, Inc., </author> <title> "Secure Networking", and, "Installing C2 Security Features", in Security Feature Guide, Part Number: 800-1735-10, Revision A, May 9th, </title> <booktitle> 1988, pp.71-79 and pp.85-87. </booktitle>
Reference-contexts: A possible solution is to restrict access to the file /etc/passwd. 2.2 SunOS Secure NFS Because of the known risks of the UNIX password system, the SunOS-4.0 documentation recommends that the file /etc/passwd be removed when the C2 security features are installed <ref> [Sun 88] </ref>. A public-key system is used to improve security in the SunOS network file system.

References-found: 28

