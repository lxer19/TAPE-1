URL: http://robotics.eecs.berkeley.edu/~clairet/switch.ps
Refering-URL: http://robotics.eecs.berkeley.edu/~clairet/switch.html
Root-URL: 
Email: fclairet, sastryg@eecs.berkeley.edu  
Title: Switching through Singularities  
Author: C. J. Tomlin and S. S. Sastry 
Keyword: Switching, nonlinear control, zero dynamics, exact and asymptotic tracking, nonminimum phase.  
Address: Berkeley CA 94720  
Affiliation: Department of Electrical Engineering and Computer Sciences University of California,  
Abstract: Asymptotic tracking is studied for systems in which the relative degree is not well defined, meaning that the control law derived from exact input-output linearization has singularities in the state space. We propose a tracking control law which switches between approximate tracking [1] close to the singularities, and exact tracking away from the singularities, and we study the applicability of this law based on the behavior of the system's zero dynamics at the switching boundary. As in [1], the ball and beam example is used to motivate the study. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> J. Hauser, S. Sastry, and P. Kokotovic, </author> <title> "Nonlinear control via approximate input-output linearization: The ball and beam example," </title> <journal> IEEE Transactions on Automatic Control, </journal> <volume> vol. 37, no. 3, </volume> <pages> pp. 392-398, </pages> <year> 1992. </year>
Reference-contexts: While the problem of trying to track trajectories that go through singularities was begun by Hirschorn and Davis [2] who limited the class of outputs that could be tracked, the first set of practical schemes for approximate asymptotic tracking through singularities was given by Hauser, Sastry and Kokotovic in <ref> [1] </ref>, using an approximation technique. This in turn spurred the development of a result by Grizzle, Di Benedetto and Lamnabhi-Lagarrigue [3] which proved the necessity of "regularity" for asymptotically exact tracking. <p> The outline of our paper is as follows: in Section 2 we describe the ball and beam example of <ref> [1] </ref> with some added new insights about the zero dynamics of the singular system under perturbation and fl Research supported by NASA under grant NAG 2-1039, and by NSERC and ZONTA graduate fellowships. 1 the subtleties of introducing switching across the singularity surface into the control law. <p> The insights gained by studying the zero dynamics as the system switches across the singularity surface motivate our general formulation in the next section. Consider the following system, which describes the motion of a ball rolling along a rotating beam <ref> [1] </ref>. The state variables are (x 1 ; x 2 ; x 3 ; x 4 ) = (r; _r; ; _ ) where r is the distance of the ball from the pivot of beam, and is the angle of the beam. <p> The input t is the torque applied at the center of rotation: a preliminary change of coordinates in the input space, as in <ref> [1] </ref>, is performed to define a new input variable u which appears linearly in the system equations: _x 1 = x 2 4 G sin x 3 ) _x 4 = u The output equation is y = x 1 r 0 , where r 0 is a given position of <p> Indeed, L g L 2 f h (x) = 2Bx 1 x 4 , so that the feedback linearizing control is undefined when x 1 x 4 = 0. In <ref> [1] </ref>, an approximate input-output linearization scheme is defined using the coordinates ~ 1 = x 1 r 0 ~ 3 = Bx 1 x 2 ~ 4 = Bx 2 x 2 (2) The system dynamics in mixed x and ~ coordinates is _ ~ 1 = ~ 2 _ ~ <p> This approximate scheme is exact when 2Bx 1 x 4 = 0, and approximates the exact scheme well when j2Bx 1 x 4 j is small. However, results in <ref> [1] </ref> show that when j2Bx 1 x 4 j becomes large (which is when the values of the desired trajectory and its derivatives become large) the approximate tracking scheme is unstable. <p> We assume that x = x 0 is an equilibrium point, that is f (x 0 ) = 0, and without loss of generality we assume that h (x 0 ) = 0. In the following we need the definitions of robust relative degree and uniformly higher order <ref> [1] </ref>: Definition 1 (Robust relative degree) The nonlinear system (10) is said to have robust relative degree fl at x 0 if there exist smooth functions i (x), i = 1 : : : fl such that h (x) = 1 (x) + 0 (x; u) L f+gu fl (x) = <p> Adopting the notation of <ref> [1] </ref>, we define 8 new coordinates (~; ) by 2 6 6 6 6 4 . . . 1 nfl 7 7 7 7 7 = 6 6 6 6 6 1 (x) fl (x) . . . 3 7 7 7 7 5 where the functions i (x); i = <p> In the second, Devasia-Chen-Paden's nonlinear inversion technique [12] may be used to calculate the stable solution to the zero dynamics, and exact tracking results. For the third, bounded 9 tracking and O (*) tracking error are proven in <ref> [1] </ref> when the functions i (x; u); i = 1; : : : ; fl 1 are uniformly higher order in x and u, the zero dynamics of the approximate system ( _ = q (0; )) is exponentially stable, and the desired output and its derivatives (y D ; _y <p> In this section, we extend the result of <ref> [1] </ref> to prove bounded tracking for the fourth scenario, using the nonlinear inversion technique of [12]. Theorem 3 (Approximate Tracking for Unstable Zero Dynamics) Consider the system (10) with normal form (13). <p> Far away from this singular surface, jL g L f h (x)j is large, and the approximate control law fails. We propose a switching scheme which uses the control law derived from the approximate input-output linearization method of <ref> [1] </ref> close to the singular surface, and switches to a control law derived from exact input-output linearization far away from the singular surface. The remainder of this paper is devoted to deriving conditions under which such a switching scheme is possible. <p> Thus, if T is chosen large enough (as per the definition of slow switching) then the error introduced by switching in the computation of the desired trajectory is small. Now, continuing the analysis along the lines of <ref> [1] </ref>, we can establish that jy (t) y D (t)j K 3 ffi for t large enough. ffi Though none of the cases discussed above are explicitly mentioned here, the conditions for slow switching are unlikely to be met in cases 1 and 2, because the change in equilibrium across the <p> Remark 4 Even though the last step of the proof of Theorem 5 uses the method of <ref> [1] </ref>, it is important to note that the theorem is different and may yield better asymptotic tracking because of the switching. 6 Conclusions The ball and beam example is used to motivate the study of a tracking control law which switches between an approximate tracking law close to singularities in the
Reference: [2] <author> R. Hirschorn and J. Davis, </author> <title> "Output tracking for nonlinear systems with singular points," </title> <journal> SIAM Journal of Control and Optimization, </journal> <volume> vol. 25, no. 3, </volume> <pages> pp. 547-557, </pages> <year> 1987. </year>
Reference-contexts: One area in which results have been hard to come by is the tracking of singular or non regular nonlinear control systems, i.e. those that fail to have relative degree. While the problem of trying to track trajectories that go through singularities was begun by Hirschorn and Davis <ref> [2] </ref> who limited the class of outputs that could be tracked, the first set of practical schemes for approximate asymptotic tracking through singularities was given by Hauser, Sastry and Kokotovic in [1], using an approximation technique.
Reference: [3] <author> J. W. Grizzle, M. D. D. Benedetto, and F. </author> <title> Lamnabhi-Lagarrigue, "Necessary conditions for asymptotic tracking in nonlinear systems," </title> <journal> IEEE Transactions on Automatic Control, </journal> <volume> vol. 39, no. 9, </volume> <pages> pp. 1782-1794, </pages> <year> 1994. </year>
Reference-contexts: This in turn spurred the development of a result by Grizzle, Di Benedetto and Lamnabhi-Lagarrigue <ref> [3] </ref> which proved the necessity of "regularity" for asymptotically exact tracking. In parallel with this activity has been the interest in using switching control laws for adaptive control ([4], [5]), for steering and stabilization ([6], [7]), as well as activity in hybrid control systems ([8], [9], [10]). <p> In the first and second case (which is in fact a generalization of our ball and beam example), the change in equilibrium in the internal dynamics across the switching boundary is likely to destabilize the switched control law. Our results are not counterexamples to the Theorem of <ref> [3] </ref>, since we use discontinuous control laws and ask for only asymptotic approximate tracking. 2 Motivating Example: the ball and beam We describe in this section the proposed switching scheme applied to the ball and beam example.
Reference: [4] <author> A. S. Morse and F. M. Pait, </author> <title> "MIMO design models and internal regulators for cyclicly switched parameter-adaptive control systems," </title> <journal> IEEE Transactions on Automatic Control, </journal> <volume> vol. 39, no. 9, </volume> <pages> pp. 1809-1818, </pages> <year> 1994. </year>
Reference: [5] <author> S. Rangan and K. Poolla, </author> <title> "Adaptive H 1 control with multiple nonlinear models." </title> <booktitle> Submitted to the 1996 Conference on Decision and Control, </booktitle> <address> Kobe, </address> <year> 1996. </year> <month> 18 </month>
Reference-contexts: This in turn spurred the development of a result by Grizzle, Di Benedetto and Lamnabhi-Lagarrigue [3] which proved the necessity of "regularity" for asymptotically exact tracking. In parallel with this activity has been the interest in using switching control laws for adaptive control ([4], <ref> [5] </ref>), for steering and stabilization ([6], [7]), as well as activity in hybrid control systems ([8], [9], [10]).
Reference: [6] <author> J. Guckenheimer, </author> <title> "A robust stabilization strategy for equilibria," </title> <journal> IEEE Transactions on Au--tomatic Control, </journal> <volume> vol. 40, no. 2, </volume> <pages> pp. 321-326, </pages> <year> 1995. </year>
Reference: [7] <author> J. Malmborg, B. Bernhardsson, and K. J. Astrom, </author> <title> "A stabilizing switching scheme for multi controller systems," </title> <booktitle> in International Federation of Automatic Control, </booktitle> <address> (San Francisco, CA), </address> <year> 1996. </year>
Reference-contexts: In parallel with this activity has been the interest in using switching control laws for adaptive control ([4], [5]), for steering and stabilization ([6], <ref> [7] </ref>), as well as activity in hybrid control systems ([8], [9], [10]).
Reference: [8] <author> A. Nerode and W. Kohn, </author> <title> "Multiple agent hybrid control architecture," in Hybrid Systems (R. </title> <editor> L. Grossman, A. Nerode, A. P. Ravn, and H. Rischel, </editor> <booktitle> eds.), </booktitle> <pages> pp. 297-316, </pages> <address> New York: </address> <publisher> Springer Verlag, </publisher> <year> 1993. </year>
Reference: [9] <author> M. Branicky, V. Borkar, and S. Mitter, </author> <title> "A unified framework for hybrid control," </title> <booktitle> in Proceedings of IEEE Conference on Decision and Control, </booktitle> <pages> pp. 4228-4234, </pages> <year> 1994. </year>
Reference-contexts: In parallel with this activity has been the interest in using switching control laws for adaptive control ([4], [5]), for steering and stabilization ([6], [7]), as well as activity in hybrid control systems ([8], <ref> [9] </ref>, [10]). In this paper, we combine ideas from switching along with our results on exact tracking of slightly non-minimum phase systems (developed in [11] building on the techniques and ideas of [12] and [13]) to describe our results in approximate tracking for singular or non-regular nonlinear systems.
Reference: [10] <author> P. J. Antsaklis, J. A. Stiver, and M. Lemmon, </author> <title> "Hybrid system modeling and autonomous control systems," in Hybrid Systems (R. </title> <editor> L. Grossman, A. Nerode, A. P. Ravn, and H. Rischel, </editor> <booktitle> eds.), </booktitle> <pages> pp. 366-392, </pages> <address> New York: </address> <publisher> Springer Verlag, </publisher> <year> 1993. </year>
Reference-contexts: In parallel with this activity has been the interest in using switching control laws for adaptive control ([4], [5]), for steering and stabilization ([6], [7]), as well as activity in hybrid control systems ([8], [9], <ref> [10] </ref>). In this paper, we combine ideas from switching along with our results on exact tracking of slightly non-minimum phase systems (developed in [11] building on the techniques and ideas of [12] and [13]) to describe our results in approximate tracking for singular or non-regular nonlinear systems.
Reference: [11] <author> C. Tomlin and S. Sastry, </author> <title> "Bounded tracking for nonminimum phase nonlinear systems with fast zero dynamics," </title> <type> tech. rep., </type> <institution> UCB-ERL Memo M96/46, Electronics Research Laboratory, UC Berkeley, </institution> <address> CA 94720, </address> <year> 1996. </year>
Reference-contexts: In this paper, we combine ideas from switching along with our results on exact tracking of slightly non-minimum phase systems (developed in <ref> [11] </ref> building on the techniques and ideas of [12] and [13]) to describe our results in approximate tracking for singular or non-regular nonlinear systems. <p> The main drawback of the computations involved in the Devasia et al. scheme is that it involves computation of the "steady state" response as discussed in <ref> [11] </ref>. To address this, we will assume that the rate of switching is slow compared to the zero dynamics of the exact and approximate system.
Reference: [12] <author> S. Devasia, D. Chen, and B. Paden, </author> <title> "Nonlinear inversion-based output tracking," </title> <journal> IEEE Transactions on Automatic Control, </journal> <volume> vol. 41, no. 7, </volume> <pages> pp. 930-942, </pages> <year> 1996. </year>
Reference-contexts: In this paper, we combine ideas from switching along with our results on exact tracking of slightly non-minimum phase systems (developed in [11] building on the techniques and ideas of <ref> [12] </ref> and [13]) to describe our results in approximate tracking for singular or non-regular nonlinear systems. <p> The exactly linearizing control produces two-dimensional zero dynamics which are unstable but hyperbolic, and so the nonlinear inversion technique of Devasia, Chen, and Paden <ref> [12] </ref> may be used away from the singularity to calculate the asymptotically stable solution to these dynamics. <p> In the first scenario, feedback linearization results in exact tracking of y D (t) with stable zero dynamics. In the second, Devasia-Chen-Paden's nonlinear inversion technique <ref> [12] </ref> may be used to calculate the stable solution to the zero dynamics, and exact tracking results. <p> In this section, we extend the result of [1] to prove bounded tracking for the fourth scenario, using the nonlinear inversion technique of <ref> [12] </ref>. Theorem 3 (Approximate Tracking for Unstable Zero Dynamics) Consider the system (10) with normal form (13). <p> Proof: Assumptions 1 and 2 guarantee (see <ref> [12] </ref>) that there exists for given bounded ~ D a bounded solution D 2 R nfl satisfying lim t!1 D (t) = 0, which is obtained as the fixed point of the following integral equation: D (t) = 1 in which (t) is the Caratheodory solution of the matrix differential equation <p> As was shown in Section 4 the internal dynamics (27) may be nonminimum phase either in M or in M + or both. If so, the tracking control law that is used in (41) would have to be calculated using the technique of Devasia, Paden and Chen <ref> [12] </ref>. The main drawback of the computations involved in the Devasia et al. scheme is that it involves computation of the "steady state" response as discussed in [11]. <p> We study a general nonlinear system (10) which has relative degree fl 1 and robust relative degree fl. We first prove that if the system has unstable zero dynamics, then approximate tracking can be achieved using the nonlinear inversion technique of <ref> [12] </ref> to calculate the stable solution to the zero dynamics. We then classify the zero dynamics of the general system into three cases, in which the first two involve a change in equilibrium of the zero dynamics across the switching boundary.
Reference: [13] <author> G. Meyer, L. R. Hunt, and R. Su, </author> <title> "Nonlinear system guidance," </title> <booktitle> in Proceedings of IEEE Conference on Decision and Control, </booktitle> <address> (New Orleans, LA), </address> <pages> pp. 590-595, </pages> <year> 1995. </year>
Reference-contexts: In this paper, we combine ideas from switching along with our results on exact tracking of slightly non-minimum phase systems (developed in [11] building on the techniques and ideas of [12] and <ref> [13] </ref>) to describe our results in approximate tracking for singular or non-regular nonlinear systems.
Reference: [14] <author> S. Behtash, </author> <title> Robust Stabilization and Tracking for Nonlinear Systems. </title> <type> PhD thesis, </type> <institution> University of California at Berkeley, </institution> <year> 1988. </year> <month> 19 </month>
Reference-contexts: But the same switching method applied to other systems in which the zero dynamics (either stable or unstable) are "better behaved" has the potential to be very successful in increasing the domains of attraction of the control law. For example, the planar flexible robot arm in <ref> [14] </ref> has a singularity at cos 2 = 2 3 , where 2 is the angle of the elbow.
References-found: 14

