URL: http://diva.eecs.berkeley.edu/~ljilja/papers/nolta95.ps
Refering-URL: http://diva.eecs.berkeley.edu/~ljilja/
Root-URL: 
Email: ljilja@eecs.berkeley.edu  wolfgang@wein02.elektro.uni-wuppertal.de  
Title: Parameter Embedding Methods for Finding DC Operating Points: Formulation and Implementation  
Author: Ljiljana Trajkovic and Wolfgang Mathis flfl 
Address: Berkeley, CA 94720, USA  Fuhlrottstr. 10, D-42097 Wuppertal, Germany  
Affiliation: EECS Department, University of California,  flfl Department of Electrical Engineering University of Wuppertal  
Abstract: We address the calculation of dc operating points of nonlinear circuits by using parameter embedding methods, and we show that the usefulness of these methods depends on the type of a circuit's descriptive equations. We discuss various approaches to embedding a parameter into nonlinear equations that describe bipolar and MOS transistor circuits. Embedding algorithms were implemented in an industrial circuit simulator. We demonstrated that homotopy methods can be used as an alternative to the Newton-Raphson-type solvers and that they can be successfully applied to solving nonlinear circuit equations as well as to calculating dc operating points and transfer curves of nonlinear transistor circuits. 
Abstract-found: 1
Intro-found: 1
Reference: [1] <author> I. A. Cermak, </author> <title> "DC solution of nonlinear state-space equations in circuit analysis," </title> <journal> IEEE Trans. Circ. Th., </journal> <volume> vol. CT-18, </volume> <pages> pp. 312-314, </pages> <month> March </month> <year> 1971. </year>
Reference: [2] <author> W. M. Coughran, Jr., E. H. Grosse, and D. J. Rose, "CAzM: </author> <title> A circuit analyzer with macromod-eling," </title> <journal> IEEE Trans. Elec. Dev., </journal> <volume> vol. ED-30, </volume> <pages> pp. 1207-1213, </pages> <month> Sept. </month> <year> 1983. </year>
Reference: [3] <author> Lj. Trajkovic, R. C. Melville, and S. C. Fang, </author> <title> "Improving dc convergence in a circuit simulator using a homotopy method," </title> <booktitle> Proc. Custom Integrated Circuits Conference, </booktitle> <address> San Diego, CA, </address> <month> May </month> <year> 1991, </year> <pages> pp. </pages> <month> 8.1.1-8.1.4. </month>
Reference-contexts: If = 0, then N 1 (x) = 0 describes a nonlinear network. In this case we need to demonstrate that these equations are well-conditioned and posses a unique solution that can be calculated. Such an approach is described in <ref> [3] </ref>- [6] where the gains of the Ebers-Moll transistor model are multiplied by . For = 0 the network consists of independent sources, linear resistors, and diodes, and, therefore, possesses a unique dc operating point. III.
Reference: [4] <author> Lj. Trajkovic, R. C. Melville, and S. C. Fang, </author> <title> "Finding dc operating points of transistor circuits using homotopy methods," </title> <booktitle> IEEE Int. Symp. on Circuits and Systems, </booktitle> <address> Singapore, </address> <month> June </month> <year> 1991, </year> <pages> pp. 758-761. </pages>
Reference: [5] <author> R. C. Melville, Lj. Trajkovic, S. C. Fang, and L. T. Watson, </author> <title> "Artificial parameter homotopy methods for the dc operating point problem," </title> <journal> IEEE Trans. Computer-Aided Design, </journal> <volume> vol. 12, no. 6, </volume> <pages> pp. 861-877, </pages> <month> June </month> <year> 1993. </year>
Reference-contexts: HOMPACK's curve tracing algorithms is then used to generate the input-output characteristic. The details are shown in Table 2. VII. Implementation of a Homotopy Algorithm All analog circuits that were successfully simulated in <ref> [5] </ref> and [6] were analog designs with bipolar transistors. We have generalized the embedding method to MOS transistor circuits and have developed an embedding model for MOS transistors. The implementation was done in the industrial circuit simulator TITAN [16] using HOMPACK [11].
Reference: [6] <author> R. C. Melville, S. Moinian, P. Feldmann, and L. Watson, "Sframe: </author> <title> An efficient system for detailed dc simulation of bipolar analog integrated circuits using continuation methods," Analog Integr. Circuits and Sign. </title> <booktitle> Proc., </booktitle> <volume> vol. 3, no. 3, </volume> <pages> pp. 163-180, </pages> <month> May </month> <year> 1993. </year>
Reference-contexts: 1 Part of this work was presented at the NDES'95 Workshop, Dublin, Ireland, July 1995. In <ref> [6] </ref>, the authors discuss the application of publicly available software packages with continuation algorithms PITCON [10] and HOMPACK [11] for calculation of dc operating points. <p> If = 0, then N 1 (x) = 0 describes a nonlinear network. In this case we need to demonstrate that these equations are well-conditioned and posses a unique solution that can be calculated. Such an approach is described in [3]- <ref> [6] </ref> where the gains of the Ebers-Moll transistor model are multiplied by . For = 0 the network consists of independent sources, linear resistors, and diodes, and, therefore, possesses a unique dc operating point. III. <p> step we used [3]-<ref> [6] </ref> embedding to calculate the starting point of the input-output transfer curve. HOMPACK's curve tracing algorithms is then used to generate the input-output characteristic. The details are shown in Table 2. VII. Implementation of a Homotopy Algorithm All analog circuits that were successfully simulated in [5] and [6] were analog designs with bipolar transistors. We have generalized the embedding method to MOS transistor circuits and have developed an embedding model for MOS transistors. The implementation was done in the industrial circuit simulator TITAN [16] using HOMPACK [11].
Reference: [7] <author> W. Mathis, Lj. Trajkovic, M. Koch, and U. Feld-mann, </author> <title> "Parameter embedding methods for finding dc operating points of transistor circuits," </title> <booktitle> Proc. </booktitle> <address> NDES '95, Dublin, Ireland, </address> <month> July </month> <year> 1995, </year> <pages> pp. 147-150. </pages>

Reference: [9] <author> H. K. Gummel and H. C. Poon, </author> <title> "An integral charge controlled model for bipolar transistors," </title> <journal> Bell Syst. Tech. J., </journal> <volume> vol. 49, </volume> <pages> pp. 827-852, </pages> <month> May-June </month> <year> 1970. </year>
Reference: [10] <author> W. Rheinboldt and J. V. Burkardt, </author> <title> "A locally parameterized continuation process," </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> vol. 9, no. 2, </volume> <pages> pp. 215-235, </pages> <month> June </month> <year> 1983. </year>
Reference-contexts: 1 Part of this work was presented at the NDES'95 Workshop, Dublin, Ireland, July 1995. In [6], the authors discuss the application of publicly available software packages with continuation algorithms PITCON <ref> [10] </ref> and HOMPACK [11] for calculation of dc operating points. Although interesting results were obtained, the authors did not address the details of parameter embedding that are crucial for a successful application of homotopy methods for solving circuit equations by circuit simulators. II.
Reference: [11] <author> L. T. Watson, S. Billups, and A. Morgan, "HOM-PACK: </author> <title> A suite of codes for globally convergent homotopy algorithms," </title> <journal> ACM Transactions on Mathematical Software, </journal> <volume> vol. 13, no. 3, </volume> <pages> pp. 281-310, </pages> <month> Sept. </month> <year> 1987. </year>
Reference-contexts: 1 Part of this work was presented at the NDES'95 Workshop, Dublin, Ireland, July 1995. In [6], the authors discuss the application of publicly available software packages with continuation algorithms PITCON [10] and HOMPACK <ref> [11] </ref> for calculation of dc operating points. Although interesting results were obtained, the authors did not address the details of parameter embedding that are crucial for a successful application of homotopy methods for solving circuit equations by circuit simulators. II. <p> These curves cannot be traced using the conventional circuit simulator (SPICE). Such curves are easy to trace using HOMPACK <ref> [11] </ref>. HOM-PACK uses the arc-length parameterization of the ho-motopy parameter and solve the associated differential equations, We first multiply the input (current or voltage) by . In contrast to the above discussed embeddings, the network equations are not linear for = 0. <p> We have generalized the embedding method to MOS transistor circuits and have developed an embedding model for MOS transistors. The implementation was done in the industrial circuit simulator TITAN [16] using HOMPACK <ref> [11] </ref>. We have also added a modification to TITAN for calculating transfer curves. TITAN-HOMPACK Interface is shown in Figure 2. During our simulations, we observed difficulties with choosing the starting points for the homotopy paths.
Reference: [12] <author> C. W. Ho, A. E. Ruehli, and P. A. Brennan, </author> <title> "The modified nodal approach to network analysis," </title> <journal> IEEE Trans. Circuits Syst., </journal> <volume> vol. CAS-22, </volume> <pages> pp. 504-509, </pages> <month> Jan. </month> <year> 1975. </year>
Reference-contexts: Often, L is the identity operator and L (x) = x is used as the linear part of equation (3). It can be shown using a simple example that this approach may cause difficulties if the well-known Modified Nodal Analysis (MNA) equations <ref> [12] </ref> are used to describe networks. We should mention that it is not necessary to restrict the decomposition of a nonlinear network that will be parameterized with an embedding (or its descriptive equations) into a linear and a nonlinear part.
Reference: [13] <author> L. Nagel, </author> <title> SPICE2: A Computer Program to Simulate Semiconductor Circuits, </title> <note> ERL Memorandum No. </note> <institution> ERL-M520, Univ. of California, Berkeley, </institution> <month> May </month> <year> 1975. </year>
Reference-contexts: We show that the standard embedding F (x; ) := (1 )x + f (x) = 0 (7) fails if we use the MNA equations. The MNA method is used today in most SPICE-like circuit simulators <ref> [13] </ref>. The main reason for choosing the MNA approach when writing circuits' equations is to include network elements that are not current sources or do not have an admittance representation (such as certain controlled sources). For such elements one cannot introduce their currents into the vector of network variables.
Reference: [14] <author> J. Vlach and K. Singhal, </author> <title> Computer Methods for Circuit Analysis and Design. </title> <address> New York: </address> <publisher> Van Nostrand-Reinhold, </publisher> <year> 1983. </year>
Reference-contexts: Therefore, in contrast to the basic nodal equations, not all MNA equations represent sums of currents. Some of these equations describe the inter-connection of network elements. Consider the simple circuit shown in Figure 1 (a). The MNA equations of this circuit (see e.g., <ref> [14] </ref>) are: 1 0 u 1 U 0 : (8) In order to apply the homotopy approach, we define the following function: f (x) := G 1 U 0 ; (9) where x = i 0 .
Reference: [15] <author> Lj. Trajkovic, R. C. Melville, and S. C. Fang, </author> <title> "Passivity and no-gain properties establish global convergence of a homotopy method for dc operating points," </title> <booktitle> Proc. IEEE Int. Symp. on Circuits and Systems, </booktitle> <address> New Orleans, LA, </address> <month> May </month> <year> 1990, </year> <pages> pp. 914-917. </pages>
Reference-contexts: In our example, for G = 1=2, the coefficient matrix 1 1 1 becomes singular for 0:562. This is in contrast to the behavior of nodal equations, where similar embedding always leads to circuits with non-negative resistances <ref> [15] </ref>. In conclusion, the embedding of a parameter should be done in a manner that avoids non-physical network instances (e.g., occurrence of negative resistors).
Reference: [16] <author> U. Feldmann, U. A. Wever, Q. Zheng, R. Schultz, and H. Wriedt, </author> <title> "Algorithms for modern circuit simulation," </title> <journal> Intern. Journ. Electronics and Comm., </journal> <volume> vol. 46, no. 6, </volume> <pages> pp. 274-285, </pages> <month> July </month> <year> 1992. </year>
Reference-contexts: In conclusion, the embedding of a parameter should be done in a manner that avoids non-physical network instances (e.g., occurrence of negative resistors). For that reason, we opted to implement in an indus trial circuit simulator <ref> [16] </ref> the embeddings suggested by Trajkovic et al., [3]-[6] and by Hasler et al., [17] (see also Mathis [18]). IV. Useful Homotopies A useful embedding approach [17] is to parameterize all nonlinear network elements with in a multiplicative manner. <p> We have generalized the embedding method to MOS transistor circuits and have developed an embedding model for MOS transistors. The implementation was done in the industrial circuit simulator TITAN <ref> [16] </ref> using HOMPACK [11]. We have also added a modification to TITAN for calculating transfer curves. TITAN-HOMPACK Interface is shown in Figure 2. During our simulations, we observed difficulties with choosing the starting points for the homotopy paths.
Reference: [17] <author> M. Hasler and J. Neirynck, </author> <title> Nonlinear Circuits. </title> <address> Norwood, MA: Artech House, </address> <year> 1986. </year>
Reference-contexts: For that reason, we opted to implement in an indus trial circuit simulator [16] the embeddings suggested by Trajkovic et al., [3]-[6] and by Hasler et al., <ref> [17] </ref> (see also Mathis [18]). IV. Useful Homotopies A useful embedding approach [17] is to parameterize all nonlinear network elements with in a multiplicative manner. Starting point of the approach in [17] is the solution of a linear network obtained by setting = 0. <p> For that reason, we opted to implement in an indus trial circuit simulator [16] the embeddings suggested by Trajkovic et al., [3]-[6] and by Hasler et al., <ref> [17] </ref> (see also Mathis [18]). IV. Useful Homotopies A useful embedding approach [17] is to parameterize all nonlinear network elements with in a multiplicative manner. Starting point of the approach in [17] is the solution of a linear network obtained by setting = 0. <p> an indus trial circuit simulator [16] the embeddings suggested by Trajkovic et al., [3]-[6] and by Hasler et al., <ref> [17] </ref> (see also Mathis [18]). IV. Useful Homotopies A useful embedding approach [17] is to parameterize all nonlinear network elements with in a multiplicative manner. Starting point of the approach in [17] is the solution of a linear network obtained by setting = 0. <p> This embedding for diode equations leads to: i d (v; ) = I 0 (exp ((v)=V T ) 1) : (19) The linear network description obtained by setting = 0 corresponds to the descriptive equations of embedding given in <ref> [17] </ref>. Transistors are multi-input elements. Their currents, for example, depend on two junction voltages. Therefore, the embeddings for transistor equations are performed by multiplying each input voltage by . <p> Therefore, we will compare these embed-dings by applying them to several nontrivial circuits. We have shown that the standard embedding is not suitable in case of MNA equations. The embedding proposed by Trajkovic et al., [3]-[6] was much more robust then the embedding proposed by Hasler et al., <ref> [17] </ref> and lead in many cases to fewer Jacobian evaluations. Simulation performance in terms of the number of Jacobian evaluations of several industrial circuits is shown in Table 1. In all cases, the embedding (18) suggested in [3]-[6] was more robust than the embedding approach (12) given in [17]. <p> et al., <ref> [17] </ref> and lead in many cases to fewer Jacobian evaluations. Simulation performance in terms of the number of Jacobian evaluations of several industrial circuits is shown in Table 1. In all cases, the embedding (18) suggested in [3]-[6] was more robust than the embedding approach (12) given in [17]. For example, in the case of the CMOS reference circuit for a 16 Mbit DRAM with 27 equations, the embedding (18) required only 66 Jacobian evaluations (with HOMPACK's fixpNf algorithm), while embedding (12) required 67879 Jaco-bian evaluations. Other examples were even more favorable. VI.
Reference: [18] <author> W. Mathis, </author> <title> Theorie nichtlinearer Netzwerke. </title> <publisher> Berlin: Springer-Verlag, </publisher> <year> 1987. </year>
Reference-contexts: For that reason, we opted to implement in an indus trial circuit simulator [16] the embeddings suggested by Trajkovic et al., [3]-[6] and by Hasler et al., [17] (see also Mathis <ref> [18] </ref>). IV. Useful Homotopies A useful embedding approach [17] is to parameterize all nonlinear network elements with in a multiplicative manner. Starting point of the approach in [17] is the solution of a linear network obtained by setting = 0.
Reference: [19] <author> J. J. Ebers and J. L. </author> <title> Moll "Large-signal behavior of junction transistors," </title> <journal> Proc. IRE, </journal> <volume> vol. 42, </volume> <pages> pp. 1761-1772, </pages> <month> Dec. </month> <year> 1954. </year>
Reference-contexts: The diode current is i d = g (v), where g (v) = I 0 (exp (v=V T ) 1) : (15) This approach can be extended to other nonlinear circuit elements. If a network contains bipolar junction transistors that are described by the Ebers-Moll model <ref> [19] </ref>: I E = ff F +I S [exp (v CB =V T ) 1] ff R where I E is the emitter and I C is the collector current. For the embedding, we use the same approach as in the diode case.
Reference: [20] <author> Y. P. Tsividis, </author> <title> Operation and Modeling of the MOS Transistor. </title> <address> New York: </address> <publisher> McGraw-Hill, </publisher> <year> 1987. </year> + <title> U 0 u 1 - + U 0 R 2 = (1- l)/l + -u 2 u 1 - after parameter embedding. TITAN Input file Homotopy? Newton method Start of TITAN TITAN subroutines Output file HOMPACK Controller Input of HOMPACK parameters HOMPACK TIT AN-HOMP ACK Interface TITAN HOMPACK calls subroutines HOMPACK TITAN calls subroutines Yes No </title>
Reference-contexts: a simplified expression for the non-saturation mode: I D = C (v gs V T h )v ds 2 ds ; (17) where v gs is the gate-sources voltage, v ds is the drain-source voltage, V Th is the threshold voltage, and C and ffi are the MOS transistor parameters <ref> [20] </ref>. Again, the nonlinear terms were replaced by suitable resistors when = 0. An alternative embedding approach [3]-[6] is applicable if the nonlinear operator satisfies condition N (0) = 0. <p> There are other more complex MOS models where the drain current depends on additional internal variables (the Fermi potential in the bulk region F B and the flat-band voltage V F B ) and external vari ables (the source voltage v S ) <ref> [20] </ref>: ~ i D = ~ C v gs V F B 2 F B 2 2 h i In these cases a choice an appropriate parameter embedding remains an open issue.
References-found: 19

